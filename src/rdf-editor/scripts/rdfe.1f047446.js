!function(a){"use strict";function b(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function c(a,b){return a<<b|a>>>32-b}function d(a,d,e,f,g,h){return b(c(b(b(d,a),b(f,h)),g),e)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,c){a[c>>5]|=128<<c%32,a[(c+64>>>9<<4)+14]=c;var d,i,j,k,l,m=1732584193,n=-271733879,o=-1732584194,p=271733878;for(d=0;d<a.length;d+=16)i=m,j=n,k=o,l=p,m=e(m,n,o,p,a[d],7,-680876936),p=e(p,m,n,o,a[d+1],12,-389564586),o=e(o,p,m,n,a[d+2],17,606105819),n=e(n,o,p,m,a[d+3],22,-1044525330),m=e(m,n,o,p,a[d+4],7,-176418897),p=e(p,m,n,o,a[d+5],12,1200080426),o=e(o,p,m,n,a[d+6],17,-1473231341),n=e(n,o,p,m,a[d+7],22,-45705983),m=e(m,n,o,p,a[d+8],7,1770035416),p=e(p,m,n,o,a[d+9],12,-1958414417),o=e(o,p,m,n,a[d+10],17,-42063),n=e(n,o,p,m,a[d+11],22,-1990404162),m=e(m,n,o,p,a[d+12],7,1804603682),p=e(p,m,n,o,a[d+13],12,-40341101),o=e(o,p,m,n,a[d+14],17,-1502002290),n=e(n,o,p,m,a[d+15],22,1236535329),m=f(m,n,o,p,a[d+1],5,-165796510),p=f(p,m,n,o,a[d+6],9,-1069501632),o=f(o,p,m,n,a[d+11],14,643717713),n=f(n,o,p,m,a[d],20,-373897302),m=f(m,n,o,p,a[d+5],5,-701558691),p=f(p,m,n,o,a[d+10],9,38016083),o=f(o,p,m,n,a[d+15],14,-660478335),n=f(n,o,p,m,a[d+4],20,-405537848),m=f(m,n,o,p,a[d+9],5,568446438),p=f(p,m,n,o,a[d+14],9,-1019803690),o=f(o,p,m,n,a[d+3],14,-187363961),n=f(n,o,p,m,a[d+8],20,1163531501),m=f(m,n,o,p,a[d+13],5,-1444681467),p=f(p,m,n,o,a[d+2],9,-51403784),o=f(o,p,m,n,a[d+7],14,1735328473),n=f(n,o,p,m,a[d+12],20,-1926607734),m=g(m,n,o,p,a[d+5],4,-378558),p=g(p,m,n,o,a[d+8],11,-2022574463),o=g(o,p,m,n,a[d+11],16,1839030562),n=g(n,o,p,m,a[d+14],23,-35309556),m=g(m,n,o,p,a[d+1],4,-1530992060),p=g(p,m,n,o,a[d+4],11,1272893353),o=g(o,p,m,n,a[d+7],16,-155497632),n=g(n,o,p,m,a[d+10],23,-1094730640),m=g(m,n,o,p,a[d+13],4,681279174),p=g(p,m,n,o,a[d],11,-358537222),o=g(o,p,m,n,a[d+3],16,-722521979),n=g(n,o,p,m,a[d+6],23,76029189),m=g(m,n,o,p,a[d+9],4,-640364487),p=g(p,m,n,o,a[d+12],11,-421815835),o=g(o,p,m,n,a[d+15],16,530742520),n=g(n,o,p,m,a[d+2],23,-995338651),m=h(m,n,o,p,a[d],6,-198630844),p=h(p,m,n,o,a[d+7],10,1126891415),o=h(o,p,m,n,a[d+14],15,-1416354905),n=h(n,o,p,m,a[d+5],21,-57434055),m=h(m,n,o,p,a[d+12],6,1700485571),p=h(p,m,n,o,a[d+3],10,-1894986606),o=h(o,p,m,n,a[d+10],15,-1051523),n=h(n,o,p,m,a[d+1],21,-2054922799),m=h(m,n,o,p,a[d+8],6,1873313359),p=h(p,m,n,o,a[d+15],10,-30611744),o=h(o,p,m,n,a[d+6],15,-1560198380),n=h(n,o,p,m,a[d+13],21,1309151649),m=h(m,n,o,p,a[d+4],6,-145523070),p=h(p,m,n,o,a[d+11],10,-1120210379),o=h(o,p,m,n,a[d+2],15,718787259),n=h(n,o,p,m,a[d+9],21,-343485551),m=b(m,i),n=b(n,j),o=b(o,k),p=b(p,l);return[m,n,o,p]}function j(a){var b,c="";for(b=0;b<32*a.length;b+=8)c+=String.fromCharCode(a[b>>5]>>>b%32&255);return c}function k(a){var b,c=[];for(c[(a.length>>2)-1]=void 0,b=0;b<c.length;b+=1)c[b]=0;for(b=0;b<8*a.length;b+=8)c[b>>5]|=(255&a.charCodeAt(b/8))<<b%32;return c}function l(a){return j(i(k(a),8*a.length))}function m(a,b){var c,d,e=k(a),f=[],g=[];for(f[15]=g[15]=void 0,e.length>16&&(e=i(e,8*a.length)),c=0;16>c;c+=1)f[c]=909522486^e[c],g[c]=1549556828^e[c];return d=i(f.concat(k(b)),512+8*b.length),j(i(g.concat(d),640))}function n(a){var b,c,d="0123456789abcdef",e="";for(c=0;c<a.length;c+=1)b=a.charCodeAt(c),e+=d.charAt(b>>>4&15)+d.charAt(15&b);return e}function o(a){return unescape(encodeURIComponent(a))}function p(a){return l(o(a))}function q(a){return n(p(a))}function r(a,b){return m(o(a),o(b))}function s(a,b){return n(r(a,b))}a.md5=function(a,b,c){return b?c?r(b,a):s(b,a):c?p(a):q(a)}}("function"==typeof jQuery?jQuery:this),function(){var a=this,b=a._,c=Array.prototype,d=Object.prototype,e=Function.prototype,f=c.push,g=c.slice,h=c.concat,i=d.toString,j=d.hasOwnProperty,k=Array.isArray,l=Object.keys,m=e.bind,n=function(a){return a instanceof n?a:this instanceof n?void(this._wrapped=a):new n(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=n),exports._=n):a._=n,n.VERSION="1.7.0";var o=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}};n.iteratee=function(a,b,c){return null==a?n.identity:n.isFunction(a)?o(a,b,c):n.isObject(a)?n.matches(a):n.property(a)},n.each=n.forEach=function(a,b,c){if(null==a)return a;b=o(b,c);var d,e=a.length;if(e===+e)for(d=0;e>d;d++)b(a[d],d,a);else{var f=n.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},n.map=n.collect=function(a,b,c){if(null==a)return[];b=n.iteratee(b,c);for(var d,e=a.length!==+a.length&&n.keys(a),f=(e||a).length,g=Array(f),h=0;f>h;h++)d=e?e[h]:h,g[h]=b(a[d],d,a);return g};var p="Reduce of empty array with no initial value";n.reduce=n.foldl=n.inject=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length,h=0;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[h++]:h++]}for(;g>h;h++)e=f?f[h]:h,c=b(c,a[e],e,a);return c},n.reduceRight=n.foldr=function(a,b,c,d){null==a&&(a=[]),b=o(b,d,4);var e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;if(arguments.length<3){if(!g)throw new TypeError(p);c=a[f?f[--g]:--g]}for(;g--;)e=f?f[g]:g,c=b(c,a[e],e,a);return c},n.find=n.detect=function(a,b,c){var d;return b=n.iteratee(b,c),n.some(a,function(a,c,e){return b(a,c,e)?(d=a,!0):void 0}),d},n.filter=n.select=function(a,b,c){var d=[];return null==a?d:(b=n.iteratee(b,c),n.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d)},n.reject=function(a,b,c){return n.filter(a,n.negate(n.iteratee(b)),c)},n.every=n.all=function(a,b,c){if(null==a)return!0;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,!b(a[e],e,a))return!1;return!0},n.some=n.any=function(a,b,c){if(null==a)return!1;b=n.iteratee(b,c);var d,e,f=a.length!==+a.length&&n.keys(a),g=(f||a).length;for(d=0;g>d;d++)if(e=f?f[d]:d,b(a[e],e,a))return!0;return!1},n.contains=n.include=function(a,b){return null==a?!1:(a.length!==+a.length&&(a=n.values(a)),n.indexOf(a,b)>=0)},n.invoke=function(a,b){var c=g.call(arguments,2),d=n.isFunction(b);return n.map(a,function(a){return(d?b:a[b]).apply(a,c)})},n.pluck=function(a,b){return n.map(a,n.property(b))},n.where=function(a,b){return n.filter(a,n.matches(b))},n.findWhere=function(a,b){return n.find(a,n.matches(b))},n.max=function(a,b,c){var d,e,f=-1/0,g=-1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-1/0&&f===-1/0)&&(f=a,g=e)});return f},n.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=a.length===+a.length?a:n.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=n.iteratee(b,c),n.each(a,function(a,c,d){e=b(a,c,d),(g>e||1/0===e&&1/0===f)&&(f=a,g=e)});return f},n.shuffle=function(a){for(var b,c=a&&a.length===+a.length?a:n.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=n.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},n.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=n.values(a)),a[n.random(a.length-1)]):n.shuffle(a).slice(0,Math.max(0,b))},n.sortBy=function(a,b,c){return b=n.iteratee(b,c),n.pluck(n.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var q=function(a){return function(b,c,d){var e={};return c=n.iteratee(c,d),n.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};n.groupBy=q(function(a,b,c){n.has(a,c)?a[c].push(b):a[c]=[b]}),n.indexBy=q(function(a,b,c){a[c]=b}),n.countBy=q(function(a,b,c){n.has(a,c)?a[c]++:a[c]=1}),n.sortedIndex=function(a,b,c,d){c=n.iteratee(c,d,1);for(var e=c(b),f=0,g=a.length;g>f;){var h=f+g>>>1;c(a[h])<e?f=h+1:g=h}return f},n.toArray=function(a){return a?n.isArray(a)?g.call(a):a.length===+a.length?n.map(a,n.identity):n.values(a):[]},n.size=function(a){return null==a?0:a.length===+a.length?a.length:n.keys(a).length},n.partition=function(a,b,c){b=n.iteratee(b,c);var d=[],e=[];return n.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},n.first=n.head=n.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:g.call(a,0,b)},n.initial=function(a,b,c){return g.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},n.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:g.call(a,Math.max(a.length-b,0))},n.rest=n.tail=n.drop=function(a,b,c){return g.call(a,null==b||c?1:b)},n.compact=function(a){return n.filter(a,n.identity)};var r=function(a,b,c,d){if(b&&n.every(a,n.isArray))return h.apply(d,a);for(var e=0,g=a.length;g>e;e++){var i=a[e];n.isArray(i)||n.isArguments(i)?b?f.apply(d,i):r(i,b,c,d):c||d.push(i)}return d};n.flatten=function(a,b){return r(a,b,!1,[])},n.without=function(a){return n.difference(a,g.call(arguments,1))},n.uniq=n.unique=function(a,b,c,d){if(null==a)return[];n.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=n.iteratee(c,d));for(var e=[],f=[],g=0,h=a.length;h>g;g++){var i=a[g];if(b)g&&f===i||e.push(i),f=i;else if(c){var j=c(i,g,a);n.indexOf(f,j)<0&&(f.push(j),e.push(i))}else n.indexOf(e,i)<0&&e.push(i)}return e},n.union=function(){return n.uniq(r(arguments,!0,!0,[]))},n.intersection=function(a){if(null==a)return[];for(var b=[],c=arguments.length,d=0,e=a.length;e>d;d++){var f=a[d];if(!n.contains(b,f)){for(var g=1;c>g&&n.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},n.difference=function(a){var b=r(g.call(arguments,1),!0,!0,[]);return n.filter(a,function(a){return!n.contains(b,a)})},n.zip=function(a){if(null==a)return[];for(var b=n.max(arguments,"length").length,c=Array(b),d=0;b>d;d++)c[d]=n.pluck(arguments,d);return c},n.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},n.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=n.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}for(;e>d;d++)if(a[d]===b)return d;return-1},n.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=a.length;for("number"==typeof c&&(d=0>c?d+c+1:Math.min(d,c+1));--d>=0;)if(a[d]===b)return d;return-1},n.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var s=function(){};n.bind=function(a,b){var c,d;if(m&&a.bind===m)return m.apply(a,g.call(arguments,1));if(!n.isFunction(a))throw new TypeError("Bind must be called on a function");return c=g.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(g.call(arguments)));s.prototype=a.prototype;var e=new s;s.prototype=null;var f=a.apply(e,c.concat(g.call(arguments)));return n.isObject(f)?f:e}},n.partial=function(a){var b=g.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===n&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},n.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=n.bind(a[c],a);return a},n.memoize=function(a,b){var c=function(d){var e=c.cache,f=b?b.apply(this,arguments):d;return n.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},n.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},n.defer=function(a){return n.delay.apply(n,[a,1].concat(g.call(arguments,1)))},n.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:n.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=n.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},n.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=n.now()-g;b>j&&j>0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=n.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},n.wrap=function(a,b){return n.partial(b,a)},n.negate=function(a){return function(){return!a.apply(this,arguments)}},n.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},n.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},n.before=function(a,b){var c;return function(){return--a>0?c=b.apply(this,arguments):b=null,c}},n.once=n.partial(n.before,2),n.keys=function(a){if(!n.isObject(a))return[];if(l)return l(a);var b=[];for(var c in a)n.has(a,c)&&b.push(c);return b},n.values=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},n.pairs=function(a){for(var b=n.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},n.invert=function(a){for(var b={},c=n.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},n.functions=n.methods=function(a){var b=[];for(var c in a)n.isFunction(a[c])&&b.push(c);return b.sort()},n.extend=function(a){if(!n.isObject(a))return a;for(var b,c,d=1,e=arguments.length;e>d;d++){b=arguments[d];for(c in b)j.call(b,c)&&(a[c]=b[c])}return a},n.pick=function(a,b,c){var d,e={};if(null==a)return e;if(n.isFunction(b)){b=o(b,c);for(d in a){var f=a[d];b(f,d,a)&&(e[d]=f)}}else{var i=h.apply([],g.call(arguments,1));a=new Object(a);for(var j=0,k=i.length;k>j;j++)d=i[j],d in a&&(e[d]=a[d])}return e},n.omit=function(a,b,c){if(n.isFunction(b))b=n.negate(b);else{var d=n.map(h.apply([],g.call(arguments,1)),String);b=function(a,b){return!n.contains(d,b)}}return n.pick(a,b,c)},n.defaults=function(a){if(!n.isObject(a))return a;for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)void 0===a[e]&&(a[e]=d[e])}return a},n.clone=function(a){return n.isObject(a)?n.isArray(a)?a.slice():n.extend({},a):a},n.tap=function(a,b){return b(a),a};var t=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof n&&(a=a._wrapped),b instanceof n&&(b=b._wrapped);var e=i.call(a);if(e!==i.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]===a)return d[f]===b;var g=a.constructor,h=b.constructor;if(g!==h&&"constructor"in a&&"constructor"in b&&!(n.isFunction(g)&&g instanceof g&&n.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var j,k;if("[object Array]"===e){if(j=a.length,k=j===b.length)for(;j--&&(k=t(a[j],b[j],c,d)););}else{var l,m=n.keys(a);if(j=m.length,k=n.keys(b).length===j)for(;j--&&(l=m[j],k=n.has(b,l)&&t(a[l],b[l],c,d)););}return c.pop(),d.pop(),k};n.isEqual=function(a,b){return t(a,b,[],[])},n.isEmpty=function(a){if(null==a)return!0;if(n.isArray(a)||n.isString(a)||n.isArguments(a))return 0===a.length;for(var b in a)if(n.has(a,b))return!1;return!0},n.isElement=function(a){return!(!a||1!==a.nodeType)},n.isArray=k||function(a){return"[object Array]"===i.call(a)},n.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},n.each(["Arguments","Function","String","Number","Date","RegExp"],function(a){n["is"+a]=function(b){return i.call(b)==="[object "+a+"]"}}),n.isArguments(arguments)||(n.isArguments=function(a){return n.has(a,"callee")}),"function"!=typeof/./&&(n.isFunction=function(a){return"function"==typeof a||!1}),n.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},n.isNaN=function(a){return n.isNumber(a)&&a!==+a},n.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===i.call(a)},n.isNull=function(a){return null===a},n.isUndefined=function(a){return void 0===a},n.has=function(a,b){return null!=a&&j.call(a,b)},n.noConflict=function(){return a._=b,this},n.identity=function(a){return a},n.constant=function(a){return function(){return a}},n.noop=function(){},n.property=function(a){return function(b){return b[a]}},n.matches=function(a){var b=n.pairs(a),c=b.length;return function(a){if(null==a)return!c;a=new Object(a);for(var d=0;c>d;d++){var e=b[d],f=e[0];if(e[1]!==a[f]||!(f in a))return!1}return!0}},n.times=function(a,b,c){var d=Array(Math.max(0,a));b=o(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},n.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},n.now=Date.now||function(){return(new Date).getTime()};var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},v=n.invert(u),w=function(a){var b=function(b){return a[b]},c="(?:"+n.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};n.escape=w(u),n.unescape=w(v),n.result=function(a,b){if(null==a)return void 0;var c=a[b];return n.isFunction(c)?a[b]():c};var x=0;n.uniqueId=function(a){var b=++x+"";return a?a+b:b},n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/(.)^/,z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},A=/\\|'|\r|\n|\u2028|\u2029/g,B=function(a){return"\\"+z[a]};n.template=function(a,b,c){!b&&c&&(b=c),b=n.defaults({},b,n.templateSettings);var d=RegExp([(b.escape||y).source,(b.interpolate||y).source,(b.evaluate||y).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(A,B),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,n)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},n.chain=function(a){var b=n(a);return b._chain=!0,b};var C=function(a){return this._chain?n(a).chain():a};n.mixin=function(a){n.each(n.functions(a),function(b){var c=n[b]=a[b];n.prototype[b]=function(){var a=[this._wrapped];return f.apply(a,arguments),C.call(this,c.apply(n,a))}})},n.mixin(n),n.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=c[a];n.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],C.call(this,c)}}),n.each(["concat","join","slice"],function(a){var b=c[a];n.prototype[a]=function(){return C.call(this,b.apply(this._wrapped,arguments))}}),n.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return n})}.call(this),function(a,b){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(c,d,e){a.Backbone=b(a,e,c,d)});else if("undefined"!=typeof exports){var c=require("underscore");b(a,exports,c)}else a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b,c,d){var e=a.Backbone,f=[],g=(f.push,f.slice);f.splice;b.VERSION="1.1.2",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var h=b.Events={on:function(a,b,c){if(!j(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,d){if(!j(this,"once",a,[b,d])||!b)return this;var e=this,f=c.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,d)},off:function(a,b,d){var e,f,g,h,i,k,l,m;if(!this._events||!j(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events=void 0,this;for(h=a?[a]:c.keys(this._events),i=0,k=h.length;k>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],b||d)for(l=0,m=g.length;m>l;l++)f=g[l],(b&&b!==f.callback&&b!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=g.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&k(c,b),d&&k(d,arguments),this},stopListening:function(a,b,d){var e=this._listeningTo;if(!e)return this;var f=!b&&!d;d||"object"!=typeof b||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(b,d,this),(f||c.isEmpty(a._events))&&delete this._listeningTo[g];return this}},i=/\s+/,j=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(i.test(c)){for(var f=c.split(i),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},k=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},l={listenTo:"on",listenToOnce:"once"};c.each(l,function(a,b){h[b]=function(b,d,e){var f=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=c.uniqueId("l"));return f[g]=b,e||"object"!=typeof d||(e=this),b[a](d,e,this),this}}),h.bind=h.on,h.unbind=h.off,c.extend(b,h);var m=b.Model=function(a,b){var d=a||{};b||(b={}),this.cid=c.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{}),d=c.defaults({},d,c.result(this,"defaults")),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(m.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,d){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,d=b):(f={})[a]=b,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=c.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)b=f[e],c.isEqual(l[e],b)||h.push(e),c.isEqual(k[e],b)?delete this.changed[e]:this.changed[e]=b,g?delete l[e]:l[e]=b;if(!i){h.length&&(this._pending=d);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],d)}if(j)return this;if(!i)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b,d=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)c.isEqual(e[f],b=a[f])||((d||(d={}))[f]=b);return d},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,d=a.success;return a.success=function(c){return b.set(b.parse(c,a),a)?(d&&d(b,c,a),void b.trigger("sync",b,c,a)):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,d){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0},d),e&&!d.wait){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;e&&d.wait&&(this.attributes=c.extend({},h,e)),void 0===d.parse&&(d.parse=!0);var i=this,j=d.success;return d.success=function(a){i.attributes=h;var b=i.parse(a,d);return d.wait&&(b=c.extend(e||{},b)),c.isObject(b)&&!i.set(b,d)?!1:(j&&j(i,a,d),void i.trigger("sync",i,a,d))},L(this,d),f=this.isNew()?"create":d.patch?"patch":"update","patch"===f&&(d.attrs=e),g=this.sync(f,this,d),e&&d.wait&&(this.attributes=h),g},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(c){(a.wait||b.isNew())&&e(),d&&d(b,c,a),b.isNew()||b.trigger("sync",b,c,a)},this.isNew())return a.success(),!1;L(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||K();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return d?(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1):!0}});var n=["keys","values","pairs","invert","pick","omit"];c.each(n,function(a){m.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.attributes),c[a].apply(c,b)}});var o=b.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},p={add:!0,remove:!0,merge:!0},q={add:!0,remove:!1};c.extend(o.prototype,h,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,q))},remove:function(a,b){var d=!c.isArray(a);a=d?[a]:c.clone(a),b||(b={});var e,f,g,h;for(e=0,f=a.length;f>e;e++)h=a[e]=this.get(a[e]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h,b));return d?a[0]:a},set:function(a,b){b=c.defaults({},b,p),b.parse&&(a=this.parse(a,b));var d=!c.isArray(a);a=d?a?[a]:[]:c.clone(a);var e,f,g,h,i,j,k,l=b.at,n=this.model,o=this.comparator&&null==l&&b.sort!==!1,q=c.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!o&&u&&w?[]:!1;for(e=0,f=a.length;f>e;e++){if(i=a[e]||{},g=i instanceof m?h=i:i[n.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),o&&!k&&j.hasChanged(q)&&(k=!0)),a[e]=j;else if(u){if(h=a[e]=this._prepareModel(i,b),!h)continue;r.push(h),this._addReference(h,b)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;f>e;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(o&&(k=!0),this.length+=r.length,null!=l)for(e=0,f=r.length;f>e;e++)this.models.splice(l+e,0,r[e]);else{x&&(this.models.length=0);var y=x||r;for(e=0,f=y.length;f>e;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!b.silent){for(e=0,f=r.length;f>e;e++)(h=r[e]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return d?a[0]:a},reset:function(a,b){b||(b={});for(var d=0,e=this.models.length;e>d;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return g.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a]||this._byId[a.id]||this._byId[a.cid]},at:function(a){return this.models[a]},where:function(a,b){return c.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b(d,c,a),d.trigger("sync",d,c,a)},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?c.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var d=this,e=b.success;return b.success=function(a,c){b.wait&&d.add(a,b),e&&e(a,c,b)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof m)return a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var r=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];c.each(r,function(a){o.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.models),c[a].apply(c,b)}});var s=["groupBy","countBy","sortBy","indexBy"];c.each(s,function(a){o.prototype[a]=function(b,d){var e=c.isFunction(b)?b:function(a){return a.get(b)};return c[a](this.models,e,d)}});var t=b.View=function(a){this.cid=c.uniqueId("view"),a||(a={}),c.extend(this,c.pick(a,v)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},u=/^(\S+)\s*(.*)$/,v=["model","collection","el","id","attributes","className","tagName","events"];c.extend(t.prototype,h,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,c){return this.$el&&this.undelegateEvents(),this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=c.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[a[b]]),d){var e=b.match(u),f=e[1],g=e[2];d=c.bind(d,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,d):this.$el.on(f,g,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"),!1);else{
var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a["class"]=c.result(this,"className"));var d=b.$("<"+c.result(this,"tagName")+">").attr(a);this.setElement(d,!1)}}}),b.sync=function(a,d,e){var f=x[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||K()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),h?h.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1),"PATCH"===g.type&&w&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,i,e),i};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var y=b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},z=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,B=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(y.prototype,h,{initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);f.execute(e,g),f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(C,"\\$&").replace(z,"(?:$1)?").replace(A,function(a,b){return b?a:"([^/?]+)"}).replace(B,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var D=b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,G=/msie [\w.]+/,H=/\/$/,I=/#.*$/;D.started=!1,c.extend(D.prototype,h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(H,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(E,"")},start:function(a){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var d=this.getFragment(),e=document.documentMode,f=G.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e);if(this.root=("/"+this.root+"/").replace(F,"/"),f&&this._wantsHashChange){var g=b.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=g.hide().appendTo("body")[0].contentWindow,this.navigate(d)}this._hasPushState?b.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?b.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var h=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&h.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){b.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment?!1:(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),c.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!D.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(I,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new D;var J=function(a,b){var d,e=this;d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&c.extend(d.prototype,a),d.__super__=e.prototype,d};m.extend=o.extend=y.extend=t.extend=D.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return b}),!function(a){!function(){function b(a,b){for(var d in j)b?a.prototype[d]=c(j[d]):a[d]=j[d];return a}function c(a){return function(b){return a(this,b)}}var d="http://www.w3.org/2001/XMLSchema#",e=d+"string",f=d+"integer",g=d+"decimal",h=d+"boolean",i="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",j={isIRI:function(a){if(!a)return a;var b=a[0];return'"'!==b&&"_"!==b},isLiteral:function(a){return a&&'"'===a[0]},isBlank:function(a){return a&&"_:"===a.substr(0,2)},getLiteralValue:function(a){var b=/^"([^]*)"/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]},getLiteralType:function(a){var b=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]||(b[2]?i:e)},getLiteralLanguage:function(a){var b=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]?b[1].toLowerCase():""},isPrefixedName:function(a){return a&&/^[^:\/"']*:[^:\/"']+$/.test(a)},expandPrefixedName:function(a,b){var c,d,e,f=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(a);return f&&(c=f[1],d=b[c],e=f.index),void 0===d?a:0===e?d+a.substr(c.length+1):a.substr(0,e+3)+d+a.substr(e+c.length+4)},createIRI:function(a){return a&&'"'===a[0]?j.getLiteralValue(a):a},createLiteral:function(a,b){if(!b)switch(typeof a){case"boolean":b=h;break;case"number":if(isFinite(a)){b=a%1===0?f:g;break}default:return'"'+a+'"'}return'"'+a+(/^[a-z]+(-[a-z0-9]+)*$/i.test(b)?'"@'+b.toLowerCase():'"^^'+b)},prefix:function(a){return j.prefixes({"":a})("")},prefixes:function(a){function b(a,b){if(b||!(a in c)){var d=Object.create(null);b=b||"",c[a]=function(a){return d[a]||(d[a]=b+a)}}return c[a]}var c=Object.create(null);for(var d in a)b(d,a[d]);return b}};a.Util=b(b)}(),function(){function b(a){if(!(this instanceof b))return new b(a);if(a=a||{},a.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var c=this;this._tokenize=this.tokenize,this.tokenize=function(a,b){this._tokenize(a,function(a,d){!a&&/^(?:IRI|prefixed|literal|langcode|type|\.|eof)$/.test(d.type)?b&&b(a,d):b&&b(a||c._syntaxError(d.type,b=null))})}}this._n3Mode=a.n3!==!1,this._comments=!!a.comments}var c=String.fromCharCode,d="function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},e=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,f={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},g=/[\x00-\x20<>\\"\{\}\|\^\`]/;b.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\]+"(?=[^"\\])/,_singleQuotedString:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=[.,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(a,b){function c(b){a(b._syntaxError(/^\S*/.exec(d)[0]))}for(var d=this._input,e=this._comments;;){for(var f,h;f=this._newline.exec(d);)e&&(h=this._comment.exec(f[0]))&&a(null,{line:this._line,type:"comment",value:h[1],prefix:""}),d=d.substr(f[0].length,d.length),this._line++;if((f=this._whitespace.exec(d))&&(d=d.substr(f[0].length,d.length)),this._endOfFile.test(d))return b&&(e&&(h=this._comment.exec(d))&&a(null,{line:this._line,type:"comment",value:h[1],prefix:""}),a(d=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=d;var i,j=this._line,k="",l="",m="",n=d[0],o=null,p=0,q=!1;switch(n){case"^":if(d.length<3)break;if("^"!==d[1]){this._n3Mode&&(p=1,k="^");break}if(this._prevTokenType="^^",d=d.substr(2),"<"!==d[0]){q=!0;break}case"<":if(o=this._unescapedIri.exec(d))k="IRI",l=o[1];else if(o=this._iri.exec(d)){if(i=this._unescape(o[1]),null===i||g.test(i))return c(this);k="IRI",l=i}else this._n3Mode&&d.length>1&&"="===d[1]&&(k="inverse",p=2,l="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((o=this._blank.exec(d))||b&&(o=this._blank.exec(d+" ")))&&(k="blank",m="_",l=o[1]);break;case'"':case"'":if(o=this._unescapedString.exec(d))k="literal",l=o[0];else if(o=this._singleQuotedString.exec(d)){if(i=this._unescape(o[0]),null===i)return c(this);k="literal",l=i.replace(/^'|'$/g,'"')}else if(o=this._tripleQuotedString.exec(d)){if(i=o[1]||o[2],this._line+=i.split(/\r\n|\r|\n/).length-1,i=this._unescape(i),null===i)return c(this);k="literal",l=i.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(o=this._variable.exec(d))&&(k="var",l=o[0]);break;case"@":"literal"===this._prevTokenType&&(o=this._langcode.exec(d))?(k="langcode",l=o[1]):(o=this._keyword.exec(d))&&(k=o[0]);break;case".":if(1===d.length?b:d[1]<"0"||d[1]>"9"){k=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(o=this._number.exec(d))&&(k="literal",l='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(o[1]?"double":/^[+\-]?\d+$/.test(o[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(o=this._sparqlKeyword.exec(d))?k=o[0].toUpperCase():q=!0;break;case"f":case"t":(o=this._boolean.exec(d))?(k="literal",l='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):q=!0;break;case"a":(o=this._shortPredicates.exec(d))?(k="abbreviation",l="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):q=!0;break;case"=":this._n3Mode&&d.length>1&&(k="abbreviation",">"!==d[1]?(p=1,l="http://www.w3.org/2002/07/owl#sameAs"):(p=2,l="http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":p=1,k=n;break;default:q=!0}if(q&&("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(o=this._prefix.exec(d))?((o=this._prefixed.exec(d))||b&&(o=this._prefixed.exec(d+" ")))&&(k="prefixed",m=o[1]||"",l=this._unescape(o[2])):(k="prefix",l=o[1]||"")),"^^"===this._prevTokenType)switch(k){case"prefixed":k="type";break;case"IRI":k="typeIRI";break;default:k=""}if(!k)return b||!/^'''|^"""/.test(d)&&/\n|\r/.test(d)?c(this):this._input=d;a(null,{line:j,type:k,value:l,prefix:m}),this._prevTokenType=k,d=d.substr(p||o[0].length,d.length)}},_unescape:function(a){try{return a.replace(e,function(a,b,d,e){var g;if(b){if(g=parseInt(b,16),isNaN(g))throw new Error;return c(g)}if(d){if(g=parseInt(d,16),isNaN(g))throw new Error;return 65535>=g?c(g):c(55296+(g-=65536)/1024,56320+(1023&g))}var h=f[e];if(!h)throw new Error;return h})}catch(a){return null}},_syntaxError:function(a){return this._input=null,new Error('Unexpected "'+a+'" on line '+this._line+".")},tokenize:function(a,b){var c=this;if(this._line=1,"string"==typeof a){if(this._input=a,"function"!=typeof b){var e,f=[];if(this._tokenizeToEnd(function(a,b){a?e=a:f.push(b)},!0),e)throw e;return f}d(function(){c._tokenizeToEnd(b,!0)})}else this._input="","function"==typeof a.setEncoding&&a.setEncoding("utf8"),a.on("data",function(a){null!==c._input&&(c._input+=a,c._tokenizeToEnd(b,!1))}),a.on("end",function(){null!==c._input&&c._tokenizeToEnd(b,!0)})}},a.Lexer=b}(),function(){function b(a){if(!(this instanceof b))return new b(a);this._contextStack=[],this._graph=null,a=a||{},this._setBase(a.documentIRI);var e="string"==typeof a.format?a.format.match(/\w*$/)[0].toLowerCase():"",f="turtle"===e,g="trig"===e,h=/triple/.test(e),i=/quad/.test(e),j=this._n3Mode=/n3/.test(e),k=h||i;(this._supportsNamedGraphs=!(f||j))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(f||g||h||j),k&&(this._base="",this._resolveIRI=function(a){return this._error("Disallowed relative IRI",a),this._callback=c,this._subject=null}),this._blankNodePrefix="string"!=typeof a.blankNodePrefix?"":"_:"+a.blankNodePrefix.replace(/^_:/,""),this._lexer=a.lexer||new d({lineMode:k,n3:j}),this._explicitQuantifiers=!!a.explicitQuantifiers}function c(){}var d=a.Lexer,e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",f=e+"nil",g=e+"first",h=e+"rest",i="urn:n3:quantifiers",j=/^[a-z][a-z0-9+.-]*:/i,k=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,l=/(?:^|\/)\.\.?(?:$|[\/#?])/,m=0,n=0;b._resetBlankNodeIds=function(){m=n=0},b.prototype={_setBase:function(a){if(a){var b=a.indexOf("#");b>=0&&(a=a.substr(0,b)),this._base=a,this._basePath=a.indexOf("/")<0?a:a.replace(/[^\/?]*(?:\?.*)?$/,""),a=a.match(k),this._baseRoot=a[0],this._baseScheme=a[1]}else this._base=null},_saveContext:function(a,b,c,d,e){var f=this._n3Mode;this._contextStack.push({subject:c,predicate:d,object:e,graph:b,type:a,inverse:!!f&&this._inversePredicate,blankPrefix:f?this._prefixes._:"",quantified:f?this._quantified:null}),f&&(this._inversePredicate=!1,this._prefixes._=this._graph+".",this._quantified=Object.create(this._quantified))},_restoreContext:function(){var a=this._contextStack.pop(),b=this._n3Mode;this._subject=a.subject,this._predicate=a.predicate,this._object=a.object,this._graph=a.graph,b&&(this._inversePredicate=a.inverse,this._prefixes._=a.blankPrefix,this._quantified=a.quantified)},_readInTopContext:function(a){switch(a.type){case"eof":return null!==this._graph?this._error("Unclosed graph",a):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(a)}},_readEntity:function(a,b){var c;switch(a.type){case"IRI":case"typeIRI":c=null===this._base||j.test(a.value)?a.value:this._resolveIRI(a);break;case"type":case"blank":case"prefixed":var d=this._prefixes[a.prefix];if(void 0===d)return this._error('Undefined prefix "'+a.prefix+':"',a);c=d+a.value;break;case"var":return a.value;default:return this._error("Expected entity but got "+a.type,a)}return!b&&this._n3Mode&&c in this._quantified&&(c=this._quantified[c]),c},_readSubject:function(a){switch(this._predicate=null,a.type){case"[":return this._saveContext("blank",this._graph,this._subject="_:b"+n++,null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,f,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph="_:b"+n++,null,null),this._readSubject):this._error("Unexpected graph",a);case"}":return this._readPunctuation(a);case"@forSome":return this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forSome",this._quantifiedPrefix="_:b",this._readQuantifierList;case"@forAll":return this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forAll",this._quantifiedPrefix="?b-",this._readQuantifierList;default:if(void 0===(this._subject=this._readEntity(a)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph},_readPredicate:function(a){var b=a.type;switch(b){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=a.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+b,a):(this._subject=null,"]"===b?this._readBlankNodeTail(a):this._readPunctuation(a));case";":return this._readPredicate;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",a);default:if(void 0===(this._predicate=this._readEntity(a)))return}return this._readObject},_readObject:function(a){switch(a.type){case"literal":return this._object=a.value,this._readDataTypeOrLang;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject="_:b"+n++),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,f),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph="_:b"+n++),this._readSubject):this._error("Unexpected graph",a);default:if(void 0===(this._object=this._readEntity(a)))return;if(this._n3Mode)return this._getPathReader(this._getTripleEndReader())}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(a){return"{"===a.type?this._readGraph(a):this._readPredicate(a)},_readGraph:function(a){return"{"!==a.type?this._error("Expected graph but got "+a.type,a):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(a){return"]"===a.type?(this._subject=null,this._readBlankNodeTail(a)):(this._predicate=null,this._readPredicate(a))},_readBlankNodeTail:function(a){if("]"!==a.type)return this._readBlankNodePunctuation(a);null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph);var b=null===this._predicate;return this._restoreContext(),null===this._object?b?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getTripleEndReader()},_readPredicateAfterBlank:function(a){return"."!==a.type||this._contextStack.length?this._readPredicate(a):(this._subject=null,this._readPunctuation(a))},_readDataTypeOrLang:function(a){var b;switch(a.type){case"type":case"typeIRI":b="^^"+this._readEntity(a);break;case"langcode":b="@"+a.value.toLowerCase();break;default:return this._readCallback=this._getTripleEndReader(),this._readCallback(a)}return this._object+=b,this._getTripleEndReader()},_readListItem:function(a){var b=null,c=null,d=this._subject,e=this._contextStack,i=e[e.length-1],j=this._readListItem;switch(a.type){case"[":this._saveContext("blank",this._graph,c="_:b"+n++,g,this._subject=b="_:b"+n++),j=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,c="_:b"+n++,g,f),this._subject=null;break;case")":if(this._restoreContext(),0!==e.length&&"list"===e[e.length-1].type&&this._triple(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(j=this._readPredicate,this._subject===f)return j}else if(j=this._getTripleEndReader(),this._object===f)return j;c=f;break;case"literal":b=a.value,j=this._readDataTypeOrLang;break;default:if(void 0===(b=this._readEntity(a)))return}if(null===c&&(this._subject=c="_:b"+n++),null===d?null===i.predicate?i.subject=c:i.object=c:this._triple(d,h,c,this._graph),null!==b){if(this._n3Mode&&("IRI"===a.type||"prefixed"===a.type))return this._saveContext("item",this._graph,c,g,b),this._subject=b,this._predicate=null,this._getPathReader(this._readListItem);this._triple(c,g,b,this._graph)}return j},_readFormulaTail:function(a){return"}"!==a.type?this._readPunctuation(a):(null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getTripleEndReader())},_readPunctuation:function(a){var b,c=this._subject,d=this._graph,e=this._inversePredicate;switch(a.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",a);if(this._n3Mode)return this._readFormulaTail(a);this._graph=null;case".":this._subject=null,b=this._contextStack.length?this._readSubject:this._readInTopContext,e&&(this._inversePredicate=!1);break;case";":b=this._readPredicate;break;case",":b=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(d=this._readEntity(a))){b=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object+'"',a)}if(null!==c){var f=this._predicate,g=this._object;e?this._triple(g,f,c,d):this._triple(c,f,g,d)}return b},_readBlankNodePunctuation:function(a){var b;switch(a.type){case";":b=this._readPredicate;break;case",":b=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}return this._triple(this._subject,this._predicate,this._object,this._graph),b},_readQuadPunctuation:function(a){return"."!==a.type?this._error("Expected dot to follow quad",a):this._readInTopContext},_readPrefix:function(a){return"prefix"!==a.type?this._error("Expected prefix to follow @prefix",a):(this._prefix=a.value,this._readPrefixIRI)},_readPrefixIRI:function(a){if("IRI"!==a.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',a);var b=this._readEntity(a);return this._prefixes[this._prefix]=b,this._prefixCallback(this._prefix,b),this._readDeclarationPunctuation},_readBaseIRI:function(a){return"IRI"!==a.type?this._error("Expected IRI to follow base declaration",a):(this._setBase(null===this._base||j.test(a.value)?a.value:this._resolveIRI(a)),this._readDeclarationPunctuation)},_readNamedGraphLabel:function(a){switch(a.type){case"IRI":case"blank":case"prefixed":return this._readSubject(a),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",a)}},_readNamedGraphBlankLabel:function(a){return"]"!==a.type?this._error("Invalid graph label",a):(this._subject="_:b"+n++,this._readGraph)},_readDeclarationPunctuation:function(a){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(a)):"."!==a.type?this._error("Expected declaration to end with a dot",a):this._readInTopContext},_readQuantifierList:function(a){var b;switch(a.type){case"IRI":case"prefixed":if(void 0!==(b=this._readEntity(a,!0)))break;default:return this._error("Unexpected "+a.type,a)}return this._explicitQuantifiers?(null===this._subject?this._triple(this._graph||"",this._predicate,this._subject="_:b"+n++,i):this._triple(this._subject,h,this._subject="_:b"+n++,i),this._triple(this._subject,g,b,i)):this._quantified[b]=this._quantifiedPrefix+n++,this._readQuantifierPunctuation},_readQuantifierPunctuation:function(a){return","===a.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._triple(this._subject,h,f,i),this._subject=null),this._readCallback=this._getTripleEndReader(),this._readCallback(a))},_getPathReader:function(a){return this._afterPath=a,this._readPath},_readPath:function(a){switch(a.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var b=this._contextStack,c=b.length&&b[b.length-1];if(c&&"item"===c.type){var d=this._subject;this._restoreContext(),this._triple(this._subject,g,d,this._graph)}return this._afterPath(a)}},_readForwardPath:function(a){var b,c,d="_:b"+n++;return void 0!==(c=this._readEntity(a))?(null===this._predicate?(b=this._subject,this._subject=d):(b=this._object,this._object=d),this._triple(b,c,d,this._graph),this._readPath):void 0},_readBackwardPath:function(a){var b,c,d="_:b"+n++;return void 0!==(b=this._readEntity(a))?(null===this._predicate?(c=this._subject,this._subject=d):(c=this._object,this._object=d),this._triple(d,b,c,this._graph),this._readPath):void 0},_getTripleEndReader:function(){var a=this._contextStack;if(!a.length)return this._readPunctuation;switch(a[a.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}},_triple:function(a,b,c,d){this._callback(null,{subject:a,predicate:b,object:c,graph:d||""})},_error:function(a,b){this._callback(new Error(a+" on line "+b.line+"."))},_resolveIRI:function(a){var b=a.value;switch(b[0]){case void 0:return this._base;case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return this._removeDotSegments(this._basePath+b)}},_removeDotSegments:function(a){if(!l.test(a))return a;for(var b="",c=a.length,d=-1,e=-1,f=0,g="/";c>d;){switch(g){case":":if(0>e&&"/"===a[++d]&&"/"===a[++d])for(;(e=d+1)<c&&"/"!==a[e];)d=e;break;case"?":case"#":d=c;break;case"/":if("."===a[d+1])switch(g=a[++d+1]){case"/":b+=a.substring(f,d-1),f=d+1;break;case void 0:case"?":case"#":return b+a.substring(f,d)+a.substr(d+1);case".":if(g=a[++d+1],void 0===g||"/"===g||"?"===g||"#"===g){if(b+=a.substring(f,d-2),(f=b.lastIndexOf("/"))>=e&&(b=b.substr(0,f)),"/"!==g)return b+"/"+a.substr(d+1);f=d+1}}}g=a[++d]}return b+a.substring(f)},parse:function(a,b,d){var e=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+m++ +"_",this._prefixCallback=d||c,this._inversePredicate=!1,this._quantified=Object.create(null),!b){var f,g=[];if(this._callback=function(a,b){a?f=a:b&&g.push(b)},this._lexer.tokenize(a).every(function(a){return e._readCallback=e._readCallback(a)}),f)throw f;return g}this._callback=b,this._lexer.tokenize(a,function(a,b){null!==a?(e._callback(a),e._callback=c):e._readCallback&&(e._readCallback=e._readCallback(b))})}},a.Parser=b}(),function(){function b(a,c){if(!(this instanceof b))return new b(a,c);if(a&&"function"!=typeof a.write&&(c=a,a=null),c=c||{},a)this._outputStream=a,this._endStream=void 0===c.end||!!c.end;else{var d="";this._outputStream={write:function(a,b,c){d+=a,c&&c()},end:function(a){a&&a(null,d)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(c.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),c.prefixes&&this.addPrefixes(c.prefixes))}function c(a){var b=i[a];return void 0===b&&(1===a.length?(b=a.charCodeAt(0).toString(16),b="\\u0000".substr(0,6-b.length)+b):(b=(1024*(a.charCodeAt(0)-55296)+a.charCodeAt(1)+9216).toString(16),b="\\U00000000".substr(0,10-b.length)+b)),b}var d=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",f=e+"type",g=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,h=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,i={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};b.prototype={_write:function(a,b){this._outputStream.write(a,"utf8",b)},_writeTriple:function(a,b,c,d,e){try{this._graph!==d&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(d?this._encodeIriOrBlankNode(d)+" {\n":"")),this._subject=null,this._graph="["!==d[0]?d:"]"),this._subject===a?this._predicate===b?this._write(", "+this._encodeObject(c),e):this._write(";\n    "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=a)+" "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e)}catch(a){e&&e(a)}},_writeTripleLine:function(a,b,c,d,e){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(a)+" "+this._encodeIriOrBlankNode(b)+" "+this._encodeObject(c)+(d?" "+this._encodeIriOrBlankNode(d)+".\n":".\n"),e)}catch(a){e&&e(a)}},_encodeIriOrBlankNode:function(a){var b=a[0];if("["===b||"("===b||"_"===b&&":"===a[1])return a;g.test(a)&&(a=a.replace(h,c));var d=this._prefixRegex.exec(a);return d?d[1]?this._prefixIRIs[d[1]]+d[2]:a:"<"+a+">"},_encodeLiteral:function(a,b,d){return g.test(a)&&(a=a.replace(h,c)),d?'"'+a+'"@'+d:b?'"'+a+'"^^'+this._encodeIriOrBlankNode(b):'"'+a+'"'},_encodeSubject:function(a){if('"'===a[0])throw new Error("A literal as subject is not allowed: "+a);return"["===a[0]&&(this._subject="]"),this._encodeIriOrBlankNode(a);
},_encodePredicate:function(a){if('"'===a[0])throw new Error("A literal as predicate is not allowed: "+a);return a===f?"a":this._encodeIriOrBlankNode(a)},_encodeObject:function(a){if('"'!==a[0])return this._encodeIriOrBlankNode(a);var b=d.exec(a);if(!b)throw new Error("Invalid literal: "+a);return this._encodeLiteral(b[1],b[2],b[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(a,b,c,d,e){void 0===c?this._writeTriple(a.subject,a.predicate,a.object,a.graph||"",b):"string"!=typeof d?this._writeTriple(a,b,c,"",d):this._writeTriple(a,b,c,d,e)},addTriples:function(a){for(var b=0;b<a.length;b++)this.addTriple(a[b])},addPrefix:function(a,b,c){var d={};d[a]=b,this.addPrefixes(d,c)},addPrefixes:function(a,b){var c=this._prefixIRIs,d=!1;for(var e in a){var f=a[e];/[#\/]$/.test(f)&&c[f]!==(e+=":")&&(d=!0,c[f]=e,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+e+" <"+f+">.\n"))}if(d){var g="",h="";for(var i in c)g+=g?"|"+i:i,h+=(h?"|":"")+c[i];g=g.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+h+")[^/]*$|^("+g+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(d?"\n":"",b)},blank:function(a,b){var c,d,e=a;switch(void 0===a?e=[]:"string"==typeof a?e=[{predicate:a,object:b}]:"length"in a||(e=[a]),d=e.length){case 0:return"[]";case 1:if(c=e[0],"["!==c.object[0])return"[ "+this._encodePredicate(c.predicate)+" "+this._encodeObject(c.object)+" ]";default:for(var f="[",g=0;d>g;g++)c=e[g],c.predicate===a?f+=", "+this._encodeObject(c.object):(f+=(g?";\n  ":"\n  ")+this._encodePredicate(c.predicate)+" "+this._encodeObject(c.object),a=c.predicate);return f+"\n]"}},list:function(a){for(var b=a&&a.length||0,c=new Array(b),d=0;b>d;d++)c[d]=this._encodeObject(a[d]);return"("+c.join(" ")+")"},_prefixRegex:/$0^/,end:function(a){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var b=a&&function(c,d){b=null,a(c,d)};if(this._endStream)try{return this._outputStream.end(b)}catch(a){}b&&b()}},a.Writer=b}(),function(){function b(a,c){return this instanceof b?(this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,c||!a||a[0]||(c=a,a=null),c=c||{},this._prefixes=Object.create(null),c.prefixes&&this.addPrefixes(c.prefixes),void(a&&this.addTriples(a))):new b(a,c)}var c=a.Util.expandPrefixedName,d="urn:n3:defaultGraph";b.prototype={get size(){var a=this._size;if(null!==a)return a;var b,c,d=this._graphs;for(var e in d)for(var f in b=d[e].subjects)for(var g in c=b[f])a+=Object.keys(c[g]).length;return this._size=a},get defaultGraph(){return d},_addToIndex:function(a,b,c,d){var e=a[b]||(a[b]={}),f=e[c]||(e[c]={}),g=d in f;return g||(f[d]=null),!g},_removeFromIndex:function(a,b,c,d){var e,f=a[b],g=f[c];delete g[d];for(e in g)return;delete f[c];for(e in f)return;delete a[b]},_findInIndex:function(a,b,c,d,e,f,g,h){var i,j,k,l=[],m=!b+!c+!d,n=m>1?Object.keys(this._ids):this._entities;b&&((i=a,a={})[b]=i[b]);for(var o in a){var p=n[o];if(j=a[o]){c&&((i=j,j={})[c]=i[c]);for(var q in j){var r=n[q];if(k=j[q])for(var s=(d?d in k?[d]:[]:Object.keys(k)),t=s.length-1;t>=0;t--){var u={subject:"",predicate:"",object:"",graph:h};u[e]=p,u[f]=r,u[g]=n[s[t]],l.push(u)}}}}return l},_countInIndex:function(a,b,c,d){var e,f,g,h=0;b&&((e=a,a={})[b]=e[b]);for(var i in a)if(f=a[i]){c&&((e=f,f={})[c]=e[c]);for(var j in f)(g=f[j])&&(d?d in g&&h++:h+=Object.keys(g).length)}return h},addTriple:function(a,b,c,e){b||(e=a.graph,c=a.object,b=a.predicate,a=a.subject),e=e||d;var f=this._graphs[e];f||(f=this._graphs[e]={subjects:{},predicates:{},objects:{}},Object.freeze(f));var g=this._ids,h=this._entities;a=g[a]||(g[h[++this._id]=a]=this._id),b=g[b]||(g[h[++this._id]=b]=this._id),c=g[c]||(g[h[++this._id]=c]=this._id);var i=this._addToIndex(f.subjects,a,b,c);return this._addToIndex(f.predicates,b,c,a),this._addToIndex(f.objects,c,a,b),this._size=null,i},addTriples:function(a){for(var b=a.length-1;b>=0;b--)this.addTriple(a[b])},addPrefix:function(a,b){this._prefixes[a]=b},addPrefixes:function(a){for(var b in a)this.addPrefix(b,a[b])},removeTriple:function(a,b,c,e){b||(e=a.graph,c=a.object,b=a.predicate,a=a.subject),e=e||d;var f,g=this._ids,h=this._graphs;if(!(a=g[a]))return!1;if(!(b=g[b]))return!1;if(!(c=g[c]))return!1;if(!(f=h[e]))return!1;var i,j;if(!(i=f.subjects[a]))return!1;if(!(j=i[b]))return!1;if(!(c in j))return!1;this._removeFromIndex(f.subjects,a,b,c),this._removeFromIndex(f.predicates,b,c,a),this._removeFromIndex(f.objects,c,a,b),null!==this._size&&this._size--;for(a in f.subjects)return!0;return delete h[e],!0},removeTriples:function(a){for(var b=a.length-1;b>=0;b--)this.removeTriple(a[b])},find:function(a,b,d,e){var f=this._prefixes;return this.findByIRI(c(a,f),c(b,f),c(d,f),c(e,f))},findByIRI:function(a,b,c,e){var f,g,h,i,j=[],k={},l=this._ids;if(e?k[e]=this._graphs[e]:k=this._graphs,a&&!(g=l[a]))return j;if(b&&!(h=l[b]))return j;if(c&&!(i=l[c]))return j;for(var m in k)(f=k[m])&&(m===d&&(m=""),g?i?j.push(this._findInIndex(f.objects,i,g,h,"object","subject","predicate",m)):j.push(this._findInIndex(f.subjects,g,h,null,"subject","predicate","object",m)):h?j.push(this._findInIndex(f.predicates,h,i,null,"predicate","object","subject",m)):i?j.push(this._findInIndex(f.objects,i,null,null,"object","subject","predicate",m)):j.push(this._findInIndex(f.subjects,null,null,null,"subject","predicate","object",m)));return 1===j.length?j[0]:j.concat.apply([],j)},count:function(a,b,d,e){var f=this._prefixes;return this.countByIRI(c(a,f),c(b,f),c(d,f),c(e,f))},countByIRI:function(a,b,c,e){e=e||d;var f=this._graphs[e],g=this._ids;return f?a&&!(a=g[a])?0:b&&!(b=g[b])?0:c&&!(c=g[c])?0:a?c?this._countInIndex(f.objects,c,a,b):this._countInIndex(f.subjects,a,b,c):b?this._countInIndex(f.predicates,b,c,a):this._countInIndex(f.objects,c,a,b):0},createBlankNode:function(a){var b,c;if(a)for(b=a="_:"+a,c=1;this._ids[b];)b=a+c++;else do b="_:b"+this._blankNodeIndex++;while(this._ids[b]);return this._ids[b]=++this._id,this._entities[this._id]=b,b}},a.Store=b}()}("undefined"!=typeof exports?exports:this.N3={}),!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.rdfstore=a()}}(function(){var define,module,exports;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(){function a(a){this.message=a}var b="undefined"!=typeof c?c:this,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.prototype=new Error,a.prototype.name="InvalidCharacterError",b.btoa||(b.btoa=function(b){for(var c,e,f=0,g=d,h="";b.charAt(0|f)||(g="=",f%1);h+=g.charAt(63&c>>8-f%1*8)){if(e=b.charCodeAt(f+=.75),e>255)throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");c=c<<8|e}return h}),b.atob||(b.atob=function(b){if(b=b.replace(/=+$/,""),b.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,f=0,g=0,h="";e=b.charAt(g++);~e&&(c=f%4?64*c+e:e,f++%4)?h+=String.fromCharCode(255&c>>(-2*f&6)):0)e=d.indexOf(e);return h})}()},{}],2:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g?62:b===h?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],3:[function(a,b,c){(function(c,d){(function(){"use strict";function e(a){return"function"==typeof a||"object"==typeof a&&null!==a}function f(a){return"function"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){T=a}function i(a){X=a}function j(){var a=c.nextTick,b=c.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(o)}}function k(){return function(){S(o)}}function l(){var a=0,b=new $(o),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function m(){var a=new MessageChannel;return a.port1.onmessage=o,function(){a.port2.postMessage(0)}}function n(){return function(){setTimeout(o,1)}}function o(){for(var a=0;W>a;a+=2){var b=ba[a],c=ba[a+1];b(c),ba[a]=void 0,ba[a+1]=void 0}W=0}function p(){try{var b=a,c=b("vertx");return S=c.runOnLoop||c.runOnContext,k()}catch(d){return n()}}function q(){}function r(){return new TypeError("You cannot resolve a promise with itself")}function s(){return new TypeError("A promises callback cannot return that same promise.")}function t(a){try{return a.then}catch(b){return fa.error=b,fa}}function u(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function v(a,b,c){X(function(a){var d=!1,e=u(c,b,function(c){d||(d=!0,b!==c?y(a,c):A(a,c))},function(b){d||(d=!0,B(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,B(a,e))},a)}function w(a,b){b._state===da?A(a,b._result):b._state===ea?B(a,b._result):C(b,void 0,function(b){y(a,b)},function(b){B(a,b)})}function x(a,b){if(b.constructor===a.constructor)w(a,b);else{var c=t(b);c===fa?B(a,fa.error):void 0===c?A(a,b):f(c)?v(a,b,c):A(a,b)}}function y(a,b){a===b?B(a,r()):e(b)?x(a,b):A(a,b)}function z(a){a._onerror&&a._onerror(a._result),D(a)}function A(a,b){a._state===ca&&(a._result=b,a._state=da,0!==a._subscribers.length&&X(D,a))}function B(a,b){a._state===ca&&(a._state=ea,a._result=b,X(z,a))}function C(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+da]=c,e[f+ea]=d,0===f&&a._state&&X(D,a)}function D(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?G(c,d,e,f):e(f);a._subscribers.length=0}}function E(){this.error=null}function F(a,b){try{return a(b)}catch(c){return ga.error=c,ga}}function G(a,b,c,d){var e,g,h,i,j=f(c);if(j){if(e=F(c,d),e===ga?(i=!0,g=e.error,e=null):h=!0,b===e)return void B(b,s())}else e=d,h=!0;b._state!==ca||(j&&h?y(b,e):i?B(b,g):a===da?A(b,e):a===ea&&B(b,e))}function H(a,b){try{b(function(b){y(a,b)},function(b){B(a,b)})}catch(c){B(a,c)}}function I(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(q),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?A(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&A(c.promise,c._result))):B(c.promise,c._validationError())}function J(a){return new ha(this,a).promise}function K(a){function b(a){y(e,a)}function c(a){B(e,a)}var d=this,e=new d(q);if(!V(a))return B(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===ca&&f>g;g++)C(d.resolve(a[g]),void 0,b,c);return e}function L(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(q);return y(c,a),c}function M(a){var b=this,c=new b(q);return B(c,a),c}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function O(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function P(a){this._id=ma++,this._state=void 0,this._result=void 0,this._subscribers=[],q!==a&&(f(a)||N(),this instanceof P||O(),H(this,a))}function Q(){var a;if("undefined"!=typeof d)a=d;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=na)}var R;R=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var S,T,U,V=R,W=0,X=({}.toString,function(a,b){ba[W]=a,ba[W+1]=b,W+=2,2===W&&(T?T(o):U())}),Y="undefined"!=typeof window?window:void 0,Z=Y||{},$=Z.MutationObserver||Z.WebKitMutationObserver,_="undefined"!=typeof c&&"[object process]"==={}.toString.call(c),aa="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ba=new Array(1e3);U=_?j():$?l():aa?m():void 0===Y&&"function"==typeof a?p():n();var ca=void 0,da=1,ea=2,fa=new E,ga=new E;I.prototype._validateInput=function(a){return V(a)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var ha=I;I.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===ca&&b>e;e++)a._eachEntry(d[e],e)},I.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;g(a)?a.constructor===d&&a._state!==ca?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},I.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===ca&&(d._remaining--,a===ea?B(e,c):d._result[b]=c),0===d._remaining&&A(e,d._result)},I.prototype._willSettleAt=function(a,b){var c=this;C(a,void 0,function(a){c._settledAt(da,b,a)},function(a){c._settledAt(ea,b,a)})};var ia=J,ja=K,ka=L,la=M,ma=0,na=P;P.all=ia,P.race=ja,P.resolve=ka,P.reject=la,P._setScheduler=h,P._setAsap=i,P._asap=X,P.prototype={constructor:P,then:function(a,b){var c=this,d=c._state;if(d===da&&!a||d===ea&&!b)return this;var e=new this.constructor(q),f=c._result;if(d){var g=arguments[d-1];X(function(){G(d,e,g,f)})}else C(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var oa=Q,pa={Promise:na,polyfill:oa};"function"==typeof define&&define.amd?define(function(){return pa}):"undefined"!=typeof b&&b.exports?b.exports=pa:"undefined"!=typeof this&&(this.ES6Promise=pa),oa()}).call(this)}).call(this,a("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"7YKIPe":10}],4:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],5:[function(a,b,c){},{}],6:[function(a,b,c){function d(a,b,c){if(!(this instanceof d))return new d(a,b,c);var e=typeof a;if("base64"===b&&"string"===e)for(a=C(a);a.length%4!==0;)a+="=";var f;if("number"===e)f=E(a);else if("string"===e)f=d.byteLength(a,b);else{if("object"!==e)throw new Error("First argument needs to be a number, array or string.");f=E(a.length)}var g;d._useTypedArrays?g=d._augment(new Uint8Array(f)):(g=this,g.length=f,g._isBuffer=!0);var h;if(d._useTypedArrays&&"number"==typeof a.byteLength)g._set(a);else if(G(a))for(h=0;f>h;h++)d.isBuffer(a)?g[h]=a.readUInt8(h):g[h]=a[h];else if("string"===e)g.write(a,0,b);else if("number"===e&&!d._useTypedArrays&&!c)for(h=0;f>h;h++)g[h]=0;return g}function e(a,b,c,e){c=Number(c)||0;var f=a.length-c;e?(e=Number(e),e>f&&(e=f)):e=f;var g=b.length;R(g%2===0,"Invalid hex string"),e>g/2&&(e=g/2);for(var h=0;e>h;h++){var i=parseInt(b.substr(2*h,2),16);R(!isNaN(i),"Invalid hex string"),a[c+h]=i}return d._charsWritten=2*h,h}function f(a,b,c,e){var f=d._charsWritten=M(I(b),a,c,e);return f}function g(a,b,c,e){var f=d._charsWritten=M(J(b),a,c,e);return f}function h(a,b,c,d){return g(a,b,c,d)}function i(a,b,c,e){var f=d._charsWritten=M(L(b),a,c,e);return f}function j(a,b,c,e){var f=d._charsWritten=M(K(b),a,c,e);return f}function k(a,b,c){return 0===b&&c===a.length?S.fromByteArray(a):S.fromByteArray(a.slice(b,c))}function l(a,b,c){var d="",e="";c=Math.min(a.length,c);for(var f=b;c>f;f++)a[f]<=127?(d+=N(e)+String.fromCharCode(a[f]),e=""):e+="%"+a[f].toString(16);return d+N(e)}function m(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function n(a,b,c){return m(a,b,c)}function o(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=H(a[f]);return e}function p(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function q(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(f=a[b],e>b+1&&(f|=a[b+1]<<8)):(f=a[b]<<8,e>b+1&&(f|=a[b+1])),f}}function r(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f;return c?(e>b+2&&(f=a[b+2]<<16),e>b+1&&(f|=a[b+1]<<8),f|=a[b],e>b+3&&(f+=a[b+3]<<24>>>0)):(e>b+1&&(f=a[b+1]<<16),e>b+2&&(f|=a[b+2]<<8),e>b+3&&(f|=a[b+3]),f+=a[b]<<24>>>0),f}}function s(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+1<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=q(a,b,c,!0),g=32768&f;return g?-1*(65535-f+1):f}}function t(a,b,c,d){d||(R("boolean"==typeof c,"missing or invalid endian"),R(void 0!==b&&null!==b,"missing offset"),R(b+3<a.length,"Trying to read beyond buffer length"));var e=a.length;if(!(b>=e)){var f=r(a,b,c,!0),g=2147483648&f;return g?-1*(4294967295-f+1):f}}function u(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+3<a.length,"Trying to read beyond buffer length")),T.read(a,b,c,23,4)}function v(a,b,c,d){return d||(R("boolean"==typeof c,"missing or invalid endian"),R(b+7<a.length,"Trying to read beyond buffer length")),T.read(a,b,c,52,8)}function w(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"trying to write beyond buffer length"),O(b,65535));var f=a.length;if(!(c>=f))for(var g=0,h=Math.min(f-c,2);h>g;g++)a[c+g]=(b&255<<8*(d?g:1-g))>>>8*(d?g:1-g)}function x(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"trying to write beyond buffer length"),O(b,4294967295));var f=a.length;if(!(c>=f))for(var g=0,h=Math.min(f-c,4);h>g;g++)a[c+g]=b>>>8*(d?g:3-g)&255}function y(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+1<a.length,"Trying to write beyond buffer length"),P(b,32767,-32768));var f=a.length;c>=f||(b>=0?w(a,b,c,d,e):w(a,65535+b+1,c,d,e))}function z(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),P(b,2147483647,-2147483648));var f=a.length;c>=f||(b>=0?x(a,b,c,d,e):x(a,4294967295+b+1,c,d,e))}function A(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+3<a.length,"Trying to write beyond buffer length"),Q(b,3.4028234663852886e38,-3.4028234663852886e38));var f=a.length;c>=f||T.write(a,b,c,d,23,4)}function B(a,b,c,d,e){e||(R(void 0!==b&&null!==b,"missing value"),R("boolean"==typeof d,"missing or invalid endian"),R(void 0!==c&&null!==c,"missing offset"),R(c+7<a.length,"Trying to write beyond buffer length"),Q(b,1.7976931348623157e308,-1.7976931348623157e308));var f=a.length;c>=f||T.write(a,b,c,d,52,8)}function C(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function D(a,b,c){return"number"!=typeof a?c:(a=~~a,a>=b?b:a>=0?a:(a+=b,a>=0?a:0))}function E(a){return a=~~Math.ceil(+a),0>a?0:a}function F(a){return(Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)})(a)}function G(a){return F(a)||d.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length}function H(a){return 16>a?"0"+a.toString(16):a.toString(16)}function I(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);if(127>=d)b.push(a.charCodeAt(c));else{var e=c;d>=55296&&57343>=d&&c++;for(var f=encodeURIComponent(a.slice(e,c+1)).substr(1).split("%"),g=0;g<f.length;g++)b.push(parseInt(f[g],16))}}return b}function J(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function K(a){for(var b,c,d,e=[],f=0;f<a.length;f++)b=a.charCodeAt(f),c=b>>8,d=b%256,e.push(d),e.push(c);return e}function L(a){return S.toByteArray(a)}function M(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}function N(a){try{return decodeURIComponent(a)}catch(b){return String.fromCharCode(65533)}}function O(a,b){R("number"==typeof a,"cannot write a non-number as a number"),R(a>=0,"specified a negative value for writing an unsigned value"),R(b>=a,"value is larger than maximum value for type"),R(Math.floor(a)===a,"value has a fractional component")}function P(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value"),R(Math.floor(a)===a,"value has a fractional component")}function Q(a,b,c){R("number"==typeof a,"cannot write a non-number as a number"),R(b>=a,"value larger than maximum allowed value"),R(a>=c,"value smaller than minimum allowed value")}function R(a,b){if(!a)throw new Error(b||"Failed assertion")}var S=a("base64-js"),T=a("ieee754");c.Buffer=d,c.SlowBuffer=d,c.INSPECT_MAX_BYTES=50,d.poolSize=8192,d._useTypedArrays=function(){try{var a=new ArrayBuffer(0),b=new Uint8Array(a);return b.foo=function(){return 42},42===b.foo()&&"function"==typeof b.subarray}catch(c){return!1}}(),d.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.isBuffer=function(a){return!(null===a||void 0===a||!a._isBuffer)},d.byteLength=function(a,b){var c;switch(a+="",b||"utf8"){case"hex":c=a.length/2;break;case"utf8":case"utf-8":c=I(a).length;break;case"ascii":case"binary":case"raw":c=a.length;break;case"base64":c=L(a).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":c=2*a.length;break;default:throw new Error("Unknown encoding")}return c},d.concat=function(a,b){if(R(F(a),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===a.length)return new d(0);if(1===a.length)return a[0];var c;if("number"!=typeof b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var e=new d(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(e,f),f+=g.length}return e},d.prototype.write=function(a,b,c,d){if(isFinite(b))isFinite(c)||(d=c,c=void 0);else{var k=d;d=b,b=c,c=k}b=Number(b)||0;var l=this.length-b;c?(c=Number(c),c>l&&(c=l)):c=l,d=String(d||"utf8").toLowerCase();var m;switch(d){case"hex":m=e(this,a,b,c);break;case"utf8":case"utf-8":m=f(this,a,b,c);break;case"ascii":m=g(this,a,b,c);break;case"binary":m=h(this,a,b,c);break;case"base64":m=i(this,a,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":m=j(this,a,b,c);break;default:throw new Error("Unknown encoding")}return m},d.prototype.toString=function(a,b,c){var d=this;if(a=String(a||"utf8").toLowerCase(),b=Number(b)||0,c=void 0!==c?Number(c):c=d.length,c===b)return"";var e;switch(a){case"hex":e=o(d,b,c);break;case"utf8":case"utf-8":e=l(d,b,c);break;case"ascii":e=m(d,b,c);break;case"binary":e=n(d,b,c);break;case"base64":e=k(d,b,c);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":e=p(d,b,c);break;default:throw new Error("Unknown encoding")}return e},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},d.prototype.copy=function(a,b,c,e){var f=this;if(c||(c=0),e||0===e||(e=this.length),b||(b=0),e!==c&&0!==a.length&&0!==f.length){R(e>=c,"sourceEnd < sourceStart"),R(b>=0&&b<a.length,"targetStart out of bounds"),R(c>=0&&c<f.length,"sourceStart out of bounds"),R(e>=0&&e<=f.length,"sourceEnd out of bounds"),e>this.length&&(e=this.length),a.length-b<e-c&&(e=a.length-b+c);var g=e-c;if(100>g||!d._useTypedArrays)for(var h=0;g>h;h++)a[h+b]=this[h+c];else a._set(this.subarray(c,c+g),b)}},d.prototype.slice=function(a,b){var c=this.length;if(a=D(a,c,0),b=D(b,c,c),d._useTypedArrays)return d._augment(this.subarray(a,b));for(var e=b-a,f=new d(e,void 0,!0),g=0;e>g;g++)f[g]=this[g+a];return f},d.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},d.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},d.prototype.readUInt8=function(a,b){return b||(R(void 0!==a&&null!==a,"missing offset"),R(a<this.length,"Trying to read beyond buffer length")),a>=this.length?void 0:this[a]},d.prototype.readUInt16LE=function(a,b){return q(this,a,!0,b)},d.prototype.readUInt16BE=function(a,b){return q(this,a,!1,b)},d.prototype.readUInt32LE=function(a,b){return r(this,a,!0,b)},d.prototype.readUInt32BE=function(a,b){return r(this,a,!1,b)},d.prototype.readInt8=function(a,b){if(b||(R(void 0!==a&&null!==a,"missing offset"),R(a<this.length,"Trying to read beyond buffer length")),!(a>=this.length)){var c=128&this[a];return c?-1*(255-this[a]+1):this[a]}},d.prototype.readInt16LE=function(a,b){return s(this,a,!0,b)},d.prototype.readInt16BE=function(a,b){return s(this,a,!1,b)},d.prototype.readInt32LE=function(a,b){return t(this,a,!0,b)},d.prototype.readInt32BE=function(a,b){return t(this,a,!1,b)},d.prototype.readFloatLE=function(a,b){return u(this,a,!0,b)},d.prototype.readFloatBE=function(a,b){return u(this,a,!1,b)},d.prototype.readDoubleLE=function(a,b){return v(this,a,!0,b)},d.prototype.readDoubleBE=function(a,b){return v(this,a,!1,b)},d.prototype.writeUInt8=function(a,b,c){c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<this.length,"trying to write beyond buffer length"),O(a,255)),b>=this.length||(this[b]=a)},d.prototype.writeUInt16LE=function(a,b,c){w(this,a,b,!0,c)},d.prototype.writeUInt16BE=function(a,b,c){w(this,a,b,!1,c)},d.prototype.writeUInt32LE=function(a,b,c){x(this,a,b,!0,c)},d.prototype.writeUInt32BE=function(a,b,c){x(this,a,b,!1,c)},d.prototype.writeInt8=function(a,b,c){c||(R(void 0!==a&&null!==a,"missing value"),R(void 0!==b&&null!==b,"missing offset"),R(b<this.length,"Trying to write beyond buffer length"),P(a,127,-128)),b>=this.length||(a>=0?this.writeUInt8(a,b,c):this.writeUInt8(255+a+1,b,c))},d.prototype.writeInt16LE=function(a,b,c){y(this,a,b,!0,c)},d.prototype.writeInt16BE=function(a,b,c){y(this,a,b,!1,c)},d.prototype.writeInt32LE=function(a,b,c){z(this,a,b,!0,c)},d.prototype.writeInt32BE=function(a,b,c){z(this,a,b,!1,c)},d.prototype.writeFloatLE=function(a,b,c){A(this,a,b,!0,c)},d.prototype.writeFloatBE=function(a,b,c){A(this,a,b,!1,c)},d.prototype.writeDoubleLE=function(a,b,c){B(this,a,b,!0,c)},d.prototype.writeDoubleBE=function(a,b,c){B(this,a,b,!1,c)},d.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),"string"==typeof a&&(a=a.charCodeAt(0)),R("number"==typeof a&&!isNaN(a),"value is not a number"),R(c>=b,"end < start"),c!==b&&0!==this.length){R(b>=0&&b<this.length,"start out of bounds"),R(c>=0&&c<=this.length,"end out of bounds");
for(var d=b;c>d;d++)this[d]=a}},d.prototype.inspect=function(){for(var a=[],b=this.length,d=0;b>d;d++)if(a[d]=H(this[d]),d===c.INSPECT_MAX_BYTES){a[d+1]="...";break}return"<Buffer "+a.join(" ")+">"},d.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(d._useTypedArrays)return new d(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var U=d.prototype;d._augment=function(a){return a._isBuffer=!0,a._get=a.get,a._set=a.set,a.get=U.get,a.set=U.set,a.write=U.write,a.toString=U.toString,a.toLocaleString=U.toString,a.toJSON=U.toJSON,a.copy=U.copy,a.slice=U.slice,a.readUInt8=U.readUInt8,a.readUInt16LE=U.readUInt16LE,a.readUInt16BE=U.readUInt16BE,a.readUInt32LE=U.readUInt32LE,a.readUInt32BE=U.readUInt32BE,a.readInt8=U.readInt8,a.readInt16LE=U.readInt16LE,a.readInt16BE=U.readInt16BE,a.readInt32LE=U.readInt32LE,a.readInt32BE=U.readInt32BE,a.readFloatLE=U.readFloatLE,a.readFloatBE=U.readFloatBE,a.readDoubleLE=U.readDoubleLE,a.readDoubleBE=U.readDoubleBE,a.writeUInt8=U.writeUInt8,a.writeUInt16LE=U.writeUInt16LE,a.writeUInt16BE=U.writeUInt16BE,a.writeUInt32LE=U.writeUInt32LE,a.writeUInt32BE=U.writeUInt32BE,a.writeInt8=U.writeInt8,a.writeInt16LE=U.writeInt16LE,a.writeInt16BE=U.writeInt16BE,a.writeInt32LE=U.writeInt32LE,a.writeInt32BE=U.writeInt32BE,a.writeFloatLE=U.writeFloatLE,a.writeFloatBE=U.writeFloatBE,a.writeDoubleLE=U.writeDoubleLE,a.writeDoubleBE=U.writeDoubleBE,a.fill=U.fill,a.inspect=U.inspect,a.toArrayBuffer=U.toArrayBuffer,a}},{"base64-js":2,ieee754:23}],7:[function(a,b,c){var d=b.exports,e=(a("events").EventEmitter,a("./lib/request")),f=a("url");d.request=function(a,b){"string"==typeof a&&(a=f.parse(a)),a||(a={}),a.host||a.port||(a.port=parseInt(window.location.port,10)),!a.host&&a.hostname&&(a.host=a.hostname),a.scheme||(a.scheme=window.location.protocol.split(":")[0]),a.host||(a.host=window.location.hostname||window.location.host),/:/.test(a.host)&&(a.port||(a.port=a.host.split(":")[1]),a.host=a.host.split(":")[0]),a.port||(a.port="https"==a.scheme?443:80);var c=new e(new g,a);return b&&c.on("response",b),c},d.get=function(a,b){a.method="GET";var c=d.request(a,b);return c.end(),c},d.Agent=function(){},d.Agent.defaultMaxSockets=4;var g=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new window.ActiveXObject(a[b]);return function(){if(c){var d=c;return c=null,d}return new window.ActiveXObject(a[b])}}catch(d){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();d.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":8,events:4,url:36}],8:[function(a,b,c){var d=a("stream"),e=a("./response"),f=a("Base64"),g=a("inherits"),h=b.exports=function(a,b){var c=this;c.writable=!0,c.xhr=a,c.body=[],c.uri=(b.scheme||"http")+"://"+b.host+(b.port?":"+b.port:"")+(b.path||"/"),"undefined"==typeof b.withCredentials&&(b.withCredentials=!0);try{a.withCredentials=b.withCredentials}catch(d){}if(a.open(b.method||"GET",c.uri,!0),c._headers={},b.headers)for(var g=i(b.headers),h=0;h<g.length;h++){var j=g[h];if(c.isSafeRequestHeader(j)){var k=b.headers[j];c.setHeader(j,k)}}b.auth&&this.setHeader("Authorization","Basic "+f.btoa(b.auth));var l=new e;l.on("close",function(){c.emit("close")}),l.on("ready",function(){c.emit("response",l)}),a.onreadystatechange=function(){a.__aborted||l.handle(a)}};g(h,d),h.prototype.setHeader=function(a,b){this._headers[a.toLowerCase()]=b},h.prototype.getHeader=function(a){return this._headers[a.toLowerCase()]},h.prototype.removeHeader=function(a){delete this._headers[a.toLowerCase()]},h.prototype.write=function(a){this.body.push(a)},h.prototype.destroy=function(a){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},h.prototype.end=function(a){void 0!==a&&this.body.push(a);for(var b=i(this._headers),c=0;c<b.length;c++){var d=b[c],e=this._headers[d];if(j(e))for(var f=0;f<e.length;f++)this.xhr.setRequestHeader(d,e[f]);else this.xhr.setRequestHeader(d,e)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(j(this.body[0])){for(var g=[],c=0;c<this.body.length;c++)g.push.apply(g,this.body[c]);this.xhr.send(g)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var h=0,c=0;c<this.body.length;c++)h+=this.body[c].length;for(var g=new this.body[0].constructor(h),k=0,c=0;c<this.body.length;c++)for(var l=this.body[c],f=0;f<l.length;f++)g[k++]=l[f];this.xhr.send(g)}else{for(var g="",c=0;c<this.body.length;c++)g+=this.body[c].toString();this.xhr.send(g)}},h.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],h.prototype.isSafeRequestHeader=function(a){return a?-1===k(h.unsafeHeaders,a.toLowerCase()):!1};var i=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1}},{"./response":9,Base64:1,inherits:24,stream:15}],9:[function(a,b,c){function d(a){for(var b=a.getAllResponseHeaders().split(/\r?\n/),c={},d=0;d<b.length;d++){var e=b[d];if(""!==e){var f=e.match(/^([^:]+):\s*(.*)/);if(f){var g=f[1].toLowerCase(),h=f[2];void 0!==c[g]?i(c[g])?c[g].push(h):c[g]=[c[g],h]:c[g]=h}else c[e]=!0}}return c}var e=a("stream"),f=a("util"),g=b.exports=function(a){this.offset=0,this.readable=!0};f.inherits(g,e);var h={streaming:!0,status2:!0};g.prototype.getResponse=function(a){var b=String(a.responseType).toLowerCase();return"blob"===b?a.responseBlob||a.response:"arraybuffer"===b?a.response:a.responseText},g.prototype.getHeader=function(a){return this.headers[a.toLowerCase()]},g.prototype.handle=function(a){if(2===a.readyState&&h.status2){try{this.statusCode=a.status,this.headers=d(a)}catch(b){h.status2=!1}h.status2&&this.emit("ready")}else if(h.streaming&&3===a.readyState){try{this.statusCode||(this.statusCode=a.status,this.headers=d(a),this.emit("ready"))}catch(b){}try{this._emitData(a)}catch(b){h.streaming=!1}}else 4===a.readyState&&(this.statusCode||(this.statusCode=a.status,this.emit("ready")),this._emitData(a),a.error?this.emit("error",this.getResponse(a)):this.emit("end"),this.emit("close"))},g.prototype._emitData=function(a){var b=this.getResponse(a);return b.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(b,this.offset)),void(this.offset=b.byteLength)):void(b.length>this.offset&&(this.emit("data",b.slice(this.offset)),this.offset=b.length))};var i=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{stream:15,util:38}],10:[function(a,b,c){function d(){}var e=b.exports={};e.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.binding=function(a){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],11:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],12:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(d){var g=encodeURIComponent(e(d))+c;return f(a[d])?a[d].map(function(a){return g+encodeURIComponent(e(a))}).join(b):g+encodeURIComponent(e(a[d]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],13:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":11,"./encode":12}],14:[function(a,b,c){function d(a){return this instanceof d?(h.call(this,a),i.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){if(!this.allowHalfOpen&&!this._writableState.ended){var a=this;g(function(){a.end()})}}b.exports=d;var f=a("inherits"),g=a("process/browser.js").nextTick,h=a("./readable.js"),i=a("./writable.js");f(d,h),d.prototype.write=i.prototype.write,d.prototype.end=i.prototype.end,d.prototype._write=i.prototype._write},{"./readable.js":18,"./writable.js":20,inherits:24,"process/browser.js":16}],15:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("./readable.js"),d.Writable=a("./writable.js"),d.Duplex=a("./duplex.js"),d.Transform=a("./transform.js"),d.PassThrough=a("./passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{"./duplex.js":14,"./passthrough.js":17,"./readable.js":18,"./transform.js":19,"./writable.js":20,events:4,inherits:24}],16:[function(a,b,c){var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.binding=function(a){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(a){throw new Error("process.chdir is not supported")}},{}],17:[function(a,b,c){function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./transform.js"),f=a("inherits");f(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./transform.js":19,inherits:24}],18:[function(a,b,c){(function(c){function d(b,c){b=b||{};var d=b.highWaterMark;this.highWaterMark=d||0===d?d:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!b.objectMode,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(x||(x=a("string_decoder").StringDecoder),this.decoder=new x(b.encoding),this.encoding=b.encoding)}function e(a){return this instanceof e?(this._readableState=new d(a,this),this.readable=!0,void z.call(this)):new e(a)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c||void 0===c)b.reading=!1,b.ended||k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):(b.reading=!1,b.buffer.push(c)),b.needReadable&&l(a),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=D)a=D;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:isNaN(a)||null===a?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return A.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||c||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(b.decoder&&!b.ended){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,b.length>0?l(a):u(a)}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(b.emittedReadable=!0,b.sync?B(function(){m(a)}):m(a))}function m(a){a.emit("readable")}function n(a,b){b.readingMore||(b.readingMore=!0,B(function(){o(a,b)}))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;b.awaitDrain--,0===b.awaitDrain&&q(a)}}function q(a){function b(a,b,e){var f=a.write(c);!1===f&&d.awaitDrain++}var c,d=a._readableState;for(d.awaitDrain=0;d.pipesCount&&null!==(c=a.read());)if(1===d.pipesCount?b(d.pipes,0,null):v(d.pipes,b),a.emit("data",c),d.awaitDrain>0)return;return 0===d.pipesCount?(d.flowing=!1,void(y.listenerCount(a,"data")>0&&s(a))):void(d.ranOut=!0)}function r(){this._readableState.ranOut&&(this._readableState.ranOut=!1,q(this))}function s(a,b){var c=a._readableState;if(c.flowing)throw new Error("Cannot switch to old mode now.");var d=b||!1,e=!1;a.readable=!0,a.pipe=z.prototype.pipe,a.on=a.addListener=z.prototype.on,a.on("readable",function(){e=!0;for(var b;!d&&null!==(b=a.read());)a.emit("data",b);null===b&&(e=!1,a._readableState.needReadable=!0)}),a.pause=function(){d=!0,this.emit("pause")},a.resume=function(){d=!1,e?B(function(){a.emit("readable")}):this.read(0),this.emit("resume")},a.emit("readable")}function t(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):A.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new A(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function u(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");!b.endEmitted&&b.calledRead&&(b.ended=!0,B(function(){b.endEmitted||0!==b.length||(b.endEmitted=!0,a.readable=!1,a.emit("end"))}))}function v(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function w(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e,e.ReadableState=d;var x,y=a("events").EventEmitter,z=a("./index.js"),A=a("buffer").Buffer,B=a("process/browser.js").nextTick,C=a("inherits");C(e,z),e.prototype.push=function(a,b){var c=this._readableState;return"string"!=typeof a||c.objectMode||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new A(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.setEncoding=function(b){x||(x=a("string_decoder").StringDecoder),this._readableState.decoder=new x(b),this._readableState.encoding=b};var D=8388608;e.prototype.read=function(a){var b=this._readableState;b.calledRead=!0;var c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&u(this),null;var d=b.needReadable;b.length-a<=b.highWaterMark&&(d=!0),(b.ended||b.reading)&&(d=!1),d&&(b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?t(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),b.ended&&!b.endEmitted&&0===b.length&&u(this),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){a===k&&f()}function e(){a.end()}function f(){a.removeListener("close",h),a.removeListener("finish",i),a.removeListener("drain",o),a.removeListener("error",g),a.removeListener("unpipe",d),k.removeListener("end",e),k.removeListener("end",f),(!a._writableState||a._writableState.needDrain)&&o()}function g(b){j(),0===s&&0===y.listenerCount(a,"error")&&a.emit("error",b)}function h(){a.removeListener("finish",i),j()}function i(){a.removeListener("close",h),j()}function j(){k.unpipe(a)}var k=this,l=this._readableState;switch(l.pipesCount){case 0:l.pipes=a;break;case 1:l.pipes=[l.pipes,a];break;default:l.pipes.push(a)}l.pipesCount+=1;var m=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,n=m?e:f;l.endEmitted?B(n):k.once("end",n),a.on("unpipe",d);var o=p(k);a.on("drain",o);var s=y.listenerCount(a,"error");return a.once("error",g),a.once("close",h),a.once("finish",i),a.emit("pipe",k),l.flowing||(this.on("readable",r),l.flowing=!0,B(function(){q(k)})),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,this.removeListener("readable",r),b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=w(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=z.prototype.on.call(this,a,b);if("data"!==a||this._readableState.flowing||s(this),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,d.reading?d.length&&l(this,d):this.read(0))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){s(this),this.read(0),this.emit("resume")},e.prototype.pause=function(){s(this,!0),this.emit("pause")},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(b.decoder&&(e=b.decoder.write(e)),e&&(b.objectMode||e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)"function"==typeof a[e]&&"undefined"==typeof this[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return v(f,function(b){a.on(b,function(a){return d.emit.apply(d,b,a)})}),d._read=function(b){c&&(c=!1,a.resume())},d},e._fromList=t}).call(this,a("7YKIPe"))},{"./index.js":15,"7YKIPe":10,buffer:6,events:4,inherits:24,"process/browser.js":16,string_decoder:21}],19:[function(a,b,c){function d(a,b){this.afterTransform=function(a,c){return e(b,a,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a);var b=(this._transformState=new d(a,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=(a._readableState,a._transformState);if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./duplex.js"),i=a("inherits");i(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./duplex.js":14,inherits:24}],20:[function(a,b,c){function d(a,b,c){this.chunk=a,this.encoding=b,this.callback=c}function e(a,b){a=a||{};var c=a.highWaterMark;this.highWaterMark=c||0===c?c:16384,this.objectMode=!!a.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var d=a.decodeStrings===!1;this.decodeStrings=!d,this.defaultEncoding=a.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){n(b,a)},this.writecb=null,this.writelen=0,this.buffer=[]}function f(a){return this instanceof f||this instanceof x.Duplex?(this._writableState=new e(a,this),this.writable=!0,void x.call(this)):new f(a)}function g(a,b,c){var d=new Error("write after end");a.emit("error",d),y(function(){c(d)})}function h(a,b,c,d){var e=!0;if(!z.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");a.emit("error",f),y(function(){d(f)}),e=!1}return e}function i(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new z(b,c)),b}function j(a,b,c,e,f){c=i(b,c,e);var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;return b.needDrain=!h,b.writing?b.buffer.push(new d(c,e,f)):k(a,b,g,c,e,f),h}function k(a,b,c,d,e,f){b.writelen=c,b.writecb=f,b.writing=!0,b.sync=!0,a._write(d,e,b.onwrite),b.sync=!1}function l(a,b,c,d,e){c?y(function(){e(d)}):e(d),a.emit("error",d)}function m(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function n(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(m(c),b)l(a,c,d,b,e);else{var f=r(a,c);f||c.bufferProcessing||!c.buffer.length||q(a,c),d?y(function(){o(a,c,f,e)}):o(a,c,f,e)}}function o(a,b,c,d){c||p(a,b),d(),c&&s(a,b)}function p(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function q(a,b){b.bufferProcessing=!0;for(var c=0;c<b.buffer.length;c++){var d=b.buffer[c],e=d.chunk,f=d.encoding,g=d.callback,h=b.objectMode?1:e.length;if(k(a,b,h,e,f,g),b.writing){c++;break}}b.bufferProcessing=!1,c<b.buffer.length?b.buffer=b.buffer.slice(c):b.buffer.length=0}function r(a,b){return b.ending&&0===b.length&&!b.finished&&!b.writing}function s(a,b){var c=r(a,b);return c&&(b.finished=!0,a.emit("finish")),c}function t(a,b,c){b.ending=!0,s(a,b),c&&(b.finished?y(c):a.once("finish",c)),b.ended=!0}b.exports=f,f.WritableState=e;var u="undefined"!=typeof Uint8Array?function(a){return a instanceof Uint8Array}:function(a){return a&&a.constructor&&"Uint8Array"===a.constructor.name},v="undefined"!=typeof ArrayBuffer?function(a){return a instanceof ArrayBuffer}:function(a){return a&&a.constructor&&"ArrayBuffer"===a.constructor.name},w=a("inherits"),x=a("./index.js"),y=a("process/browser.js").nextTick,z=a("buffer").Buffer;w(f,x),f.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},f.prototype.write=function(a,b,c){var d=this._writableState,e=!1;return"function"==typeof b&&(c=b,b=null),!z.isBuffer(a)&&u(a)&&(a=new z(a)),v(a)&&"undefined"!=typeof Uint8Array&&(a=new z(new Uint8Array(a))),z.isBuffer(a)?b="buffer":b||(b=d.defaultEncoding),"function"!=typeof c&&(c=function(){}),d.ended?g(this,d,c):h(this,d,a,c)&&(e=j(this,d,a,b,c)),e},f.prototype._write=function(a,b,c){c(new Error("not implemented"))},f.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),"undefined"!=typeof a&&null!==a&&this.write(a,b),d.ending||d.finished||t(this,d,c)}},{"./index.js":15,buffer:6,inherits:24,"process/browser.js":16}],21:[function(a,b,c){function d(a){if(a&&!h.isEncoding(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){var b=this.charReceived=a.length%2;return this.charLength=b?2:0,b}function g(a){var b=this.charReceived=a.length%3;return this.charLength=b?3:0,b}var h=a("buffer").Buffer,i=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};i.prototype.write=function(a){for(var b="",c=0;this.charLength;){var d=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,c,d),this.charReceived+=d-c,c=d,this.charReceived<this.charLength)return"";b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var e=b.charCodeAt(b.length-1);if(!(e>=55296&&56319>=e)){if(this.charReceived=this.charLength=0,d==a.length)return b;a=a.slice(d,a.length);break}this.charLength+=this.surrogateSize,b=""}var f=this.detectIncompleteChar(a),g=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-f,g),this.charReceived=f,g-=f),b+=a.toString(this.encoding,0,g);var g=b.length-1,e=b.charCodeAt(g);if(e>=55296&&56319>=e){var h=this.surrogateSize;return this.charLength+=h,this.charReceived+=h,this.charBuffer.copy(this.charBuffer,h,0,h),this.charBuffer.write(b.charAt(b.length-1),this.encoding),b.substring(0,g)}return b},i.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){this.charLength=4;break}}return b},i.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:6}],22:[function(a,b,c){var d=a("http"),e=b.exports;for(var f in d)d.hasOwnProperty(f)&&(e[f]=d[f]);e.request=function(a,b){return a||(a={}),a.scheme="https",a.protocol="https:",d.request.call(this,a,b)}},{http:7}],23:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],24:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],25:[function(a,b,c){},{}],26:[function(a,b,c){(function(c,d,e){!function(){var f="undefined"!=typeof c&&c.versions&&c.versions.node,g=!f&&("undefined"!=typeof window||"undefined"!=typeof self);g&&"undefined"==typeof d&&("undefined"!=typeof window?d=window:"undefined"!=typeof self?d=self:"undefined"!=typeof $&&(d=$));var h=function(b){function h(){}function i(a){for(var b=[],c=Object.keys(a).sort(),d=0;d<c.length;++d){var e=c[d],f=a[e];O(f)||(f=[f]);for(var g=0;g<f.length;++g){var h=f[g];if(null!==h){if(!Q(h))throw new Ga("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:a});b.push({"@value":h,"@language":e.toLowerCase()})}}}return b}function j(a,b){if(O(b))for(var c=0;c<b.length;++c)b[c]=j(a,b[c]);else if(Z(b))b["@list"]=j(a,b["@list"]);else if(M(b)){$(b)&&(b["@id"]=a.getId(b["@id"]));for(var d=Object.keys(b).sort(),e=0;e<d.length;++e){var f=d[e];"@id"!==f&&(b[f]=j(a,b[f]));
}}return b}function k(a,c,d){if(null===d||void 0===d)return null;var e=H(a,c,{vocab:!0});if("@id"===e)return H(a,d,{base:!0});if("@type"===e)return H(a,d,{vocab:!0,base:!0});var f=b.getContextValue(a,c,"@type");if("@id"===f||"@graph"===e&&Q(d))return{"@id":H(a,d,{base:!0})};if("@vocab"===f)return{"@id":H(a,d,{vocab:!0,base:!0})};if(L(e))return d;var g={};if(null!==f)g["@type"]=f;else if(Q(d)){var h=b.getContextValue(a,c,"@language");null!==h&&(g["@language"]=h)}return-1===["boolean","number","string"].indexOf(typeof d)&&(d=d.toString()),g["@value"]=d,g}function l(a,b,c){for(var d=[],e=Object.keys(a).sort(),f=0;f<e.length;++f)for(var g=e[f],h=a[g],i=Object.keys(h).sort(),j=0;j<i.length;++j){var k=i[j],l=h[k];if("@type"===k)k=za;else if(L(k))continue;for(var o=0;o<l.length;++o){var p=l[o],q={};if(q.type=0===g.indexOf("_:")?"blank node":"IRI",q.value=g,_(g)){var r={};if(r.type=0===k.indexOf("_:")?"blank node":"IRI",r.value=k,_(k)&&("blank node"!==r.type||c.produceGeneralizedRdf))if(Z(p))m(p["@list"],b,q,r,d);else{var s=n(p);s&&d.push({subject:q,predicate:r,object:s})}}}}return d}function m(a,b,c,d,e){for(var f={type:"IRI",value:wa},g={type:"IRI",value:xa},h={type:"IRI",value:ya},i=0;i<a.length;++i){var j=a[i],k={type:"blank node",value:b.getId()};e.push({subject:c,predicate:d,object:k}),c=k,d=f;var l=n(j);l&&e.push({subject:c,predicate:d,object:l}),d=g}e.push({subject:c,predicate:d,object:h})}function n(a){var b={};if(Y(a)){b.type="literal";var c=a["@value"],d=a["@type"]||null;U(c)?(b.value=c.toString(),b.datatype=d||qa):S(c)||d===ra?(S(c)||(c=parseFloat(c)),b.value=c.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),b.datatype=d||ra):R(c)?(b.value=c.toFixed(0),b.datatype=d||sa):"@language"in a?(b.value=c,b.datatype=d||Da,b.language=a["@language"]):(b.value=c,b.datatype=d||ta)}else{var e=M(a)?a["@id"]:a;b.type=0===e.indexOf("_:")?"blank node":"IRI",b.value=e}return"IRI"!==b.type||_(b.value)?b:null}function o(a,b){if("IRI"===a.type||"blank node"===a.type)return{"@id":a.value};var c={"@value":a.value};if(a.language)c["@language"]=a.language;else{var d=a.datatype;if(d||(d=ta),b){if(d===qa)"true"===c["@value"]?c["@value"]=!0:"false"===c["@value"]&&(c["@value"]=!1);else if(T(c["@value"]))if(d===sa){var e=parseInt(c["@value"],10);e.toFixed(0)===c["@value"]&&(c["@value"]=e)}else d===ra&&(c["@value"]=parseFloat(c["@value"]));-1===[qa,sa,ra,ta].indexOf(d)&&(c["@type"]=d)}else d!==ta&&(c["@type"]=d)}return c}function p(a,b){for(var c=["subject","predicate","object"],d=0;d<c.length;++d){var e=c[d];if(a[e].type!==b[e].type||a[e].value!==b[e].value)return!1}return a.object.language!==b.object.language?!1:a.object.datatype!==b.object.datatype?!1:!0}function q(a,c,d,e,f,g){if(O(a))for(var h=0;h<a.length;++h)q(a[h],c,d,e,void 0,g);else{if(!M(a))return void(g&&g.push(a));if(Y(a)){if("@type"in a){var i=a["@type"];0===i.indexOf("_:")&&(a["@type"]=i=e.getId(i))}return void(g&&g.push(a))}if("@type"in a)for(var j=a["@type"],h=0;h<j.length;++h){var i=j[h];0===i.indexOf("_:")&&e.getId(i)}V(f)&&(f=$(a)?e.getId(a["@id"]):a["@id"]),g&&g.push({"@id":f});var k=c[d],l=k[f]=k[f]||{};l["@id"]=f;for(var m=Object.keys(a).sort(),n=0;n<m.length;++n){var o=m[n];if("@id"!==o)if("@reverse"!==o)if("@graph"!==o)if("@type"!==o&&L(o)){if("@index"===o&&o in l&&(a[o]!==l[o]||a[o]["@id"]!==l[o]["@id"]))throw new Ga("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:l});l[o]=a[o]}else{var p=a[o];if(0===o.indexOf("_:")&&(o=e.getId(o)),0!==p.length)for(var r=0;r<p.length;++r){var s=p[r];if("@type"===o&&(s=0===s.indexOf("_:")?e.getId(s):s),W(s)||X(s)){var t=$(s)?e.getId(s["@id"]):s["@id"];b.addValue(l,o,{"@id":t},{propertyIsArray:!0,allowDuplicate:!1}),q(s,c,d,e,t)}else if(Z(s)){var u=[];q(s["@list"],c,d,e,f,u),s={"@list":u},b.addValue(l,o,s,{propertyIsArray:!0,allowDuplicate:!1})}else q(s,c,d,e,f),b.addValue(l,o,s,{propertyIsArray:!0,allowDuplicate:!1})}else b.addValue(l,o,[],{propertyIsArray:!0})}else{f in c||(c[f]={});var v="@merged"===d?d:f;q(a[o],c,v,e)}else{var w={"@id":f},x=a["@reverse"];for(var y in x)for(var z=x[y],A=0;A<z.length;++A){var B=z[A],C=B["@id"];$(B)&&(C=e.getId(C)),q(B,c,d,e,C),b.addValue(k[C],y,w,{propertyIsArray:!0,allowDuplicate:!1})}}}}}function r(a){for(var b=a["@default"],c=Object.keys(a).sort(),d=0;d<c.length;++d){var e=c[d];if("@default"!==e){var f=a[e],g=b[e];g?"@graph"in g||(g["@graph"]=[]):b[e]=g={"@id":e,"@graph":[]};for(var h=g["@graph"],i=Object.keys(f).sort(),j=0;j<i.length;++j){var k=f[i[j]];X(k)||h.push(k)}}}return b}function s(a,b,c,d,e){w(c),c=c[0];for(var f=a.options,g={embed:v(c,f,"embed"),explicit:v(c,f,"explicit"),requireAll:v(c,f,"requireAll")},h=x(a,b,c,g),i=Object.keys(h).sort(),j=0;j<i.length;++j){var k=i[j],l=h[k];if("@link"===g.embed&&k in a.link)A(d,e,a.link[k]);else{null===e&&(a.uniqueEmbeds={});var m={};if(m["@id"]=k,a.link[k]=m,"@never"===g.embed||u(l,a.subjectStack))A(d,e,m);else{"@last"===g.embed&&(k in a.uniqueEmbeds&&z(a,k),a.uniqueEmbeds[k]={parent:d,property:e}),a.subjectStack.push(l);for(var n=Object.keys(l).sort(),o=0;o<n.length;o++){var p=n[o];if(L(p))m[p]=aa(l[p]);else if(!g.explicit||p in c)for(var q=l[p],r=0;r<q.length;++r){var y=q[r];if(Z(y)){var B={"@list":[]};A(m,p,B);var C=y["@list"];for(var D in C)if(y=C[D],X(y)){var E=p in c?c[p][0]["@list"]:t(g);s(a,[y["@id"]],E,B,"@list")}else A(B,"@list",aa(y))}else if(X(y)){var E=p in c?c[p]:t(g);s(a,[y["@id"]],E,m,p)}else A(m,p,aa(y))}}for(var n=Object.keys(c).sort(),o=0;o<n.length;++o){var p=n[o];if(!L(p)){var F=c[p][0],G=v(F,f,"omitDefault");if(!(G||p in m)){var H="@null";"@default"in F&&(H=aa(F["@default"])),O(H)||(H=[H]),m[p]=[{"@preserve":H}]}}}A(d,e,m),a.subjectStack.pop()}}}}function t(a){var b={};for(var c in a)void 0!==a[c]&&(b["@"+c]=[a[c]]);return[b]}function u(a,b){for(var c=b.length-1;c>=0;--c)if(b[c]["@id"]===a["@id"])return!0;return!1}function v(a,b,c){var d="@"+c,e=d in a?a[d][0]:b[c];return"embed"===c&&(e===!0?e="@last":e===!1?e="@never":"@always"!==e&&"@never"!==e&&"@link"!==e&&(e="@last")),e}function w(a){if(!O(a)||1!==a.length||!M(a[0]))throw new Ga("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:a})}function x(a,b,c,d){for(var e={},f=0;f<b.length;++f){var g=b[f],h=a.subjects[g];y(h,c,d)&&(e[g]=h)}return e}function y(a,c,d){if("@type"in c&&(1!==c["@type"].length||!M(c["@type"][0]))){for(var e=c["@type"],f=0;f<e.length;++f)if(b.hasValue(a,"@type",e[f]))return!0;return!1}var g=!0,h=!1;for(var i in c){if(L(i)){if("@id"!==i&&"@type"!==i)continue;if(g=!1,"@id"===i&&Q(c[i])){if(a[i]!==c[i])return!1;h=!0;continue}}if(g=!1,i in a){if(O(c[i])&&0===c[i].length&&void 0!==a[i])return!1;h=!0}else{var j=O(c[i])&&M(c[i][0])&&"@default"in c[i][0];if(d.requireAll&&!j)return!1}}return g||h}function z(a,c){var d=a.uniqueEmbeds,e=d[c],f=e.parent,g=e.property,h={"@id":c};if(O(f)){for(var i=0;i<f.length;++i)if(b.compareValues(f[i],h)){f[i]=h;break}}else{var j=O(f[g]);b.removeValue(f,g,h,{propertyIsArray:j}),b.addValue(f,g,h,{propertyIsArray:j})}var k=function(a){for(var b=Object.keys(d),c=0;c<b.length;++c){var e=b[c];e in d&&M(d[e].parent)&&d[e].parent["@id"]===a&&(delete d[e],k(e))}};k(c)}function A(a,c,d){M(a)?b.addValue(a,c,d,{propertyIsArray:!0}):a.push(d)}function B(a,c,d){if(O(c)){for(var e=[],f=0;f<c.length;++f){var g=B(a,c[f],d);null!==g&&e.push(g)}c=e}else if(M(c)){if("@preserve"in c)return"@null"===c["@preserve"]?null:c["@preserve"];if(Y(c))return c;if(Z(c))return c["@list"]=B(a,c["@list"],d),c;var h=E(a,"@id");if(h in c){var i=c[h];if(i in d.link){var j=d.link[i].indexOf(c);if(-1!==j)return d.link[i][j];d.link[i].push(c)}else d.link[i]=[c]}for(var k in c){var g=B(a,c[k],d),l=b.getContextValue(a,k,"@container");d.compactArrays&&O(g)&&1===g.length&&null===l&&(g=g[0]),c[k]=g}}return c}function C(a,b){return a.length<b.length?-1:b.length<a.length?1:a===b?0:b>a?-1:1}function D(a,b,c,d,e,f){null===f&&(f="@null");var g=[];if("@id"!==f&&"@reverse"!==f||!X(c))g.push(f);else{"@reverse"===f&&g.push("@reverse");var h=E(a,c["@id"],null,{vocab:!0});h in a.mappings&&a.mappings[h]&&a.mappings[h]["@id"]===c["@id"]?g.push.apply(g,["@vocab","@id"]):g.push.apply(g,["@id","@vocab"])}g.push("@none");for(var i=a.inverse[b],j=0;j<d.length;++j){var k=d[j];if(k in i)for(var l=i[k][e],m=0;m<g.length;++m){var n=g[m];if(n in l)return l[n]}}return null}function E(a,b,c,d,e){if(null===b)return b;V(c)&&(c=null),V(e)&&(e=!1),d=d||{};var f=a.getInverse();if(L(b))return b in f?f[b]["@none"]["@type"]["@none"]:b;if(d.vocab&&b in f){var g=a["@language"]||"@none",h=[];M(c)&&"@index"in c&&h.push("@index");var i="@language",j="@null";if(e)i="@type",j="@reverse",h.push("@set");else if(Z(c)){"@index"in c||h.push("@list");for(var k=c["@list"],l=0===k.length?g:null,m=null,n=0;n<k.length;++n){var o=k[n],p="@none",q="@none";if(Y(o)?"@language"in o?p=o["@language"]:"@type"in o?q=o["@type"]:p="@null":q="@id",null===l?l=p:p!==l&&Y(o)&&(l="@none"),null===m?m=q:q!==m&&(m="@none"),"@none"===l&&"@none"===m)break}l=l||"@none",m=m||"@none","@none"!==m?(i="@type",j=m):j=l}else Y(c)?"@language"in c&&!("@index"in c)?(h.push("@language"),j=c["@language"]):"@type"in c&&(i="@type",j=c["@type"]):(i="@type",j="@id"),h.push("@set");h.push("@none");var r=D(a,b,c,h,i,j);if(null!==r)return r}if(d.vocab&&"@vocab"in a){var s=a["@vocab"];if(0===b.indexOf(s)&&b!==s){var t=b.substr(s.length);if(!(t in a.mappings))return t}}for(var u=null,v=0,w=[],x=a.fastCurieMap,y=b.length-1;y>v&&b[v]in x;++v)x=x[b[v]],""in x&&w.push(x[""][0]);for(var n=w.length-1;n>=0;--n)for(var z=w[n],A=z.terms,B=0;B<A.length;++B){var E=A[B]+":"+b.substr(z.iri.length),F=!(E in a.mappings)||null===c&&a.mappings[E]["@id"]===b;F&&(null===u||C(E,u)<0)&&(u=E)}return null!==u?u:d.vocab?b:J(a["@base"],b)}function F(a,c,d){if(Y(d)){var e=b.getContextValue(a,c,"@type"),f=b.getContextValue(a,c,"@language"),g=b.getContextValue(a,c,"@container"),h="@index"in d&&"@index"!==g;if(!h&&(d["@type"]===e||d["@language"]===f))return d["@value"];var i=Object.keys(d).length,j=1===i||2===i&&"@index"in d&&!h,k="@language"in a,l=Q(d["@value"]),m=a.mappings[c]&&null===a.mappings[c]["@language"];if(j&&(!k||!l||m))return d["@value"];var n={};return h&&(n[E(a,"@index")]=d["@index"]),"@type"in d?n[E(a,"@type")]=E(a,d["@type"],null,{vocab:!0}):"@language"in d&&(n[E(a,"@language")]=d["@language"]),n[E(a,"@value")]=d["@value"],n}var o=H(a,c,{vocab:!0}),e=b.getContextValue(a,c,"@type"),p=E(a,d["@id"],null,{vocab:"@vocab"===e});if("@id"===e||"@vocab"===e||"@graph"===o)return p;var n={};return n[E(a,"@id")]=p,n}function G(a,b,c,d){if(c in d){if(d[c])return;throw new Ga("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:b,term:c})}if(d[c]=!1,L(c))throw new Ga("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:b,term:c});if(""===c)throw new Ga("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:b});a.mappings[c]&&delete a.mappings[c];var e=b[c];if(null===e||M(e)&&null===e["@id"])return a.mappings[c]=null,void(d[c]=!0);if(Q(e)&&(e={"@id":e}),!M(e))throw new Ga("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:b});var f=a.mappings[c]={};if(f.reverse=!1,"@reverse"in e){if("@id"in e)throw new Ga("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});var g=e["@reverse"];if(!Q(g))throw new Ga("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});var h=H(a,g,{vocab:!0,base:!1},b,d);if(!_(h))throw new Ga("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h,f.reverse=!0}else if("@id"in e){var h=e["@id"];if(!Q(h))throw new Ga("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});if(h!==c){if(h=H(a,h,{vocab:!0,base:!1},b,d),!_(h)&&!L(h))throw new Ga("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b});f["@id"]=h}}var i=c.indexOf(":");if(f._termHasColon=-1!==i,!("@id"in f))if(f._termHasColon){var j=c.substr(0,i);if(j in b&&G(a,b,j,d),a.mappings[j]){var k=c.substr(i+1);f["@id"]=a.mappings[j]["@id"]+k}else f["@id"]=c}else{if(!("@vocab"in a))throw new Ga("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:b,term:c});f["@id"]=a["@vocab"]+c}if(d[c]=!0,"@type"in e){var l=e["@type"];if(!Q(l))throw new Ga("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if("@id"!==l&&"@vocab"!==l){if(l=H(a,l,{vocab:!0,base:!1},b,d),!_(l))throw new Ga("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:b});if(0===l.indexOf("_:"))throw new Ga("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:b})}f["@type"]=l}if("@container"in e){var m=e["@container"];if("@list"!==m&&"@set"!==m&&"@index"!==m&&"@language"!==m)throw new Ga("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:b});if(f.reverse&&"@index"!==m&&"@set"!==m&&null!==m)throw new Ga("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:b});f["@container"]=m}if("@language"in e&&!("@type"in e)){var n=e["@language"];if(null!==n&&!Q(n))throw new Ga("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:b});null!==n&&(n=n.toLowerCase()),f["@language"]=n}var h=f["@id"];if("@context"===h||"@preserve"===h)throw new Ga("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:b})}function H(a,c,d,e,f){if(null===c||L(c))return c;if(c=String(c),e&&c in e&&f[c]!==!0&&G(a,e,c,f),d=d||{},d.vocab){var g=a.mappings[c];if(null===g)return null;if(g)return g["@id"]}var h=c.indexOf(":");if(-1!==h){var i=c.substr(0,h),j=c.substr(h+1);if("_"===i||0===j.indexOf("//"))return c;e&&i in e&&G(a,e,i,f);var g=a.mappings[i];return g?g["@id"]+j:c}if(d.vocab&&"@vocab"in a)return a["@vocab"]+c;var k=c;return d.base&&(k=b.prependBase(a["@base"],k)),k}function I(a,c){if(null===a)return c;if(-1!==c.indexOf(":"))return c;Q(a)&&(a=b.url.parse(a||""));var d=b.url.parse(c),e={protocol:a.protocol||""};if(null!==d.authority)e.authority=d.authority,e.path=d.path,e.query=d.query;else if(e.authority=a.authority,""===d.path)e.path=a.path,null!==d.query?e.query=d.query:e.query=a.query;else{if(0===d.path.indexOf("/"))e.path=d.path;else{var f=a.path;""!==d.path&&(f=f.substr(0,f.lastIndexOf("/")+1),f.length>0&&"/"!==f.substr(-1)&&(f+="/"),f+=d.path),e.path=f}e.query=d.query}e.path=ia(e.path,!!e.authority);var g=e.protocol;return null!==e.authority&&(g+="//"+e.authority),g+=e.path,null!==e.query&&(g+="?"+e.query),null!==d.fragment&&(g+="#"+d.fragment),""===g&&(g="./"),g}function J(a,c){if(null===a)return c;Q(a)&&(a=b.url.parse(a||""));var d="";if(""!==a.href?d+=(a.protocol||"")+"//"+(a.authority||""):c.indexOf("//")&&(d+="//"),0!==c.indexOf(d))return c;for(var e=b.url.parse(c.substr(d.length)),f=a.normalizedPath.split("/"),g=e.normalizedPath.split("/"),h=e.fragment||e.query?0:1;f.length>0&&g.length>h&&f[0]===g[0];)f.shift(),g.shift();var i="";if(f.length>0){f.pop();for(var j=0;j<f.length;++j)i+="../"}return i+=g.join("/"),null!==e.query&&(i+="?"+e.query),null!==e.fragment&&(i+="#"+e.fragment),""===i&&(i="./"),i}function K(a){function c(){var a=this;if(a.inverse)return a.inverse;for(var b=a.inverse={},c=a.fastCurieMap={},f={},g=a["@language"]||"@none",h=a.mappings,i=Object.keys(h).sort(C),j=0;j<i.length;++j){var k=i[j],l=h[k];if(null!==l){var m=l["@container"]||"@none",n=l["@id"];O(n)||(n=[n]);for(var o=0;o<n.length;++o){var p=n[o],q=b[p],r=L(p);if(q)r||l._termHasColon||f[p].push(k);else if(b[p]=q={},!r&&!l._termHasColon){f[p]=[k];var s={iri:p,terms:f[p]};p[0]in c?c[p[0]].push(s):c[p[0]]=[s]}if(q[m]||(q[m]={"@language":{},"@type":{}}),q=q[m],l.reverse)e(l,k,q["@type"],"@reverse");else if("@type"in l)e(l,k,q["@type"],l["@type"]);else if("@language"in l){var t=l["@language"]||"@null";e(l,k,q["@language"],t)}else e(l,k,q["@language"],g),e(l,k,q["@type"],"@none"),e(l,k,q["@language"],"@none")}}}for(var u in c)d(c,u,1);return b}function d(a,b,c){for(var e,f,g=a[b],h=a[b]={},i=0;i<g.length;++i)e=g[i].iri,f=c>=e.length?"":e[c],f in h?h[f].push(g[i]):h[f]=[g[i]];for(var b in h)""!==b&&d(h,b,c+1)}function e(a,b,c,d){d in c||(c[d]=b)}function f(){var a={};return a["@base"]=this["@base"],a.mappings=aa(this.mappings),a.clone=this.clone,a.inverse=null,a.getInverse=this.getInverse,"@language"in this&&(a["@language"]=this["@language"]),"@vocab"in this&&(a["@vocab"]=this["@vocab"]),a}var g=b.url.parse(a.base||"");return{"@base":g,mappings:{},inverse:null,getInverse:c,clone:f}}function L(a){if(!Q(a))return!1;switch(a){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function M(a){return"[object Object]"===Object.prototype.toString.call(a)}function N(a){return M(a)&&0===Object.keys(a).length}function O(a){return Array.isArray(a)}function P(a){if(!Q(a)&&!N(a)){var b=!1;if(O(a)){b=!0;for(var c=0;c<a.length;++c)if(!Q(a[c])){b=!1;break}}if(!b)throw new Ga('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:a})}}function Q(a){return"string"==typeof a||"[object String]"===Object.prototype.toString.call(a)}function R(a){return"number"==typeof a||"[object Number]"===Object.prototype.toString.call(a)}function S(a){return R(a)&&-1!==String(a).indexOf(".")}function T(a){return!isNaN(parseFloat(a))&&isFinite(a)}function U(a){return"boolean"==typeof a||"[object Boolean]"===Object.prototype.toString.call(a)}function V(a){return"undefined"==typeof a}function W(a){var b=!1;if(M(a)&&!("@value"in a||"@set"in a||"@list"in a)){var c=Object.keys(a).length;b=c>1||!("@id"in a)}return b}function X(a){return M(a)&&1===Object.keys(a).length&&"@id"in a}function Y(a){return M(a)&&"@value"in a}function Z(a){return M(a)&&"@list"in a}function $(a){var b=!1;return M(a)&&(b="@id"in a?0===a["@id"].indexOf("_:"):0===Object.keys(a).length||!("@value"in a||"@set"in a||"@list"in a)),b}function _(a){return Q(a)&&-1!==a.indexOf(":")}function aa(a){if(a&&"object"==typeof a){var b;if(O(a)){b=[];for(var c=0;c<a.length;++c)b[c]=aa(a[c])}else if(M(a)){b={};for(var d in a)b[d]=aa(a[d])}else b=a.toString();return b}return a}function ba(a,c,d,e){var f=Object.keys(c).length;if(O(a)){for(var g=0;g<a.length;++g)ba(a[g],c,d,e);return f<Object.keys(c).length}if(M(a)){for(var h in a)if("@context"===h){var i=a[h];if(O(i))for(var j=i.length,g=0;j>g;++g){var k=i[g];Q(k)&&(k=b.prependBase(e,k),d?(k=c[k],O(k)?(Array.prototype.splice.apply(i,[g,1].concat(k)),g+=k.length-1,j=i.length):i[g]=k):k in c||(c[k]=!1))}else Q(i)&&(i=b.prependBase(e,i),d?a[h]=c[i]:i in c||(c[i]=!1))}else ba(a[h],c,d,e);return f<Object.keys(c).length}return!1}function ca(a,b,c){var d=null,e=b.documentLoader,f=function(a,b,c,e,g){if(Object.keys(b).length>Fa)return d=new Ga("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:Fa}),g(d);var h={},i=function(){ba(a,h,!0,e),g(null,a)};ba(a,h,!1,e)||i();var j=[];for(var k in h)h[k]===!1&&j.push(k);for(var l=j.length,m=0;m<j.length;++m)!function(a){if(a in b)return d=new Ga("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:a}),g(d);var e=aa(b);e[a]=!0;var j=function(b,j){if(!d){var k=j?j.document:null;if(!b&&Q(k))try{k=JSON.parse(k)}catch(m){b=m}if(b?b=new Ga("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:a,cause:b}):M(k)||(b=new Ga("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:a,cause:b})),b)return d=b,g(d);k="@context"in k?{"@context":k["@context"]}:{"@context":{}},j.contextUrl&&(O(k["@context"])||(k["@context"]=[k["@context"]]),k["@context"].push(j.contextUrl)),f(k,e,c,a,function(b,c){return b?g(b):(h[a]=c["@context"],l-=1,void(0===l&&i()))})}},k=c(a,j);k&&"then"in k&&k.then(j.bind(null,null),j)}(j[m])};f(a,{},e,b.base,c)}function da(a){for(var b="(?:<([^:]+:[^>]*)>)",c="(_:(?:[A-Za-z0-9]+))",d='"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"',e="(?:\\^\\^"+b+")",f="(?:@([a-z]+(?:-[a-z0-9]+)*))",g="(?:"+d+"(?:"+e+"|"+f+")?)",h="(?:#.*)?",i="[ \\t]+",j="[ \\t]*",k=/(?:\r\n)|(?:\n)|(?:\r)/g,l=new RegExp("^"+j+h+"$"),m="(?:"+b+"|"+c+")"+i,n=b+i,o="(?:"+b+"|"+c+"|"+g+")"+j,q="(?:\\.|(?:(?:"+b+"|"+c+")"+j+"\\.))",r=new RegExp("^"+j+m+n+o+q+j+h+"$"),s={},t=a.split(k),u=0,v=0;v<t.length;++v){var w=t[v];if(u++,!l.test(w)){var x=w.match(r);if(null===x)throw new Ga("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:u});var y={};if(V(x[1])?y.subject={type:"blank node",value:x[2]}:y.subject={type:"IRI",value:x[1]},y.predicate={type:"IRI",value:x[3]},V(x[4]))if(V(x[5])){y.object={type:"literal"},V(x[7])?V(x[8])?y.object.datatype=ta:(y.object.datatype=Da,y.object.language=x[8]):y.object.datatype=x[7];var z=x[6].replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");y.object.value=z}else y.object={type:"blank node",value:x[5]};else y.object={type:"IRI",value:x[4]};var A="@default";if(V(x[9])?V(x[10])||(A=x[10]):A=x[9],A in s){for(var B=!0,C=s[A],D=0;B&&D<C.length;++D)p(C[D],y)&&(B=!1);B&&C.push(y)}else s[A]=[y]}}return s}function ea(a){var b=[];for(var c in a)for(var d=a[c],e=0;e<d.length;++e){var f=d[e];"@default"===c&&(c=null),b.push(fa(f,c))}return b.sort().join("")}function fa(a,b){var c=a.subject,d=a.predicate,e=a.object,f=b||null;"name"in a&&a.name&&(f=a.name.value);var g="";if(g+="IRI"===c.type?"<"+c.value+">":c.value,g+=" ",g+="IRI"===d.type?"<"+d.value+">":d.value,g+=" ","IRI"===e.type)g+="<"+e.value+">";else if("blank node"===e.type)g+=e.value;else{var h=e.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"');g+='"'+h+'"',e.datatype===Da?e.language&&(g+="@"+e.language):e.datatype!==ta&&(g+="^^<"+e.datatype+">")}return null!==f&&void 0!==f&&(g+=0!==f.indexOf("_:")?" <"+f+">":" "+f),g+=" .\n"}function ga(a){var b={};b["@default"]=[];for(var c=a.getSubjects(),d=0;d<c.length;++d){var e=c[d];if(null!==e){var f=a.getSubjectTriples(e);if(null!==f){var g=f.predicates;for(var h in g)for(var i=g[h].objects,j=0;j<i.length;++j){var k=i[j],l={};0===e.indexOf("_:")?l.subject={type:"blank node",value:e}:l.subject={type:"IRI",value:e},0===h.indexOf("_:")?l.predicate={type:"blank node",value:h}:l.predicate={type:"IRI",value:h};var m=k.value;if(k.type===Ba){oa||Ma();var n=new oa;m="";for(var o=0;o<k.value.length;o++)k.value[o].nodeType===pa.ELEMENT_NODE?m+=n.serializeToString(k.value[o]):k.value[o].nodeType===pa.TEXT_NODE&&(m+=k.value[o].nodeValue)}l.object={},k.type===Ca?0===k.value.indexOf("_:")?l.object.type="blank node":l.object.type="IRI":(l.object.type="literal",k.type===Aa?k.language?(l.object.datatype=Da,l.object.language=k.language):l.object.datatype=ta:l.object.datatype=k.type),l.object.value=m,b["@default"].push(l)}}}}return b}function ha(a){this.prefix=a,this.counter=0,this.existing={}}function ia(a,b){var c="";0===a.indexOf("/")&&(c="/");for(var d=a.split("/"),e=[];d.length>0;)"."===d[0]||""===d[0]&&d.length>1?d.shift():".."!==d[0]?e.push(d.shift()):(d.shift(),b||e.length>0&&".."!==e[e.length-1]?e.pop():e.push(".."));return c+e.join("/")}b.compact=function(a,c,d,e){function f(a,b,d,f){if(a)return e(a);f.compactArrays&&!f.graph&&O(b)?1===b.length?b=b[0]:0===b.length&&(b={}):f.graph&&M(b)&&(b=[b]),M(c)&&"@context"in c&&(c=c["@context"]),c=aa(c),O(c)||(c=[c]);var g=c;c=[];for(var h=0;h<g.length;++h)(!M(g[h])||Object.keys(g[h]).length>0)&&c.push(g[h]);var i=c.length>0;if(1===c.length&&(c=c[0]),O(b)){var j=E(d,"@graph"),k=b;b={},i&&(b["@context"]=c),b[j]=k}else if(M(b)&&i){var k=b;b={"@context":c};for(var l in k)b[l]=k[l]}e(null,b,d)}if(arguments.length<2)return b.nextTick(function(){e(new TypeError("Could not compact, too few arguments."))});if("function"==typeof d&&(e=d,d={}),d=d||{},null===c)return b.nextTick(function(){e(new Ga("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===a)return b.nextTick(function(){e(null,null)});"base"in d||(d.base="string"==typeof a?a:""),"compactArrays"in d||(d.compactArrays=!0),"graph"in d||(d.graph=!1),"skipExpansion"in d||(d.skipExpansion=!1),"documentLoader"in d||(d.documentLoader=b.loadDocument),"link"in d||(d.link=!1),d.link&&(d.skipExpansion=!0);var g=function(a,c,d){return c.skipExpansion?b.nextTick(function(){d(null,a)}):void b.expand(a,c,d)};g(a,d,function(a,g){if(a)return e(new Ga("Could not expand input before compaction.","jsonld.CompactError",{cause:a}));var h=K(d);b.processContext(h,c,d,function(a,b){if(a)return e(new Ga("Could not process context before compaction.","jsonld.CompactError",{cause:a}));var c;try{c=(new Ha).compact(b,null,g,d)}catch(h){return e(h)}f(null,c,b,d)})})},b.expand=function(a,c,d){function e(a){"base"in c||(c.base=a.documentUrl||"");var b={document:aa(a.document),remoteContext:{"@context":a.contextUrl}};if("expandContext"in c){var e=aa(c.expandContext);"object"==typeof e&&"@context"in e?b.expandContext=e:b.expandContext={"@context":e}}ca(b,c,function(a,b){if(a)return d(a);var e;try{var f=new Ha,g=K(c),h=b.document,i=b.remoteContext["@context"];b.expandContext&&(g=f.processContext(g,b.expandContext["@context"],c)),i&&(g=f.processContext(g,i,c)),e=f.expand(g,null,h,c,!1),M(e)&&"@graph"in e&&1===Object.keys(e).length?e=e["@graph"]:null===e&&(e=[]),O(e)||(e=[e])}catch(j){return d(j)}d(null,e)})}return arguments.length<1?b.nextTick(function(){d(new TypeError("Could not expand, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"documentLoader"in c||(c.documentLoader=b.loadDocument),"keepFreeFloatingNodes"in c||(c.keepFreeFloatingNodes=!1),void b.nextTick(function(){if("string"==typeof a){var b=function(a,b){if(a)return d(a);try{if(!b.document)throw new Ga("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(c){return d(new Ga("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:c,remoteDoc:b}))}e(b)},f=c.documentLoader(a,b);return void(f&&"then"in f&&f.then(b.bind(null,null),b))}e({contextUrl:null,documentUrl:null,document:a})}))},b.flatten=function(a,c,d,e){return arguments.length<1?b.nextTick(function(){e(new TypeError("Could not flatten, too few arguments."))}):("function"==typeof d?(e=d,d={}):"function"==typeof c&&(e=c,c=null,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=b.loadDocument),void b.expand(a,d,function(a,f){if(a)return e(new Ga("Could not expand input before flattening.","jsonld.FlattenError",{cause:a}));var g;try{g=(new Ha).flatten(f)}catch(h){return e(h)}return null===c?e(null,g):(d.graph=!0,d.skipExpansion=!0,void b.compact(g,c,d,function(a,b){return a?e(new Ga("Could not compact flattened output.","jsonld.FlattenError",{cause:a})):void e(null,b)}))}))},b.frame=function(a,c,d,e){function f(c){var f,g=c.document;g?(f=g["@context"],c.contextUrl?(f?O(f)?f.push(c.contextUrl):f=[f,c.contextUrl]:f=c.contextUrl,g["@context"]=f):f=f||{}):f={},b.expand(a,d,function(a,c){if(a)return e(new Ga("Could not expand input before framing.","jsonld.FrameError",{cause:a}));var h=aa(d);h.isFrame=!0,h.keepFreeFloatingNodes=!0,b.expand(g,h,function(a,d){if(a)return e(new Ga("Could not expand frame before framing.","jsonld.FrameError",{cause:a}));var g;try{g=(new Ha).frame(c,d,h)}catch(i){return e(i)}h.graph=!0,h.skipExpansion=!0,h.link={},b.compact(g,f,h,function(a,b,c){if(a)return e(new Ga("Could not compact framed output.","jsonld.FrameError",{cause:a}));var d=E(c,"@graph");h.link={},b[d]=B(c,b[d],h),e(null,b)})})})}return arguments.length<2?b.nextTick(function(){e(new TypeError("Could not frame, too few arguments."))}):("function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=b.loadDocument),"embed"in d||(d.embed="@last"),d.explicit=d.explicit||!1,"requireAll"in d||(d.requireAll=!0),d.omitDefault=d.omitDefault||!1,void b.nextTick(function(){if("string"==typeof c){var a=function(a,b){if(a)return e(a);try{if(!b.document)throw new Ga("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof b.document&&(b.document=JSON.parse(b.document))}catch(c){return e(new Ga("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:c,remoteDoc:b}))}f(b)},b=d.documentLoader(c,a);return void(b&&"then"in b&&b.then(a.bind(null,null),a))}f({contextUrl:null,documentUrl:null,document:c})}))},b.link=function(a,c,d,e){var f={};c&&(f["@context"]=c),f["@embed"]="@link",b.frame(a,f,d,e)},b.objectify=function(a,c,d,e){"function"==typeof d&&(e=d,d={}),d=d||{},"base"in d||(d.base="string"==typeof a?a:""),"documentLoader"in d||(d.documentLoader=b.loadDocument),b.expand(a,d,function(a,f){if(a)return e(new Ga("Could not expand input before linking.","jsonld.LinkError",{cause:a}));var g;try{g=(new Ha).flatten(f)}catch(h){return e(h)}d.graph=!0,d.skipExpansion=!0,b.compact(g,c,d,function(a,c,d){if(a)return e(new Ga("Could not compact flattened output before linking.","jsonld.LinkError",{cause:a}));var f=E(d,"@graph"),g=c[f][0],h=function(a){if(M(a)||O(a)){if(M(a)){if(h.visited[a["@id"]])return;h.visited[a["@id"]]=!0}for(var c in a){var e=a[c],f="@id"===b.getContextValue(d,c,"@type");if(O(e)||M(e)||f)if(Q(e)&&f)a[c]=e=g[e],h(e);else if(O(e))for(var i=0;i<e.length;++i)Q(e[i])&&f?e[i]=g[e[i]]:M(e[i])&&"@id"in e[i]&&(e[i]=g[e[i]["@id"]]),h(e[i]);else if(M(e)){var j=e["@id"];a[c]=e=g[j],h(e)}}}};h.visited={},h(g),c.of_type={};for(var i in g)if("@type"in g[i]){var j=g[i]["@type"];O(j)||(j=[j]);for(var k=0;k<j.length;++k)j[k]in c.of_type||(c.of_type[j[k]]=[]),c.of_type[j[k]].push(g[i])}e(null,c)})})},b.normalize=function(a,c,d){if(arguments.length<1)return b.nextTick(function(){d(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof c&&(d=c,c={}),c=c||{},"algorithm"in c||(c.algorithm="URGNA2012"),"base"in c||(c.base="string"==typeof a?a:""),"documentLoader"in c||(c.documentLoader=b.loadDocument),"inputFormat"in c){if("application/nquads"!==c.inputFormat)return d(new Ga("Unknown normalization input format.","jsonld.NormalizeError"));
var e=da(a);(new Ha).normalize(e,c,d)}else{var f=aa(c);delete f.format,f.produceGeneralizedRdf=!1,b.toRDF(a,f,function(a,b){return a?d(new Ga("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:a})):void(new Ha).normalize(b,c,d)})}},b.fromRDF=function(a,c,d){return arguments.length<1?b.nextTick(function(){d(new TypeError("Could not convert from RDF, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"useRdfType"in c||(c.useRdfType=!1),"useNativeTypes"in c||(c.useNativeTypes=!1),"format"in c||!Q(a)||"format"in c||(c.format="application/nquads"),void b.nextTick(function(){function b(a,b,c){(new Ha).fromRDF(a,b,c)}var e;if(c.format){if(e=c.rdfParser||na[c.format],!e)return d(new Ga("Unknown input format.","jsonld.UnknownFormat",{format:c.format}))}else e=function(){return a};var f=!1;try{a=e(a,function(a,e){return f=!0,a?d(a):void b(e,c,d)})}catch(g){if(!f)return d(g);throw g}if(a){if("then"in a)return a.then(function(a){b(a,c,d)},d);b(a,c,d)}}))},b.toRDF=function(a,c,d){return arguments.length<1?b.nextTick(function(){d(new TypeError("Could not convert to RDF, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"base"in c||(c.base="string"==typeof a?a:""),"documentLoader"in c||(c.documentLoader=b.loadDocument),void b.expand(a,c,function(a,b){if(a)return d(new Ga("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:a}));var e;try{if(e=Ha.prototype.toRDF(b,c),c.format){if("application/nquads"===c.format)return d(null,ea(e));throw new Ga("Unknown output format.","jsonld.UnknownFormat",{format:c.format})}}catch(f){return d(f)}d(null,e)}))},b.createNodeMap=function(a,c,d){return arguments.length<1?b.nextTick(function(){d(new TypeError("Could not create node map, too few arguments."))}):("function"==typeof c&&(d=c,c={}),c=c||{},"base"in c||(c.base="string"==typeof a?a:""),"documentLoader"in c||(c.documentLoader=b.loadDocument),void b.expand(a,c,function(a,b){if(a)return d(new Ga("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:a}));var e;try{e=(new Ha).createNodeMap(b,c)}catch(f){return d(f)}d(null,e)}))},b.merge=function(a,c,d,e){function f(a,b){if(!i){if(a)return i=a,e(new Ga("Could not expand input before flattening.","jsonld.FlattenError",{cause:a}));h.push(b),0===--j&&g(h)}}function g(a){var f=!0;"mergeNodes"in d&&(f=d.mergeNodes);var g,h=d.namer||d.issuer||new ha("_:b"),i={"@default":{}};try{for(var j=0;j<a.length;++j){var k=a[j];k=b.relabelBlankNodes(k,{issuer:new ha("_:b"+j+"-")});var l=f||0===j?i:{"@default":{}};if(q(k,l,"@default",h),l!==i)for(var m in l){var n=l[m];if(m in i){var o=i[m];for(var p in n)p in o||(o[p]=n[p])}else i[m]=n}}g=r(i)}catch(s){return e(s)}for(var t=[],u=Object.keys(g).sort(),v=0;v<u.length;++v){var w=g[u[v]];X(w)||t.push(w)}return null===c?e(null,t):(d.graph=!0,d.skipExpansion=!0,void b.compact(t,c,d,function(a,b){return a?e(new Ga("Could not compact merged output.","jsonld.MergeError",{cause:a})):void e(null,b)}))}if(arguments.length<1)return b.nextTick(function(){e(new TypeError("Could not merge, too few arguments."))});if(!O(a))return b.nextTick(function(){e(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof d?(e=d,d={}):"function"==typeof c&&(e=c,c=null,d={}),d=d||{};for(var h=[],i=null,j=a.length,k=0;k<a.length;++k){var l={};for(var m in d)l[m]=d[m];b.expand(a[k],l,f)}},b.relabelBlankNodes=function(a,b){b=b||{};var c=b.namer||b.issuer||new ha("_:b");return j(c,a)},b.prependBase=function(a,b){return I(a,b)},b.documentLoader=function(a,c){var d=new Ga("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return f?c(d,{contextUrl:null,documentUrl:a,document:null}):b.promisify(function(a){a(d)})},b.loadDocument=function(a,c){var d=b.documentLoader(a,c);d&&"then"in d&&d.then(c.bind(null,null),c)},b.promises=function(c){c=c||{};var e=Array.prototype.slice,f=b.promisify,g=c.api||{},h=c.version||"jsonld.js";"string"==typeof c.api&&(c.version||(h=c.api),g={}),g.expand=function(a){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return f.apply(null,[b.expand].concat(e.call(arguments)))},g.compact=function(a,c){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");var d=function(a,c,d,e){b.compact(a,c,d,function(a,b){e(a,b)})};return f.apply(null,[d].concat(e.call(arguments)))},g.flatten=function(a){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return f.apply(null,[b.flatten].concat(e.call(arguments)))},g.frame=function(a,c){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return f.apply(null,[b.frame].concat(e.call(arguments)))},g.fromRDF=function(a){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return f.apply(null,[b.fromRDF].concat(e.call(arguments)))},g.toRDF=function(a){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return f.apply(null,[b.toRDF].concat(e.call(arguments)))},g.normalize=function(a){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return f.apply(null,[b.normalize].concat(e.call(arguments)))},"jsonld.js"===h&&(g.link=function(a,c){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return f.apply(null,[b.link].concat(e.call(arguments)))},g.objectify=function(a){return f.apply(null,[b.objectify].concat(e.call(arguments)))},g.createNodeMap=function(a){return f.apply(null,[b.createNodeMap].concat(e.call(arguments)))},g.merge=function(a){return f.apply(null,[b.merge].concat(e.call(arguments)))});try{b.Promise=d.Promise||a("es6-promise").Promise}catch(i){var j=function(){throw new Error("Unable to find a Promise implementation.")};for(var k in g)g[k]=j}return g},b.promisify=function(c){if(!b.Promise)try{b.Promise=d.Promise||a("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.")}var f=Array.prototype.slice.call(arguments,1);return new b.Promise(function(a,b){c.apply(null,f.concat(function(c,d){c?b(c):a(d)}))})},b.promises({api:b.promises}),h.prototype=b.promises({version:"json-ld-1.0"}),h.prototype.toString=function(){return this instanceof h?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},b.JsonLdProcessor=h;var ja=!!Object.defineProperty;if(ja)try{Object.defineProperty({},"x",{})}catch(ka){ja=!1}ja&&(Object.defineProperty(h,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(h.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:h})),g&&"undefined"==typeof d.JsonLdProcessor&&(ja?Object.defineProperty(d,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:h}):d.JsonLdProcessor=h);var la="function"==typeof setImmediate&&setImmediate,ma=la?function(a){la(a)}:function(a){setTimeout(a,0)};"object"==typeof c&&"function"==typeof c.nextTick?b.nextTick=c.nextTick:b.nextTick=ma,b.setImmediate=la?ma:b.nextTick,b.parseLinkHeader=function(a){for(var b={},c=a.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),d=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,e=0;e<c.length;++e){var f=c[e].match(d);if(f){for(var g={target:f[1]},h=f[2],i=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;f=i.exec(h);)g[f[1]]=void 0===f[2]?f[3]:f[2];var j=g.rel||"";O(b[j])?b[j].push(g):j in b?b[j]=[b[j],g]:b[j]=g}}return b},b.RequestQueue=function(){this._requests={}},b.RequestQueue.prototype.wrapLoader=function(a){return this._loader=a,this._usePromise=1===a.length,this.add.bind(this)},b.RequestQueue.prototype.add=function(a,c){var d=this;if(!c&&!d._usePromise)throw new Error("callback must be specified.");return d._usePromise?new b.Promise(function(b,c){var e=d._requests[a];e||(e=d._requests[a]=d._loader(a).then(function(b){return delete d._requests[a],b})["catch"](function(b){throw delete d._requests[a],b})),e.then(function(a){b(a)})["catch"](function(a){c(a)})}):void(a in d._requests?d._requests[a].push(c):(d._requests[a]=[c],d._loader(a,function(b,c){var e=d._requests[a];delete d._requests[a];for(var f=0;f<e.length;++f)e[f](b,c)})))},b.DocumentCache=function(a){this.order=[],this.cache={},this.size=a||50,this.expires=3e4},b.DocumentCache.prototype.get=function(a){if(a in this.cache){var b=this.cache[a];if(b.expires>=+new Date)return b.ctx;delete this.cache[a],this.order.splice(this.order.indexOf(a),1)}return null},b.DocumentCache.prototype.set=function(a,b){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(a),this.cache[a]={ctx:b,expires:+new Date+this.expires}},b.ActiveContextCache=function(a){this.order=[],this.cache={},this.size=a||100},b.ActiveContextCache.prototype.get=function(a,b){var c=JSON.stringify(a),d=JSON.stringify(b),e=this.cache[c];return e&&d in e?e[d]:null},b.ActiveContextCache.prototype.set=function(a,b,c){if(this.order.length===this.size){var d=this.order.shift();delete this.cache[d.activeCtx][d.localCtx]}var e=JSON.stringify(a),f=JSON.stringify(b);this.order.push({activeCtx:e,localCtx:f}),e in this.cache||(this.cache[e]={}),this.cache[e][f]=aa(c)},b.cache={activeCtx:new b.ActiveContextCache},b.documentLoaders={},b.documentLoaders.jquery=function(a,c){function d(d,e){return 0!==d.indexOf("http:")&&0!==d.indexOf("https:")?e(new Ga('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null}):c.secure&&0!==d.indexOf("https")?e(new Ga('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:d}),{contextUrl:null,documentUrl:d,document:null}):void a.ajax({url:d,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(a,c,f){var g={contextUrl:null,documentUrl:d,document:a},h=f.getResponseHeader("Content-Type"),i=f.getResponseHeader("Link");if(i&&"application/ld+json"!==h){if(i=b.parseLinkHeader(i)[Ea],O(i))return e(new Ga("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:d}),g);i&&(g.contextUrl=i.target)}e(null,g)},error:function(a,b,c){e(new Ga("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:d,cause:c}),{contextUrl:null,documentUrl:d,document:null})}})}c=c||{};var e=new b.RequestQueue,f="usePromise"in c?c.usePromise:"undefined"!=typeof Promise;return f?e.wrapLoader(function(a){return b.promisify(d,a)}):e.wrapLoader(d)},b.documentLoaders.node=function(c){function d(a,j,k){function l(c,e,g){if(m={contextUrl:null,documentUrl:a,document:g||null},c)return k(new Ga("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:c}),m);var h=i.STATUS_CODES[e.statusCode];if(e.statusCode>=400)return k(new Ga("URL could not be dereferenced: "+h,"jsonld.InvalidUrl",{code:"loading document failed",url:a,httpStatusCode:e.statusCode}),m);if(e.headers.link&&"application/ld+json"!==e.headers["content-type"]){var l=b.parseLinkHeader(e.headers.link)[Ea];if(O(l))return k(new Ga("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a}),m);l&&(m.contextUrl=l.target)}return e.statusCode>=300&&e.statusCode<400&&e.headers.location?j.length===f?k(new Ga("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:a,httpStatusCode:e.statusCode,redirects:j}),m):-1!==j.indexOf(a)?k(new Ga("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:a,httpStatusCode:e.statusCode,redirects:j}),m):(j.push(a),d(e.headers.location,j,k)):(j.push(a),void k(c,m))}if(0!==a.indexOf("http:")&&0!==a.indexOf("https:"))return k(new Ga('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a}),{contextUrl:null,documentUrl:a,document:null});if(c.secure&&0!==a.indexOf("https"))return k(new Ga('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:a}),{contextUrl:null,documentUrl:a,document:null});var m=null;if(null!==m)return k(null,m);var n={Accept:h};for(var o in c.headers)n[o]=c.headers[o];g({url:a,headers:n,strictSSL:e,followRedirect:!1},l)}c=c||{};var e="strictSSL"in c?c.strictSSL:!0,f="maxRedirects"in c?c.maxRedirects:-1,g="request"in c?c.request:a("request"),h="application/ld+json, application/json",i=a("http"),j=new b.RequestQueue;if(c.usePromise)return j.wrapLoader(function(a){return b.promisify(d,a,[])});var k=c.headers||{};if("Accept"in k||"accept"in k)throw new RangeError('Accept header may not be specified as an option; only "'+h+'" is supported.');return j.wrapLoader(function(a,b){d(a,[],b)})},b.documentLoaders.xhr=function(a){function c(c,e){if(0!==c.indexOf("http:")&&0!==c.indexOf("https:"))return e(new Ga('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:c}),{contextUrl:null,documentUrl:c,document:null});if(a.secure&&0!==c.indexOf("https"))return e(new Ga('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:c}),{contextUrl:null,documentUrl:c,document:null});var f=a.xhr||XMLHttpRequest,g=new f;g.onload=function(){if(g.status>=400)return e(new Ga("URL could not be dereferenced: "+g.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:c,httpStatusCode:g.status}),{contextUrl:null,documentUrl:c,document:null});var a,f={contextUrl:null,documentUrl:c,document:g.response},h=g.getResponseHeader("Content-Type");if(d.test(g.getAllResponseHeaders())&&(a=g.getResponseHeader("Link")),a&&"application/ld+json"!==h){if(a=b.parseLinkHeader(a)[Ea],O(a))return e(new Ga("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:c}),f);a&&(f.contextUrl=a.target)}e(null,f)},g.onerror=function(){e(new Ga("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:c}),{contextUrl:null,documentUrl:c,document:null})},g.open("GET",c,!0),g.setRequestHeader("Accept","application/ld+json, application/json"),g.send()}a=a||{};var d=/(^|(\r\n))link:/i,e=new b.RequestQueue,f="usePromise"in a?a.usePromise:"undefined"!=typeof Promise;return f?e.wrapLoader(function(a){return b.promisify(c,a)}):e.wrapLoader(c)},b.useDocumentLoader=function(a){if(!(a in b.documentLoaders))throw new Ga('Unknown document loader type: "'+a+'"',"jsonld.UnknownDocumentLoader",{type:a});b.documentLoader=b.documentLoaders[a].apply(b,Array.prototype.slice.call(arguments,1))},b.processContext=function(a,c){var d={},e=2;arguments.length>3&&(d=arguments[2]||{},e+=1);var f=arguments[e];return"base"in d||(d.base=""),"documentLoader"in d||(d.documentLoader=b.loadDocument),null===c?f(null,K(d)):(c=aa(c),M(c)&&"@context"in c||(c={"@context":c}),void ca(c,d,function(b,c){if(b)return f(b);try{c=(new Ha).processContext(a,c,d)}catch(e){return f(e)}f(null,c)}))},b.hasProperty=function(a,b){var c=!1;if(b in a){var d=a[b];c=!O(d)||d.length>0}return c},b.hasValue=function(a,c,d){var e=!1;if(b.hasProperty(a,c)){var f=a[c],g=Z(f);if(O(f)||g){g&&(f=f["@list"]);for(var h=0;h<f.length;++h)if(b.compareValues(d,f[h])){e=!0;break}}else O(d)||(e=b.compareValues(d,f))}return e},b.addValue=function(a,c,d,e){if(e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1),"allowDuplicate"in e||(e.allowDuplicate=!0),O(d)){0!==d.length||!e.propertyIsArray||c in a||(a[c]=[]);for(var f=0;f<d.length;++f)b.addValue(a,c,d[f],e)}else if(c in a){var g=!e.allowDuplicate&&b.hasValue(a,c,d);O(a[c])||g&&!e.propertyIsArray||(a[c]=[a[c]]),g||a[c].push(d)}else a[c]=e.propertyIsArray?[d]:d},b.getValues=function(a,b){var c=a[b]||[];return O(c)||(c=[c]),c},b.removeProperty=function(a,b){delete a[b]},b.removeValue=function(a,c,d,e){e=e||{},"propertyIsArray"in e||(e.propertyIsArray=!1);var f=b.getValues(a,c).filter(function(a){return!b.compareValues(a,d)});0===f.length?b.removeProperty(a,c):1!==f.length||e.propertyIsArray?a[c]=f:a[c]=f[0]},b.compareValues=function(a,b){return a===b?!0:Y(a)&&Y(b)&&a["@value"]===b["@value"]&&a["@type"]===b["@type"]&&a["@language"]===b["@language"]&&a["@index"]===b["@index"]?!0:M(a)&&"@id"in a&&M(b)&&"@id"in b?a["@id"]===b["@id"]:!1},b.getContextValue=function(a,b,c){var d=null;if(null===b)return d;if("@language"===c&&c in a&&(d=a[c]),a.mappings[b]){var e=a.mappings[b];V(c)?d=e:c in e&&(d=e[c])}return d};var na={};if(b.registerRDFParser=function(a,b){na[a]=b},b.unregisterRDFParser=function(a){delete na[a]},f){if("undefined"==typeof oa)var oa=null;if("undefined"==typeof pa)var pa={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var qa="http://www.w3.org/2001/XMLSchema#boolean",ra="http://www.w3.org/2001/XMLSchema#double",sa="http://www.w3.org/2001/XMLSchema#integer",ta="http://www.w3.org/2001/XMLSchema#string",ua="http://www.w3.org/1999/02/22-rdf-syntax-ns#",va=ua+"List",wa=ua+"first",xa=ua+"rest",ya=ua+"nil",za=ua+"type",Aa=ua+"PlainLiteral",Ba=ua+"XMLLiteral",Ca=ua+"object",Da=ua+"langString",Ea="http://www.w3.org/ns/json-ld#context",Fa=10,Ga=function(a,b,c){f?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=b||"jsonld.Error",this.message=a||"An unspecified JSON-LD error occurred.",this.details=c||{}};f?a("util").inherits(Ga,Error):"undefined"!=typeof Error&&(Ga.prototype=new Error);var Ha=function(){};Ha.prototype.compact=function(a,c,d,e){if(O(d)){for(var f=[],g=0;g<d.length;++g){var h=this.compact(a,c,d[g],e);null!==h&&f.push(h)}if(e.compactArrays&&1===f.length){var i=b.getContextValue(a,c,"@container");null===i&&(f=f[0])}return f}if(M(d)){if(e.link&&"@id"in d&&d["@id"]in e.link)for(var j=e.link[d["@id"]],g=0;g<j.length;++g)if(j[g].expanded===d)return j[g].compacted;if(Y(d)||X(d)){var f=F(a,c,d);return e.link&&X(d)&&(d["@id"]in e.link||(e.link[d["@id"]]=[]),e.link[d["@id"]].push({expanded:d,compacted:f})),f}var k="@reverse"===c,f={};e.link&&"@id"in d&&(d["@id"]in e.link||(e.link[d["@id"]]=[]),e.link[d["@id"]].push({expanded:d,compacted:f}));for(var l=Object.keys(d).sort(),m=0;m<l.length;++m){var n=l[m],o=d[n];if("@id"!==n&&"@type"!==n)if("@reverse"!==n)if("@index"!==n)if("@graph"!==n&&"@list"!==n&&L(n)){var p=E(a,n);b.addValue(f,p,o)}else{if(0===o.length){var q=E(a,n,o,{vocab:!0},k);b.addValue(f,q,o,{propertyIsArray:!0})}for(var r=0;r<o.length;++r){var s=o[r],q=E(a,n,s,{vocab:!0},k),i=b.getContextValue(a,q,"@container"),t=Z(s),u=null;t&&(u=s["@list"]);var v=this.compact(a,q,t?u:s,e);if(t)if(O(v)||(v=[v]),"@list"!==i){var w={};w[E(a,"@list")]=v,v=w,"@index"in s&&(v[E(a,"@index")]=s["@index"])}else if(q in f)throw new Ga('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===i||"@index"===i){var x;q in f?x=f[q]:f[q]=x={},"@language"===i&&Y(v)&&(v=v["@value"]),b.addValue(x,s[i],v)}else{var y=!e.compactArrays||"@set"===i||"@list"===i||O(v)&&0===v.length||"@list"===n||"@graph"===n;b.addValue(f,q,v,{propertyIsArray:y})}}}else{var i=b.getContextValue(a,c,"@container");if("@index"===i)continue;var p=E(a,n);b.addValue(f,p,o)}else{var z=this.compact(a,"@reverse",o,e);for(var A in z)if(a.mappings[A]&&a.mappings[A].reverse){var B=z[A],i=b.getContextValue(a,A,"@container"),C="@set"===i||!e.compactArrays;b.addValue(f,A,B,{propertyIsArray:C}),delete z[A]}if(Object.keys(z).length>0){var p=E(a,n);b.addValue(f,p,z)}}else{var z;if(Q(o))z=E(a,o,null,{vocab:"@type"===n});else{z=[];for(var r=0;r<o.length;++r)z.push(E(a,o[r],null,{vocab:!0}))}var p=E(a,n),y=O(z)&&0===o.length;b.addValue(f,p,z,{propertyIsArray:y})}}return f}return d},Ha.prototype.expand=function(a,c,d,e,f){var g=this;if(null===d||void 0===d)return null;if(!O(d)&&!M(d))return f||null!==c&&"@graph"!==H(a,c,{vocab:!0})?k(a,c,d):null;if(O(d)){var h=[],j=b.getContextValue(a,c,"@container");f=f||"@list"===j;for(var l=0;l<d.length;++l){var m=g.expand(a,c,d[l],e);if(f&&(O(m)||Z(m)))throw new Ga("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==m&&(O(m)?h=h.concat(m):h.push(m))}return h}"@context"in d&&(a=g.processContext(a,d["@context"],e));for(var n=H(a,c,{vocab:!0}),h={},o=Object.keys(d).sort(),p=0;p<o.length;++p){var q,r=o[p],s=d[r];if("@context"!==r){var t=H(a,r,{vocab:!0});if(null!==t&&(_(t)||L(t))){if(L(t)){if("@reverse"===n)throw new Ga("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:s});if(t in h)throw new Ga("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:t})}if("@id"===t&&!Q(s)){if(!e.isFrame)throw new Ga('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:s});if(!M(s))throw new Ga('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:s})}if("@type"===t&&P(s),"@graph"===t&&!M(s)&&!O(s))throw new Ga('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:s});if("@value"===t&&(M(s)||O(s)))throw new Ga('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:s});if("@language"===t){if(null===s)continue;if(!Q(s))throw new Ga('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:s});s=s.toLowerCase()}if("@index"===t&&!Q(s))throw new Ga('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:s});if("@reverse"!==t){var j=b.getContextValue(a,r,"@container");if("@language"===j&&M(s))q=i(s);else if("@index"===j&&M(s))q=function(b){for(var c=[],d=Object.keys(s).sort(),f=0;f<d.length;++f){var h=d[f],i=s[h];O(i)||(i=[i]),i=g.expand(a,b,i,e,!1);for(var j=0;j<i.length;++j){var k=i[j];"@index"in k||(k["@index"]=h),c.push(k)}}return c}(r);else{var u="@list"===t;if(u||"@set"===t){var v=c;if(u&&"@graph"===n&&(v=null),q=g.expand(a,v,s,e,u),u&&Z(q))throw new Ga("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else q=g.expand(a,r,s,e,!1)}if(null!==q||"@value"===t)if("@list"===t||Z(q)||"@list"!==j||(q=O(q)?q:[q],q={"@list":q}),a.mappings[r]&&a.mappings[r].reverse){var w=h["@reverse"]=h["@reverse"]||{};O(q)||(q=[q]);for(var x=0;x<q.length;++x){var y=q[x];if(Y(y)||Z(y))throw new Ga('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});b.addValue(w,t,y,{propertyIsArray:!0})}}else{var z=-1===["@index","@id","@type","@value","@language"].indexOf(t);b.addValue(h,t,q,{propertyIsArray:z})}}else{if(!M(s))throw new Ga('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:s});if(q=g.expand(a,"@reverse",s,e),"@reverse"in q)for(var A in q["@reverse"])b.addValue(h,A,q["@reverse"][A],{propertyIsArray:!0});var w=h["@reverse"]||null;for(var A in q)if("@reverse"!==A){null===w&&(w=h["@reverse"]={}),b.addValue(w,A,[],{propertyIsArray:!0});for(var B=q[A],x=0;x<B.length;++x){var y=B[x];if(Y(y)||Z(y))throw new Ga('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:q});b.addValue(w,A,y,{propertyIsArray:!0})}}}}}}o=Object.keys(h);var C=o.length;if("@value"in h){if("@type"in h&&"@language"in h)throw new Ga('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:h});var D=C-1;if("@type"in h&&(D-=1),"@index"in h&&(D-=1),"@language"in h&&(D-=1),0!==D)throw new Ga('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:h});if(null===h["@value"])h=null;else{if("@language"in h&&!Q(h["@value"]))throw new Ga("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:h});if("@type"in h&&(!_(h["@type"])||0===h["@type"].indexOf("_:")))throw new Ga('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:h})}}else if("@type"in h&&!O(h["@type"]))h["@type"]=[h["@type"]];else if("@set"in h||"@list"in h){if(C>1&&!(2===C&&"@index"in h))throw new Ga('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:h});"@set"in h&&(h=h["@set"],o=Object.keys(h),C=o.length)}else 1===C&&"@language"in h&&(h=null);return!M(h)||e.keepFreeFloatingNodes||f||null!==c&&"@graph"!==n||(0===C||"@value"in h||"@list"in h||1===C&&"@id"in h)&&(h=null),h},Ha.prototype.createNodeMap=function(a,b){b=b||{};var c=b.namer||b.issuer||new ha("_:b"),d={"@default":{}};return q(a,d,"@default",c),r(d)},Ha.prototype.flatten=function(a){for(var b=this.createNodeMap(a),c=[],d=Object.keys(b).sort(),e=0;e<d.length;++e){var f=b[d[e]];X(f)||c.push(f)}return c},Ha.prototype.frame=function(a,b,c){var d={options:c,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},e=new ha("_:b");q(a,d.graphs,"@merged",e),d.subjects=d.graphs["@merged"];var f=[];return s(d,Object.keys(d.subjects).sort(),b,f,null),f},Ha.prototype.normalize=function(a,b,c){return"URDNA2015"===b.algorithm?new Ia(b).main(a,c):"URGNA2012"===b.algorithm?new Ja(b).main(a,c):void c(new Error("Invalid RDF Dataset Normalization algorithm: "+b.algorithm))},Ha.prototype.fromRDF=function(a,c,d){var e={},f={"@default":e},g={};for(var h in a){var i=a[h];h in f||(f[h]={}),"@default"===h||h in e||(e[h]={"@id":h});for(var j=f[h],k=0;k<i.length;++k){var l=i[k],m=l.subject.value,n=l.predicate.value,p=l.object;m in j||(j[m]={"@id":m});var q=j[m],r="IRI"===p.type||"blank node"===p.type;if(!r||p.value in j||(j[p.value]={"@id":p.value}),n!==za||c.useRdfType||!r){var s=o(p,c.useNativeTypes);if(b.addValue(q,n,s,{propertyIsArray:!0}),r)if(p.value===ya){var t=j[p.value];"usages"in t||(t.usages=[]),t.usages.push({node:q,property:n,value:s})}else p.value in g?g[p.value]=!1:g[p.value]={node:q,property:n,value:s}}else b.addValue(q,"@type",p.value,{propertyIsArray:!0})}}for(var h in f){var u=f[h];if(ya in u){for(var v=u[ya],w=0;w<v.usages.length;++w){for(var x=v.usages[w],q=x.node,y=x.property,z=x.value,A=[],B=[],C=Object.keys(q).length;y===xa&&M(g[q["@id"]])&&O(q[wa])&&1===q[wa].length&&O(q[xa])&&1===q[xa].length&&(3===C||4===C&&O(q["@type"])&&1===q["@type"].length&&q["@type"][0]===va)&&(A.push(q[wa][0]),B.push(q["@id"]),x=g[q["@id"]],q=x.node,y=x.property,z=x.value,C=Object.keys(q).length,0===q["@id"].indexOf("_:")););if(y===wa){if(q["@id"]===ya)continue;z=u[z["@id"]][xa][0],A.pop(),B.pop()}delete z["@id"],z["@list"]=A.reverse();for(var D=0;D<B.length;++D)delete u[B[D]]}delete v.usages}}for(var E=[],F=Object.keys(e).sort(),w=0;w<F.length;++w){var G=F[w],q=e[G];if(G in f)for(var i=q["@graph"]=[],u=f[G],H=Object.keys(u).sort(),I=0;I<H.length;++I){var J=u[H[I]];X(J)||i.push(J)}X(q)||E.push(q)}d(null,E)},Ha.prototype.toRDF=function(a,b){var c=new ha("_:b"),d={"@default":{}};q(a,d,"@default",c);for(var e={},f=Object.keys(d).sort(),g=0;g<f.length;++g){var h=f[g];("@default"===h||_(h))&&(e[h]=l(d[h],c,b))}return e},Ha.prototype.processContext=function(a,c,d){M(c)&&"@context"in c&&O(c["@context"])&&(c=c["@context"]);var e=O(c)?c:[c];if(0===e.length)return a.clone();for(var f=a,g=0;g<e.length;++g){var h=e[g];if(null!==h){if(M(h)&&"@context"in h&&(h=h["@context"]),!M(h))throw new Ga("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:h});if(b.cache.activeCtx){var i=b.cache.activeCtx.get(a,h);if(i){f=a=i;continue}}a=f,f=f.clone();var j={};if("@base"in h){var k=h["@base"];if(null===k)k=null;else{if(!Q(k))throw new Ga('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h});if(""!==k&&!_(k))throw new Ga('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h})}null!==k&&(k=b.url.parse(k||"")),f["@base"]=k,j["@base"]=!0}if("@vocab"in h){var l=h["@vocab"];if(null===l)delete f["@vocab"];else{if(!Q(l))throw new Ga('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});if(!_(l))throw new Ga('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});f["@vocab"]=l}j["@vocab"]=!0}if("@language"in h){var l=h["@language"];if(null===l)delete f["@language"];else{if(!Q(l))throw new Ga('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:h});f["@language"]=l.toLowerCase()}j["@language"]=!0}for(var m in h)G(f,h,m,j);b.cache.activeCtx&&b.cache.activeCtx.set(a,h,f)}else f=a=K(d)}return f};var Ia=function(){var a={subject:"s",object:"o",name:"g"},c=function(a){a=a||{},this.name="URDNA2015",this.options=a,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new ha("_:c14n"),this.quads=[],this.schedule={},"maxCallStackDepth"in a?this.schedule.MAX_DEPTH=a.maxCallStackDepth:this.schedule.MAX_DEPTH=500,"maxTotalCallStackDepth"in a?this.schedule.MAX_TOTAL_DEPTH=a.maxCallStackDepth:this.schedule.MAX_TOTAL_DEPTH=4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,"timeSlice"in a?this.schedule.timeSlice=a.timeSlice:this.schedule.timeSlice=10};return c.prototype.doWork=function(a,c){var d=this.schedule;return d.totalDepth>=d.MAX_TOTAL_DEPTH?c(new Error("Maximum total call stack depth exceeded; normalization aborting.")):void function e(){if(d.depth===d.MAX_DEPTH)return d.depth=0,d.running=!1,b.nextTick(e);var f=(new Date).getTime();return d.running||(d.start=(new Date).getTime(),d.deadline=d.start+d.timeSlice),f<d.deadline?(d.running=!0,d.depth++,d.totalDepth++,a(function(a,b){d.depth--,d.totalDepth--,c(a,b)})):(d.depth=0,d.running=!1,void b.setImmediate(e))}()},c.prototype.forEach=function(a,b,c){var d,e,f=this,g=0;if(O(a))e=a.length,d=function(){return g===e?!1:(d.value=a[g++],d.key=g,!0)};else{var h=Object.keys(a);e=h.length,d=function(){return g===e?!1:(d.key=h[g++],d.value=a[d.key],!0)}}!function i(a,e){return a?c(a):d()?f.doWork(function(){b(d.value,d.key,i)}):void c()}()},c.prototype.waterfall=function(a,b){var c=this;c.forEach(a,function(a,b,d){c.doWork(a,d)},b)},c.prototype.whilst=function(a,b,c){
var d=this;!function e(f){return f?c(f):a()?void d.doWork(b,e):c()}()},c.prototype.main=function(a,b){var c=this;c.schedule.start=(new Date).getTime();var d;if(c.options.format&&"application/nquads"!==c.options.format)return b(new Ga("Unknown output format.","jsonld.UnknownFormat",{format:c.options.format}));var e={};c.waterfall([function(b){c.forEach(a,function(a,b,d){"@default"===b&&(b=null),c.forEach(a,function(a,d,f){null!==b&&(0===b.indexOf("_:")?a.name={type:"blank node",value:b}:a.name={type:"IRI",value:b}),c.quads.push(a),c.forEachComponent(a,function(b){if("blank node"===b.type){var d=b.value;d in c.blankNodeInfo?c.blankNodeInfo[d].quads.push(a):(e[d]=!0,c.blankNodeInfo[d]={quads:[a]})}}),f()},d)},b)},function(a){var b=!0;c.whilst(function(){return b},function(a){b=!1,c.hashToBlankNodes={},c.waterfall([function(a){c.forEach(e,function(a,b,d){c.hashFirstDegreeQuads(b,function(a,e){return a?d(a):(e in c.hashToBlankNodes?c.hashToBlankNodes[e].push(b):c.hashToBlankNodes[e]=[b],void d())})},a)},function(a){var d=Object.keys(c.hashToBlankNodes).sort();c.forEach(d,function(a,d,f){var g=c.hashToBlankNodes[a];if(g.length>1)return f();var h=g[0];c.canonicalIssuer.getId(h),delete e[h],delete c.hashToBlankNodes[a],b=!0,f()},a)}],a)},a)},function(a){var b=Object.keys(c.hashToBlankNodes).sort();c.forEach(b,function(a,b,d){var e=[],f=c.hashToBlankNodes[a];c.waterfall([function(a){c.forEach(f,function(a,b,d){if(c.canonicalIssuer.hasId(a))return d();var f=new ha("_:b");f.getId(a),c.hashNDegreeQuads(a,f,function(a,b){return a?d(a):(e.push(b),void d())})},a)},function(a){e.sort(function(a,b){return a.hash<b.hash?-1:a.hash>b.hash?1:0}),c.forEach(e,function(a,b,d){for(var e in a.issuer.existing)c.canonicalIssuer.getId(e);d()},a)}],d)},a)},function(a){var b=[];c.waterfall([function(a){c.forEach(c.quads,function(a,d,e){c.forEachComponent(a,function(a){"blank node"===a.type&&0!==a.value.indexOf(c.canonicalIssuer.prefix)&&(a.value=c.canonicalIssuer.getId(a.value))}),b.push(fa(a)),e()},a)},function(a){return b.sort(),"application/nquads"===c.options.format?(d=b.join(""),a()):(d=da(b.join("")),void a())}],a)}],function(a){b(a,d)})},c.prototype.hashFirstDegreeQuads=function(a,b){var c=this,d=c.blankNodeInfo[a];if("hash"in d)return b(null,d.hash);var e=[],f=d.quads;c.forEach(f,function(b,d,f){var g={predicate:b.predicate};c.forEachComponent(b,function(b,d){g[d]=c.modifyFirstDegreeComponent(a,b,d)}),e.push(fa(g)),f()},function(a){return a?b(a):(e.sort(),d.hash=La.hashNQuads(c.name,e),void b(null,d.hash))})},c.prototype.modifyFirstDegreeComponent=function(a,b){return"blank node"!==b.type?b:(b=aa(b),b.value=b.value===a?"_:a":"_:z",b)},c.prototype.hashRelatedBlankNode=function(a,b,c,d,e){var f,g=this;g.waterfall([function(b){return g.canonicalIssuer.hasId(a)?(f=g.canonicalIssuer.getId(a),b()):c.hasId(a)?(f=c.getId(a),b()):void g.hashFirstDegreeQuads(a,function(a,c){return a?b(a):(f=c,void b())})}],function(a){if(a)return e(a);var c=new La(g.name);return c.update(d),"g"!==d&&c.update(g.getRelatedPredicate(b)),c.update(f),e(null,c.digest())})},c.prototype.getRelatedPredicate=function(a){return"<"+a.predicate.value+">"},c.prototype.hashNDegreeQuads=function(a,b,c){var d,e=this,f=new La(e.name);e.waterfall([function(c){e.createHashToRelated(a,b,function(a,b){return a?c(a):(d=b,void c())})},function(a){var c=Object.keys(d).sort();e.forEach(c,function(a,c,g){f.update(a);var h,i="",j=new Ka(d[a]);e.whilst(function(){return j.hasNext()},function(a){var c=j.next(),d=b.clone(),f="",g=[];e.waterfall([function(b){e.forEach(c,function(b,c,h){return e.canonicalIssuer.hasId(b)?f+=e.canonicalIssuer.getId(b):(d.hasId(b)||g.push(b),f+=d.getId(b)),0!==i.length&&f.length>=i.length&&f>i?a():void h()},b)},function(b){e.forEach(g,function(b,c,g){e.hashNDegreeQuads(b,d,function(c,e){return c?g(c):(f+=d.getId(b),f+="<"+e.hash+">",d=e.issuer,0!==i.length&&f.length>=i.length&&f>i?a():void g())})},b)},function(a){(0===i.length||i>f)&&(i=f,h=d),a()}],a)},function(a){return a?g(a):(f.update(i),b=h,void g())})},a)}],function(a){c(a,{hash:f.digest(),issuer:b})})},c.prototype.createHashToRelated=function(b,c,d){var e=this,f={},g=e.blankNodeInfo[b].quads;e.forEach(g,function(d,g,h){e.forEach(d,function(g,h,i){if("predicate"===h||"blank node"!==g.type||g.value===b)return i();var j=g.value,k=a[h];e.hashRelatedBlankNode(j,d,c,k,function(a,b){return a?i(a):(b in f?f[b].push(j):f[b]=[j],void i())})},h)},function(a){d(a,f)})},c.prototype.forEachComponent=function(a,b){for(var c in a)"predicate"!==c&&b(a[c],c,a)},c}(),Ja=function(){var a=function(a){Ia.call(this,a),this.name="URGNA2012"};return a.prototype=new Ia,a.prototype.modifyFirstDegreeComponent=function(a,b,c){return"blank node"!==b.type?b:(b=aa(b),"name"===c?b.value="_:g":b.value=b.value===a?"_:a":"_:z",b)},a.prototype.getRelatedPredicate=function(a){return a.predicate.value},a.prototype.createHashToRelated=function(a,b,c){var d=this,e={},f=d.blankNodeInfo[a].quads;d.forEach(f,function(c,f,g){var h,i;if("blank node"===c.subject.type&&c.subject.value!==a)i=c.subject.value,h="p";else{if("blank node"!==c.object.type||c.object.value===a)return g();i=c.object.value,h="r"}d.hashRelatedBlankNode(i,c,b,h,function(a,b){b in e?e[b].push(i):e[b]=[i],g()})},function(a){c(a,e)})},a}();Object.keys||(Object.keys=function(a){if(a!==Object(a))throw new TypeError("Object.keys called on non-object");var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),b.registerRDFParser("application/nquads",da),b.registerRDFParser("rdfa-api",ga),b.IdentifierIssuer=ha,b.UniqueNamer=ha,ha.prototype.clone=function(){var a=new ha(this.prefix);return a.counter=this.counter,a.existing=aa(this.existing),a},ha.prototype.getId=function(a){if(a&&a in this.existing)return this.existing[a];var b=this.prefix+this.counter;return this.counter+=1,a&&(this.existing[a]=b),b},ha.prototype.getName=ha.prototype.getName,ha.prototype.hasId=function(a){return a in this.existing},ha.prototype.isNamed=ha.prototype.hasId;var Ka=function(a){this.list=a.sort(),this.done=!1,this.left={};for(var b=0;b<a.length;++b)this.left[a[b]]=!0};Ka.prototype.hasNext=function(){return!this.done},Ka.prototype.next=function(){for(var a=this.list.slice(),b=null,c=0,d=this.list.length,e=0;d>e;++e){var f=this.list[e],g=this.left[f];(null===b||f>b)&&(g&&e>0&&f>this.list[e-1]||!g&&d-1>e&&f>this.list[e+1])&&(b=f,c=e)}if(null===b)this.done=!0;else{var h=this.left[b]?c-1:c+1;this.list[c]=this.list[h],this.list[h]=b;for(var e=0;d>e;++e)this.list[e]>b&&(this.left[this.list[e]]=!this.left[this.list[e]])}return a};var La=function(a){if(!(this instanceof La))return new La(a);if(-1===["URDNA2015","URGNA2012"].indexOf(a))throw new Error("Invalid RDF Dataset Normalization algorithm: "+a);La._init.call(this,a)};if(La.hashNQuads=function(a,b){for(var c=new La(a),d=0;d<b.length;++d)c.update(b[d]);return c.digest()},function(b){if(b){var c=a("crypto");return La._init=function(a){a="URDNA2015"===a?"sha256":"sha1",this.md=c.createHash(a)},La.prototype.update=function(a){return this.md.update(a,"utf8")},void(La.prototype.digest=function(){return this.md.digest("hex")})}La._init=function(a){a="URDNA2015"===a?new f.Algorithm:new e.Algorithm,this.md=new d(a)},La.prototype.update=function(a){return this.md.update(a)},La.prototype.digest=function(){return this.md.digest().toHex()};var d=function(a){if(!(this instanceof d))return new d(a);if(this._algorithm=a,!d._padding||d._padding.length<this._algorithm.blockSize){d._padding=String.fromCharCode(128);for(var b=String.fromCharCode(0),c=64;c>0;)1&c&&(d._padding+=b),c>>>=1,c>0&&(b+=b)}this.start()};d.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var a=this._algorithm.messageLengthSize/4,b=0;a>b;++b)this.fullMessageLength.push(0);return this._input=new d.ByteBuffer,this.state=this._algorithm.start(),this},d.prototype.update=function(a){a=new d.ByteBuffer(unescape(encodeURIComponent(a))),this.messageLength+=a.length();var b=a.length();b=[b/4294967296>>>0,b>>>0];for(var c=this.fullMessageLength.length-1;c>=0;--c)this.fullMessageLength[c]+=b[1],b[1]=b[0]+(this.fullMessageLength[c]/4294967296>>>0),this.fullMessageLength[c]=this.fullMessageLength[c]>>>0,b[0]=b[1]/4294967296>>>0;for(this._input.putBytes(a.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(this._input.read>2048||0===this._input.length())&&this._input.compact(),this},d.prototype.digest=function(){var a=new d.ByteBuffer;a.putBytes(this._input.bytes());var b=this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize,c=b&this._algorithm.blockSize-1;a.putBytes(d._padding.substr(0,this._algorithm.blockSize-c));for(var e=new d.ByteBuffer,f=0;f<this.fullMessageLength.length;++f)e.putInt32(this.fullMessageLength[f]<<3|this.fullMessageLength[f+1]>>>28);this._algorithm.writeMessageLength(a,e);var g=this._algorithm.digest(this.state.copy(),a),h=new d.ByteBuffer;return g.write(h),h},d.ByteBuffer=function(a){"string"==typeof a?this.data=a:this.data="",this.read=0},d.ByteBuffer.prototype.putInt32=function(a){this.data+=String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(255&a)},d.ByteBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,a},d.ByteBuffer.prototype.putBytes=function(a){this.data+=a},d.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},d.ByteBuffer.prototype.length=function(){return this.data.length-this.read},d.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},d.ByteBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var c=this.data.charCodeAt(b);16>c&&(a+="0"),a+=c.toString(16)}return a};var e={_w:null};e.Algorithm=function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8},e.Algorithm.prototype.start=function(){return e._w||(e._w=new Array(80)),e._createState()},e.Algorithm.prototype.writeMessageLength=function(a,b){a.putBytes(b.bytes())},e.Algorithm.prototype.digest=function(a,b){for(var c,d,f,g,h,i,j,k,l=b.length(),m=e._w;l>=64;){for(d=a.h0,f=a.h1,g=a.h2,h=a.h3,i=a.h4,k=0;16>k;++k)c=b.getInt32(),m[k]=c,j=h^f&(g^h),c=(d<<5|d>>>27)+j+i+1518500249+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;20>k;++k)c=m[k-3]^m[k-8]^m[k-14]^m[k-16],c=c<<1|c>>>31,m[k]=c,j=h^f&(g^h),c=(d<<5|d>>>27)+j+i+1518500249+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;32>k;++k)c=m[k-3]^m[k-8]^m[k-14]^m[k-16],c=c<<1|c>>>31,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+1859775393+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;40>k;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+1859775393+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;60>k;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f&g|h&(f^g),c=(d<<5|d>>>27)+j+i+2400959708+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;for(;80>k;++k)c=m[k-6]^m[k-16]^m[k-28]^m[k-32],c=c<<2|c>>>30,m[k]=c,j=f^g^h,c=(d<<5|d>>>27)+j+i+3395469782+c,i=h,h=g,g=f<<30|f>>>2,f=d,d=c;a.h0=a.h0+d|0,a.h1=a.h1+f|0,a.h2=a.h2+g|0,a.h3=a.h3+h|0,a.h4=a.h4+i|0,l-=64}return a},e._createState=function(){var a={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return a.copy=function(){var b=e._createState();return b.h0=a.h0,b.h1=a.h1,b.h2=a.h2,b.h3=a.h3,b.h4=a.h4,b},a.write=function(b){b.putInt32(a.h0),b.putInt32(a.h1),b.putInt32(a.h2),b.putInt32(a.h3),b.putInt32(a.h4)},a};var f={_k:null,_w:null};f.Algorithm=function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8},f.Algorithm.prototype.start=function(){return f._k||f._init(),f._createState()},f.Algorithm.prototype.writeMessageLength=function(a,b){a.putBytes(b.bytes())},f.Algorithm.prototype.digest=function(a,b){for(var c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s=b.length(),t=f._k,u=f._w;s>=64;){for(j=0;16>j;++j)u[j]=b.getInt32();for(;64>j;++j)c=u[j-2],c=(c>>>17|c<<15)^(c>>>19|c<<13)^c>>>10,d=u[j-15],d=(d>>>7|d<<25)^(d>>>18|d<<14)^d>>>3,u[j]=c+u[j-7]+d+u[j-16]|0;for(k=a.h0,l=a.h1,m=a.h2,n=a.h3,o=a.h4,p=a.h5,q=a.h6,r=a.h7,j=0;64>j;++j)g=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7),h=q^o&(p^q),e=(k>>>2|k<<30)^(k>>>13|k<<19)^(k>>>22|k<<10),i=k&l|m&(k^l),c=r+g+h+t[j]+u[j],d=e+i,r=q,q=p,p=o,o=n+c|0,n=m,m=l,l=k,k=c+d|0;a.h0=a.h0+k|0,a.h1=a.h1+l|0,a.h2=a.h2+m|0,a.h3=a.h3+n|0,a.h4=a.h4+o|0,a.h5=a.h5+p|0,a.h6=a.h6+q|0,a.h7=a.h7+r|0,s-=64}return a},f._createState=function(){var a={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225};return a.copy=function(){var b=f._createState();return b.h0=a.h0,b.h1=a.h1,b.h2=a.h2,b.h3=a.h3,b.h4=a.h4,b.h5=a.h5,b.h6=a.h6,b.h7=a.h7,b},a.write=function(b){b.putInt32(a.h0),b.putInt32(a.h1),b.putInt32(a.h2),b.putInt32(a.h3),b.putInt32(a.h4),b.putInt32(a.h5),b.putInt32(a.h6),b.putInt32(a.h7)},a},f._init=function(){f._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f._w=new Array(64)}}(f),!oa)var Ma=function(){oa=a("xmldom").XMLSerializer};if(b.url={},b.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},b.url.parse=function(a,c){for(var d={},e=b.url.parsers[c||"full"],f=e.regex.exec(a),g=e.keys.length;g--;)d[e.keys[g]]=void 0===f[g]?null:f[g];return d.normalizedPath=ia(d.path,!!d.authority),d},f?b.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&b.useDocumentLoader("xhr"),f){b.use=function(c){switch(c){case"request":b.request=a("jsonld-request");break;default:throw new Ga("Unknown extension.","jsonld.UnknownExtension",{extension:c})}};var Na={exports:{},filename:e};a("pkginfo")(Na,"version"),b.version=Na.exports.version}return b},i=function(){return h(function(){return i()})};return!f&&"function"==typeof define&&define.amd?define([],function(){return h(i),i}):(h(i),"function"==typeof a&&"undefined"!=typeof b&&b.exports&&(b.exports=i),g&&("undefined"==typeof jsonld?jsonld=jsonldjs=i:jsonldjs=i)),i}()}).call(this,a("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/../node_modules/jsonld/js")},{"7YKIPe":10,crypto:25,"es6-promise":3,http:25,"jsonld-request":25,pkginfo:25,request:25,util:25,xmldom:25}],27:[function(a,b,c){var d=a;a=function(){};var c=b.exports={Lexer:a("./lib/N3Lexer"),Parser:a("./lib/N3Parser"),Writer:a("./lib/N3Writer"),Store:a("./lib/N3Store"),StreamParser:a("./lib/N3StreamParser"),StreamWriter:a("./lib/N3StreamWriter"),Util:a("./lib/N3Util")};Object.keys(c).forEach(function(a){Object.defineProperty(c,a,{configurable:!0,enumerable:!0,get:function(){return delete c[a],c[a]=d("./lib/N3"+a)}})})},{"./lib/N3Lexer":28,"./lib/N3Parser":29,"./lib/N3Store":30,"./lib/N3StreamParser":31,"./lib/N3StreamWriter":32,"./lib/N3Util":33,"./lib/N3Writer":34}],28:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);if(a=a||{},a.lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var b=this;this._tokenize=this.tokenize,this.tokenize=function(a,c){this._tokenize(a,function(a,d){!a&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(d.type)?c&&c(a,d):c&&c(a||b._syntaxError(d.type,c=null))})}}this._n3Mode=a.n3!==!1,this._comments=!!a.comments}var e=String.fromCharCode,f="function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)},g=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,h={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},i=/[\x00-\x20<>\\"\{\}\|\^\`]/;d.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(a,b){function c(b){a(b._syntaxError(/^\S*/.exec(d)[0]))}for(var d=this._input,e=this._comments;;){for(var f,g;f=this._newline.exec(d);)e&&(g=this._comment.exec(f[0]))&&a(null,{line:this._line,type:"comment",value:g[1],prefix:""}),d=d.substr(f[0].length,d.length),this._line++;if((f=this._whitespace.exec(d))&&(d=d.substr(f[0].length,d.length)),this._endOfFile.test(d))return b&&(e&&(g=this._comment.exec(d))&&a(null,{line:this._line,type:"comment",value:g[1],prefix:""}),a(d=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=d;var h,j=this._line,k="",l="",m="",n=d[0],o=null,p=0,q=!1;switch(n){case"^":if(d.length<3)break;if("^"!==d[1]){this._n3Mode&&(p=1,k="^");break}if(this._previousMarker="^^",d=d.substr(2),"<"!==d[0]){q=!0;break}case"<":if(o=this._unescapedIri.exec(d))k="IRI",l=o[1];else if(o=this._iri.exec(d)){if(h=this._unescape(o[1]),null===h||i.test(h))return c(this);k="IRI",l=h}else this._n3Mode&&d.length>1&&"="===d[1]&&(k="inverse",p=2,l="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((o=this._blank.exec(d))||b&&(o=this._blank.exec(d+" ")))&&(k="blank",m="_",l=o[1]);break;case'"':case"'":if(o=this._unescapedString.exec(d))k="literal",l=o[0];else if(o=this._singleQuotedString.exec(d)){if(h=this._unescape(o[0]),null===h)return c(this);k="literal",l=h.replace(/^'|'$/g,'"')}else if(o=this._tripleQuotedString.exec(d)){if(h=o[1]||o[2],this._line+=h.split(/\r\n|\r|\n/).length-1,h=this._unescape(h),null===h)return c(this);k="literal",l=h.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(o=this._variable.exec(d))&&(k="var",l=o[0]);break;case"@":"literal"===this._previousMarker&&(o=this._langcode.exec(d))?(k="langcode",l=o[1]):(o=this._keyword.exec(d))&&(k=o[0]);break;case".":if(1===d.length?b:d[1]<"0"||d[1]>"9"){k=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(o=this._number.exec(d)||b&&(o=this._number.exec(d+" ")))&&(k="literal",l='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(o[1]?"double":/^[+\-]?\d+$/.test(o[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(o=this._sparqlKeyword.exec(d))?k=o[0].toUpperCase():q=!0;break;case"f":case"t":(o=this._boolean.exec(d))?(k="literal",l='"'+o[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):q=!0;break;case"a":(o=this._shortPredicates.exec(d))?(k="abbreviation",l="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):q=!0;break;case"=":this._n3Mode&&d.length>1&&(k="abbreviation",">"!==d[1]?(p=1,l="http://www.w3.org/2002/07/owl#sameAs"):(p=2,l="http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":p=1,k=n;break;default:q=!0}if(q&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(o=this._prefix.exec(d))?((o=this._prefixed.exec(d))||b&&(o=this._prefixed.exec(d+" ")))&&(k="prefixed",m=o[1]||"",l=this._unescape(o[2])):(k="prefix",l=o[1]||"")),"^^"===this._previousMarker)switch(k){case"prefixed":k="type";break;case"IRI":k="typeIRI";break;default:k=""}if(!k)return b||!/^'''|^"""/.test(d)&&/\n|\r/.test(d)?c(this):this._input=d;var r={line:j,type:k,value:l,prefix:m};a(null,r),this.previousToken=r,this._previousMarker=k,d=d.substr(p||o[0].length,d.length)}},_unescape:function(a){try{return a.replace(g,function(a,b,c,d){var f;if(b){if(f=parseInt(b,16),isNaN(f))throw new Error;return e(f)}if(c){if(f=parseInt(c,16),isNaN(f))throw new Error;return 65535>=f?e(f):e(55296+(f-=65536)/1024,56320+(1023&f))}var g=h[d];if(!g)throw new Error;return g})}catch(b){return null}},_syntaxError:function(a){this._input=null;var b=new Error('Unexpected "'+a+'" on line '+this._line+".");return b.context={token:void 0,line:this._line,previousToken:this.previousToken},b},tokenize:function(a,b){var c=this;if(this._line=1,"string"==typeof a){if(this._input=a,"function"!=typeof b){var d,e=[];if(this._tokenizeToEnd(function(a,b){a?d=a:e.push(b)},!0),d)throw d;return e}f(function(){c._tokenizeToEnd(b,!0)})}else this._input="","function"==typeof a.setEncoding&&a.setEncoding("utf8"),a.on("data",function(a){null!==c._input&&(c._input+=a,c._tokenizeToEnd(b,!1))}),a.on("end",function(){null!==c._input&&c._tokenizeToEnd(b,!0)}),a.on("error",b)}},b.exports=d},{}],29:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);this._tripleStack=[],this._graph=null,a=a||{},this._setBase(a.documentIRI);var b="string"==typeof a.format&&a.format.match(/\w*$/)[0].toLowerCase(),c="turtle"===b,g="trig"===b,h=/triple/.test(b),i=/quad/.test(b),j=h||i;(this._supportsNamedGraphs=!c)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(c||g||h),j&&(this._base="",this._resolveIRI=function(a){return this._error("Disallowed relative IRI",a),this._callback=e,this._subject=null}),this._blankNodePrefix="string"!=typeof a.blankNodePrefix?"":"_:"+a.blankNodePrefix.replace(/^_:/,""),this._lexer=a.lexer||new f({lineMode:j})}function e(){}var f=a("./N3Lexer"),g="http://www.w3.org/1999/02/22-rdf-syntax-ns#",h=g+"nil",i=g+"first",j=g+"rest",k=/^[a-z][a-z0-9+.-]*:/i,l=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,m=/(?:^|\/)\.\.?(?:$|[\/#?])/,n=0,o=0;d._resetBlankNodeIds=function(){n=o=0},d.prototype={_setBase:function(a){if(a){if(a.indexOf("#")>=0)throw new Error("Invalid base IRI "+a)}else a=null;(this._base=a)&&(this._basePath=a.replace(/[^\/?]*(?:\?.*)?$/,""),a=a.match(l),this._baseRoot=a[0],this._baseScheme=a[1])},_readInTopContext:function(a){switch(a.type){case"eof":return null!==this._graph?this._error("Unclosed graph",a):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(a)}},_readSubject:function(a){switch(this._predicate=null,a.type){case"IRI":null===this._base||k.test(a.value)?this._subject=a.value:this._subject=this._resolveIRI(a);break;case"prefixed":var b=this._prefixes[a.prefix];if(void 0===b)return this._error('Undefined prefix "'+a.prefix+':"',a);this._subject=b+a.value;break;case"[":return this._subject="_:b"+o++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:h,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(a);default:return this._error("Expected subject but got "+a.type,a)}return this._readPredicateOrNamedGraph},_readPredicate:function(a){var b=a.type;switch(b){case"IRI":case"abbreviation":null===this._base||k.test(a.value)?this._predicate=a.value:this._predicate=this._resolveIRI(a);break;case"prefixed":if("_"===a.prefix)return this._error("Disallowed blank node as predicate",a);var c=this._prefixes[a.prefix];if(void 0===c)return this._error('Undefined prefix "'+a.prefix+':"',a);this._predicate=c+a.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+b,a):(this._subject=null,"]"===b?this._readBlankNodeTail(a):this._readPunctuation(a));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',a)}return this._readObject},_readObject:function(a){switch(a.type){case"IRI":null===this._base||k.test(a.value)?this._object=a.value:this._object=this._resolveIRI(a);break;case"prefixed":var b=this._prefixes[a.prefix];if(void 0===b)return this._error('Undefined prefix "'+a.prefix+':"',a);this._object=b+a.value;break;case"literal":return this._object=a.value,this._readDataTypeOrLang;case"[":var c="_:b"+o++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:c,type:"blank"}),this._subject=c,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:h,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',a)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(a){return"{"===a.type?this._readGraph(a):this._readPredicate(a)},_readGraph:function(a){return"{"!==a.type?this._error("Expected graph but got "+a.type,a):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(a){return"]"===a.type?(this._subject=null,this._readBlankNodeTail(a)):(this._predicate=null,this._readPredicate(a))},_readBlankNodeTail:function(a){if("]"!==a.type)return this._readBlankNodePunctuation(a);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var b=this._tripleStack.pop();return this._subject=b.subject,null!==b.object?(this._predicate=b.predicate,this._object=b.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(a){switch(a.type){case"type":var b;if(""===a.prefix)b=null===this._base||k.test(a.value)?a.value:this._resolveIRI(a);else{var c=this._prefixes[a.prefix];if(void 0===c)return this._error('Undefined prefix "'+a.prefix+':"',a);b=c+a.value}return this._object+="^^"+b,this._getTripleEndReader();case"langcode":return this._object+="@"+a.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,a)}},_readListItem:function(a){var b=null,c=null,d=this._subject,e=this._tripleStack,f=e[e.length-1],g=this._readListItem;switch(a.type){case"IRI":b=null===this._base||k.test(a.value)?a.value:this._resolveIRI(a);break;case"prefixed":var l=this._prefixes[a.prefix];if(void 0===l)return this._error('Undefined prefix "'+a.prefix+':"',a);b=l+a.value;break;case"literal":b=a.value,g=this._readDataTypeOrLang;break;case"[":c="_:b"+o++,b="_:b"+o++,e.push({subject:c,predicate:i,object:b,type:"blank"}),this._subject=b,g=this._readBlankNodeHead;break;case"(":c="_:b"+o++,e.push({subject:c,predicate:i,object:h,type:"list"}),this._subject=null,g=this._readListItem;break;case")":if(e.pop(),0!==e.length&&"list"===e[e.length-1].type&&this._callback(null,{subject:f.subject,predicate:f.predicate,object:f.object,graph:this._graph||""}),this._subject=f.subject,null===f.predicate){if(g=this._readPredicate,f.subject===h)return g}else if(this._predicate=f.predicate,this._object=f.object,g=this._getTripleEndReader(),f.object===h)return g;c=h;break;default:return this._error('Expected list item instead of "'+a.type+'"',a)}return null===c&&(this._subject=c="_:b"+o++),null===d?f.object===h?f.object=c:f.subject=c:this._callback(null,{subject:d,predicate:j,object:c,graph:this._graph||""}),null!==b&&this._callback(null,{subject:c,predicate:i,object:b,graph:this._graph||""}),g},_readPunctuation:function(a){var b,c=this._subject,d=this._graph;switch(a.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",a);this._graph=null;case".":this._subject=null,b=this._readInTopContext;break;case";":b=this._readPredicate;break;case",":b=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){d=null===this._base||k.test(a.value)?a.value:this._resolveIRI(a),c=this._subject,b=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var e=this._prefixes[a.prefix];if(void 0===e)return this._error('Undefined prefix "'+a.prefix+':"',a);d=e+a.value,b=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}return null!==c&&this._callback(null,{subject:c,predicate:this._predicate,object:this._object,graph:d||""}),b},_readBlankNodePunctuation:function(a){var b;switch(a.type){case";":b=this._readPredicate;break;case",":b=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',a)}return this._callback(null,{subject:this._subject,predicate:this._predicate,
object:this._object,graph:this._graph||""}),b},_readQuadPunctuation:function(a){return"."!==a.type?this._error("Expected dot to follow quad",a):this._readInTopContext},_readPrefix:function(a){return"prefix"!==a.type?this._error("Expected prefix to follow @prefix",a):(this._prefix=a.value,this._readPrefixIRI)},_readPrefixIRI:function(a){if("IRI"!==a.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',a);var b;return b=null===this._base||k.test(a.value)?a.value:this._resolveIRI(a),this._prefixes[this._prefix]=b,this._prefixCallback(this._prefix,b),this._readDeclarationPunctuation},_readBaseIRI:function(a){if("IRI"!==a.type)return this._error("Expected IRI to follow base declaration",a);try{this._setBase(null===this._base||k.test(a.value)?a.value:this._resolveIRI(a))}catch(b){this._error(b.message,a)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(a){switch(a.type){case"IRI":case"prefixed":return this._readSubject(a),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",a)}},_readNamedGraphBlankLabel:function(a){return"]"!==a.type?this._error("Invalid graph label",a):(this._subject="_:b"+o++,this._readGraph)},_readDeclarationPunctuation:function(a){return this._sparqlStyle?this._readInTopContext(a):"."!==a.type?this._error("Expected declaration to end with a dot",a):this._readInTopContext},_getTripleEndReader:function(){var a=this._tripleStack;if(0===a.length)return this._readPunctuation;switch(a[a.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(a,b){this._callback(new Error(a+" at line "+b.line+"."))},_resolveIRI:function(a){var b=a.value;switch(b[0]){case void 0:return this._base;case"#":return this._base+b;case"?":return this._base.replace(/(?:\?.*)?$/,b);case"/":return("/"===b[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(b);default:return this._removeDotSegments(this._basePath+b)}},_removeDotSegments:function(a){if(!m.test(a))return a;for(var b="",c=a.length,d=-1,e=-1,f=0,g="/";c>d;){switch(g){case":":if(0>e&&"/"===a[++d]&&"/"===a[++d])for(;(e=d+1)<c&&"/"!==a[e];)d=e;break;case"?":case"#":d=c;break;case"/":if("."===a[d+1])switch(g=a[++d+1]){case"/":b+=a.substring(f,d-1),f=d+1;break;case void 0:case"?":case"#":return b+a.substring(f,d)+a.substr(d+1);case".":if(g=a[++d+1],void 0===g||"/"===g||"?"===g||"#"===g){if(b+=a.substring(f,d-2),(f=b.lastIndexOf("/"))>=e&&(b=b.substr(0,f)),"/"!==g)return b+"/"+a.substr(d+1);f=d+1}}}g=a[++d]}return b+a.substring(f)},parse:function(a,b,c){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+n++ +"_","function"==typeof a&&(c=b,b=a,a=null),this._callback=b||e,this._prefixCallback=c||e;var d=this;this._lexer.tokenize(a,function(a,b){null!==a?(d._callback(a),d._callback=e):void 0!==d._readCallback&&(d._readCallback=d._readCallback(b))}),a||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},b.exports=d},{"./N3Lexer":28}],30:[function(a,b,c){function d(a,b){return this instanceof d?(this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,b||!a||a[0]||(b=a,a=null),b=b||{},this._prefixes=Object.create(null),b.prefixes&&this.addPrefixes(b.prefixes),this.defaultGraph=b.defaultGraph||"http://example.org/#defaultGraph",void(a&&this.addTriples(a))):new d(a,b)}var e=a("./N3Util").expandPrefixedName;d.prototype={get size(){var a=this._size;if(null!==a)return a;var b,c,d=this._graphs;for(var e in d)for(var f in b=d[e].subjects)for(var g in c=b[f])a+=Object.keys(c[g]).length;return this._size=a},_addToIndex:function(a,b,c,d){var e=a[b]||(a[b]={}),f=e[c]||(e[c]={}),g=d in f;return g||(f[d]=null),!g},_removeFromIndex:function(a,b,c,d){var e,f=a[b],g=f[c];delete g[d];for(e in g)return;delete f[c];for(e in f)return;delete a[b]},_findInIndex:function(a,b,c,d,e,f,g,h){var i,j,k,l=[],m=!b+!c+!d,n=m>1?Object.keys(this._ids):this._entities;b&&((i=a,a={})[b]=i[b]);for(var o in a){var p=n[o];if(j=a[o]){c&&((i=j,j={})[c]=i[c]);for(var q in j){var r=n[q];if(k=j[q])for(var s=(d?d in k?[d]:[]:Object.keys(k)),t=s.length-1;t>=0;t--){var u={subject:"",predicate:"",object:"",graph:h};u[e]=p,u[f]=r,u[g]=n[s[t]],l.push(u)}}}}return l},_countInIndex:function(a,b,c,d){var e,f,g,h=0;b&&((e=a,a={})[b]=e[b]);for(var i in a)if(f=a[i]){c&&((e=f,f={})[c]=e[c]);for(var j in f)(g=f[j])&&(d?d in g&&h++:h+=Object.keys(g).length)}return h},addTriple:function(a,b,c,d){b||(d=a.graph,c=a.object,b=a.predicate,a=a.subject),d=d||this.defaultGraph;var e=this._graphs[d];e||(e=this._graphs[d]={subjects:{},predicates:{},objects:{}},Object.freeze(e));var f=this._ids,g=this._entities;a=f[a]||(f[g[++this._id]=a]=this._id),b=f[b]||(f[g[++this._id]=b]=this._id),c=f[c]||(f[g[++this._id]=c]=this._id);var h=this._addToIndex(e.subjects,a,b,c);return this._addToIndex(e.predicates,b,c,a),this._addToIndex(e.objects,c,a,b),this._size=null,h},addTriples:function(a){for(var b=a.length-1;b>=0;b--)this.addTriple(a[b])},addPrefix:function(a,b){this._prefixes[a]=b},addPrefixes:function(a){for(var b in a)this.addPrefix(b,a[b])},removeTriple:function(a,b,c,d){b||(d=a.graph,c=a.object,b=a.predicate,a=a.subject),d=d||this.defaultGraph;var e,f=this._ids,g=this._graphs;if(!(a=f[a]))return!1;if(!(b=f[b]))return!1;if(!(c=f[c]))return!1;if(!(e=g[d]))return!1;var h,i;if(!(h=e.subjects[a]))return!1;if(!(i=h[b]))return!1;if(!(c in i))return!1;this._removeFromIndex(e.subjects,a,b,c),this._removeFromIndex(e.predicates,b,c,a),this._removeFromIndex(e.objects,c,a,b),null!==this._size&&this._size--;for(a in e.subjects)return!0;return delete g[d],!0},removeTriples:function(a){for(var b=a.length-1;b>=0;b--)this.removeTriple(a[b])},find:function(a,b,c,d){var f=this._prefixes;return this.findByIRI(e(a,f),e(b,f),e(c,f),e(d,f))},findByIRI:function(a,b,c,d){var e,f,g,h,i=[],j={},k=this._ids;d?j[d]=this._graphs[d]:j=this._graphs;for(var l in j)if(e=j[l]){if(a&&!(f=k[a]))return i;if(b&&!(g=k[b]))return i;if(c&&!(h=k[c]))return i;f?h?i.push(this._findInIndex(e.objects,h,f,g,"object","subject","predicate",l)):i.push(this._findInIndex(e.subjects,f,g,null,"subject","predicate","object",l)):g?i.push(this._findInIndex(e.predicates,g,h,null,"predicate","object","subject",l)):h?i.push(this._findInIndex(e.objects,h,null,null,"object","subject","predicate",l)):i.push(this._findInIndex(e.subjects,null,null,null,"subject","predicate","object",l))}return 1===i.length?i[0]:i.concat.apply([],i)},count:function(a,b,c,d){var f=this._prefixes;return this.countByIRI(e(a,f),e(b,f),e(c,f),e(d,f))},countByIRI:function(a,b,c,d){d=d||this.defaultGraph;var e=this._graphs[d],f=this._ids;return e?a&&!(a=f[a])?0:b&&!(b=f[b])?0:c&&!(c=f[c])?0:a?c?this._countInIndex(e.objects,c,a,b):this._countInIndex(e.subjects,a,b,c):b?this._countInIndex(e.predicates,b,c,a):this._countInIndex(e.objects,c,a,b):0},createBlankNode:function(a){var b,c;if(a)for(b=a="_:"+a,c=1;this._ids[b];)b=a+c++;else do b="_:b"+this._blankNodeIndex++;while(this._ids[b]);return this._ids[b]=++this._id,b}},b.exports=d},{"./N3Util":33}],31:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);e.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var b=this,c=new g(a);c.parse(function(a,c){c&&b.push(c)||a&&b.emit("error",a)},this.emit.bind(this,"prefix")),this._transform=function(a,b,d){c.addChunk(a),d()},this._flush=function(a){c.end(),a()}}var e=a("stream").Transform,f=a("util"),g=a("./N3Parser.js");f.inherits(d,e),b.exports=d},{"./N3Parser.js":29,stream:15,util:38}],32:[function(a,b,c){function d(a){if(!(this instanceof d))return new d(a);e.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var b=this,c=new g({write:function(a,c,d){b.push(a),d&&d()},end:function(a){b.push(null),a&&a()}},a);this._transform=function(a,b,d){c.addTriple(a,d)},this._flush=function(a){c.end(a)}}var e=a("stream").Transform,f=a("util"),g=a("./N3Writer.js");f.inherits(d,e),b.exports=d},{"./N3Writer.js":34,stream:15,util:38}],33:[function(a,b,c){function d(a,b){for(var c in l)b?a.prototype[c]=e(l[c]):a[c]=l[c];return a}function e(a){return function(b){return a(this,b)}}var f="http://www.w3.org/2001/XMLSchema#",g=f+"string",h=f+"integer",i=f+"double",j=f+"boolean",k="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",l={isIRI:function(a){if("string"!=typeof a)return!1;if(0===a.length)return!0;var b=a[0];return'"'!==b&&"_"!==b},isLiteral:function(a){return"string"==typeof a&&'"'===a[0]},isBlank:function(a){return"string"==typeof a&&"_:"===a.substr(0,2)},isDefaultGraph:function(a){return!a},inDefaultGraph:function(a){return!a.graph},getLiteralValue:function(a){var b=/^"([^]*)"/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]},getLiteralType:function(a){var b=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]||(b[2]?k:g)},getLiteralLanguage:function(a){var b=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(a);if(!b)throw new Error(a+" is not a literal");return b[1]?b[1].toLowerCase():""},isPrefixedName:function(a){return"string"==typeof a&&/^[^:\/"']*:[^:\/"']+$/.test(a)},expandPrefixedName:function(a,b){var c,d,e,f=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(a);return f&&(c=f[1],d=b[c],e=f.index),void 0===d?a:0===e?d+a.substr(c.length+1):a.substr(0,e+3)+d+a.substr(e+c.length+4)},createIRI:function(a){return a&&'"'===a[0]?l.getLiteralValue(a):a},createLiteral:function(a,b){if(!b)switch(typeof a){case"boolean":b=j;break;case"number":isFinite(a)?b=a%1===0?h:i:(b=i,isNaN(a)||(a=a>0?"INF":"-INF"));break;default:return'"'+a+'"'}return'"'+a+(/^[a-z]+(-[a-z0-9]+)*$/i.test(b)?'"@'+b.toLowerCase():'"^^'+b)},prefix:function(a){return l.prefixes({"":a})("")},prefixes:function(a){function b(a,b){if(b||!(a in c)){var d=Object.create(null);b=b||"",c[a]=function(a){return d[a]||(d[a]=b+a)}}return c[a]}var c=Object.create(null);for(var d in a)b(d,a[d]);return b}};b.exports=d(d)},{}],34:[function(a,b,c){function d(a,b){if(!(this instanceof d))return new d(a,b);if(a&&"function"!=typeof a.write&&(b=a,a=null),b=b||{},a)this._outputStream=a,this._endStream=void 0===b.end?!0:!!b.end;else{var c="";this._outputStream={write:function(a,b,d){c+=a,d&&d()},end:function(a){a&&a(null,c)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(b.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),b.prefixes&&this.addPrefixes(b.prefixes))}function e(a){var b=k[a];return void 0===b&&(1===a.length?(b=a.charCodeAt(0).toString(16),b="\\u0000".substr(0,6-b.length)+b):(b=(1024*(a.charCodeAt(0)-55296)+a.charCodeAt(1)+9216).toString(16),b="\\U00000000".substr(0,10-b.length)+b)),b}var f=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,g="http://www.w3.org/1999/02/22-rdf-syntax-ns#",h=g+"type",i=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,j=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,k={"\\":"\\\\",'"':'\\"',"	":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};d.prototype={_write:function(a,b){this._outputStream.write(a,"utf8",b)},_writeTriple:function(a,b,c,d,e){try{this._graph!==d&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(d?this._encodeIriOrBlankNode(d)+" {\n":"")),this._subject=null,this._graph="["!==d[0]?d:"]"),this._subject===a?this._predicate===b?this._write(", "+this._encodeObject(c),e):this._write(";\n    "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=a)+" "+this._encodePredicate(this._predicate=b)+" "+this._encodeObject(c),e)}catch(f){e&&e(f)}},_writeTripleLine:function(a,b,c,d,e){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(a)+" "+this._encodeIriOrBlankNode(b)+" "+this._encodeObject(c)+(d?" "+this._encodeIriOrBlankNode(d)+".\n":".\n"),e)}catch(f){e&&e(f)}},_encodeIriOrBlankNode:function(a){var b=a[0];if("["===b||"("===b||"_"===b&&":"===a[1])return a;i.test(a)&&(a=a.replace(j,e));var c=this._prefixRegex.exec(a);return c?c[1]?this._prefixIRIs[c[1]]+c[2]:a:"<"+a+">"},_encodeLiteral:function(a,b,c){return i.test(a)&&(a=a.replace(j,e)),c?'"'+a+'"@'+c:b?'"'+a+'"^^'+this._encodeIriOrBlankNode(b):'"'+a+'"'},_encodeSubject:function(a){if('"'===a[0])throw new Error("A literal as subject is not allowed: "+a);return"["===a[0]&&(this._subject="]"),this._encodeIriOrBlankNode(a)},_encodePredicate:function(a){if('"'===a[0])throw new Error("A literal as predicate is not allowed: "+a);return a===h?"a":this._encodeIriOrBlankNode(a)},_encodeObject:function(a){if('"'!==a[0])return this._encodeIriOrBlankNode(a);var b=f.exec(a);if(!b)throw new Error("Invalid literal: "+a);return this._encodeLiteral(b[1],b[2],b[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(a,b,c,d,e){void 0===c?this._writeTriple(a.subject,a.predicate,a.object,a.graph||"",b):"string"!=typeof d?this._writeTriple(a,b,c,"",d):this._writeTriple(a,b,c,d,e)},addTriples:function(a){for(var b=0;b<a.length;b++)this.addTriple(a[b])},addPrefix:function(a,b,c){var d={};d[a]=b,this.addPrefixes(d,c)},addPrefixes:function(a,b){var c=this._prefixIRIs,d=!1;for(var e in a){var f=a[e];/[#\/]$/.test(f)&&c[f]!==(e+=":")&&(d=!0,c[f]=e,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+e+" <"+f+">.\n"))}if(d){var g="",h="";for(var i in c)g+=g?"|"+i:i,h+=(h?"|":"")+c[i];g=g.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+h+")[^/]*$|^("+g+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(d?"\n":"",b)},blank:function(a,b){var c,d,e=a;switch(void 0===a?e=[]:"string"==typeof a?e=[{predicate:a,object:b}]:"length"in a||(e=[a]),d=e.length){case 0:return"[]";case 1:if(c=e[0],"["!==c.object[0])return"[ "+this._encodePredicate(c.predicate)+" "+this._encodeObject(c.object)+" ]";default:for(var f="[",g=0;d>g;g++)c=e[g],c.predicate===a?f+=", "+this._encodeObject(c.object):(f+=(g?";\n  ":"\n  ")+this._encodePredicate(c.predicate)+" "+this._encodeObject(c.object),a=c.predicate);return f+"\n]"}},list:function(a){for(var b=a&&a.length||0,c=new Array(b),d=0;b>d;d++)c[d]=this._encodeObject(a[d]);return"("+c.join(" ")+")"},_prefixRegex:/$0^/,end:function(a){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var b=a&&function(c,d){b=null,a(c,d)};if(this._endStream)try{return this._outputStream.end(b)}catch(c){}b&&b()}},b.exports=d},{}],35:[function(a,b,c){(function(a){!function(d){function e(a){throw RangeError(H[a])}function f(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function g(a,b){return f(a.split(G),b).join(".")}function h(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:w}function k(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;q>f;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=t>=k?x:k>=t+y?y:k-t,!(n>m);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;q>i;++i)p=a[i],128>p&&u.push(K(p));for(d=f=u.length,f&&u.push(D);q>d;){for(j=v,i=0;q>i;++i)p=a[i],p>=b&&j>p&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;q>i;++i)if(p=a[i],b>p&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=g>=n?x:n>=g+y?y:n-g,!(o>m);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof c&&c,r="object"==typeof b&&b&&b.exports==q&&b,s="object"==typeof a&&a;(s.global===s||s.window===s)&&(d=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^ -~]/,G=/\x2E|\u3002|\uFF0E|\uFF61/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.2.4",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return t});else if(q&&!q.nodeType)if(r)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else d.punycode=t}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:35,querystring:13}],37:[function(a,b,c){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],38:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a,b){return a}function h(a){var b={};return a.forEach(function(a,c){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)F(b,String(g))?f.push(m(a,b,c,d,String(g),!0)):f.push("");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":37,"7YKIPe":10,inherits:24}],39:[function(a,b,c){function d(a,b){this.name="NonSupportedSparqlFeatureError",this.feature=a,this.message=b||"SPARQL feature "+a+" non supported"}function e(a){this.name=ParserError,this.message=a||"Error parsing SPARQL query"}var f=a("./parser"),g=a("./utils"),h=g;d.prototype=new Error,d.constructor=d,e.prototype=new Error,e.constructor=e,AbstractQueryTree=function(){},AbstractQueryTree.prototype.parseQueryString=function(a){return f.parse(a)},AbstractQueryTree.prototype.parseExecutableUnit=function(a){if("select"===a.kind)return this.parseSelect(a);if("ask"===a.kind)return this.parseSelect(a);if("modify"===a.kind)return this.parseSelect(a);if("construct"===a.kind)return this.parseSelect(a);if("insertdata"===a.kind)return this.parseInsertData(a);if("deletedata"===a.kind)return this.parseInsertData(a);if("load"===a.kind)return a;if("clear"===a.kind)return a;if("drop"===a.kind)return a;if("create"===a.kind)return a;throw new Error("unknown executable unit: "+a.kind)},AbstractQueryTree.prototype.parseSelect=function(a){if(null==a)return console.log("error parsing query"),
null;var b={freshCounter:0};return a.pattern=this.build(a.pattern,b),a},AbstractQueryTree.prototype.parseInsertData=function(a){return null==a?(console.log("error parsing query"),null):a},AbstractQueryTree.prototype.build=function(a,b){if("groupgraphpattern"===a.token)return this._buildGroupGraphPattern(a,b);if("basicgraphpattern"===a.token){var c={kind:"BGP",value:a.triplesContext};return c=AbstractQueryTree.translatePathExpressionsInBGP(c,b)}if("graphunionpattern"===a.token){var f=this.build(a.value[0],b),g=this.build(a.value[1],b);return{kind:"UNION",value:[f,g]}}if("graphgraphpattern"===a.token){var h=this.build(a.value,b);return{kind:"GRAPH",value:h,graph:a.graph}}throw null!=a.token?new d(a.token,"Non implemented SPARQL graph pattern: '"+a.token+"'"):new e("Error parsing graph pattern: '"+JSON.stringify(a)+"'")},AbstractQueryTree.translatePathExpressionsInBGP=function(a,b){for(var c,d,e,f=[],g=0;g<a.value.length;g++)if(a.value[g].predicate&&"path"===a.value[g].predicate.token){c=a.value[g],d=a.value.slice(g+1);var i=AbstractQueryTree.translatePathExpression(c,b),j=null;if("BGP"!==i.kind){if("ZERO_OR_MORE_PATH"===i.kind||"ONE_OR_MORE_PATH"===i.kind){if(e=f.length>0?{kind:"JOIN",lvalue:{kind:"BGP",value:f},rvalue:i}:i,"ZERO_OR_MORE_PATH"===i.kind)if("var"===i.y.token&&0===i.y.value.indexOf("fresh:")&&"var"===i.x.token&&0===i.x.value.indexOf("fresh:"))for(var k=0;k<a.value.length;k++)a.value[k].object&&"var"===a.value[k].object.token&&a.value[k].object.value===i.x.value&&(j=h.clone(a.value[k],!0),j.object=i.y);else if("var"===i.y.token&&0===i.y.value.indexOf("fresh:"))for(var k=0;k<a.value.length;k++)a.value[k].subject&&"var"===a.value[k].subject.token&&a.value[k].subject.value===i.y.value&&(j=h.clone(a.value[k],!0),j.subject=i.x);if(d.length>0){var l=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:d},b);if(null!=j){var m=f.concat([j]).concat(d);return{kind:"UNION",value:[{kind:"JOIN",lvalue:e,rvalue:l},{kind:"BGP",value:m}]}}return{kind:"JOIN",lvalue:e,rvalue:l}}return e}return i}f=f.concat(i.value)}else f.push(a.value[g]);return a.value=f,a},AbstractQueryTree.translatePathExpression=function(a,b){if("element"===a.predicate.kind){if("+"===a.predicate.modifier){a.predicate.modifier=null;var c=AbstractQueryTree.translatePathExpression(a,b);return{kind:"ONE_OR_MORE_PATH",path:c,x:a.subject,y:a.object}}if("*"===a.predicate.modifier){a.predicate.modifier=null;var c=AbstractQueryTree.translatePathExpression(a,b);return{kind:"ZERO_OR_MORE_PATH",path:c,x:a.subject,y:a.object}}return a.predicate=a.predicate.value,{kind:"BGP",value:[a]}}if("sequence"===a.predicate.kind){for(var e,f,g=a.subject,i=a.object,j=a.graph,k=[],l=0;l<a.predicate.value.length;l++)l!=a.predicate.value.length-1?(e={token:"var",value:"fresh:"+b.freshCounter},b.freshCounter++):e=i,f={subject:g,predicate:a.predicate.value[l],object:e},null!=j&&(f.graph=h.clone(j,!0)),k.push(f),l!=a.predicate.value.length-1&&(g=h.clone(e,!0));var m={kind:"BGP",value:k};return AbstractQueryTree.translatePathExpressionsInBGP(m,b)}throw new d("Non supported path expression "+a.predicate.kind)},AbstractQueryTree.prototype._buildGroupGraphPattern=function(a,b){for(var c=a.filters||[],d=a.binds||[],e={kind:"EMPTY_PATTERN"},f=0;f<a.patterns.length;f++){var g=a.patterns[f];if("optionalgraphpattern"===g.token){var h=this.build(g.value,b);e="FILTER"===h.kind?{kind:"LEFT_JOIN",lvalue:e,rvalue:h.value,filter:h.filter}:{kind:"LEFT_JOIN",lvalue:e,rvalue:h,filter:!0}}else{var h=this.build(g,b);e="EMPTY_PATTERN"==e.kind?h:{kind:"JOIN",lvalue:e,rvalue:h}}}if(e.binds=d,0!=c.length){if("EMPTY_PATTERN"===e.kind)return{kind:"FILTER",filter:c,value:e};if("LEFT_JOIN"===e.kind&&e.filter===!0)return{kind:"FILTER",filter:c,value:e};if("LEFT_JOIN"===e.kind)return{kind:"FILTER",filter:c,value:e};if("JOIN"===e.kind)return{kind:"FILTER",filter:c,value:e};if("UNION"===e.kind)return{kind:"FILTER",filter:c,value:e};if("GRAPH"===e.kind)return{kind:"FILTER",filter:c,value:e};if("BGP"===e.kind)return{kind:"FILTER",filter:c,value:e};throw new Error("Unknow kind of algebra expression: "+e.kind)}return e},AbstractQueryTree.prototype.collectBasicTriples=function(a,b){if(null==b&&(b=[]),"select"===a.kind)b=this.collectBasicTriples(a.pattern,b);else if("BGP"===a.kind)b=b.concat(a.value);else if("ZERO_OR_MORE_PATH"===a.kind)b=this.collectBasicTriples(a.path);else if("UNION"===a.kind)b=this.collectBasicTriples(a.value[0],b),b=this.collectBasicTriples(a.value[1],b);else if("GRAPH"===a.kind)b=this.collectBasicTriples(a.value,b);else if("LEFT_JOIN"===a.kind||"JOIN"===a.kind)b=this.collectBasicTriples(a.lvalue,b),b=this.collectBasicTriples(a.rvalue,b);else if("FILTER"===a.kind)b=this.collectBasicTriples(a.value,b);else if("construct"===a.kind)b=this.collectBasicTriples(a.pattern,b);else if("EMPTY_PATTERN"!==a.kind)throw"Unknown pattern: "+a.kind;return b},AbstractQueryTree.prototype.bind=function(a,b){if(null!=a.graph&&a.graph.token&&"var"===a.graph.token&&null!=b[a.graph.value]&&(a.graph=b[a.graph.value]),null!=a.filter){for(var c=[],d=0;d<a.filter.length;d++)a.filter[d].value=this._bindFilter(a.filter[d].value,b),c.push(a.filter[d]);a.filter=c}if("select"===a.kind)a.pattern=this.bind(a.pattern,b);else if("BGP"===a.kind)a.value=this._bindTripleContext(a.value,b);else if("ZERO_OR_MORE_PATH"===a.kind)a.path=this._bindTripleContext(a.path,b),a.x&&"var"===a.x.token&&null!=b[a.x.value]&&(a.x=b[a.x.value]),a.y&&"var"===a.y.token&&null!=b[a.y.value]&&(a.y=b[a.y.value]);else if("UNION"===a.kind)a.value[0]=this.bind(a.value[0],b),a.value[1]=this.bind(a.value[1],b);else if("GRAPH"===a.kind)a.value=this.bind(a.value,b);else if("LEFT_JOIN"===a.kind||"JOIN"===a.kind)a.lvalue=this.bind(a.lvalue,b),a.rvalue=this.bind(a.rvalue,b);else if("FILTER"===a.kind){var e=this;a.value=this.bind(a.value,b),a.filter=a.filter.map(function(a){return{token:"filter",value:e._bindFilter(a.value,b)}})}else if("EMPTY_PATTERN"!==a.kind)throw"Unknown pattern: "+a.kind;return a},AbstractQueryTree.prototype._bindTripleContext=function(a,b){for(var c=0;c<a.length;c++){delete a[c].graph,delete a[c].variables;for(var d in a[c]){var e=a[c][d];"var"===e.token&&null!=b[e.value]&&(a[c][d]=b[e.value])}}return a},AbstractQueryTree.prototype._bindFilter=function(a,b){if(null!=a.expressionType){var c=a.expressionType;if("relationalexpression"==c)a.op1=this._bindFilter(a.op1,b),a.op2=this._bindFilter(a.op2,b);else if("conditionalor"==c||"conditionaland"==c)for(var d=0;d<a.operands.length;d++)a.operands[d]=this._bindFilter(a.operands[d],b);else if("additiveexpression"==c){a.summand=this._bindFilter(a.summand,b);for(var d=0;d<a.summands.length;d++)a.summands[d].expression=this._bindFilter(a.summands[d].expression,b)}else if("builtincall"==c)for(var d=0;d<a.args.length;d++)a.args[d]=this._bindFilter(a.args[d],b);else if("multiplicativeexpression"==c){a.factor=this._bindFilter(a.factor,b);for(var d=0;d<a.factors.length;d++)a.factors[d].expression=this._bindFilter(a.factors[d].expression,b)}else if("unaryexpression"==c)a.expression=this._bindFilter(a.expression,b);else if("irireforfunction"==c)for(var d=0;d<a.factors.args;d++)a.args[d]=this._bindFilter(a.args[d],b);else if("atomic"==c&&"var"==a.primaryexpression&&null!=b[a.value.value]){var e=b[a.value.value];"uri"===e.token?a.primaryexpression="iri":a.primaryexpression="literal",a.value=e}}return a},AbstractQueryTree.prototype.replace=function(a,b,c,d){if(null!=a.graph&&a.graph.token&&a.graph.token===b.token&&a.graph.value==b.value&&(a.graph=h.clone(c,!0)),null!=a.filter){for(var e=[],f=0;f<a.filter.length;f++)a.filter[f].value=this._replaceFilter(a.filter[f].value,b,c,d),e.push(a.filter[f]);a.filter=e}if("select"===a.kind)a.pattern=this.replace(a.pattern,b,c,d);else if("BGP"===a.kind)a.value=this._replaceTripleContext(a.value,b,c,d);else if("ZERO_OR_MORE_PATH"===a.kind)a.path=this._replaceTripleContext(a.path,b,c,d),a.x&&a.x.token===b.token&&a.value===b.value&&(a.x=h.clone(c,!0)),a.y&&a.y.token===b.token&&a.value===b.value&&(a.y=h.clone(c,!0));else if("UNION"===a.kind)a.value[0]=this.replace(a.value[0],b,c,d),a.value[1]=this.replace(a.value[1],b,c,d);else if("GRAPH"===a.kind)a.value=this.replace(a.value,b,c);else if("LEFT_JOIN"===a.kind||"JOIN"===a.kind)a.lvalue=this.replace(a.lvalue,b,c,d),a.rvalue=this.replace(a.rvalue,b,c,d);else if("FILTER"===a.kind)a.value=this._replaceFilter(a.value,b,c,d);else if("EMPTY_PATTERN"!==a.kind)throw"Unknown pattern: "+a.kind;return a},AbstractQueryTree.prototype._replaceTripleContext=function(a,b,c,d){for(var e=0;e<a.length;e++)for(var f in a[e]){var h=a[e][f];"var"===h.token&&"var"===b.token&&h.value===b.value?a[e][f]=c:"blank"===h.token&&"blank"===b.token&&h.value===b.value?a[e][f]=c:"literal"!==h.token&&"uri"!==h.token||"literal"!==b.token&&"uri"!==b.token||h.token!==b.token||g.lexicalFormTerm(h,d)[h.token]!==g.lexicalFormTerm(b,d)[h.token]||(a[e][f]=c)}return a},AbstractQueryTree.prototype._replaceFilter=function(a,b,c,d){if(null!=a.expressionType){var e=a.expressionType;if("relationalexpression"==e)a.op1=this._replaceFilter(a.op1,b,c,d),a.op2=this._replaceFilter(a.op2,b,c,d);else if("conditionalor"==e||"conditionaland"==e)for(var f=0;f<a.operands.length;f++)a.operands[f]=this._replaceFilter(a.operands[f],b,c,d);else if("additiveexpression"==e){a.summand=this._replaceFilter(a.summand,b,c,d);for(var f=0;f<a.summands.length;f++)a.summands[f].expression=this._replaceFilter(a.summands[f].expression,b,c,d)}else if("builtincall"==e)for(var f=0;f<a.args.length;f++)a.args[f]=this._replaceFilter(a.args[f],b,c,d);else if("multiplicativeexpression"==e){a.factor=this._replaceFilter(a.factor,b,c,d);for(var f=0;f<a.factors.length;f++)a.factors[f].expression=this._replaceFilter(a.factors[f].expression,b,c,d)}else if("unaryexpression"==e)a.expression=this._replaceFilter(a.expression,b,c,d);else if("irireforfunction"==e)for(var f=0;f<a.factors.args;f++)a.args[f]=this._replaceFilter(a.args[f],b,c,d);else if("atomic"==e){var g=null;a.primaryexpression==b.token&&a.value==b.value?g=c.value:"iri"==a.primaryexpression&&"uri"==b.token&&a.value==b.value&&(g=c.value),null!=g&&("uri"===c.token?a.primaryexpression="iri":a.primaryexpression=c.token,a.value=g)}}return a},AbstractQueryTree.prototype.treeWithUnion=function(a){if(null==a)return!1;if(null==a.kind)return!1;if("select"===a.kind)return this.treeWithUnion(a.pattern);if("BGP"===a.kind)return this.treeWithUnion(a.value);if("ZERO_OR_MORE_PATH"===a.kind)return!1;if("UNION"===a.kind){if(null==a.value[0].value||null==a.value[0].value.variables||null==a.value[1].value||null==a.value[1].value.variables)return!0;if(a.value[0].variables.join("/")===a.values[1].variables.join("/"))return this.treeWithUnion(a.value[0])?!0:this.treeWithUnion(a.value[1])}else{if("GRAPH"===a.kind)return!1;if("LEFT_JOIN"!==a.kind&&"JOIN"!==a.kind)return"FILTER"===a.kind?!1:"EMPTY_PATTERN"===a.kind?!1:!1;var b=this.treeWithUnion(a.lvalue);if(b)return!0;this.treeWithUnion(a.rvalue)}},b.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:d,SparqlParserError:e}},{"./parser":46,"./utils":57}],40:[function(a,b,c){"use strict";var d=a("./utils"),e=d,f=d.nextTick,g=-1,h=1,i=function(a,b){if(0!=arguments.length){this.order=a,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0;var c=this;this._diskWrite(this.root,function(a){c.root=a,c._updateRootNode(c.root,function(a){c.comparator=function(a,b){return b>a?-1:a>b?1:0},c.merger=null,null!=b&&b(c)})})}};i.prototype._allocateNode=function(){return new j},i.prototype._diskWrite=function(a,b){f(function(){b(a)})},i.prototype._diskRead=function(a,b){f(function(){b(a)})},i.prototype._diskDelete=function(a,b){f(function(){b()})},i.prototype._updateRootNode=function(a,b){b(a)},i.prototype.search=function(a,b,c){var d=this.root,e=this;e.__search(e,a,d,b,c)},i.prototype.__search=function(a,b,c,d,e){for(var f=0;f<c.numberActives&&1===a.comparator(b,c.keys[f].key);)f++;f<c.numberActives&&0===a.comparator(c.keys[f].key,b)?d(null!=e&&1==e?!0:c.keys[f].data):c.isLeaf===!0?d(null):a._diskRead(c.children[f],function(c){a.__search(a,b,c,d,e)})},i.prototype.walk=function(a,b){this.__walk(this,this.root,a,b)},i.prototype.__walk=function(a,b,c,d){var f=b.numberActives,g=0;if(b.isLeaf){for(g=0;g<b.numberActives;g++)c(b.keys[g]);return d()}e.whilst(function(){return f>g},function(d){a._diskRead(b.children[g],function(e){a.__walk(a,e,c,function(){a._diskRead(b.keys[g],function(a){c(a),g++,d()})})})},function(){a._diskRead(b.children[f],function(b){a.__walk(a,b,c,function(){d()})})})},i.prototype.walkNodes=function(a){this.__walkNodes(this,root,a,function(){})},i.prototype.__walkNodes=function(a,b,c,d){if(b.isLeaf)return c(b),d();c(b);var f=b.numberActives,g=0;e.whilst(function(){return f>g},function(d){a._diskRead(b.children[g],function(b){a.__walkNodes(a,b,c,function(){g++,d()})})},function(){a._diskRead(b.children[f],function(b){a.__walkNodes(a,b,c,function(){})})})},i.prototype._splitChild=function(a,b,c,d){var e=this._allocateNode();e.isLeaf=c.isLeaf,e.level=c.level,e.numberActives=this.order-1;var f=c.keys[this.order-1];c.keys[this.order-1]=null;for(var g=0;g<this.order-1;g++)e.keys[g]=c.keys[g+this.order],c.keys[g+this.order]=null,c.isLeaf||(e.children[g]=c.children[g+this.order],c.children[g+this.order]=null);for(c.isLeaf||(e.children[g]=c.children[g+this.order],c.children[g+this.order]=null),c.numberActives=this.order-1,g=a.numberActives+1;g>b+1;g--)a.children[g]=a.children[g-1];for(a.children[b+1]=e,g=a.numberActives;g>b;g--)a.keys[g]=a.keys[g-1];a.keys[b]=f,a.numberActives++;var h=this;this._diskWrite(e,function(e){h._diskWrite(a,function(a){a.children[b+1]=e,h._diskWrite(c,function(b){return d(a)})})})},i.prototype.insert=function(a,b,c){if(this.root.numberActives===2*this.order-1){var d=this._allocateNode();d.isLeaf=!1,d.level=this.root.level+1,d.numberActives=0,d.children[0]=this.root;var e=this;this._splitChild(d,0,this.root,function(f){d=f,e.root=d,e._updateRootNode(d,function(d){e._insertNonFull(d,a,b,c)})})}else this._insertNonFull(this.root,a,b,c)},i.prototype._insertNonFull=function(a,b,c,d){var e=a.numberActives-1;this.__insertNonFull(this,a,e,b,c,d)},i.prototype.__insertNonFull=function(a,b,c,d,e,f){if(b.isLeaf){for(;c>=0&&-1===a.comparator(d,b.keys[c].key);)b.keys[c+1]=b.keys[c],c--;c>=0&&0===a.comparator(d,b.keys[c].key)?b.keys[c]={key:d,data:e}:(b.keys[c+1]={key:d,data:e},b.numberActives++),a._diskWrite(b,function(a){return f(a)})}else{for(;c>=0&&-1===a.comparator(d,b.keys[c].key);)c--;c++;var g=a;a._diskRead(b.children[c],function(h){h.numberActives===2*g.order-1?g._splitChild(b,c,h,function(){1===g.comparator(d,b.keys[c].key)&&c++,g._diskRead(b.children[c],function(b){c=b.numberActives-1,g.__insertNonFull(a,b,c,d,e,f)})}):g._diskRead(b.children[c],function(b){c=b.numberActives-1,g.__insertNonFull(a,b,c,d,e,f)})})}},i.prototype["delete"]=function(a,b){var c=this.root;i.prototype.__deleteSearchNode(this,a,c,b)},i.prototype.__deleteSearchNode=function(a,b,c,d){var e=0;if(0===c.numberActives)return d(!1);for(;e<c.numberActives&&1===a.comparator(b,c.keys[e].key);)e++;var f=e;if(e<c.numberActives&&0===a.comparator(b,c.keys[e].key))return a.__deleteNodeFound(a,f,b,c,d);if(c.isLeaf===!0)return d(!1);var i=c;a._diskRead(c.children[e],function(c){if(null===c)return d(!1);var j=!1,k=!1,l=null,m=null;f===i.numberActives?(k=!0,m=i.children[f-1],l=i.children[f-1]):0===f?(j=!0,l=i.children[1],m=i.children[1]):(m=i.children[f-1],l=i.children[f+1]),a._diskRead(m,function(f){a._diskRead(l,function(l){k===!0&&(l=null),j===!0&&(f=null),c.numberActives===a.order-1&&null!=i?null!=l&&l.numberActives>a.order-1?a._moveKey(i,e,g,function(e){a.__deleteSearchNode(a,b,c,d)}):null!=f&&f.numberActives>a.order-1?a._moveKey(i,e,h,function(e){a.__deleteSearchNode(a,b,c,d)}):null!=f&&f.numberActives===a.order-1?a._mergeSiblings(i,e,g,function(c){a.__deleteSearchNode(a,b,c,d)}):null!=l&&l.numberActives===a.order-1&&a._mergeSiblings(i,e,h,function(c){a.__deleteSearchNode(a,b,c,d)}):a.__deleteSearchNode(a,b,c,d)})})})},i.prototype.__deleteNodeFound=function(a,b,c,d,e){return d.isLeaf&&d.numberActives>a.order-1?(a._deleteKeyFromNode(d,b,function(){e(!0)}),!0):d.isLeaf&&d===a.root?(a._deleteKeyFromNode(d,b,function(){e(!0)}),!0):(d.isLeaf===!1&&a._diskRead(d.children[b],function(f){f.numberActives>a.order-1?a._getMaxKeyPos(a,f,function(g){c=g.node.keys[g.index],d.keys[b]=c,a._diskWrite(d,function(b){b=f,c=c.key,a.__deleteSearchNode(a,c,b,e)})}):a._diskRead(d.children[b+1],function(g){g.numberActives>a.order-1?a._getMinKeyPos(a,g,function(f){c=f.node.keys[f.index],d.keys[b]=c,a._diskWrite(d,function(b){b=g,c=c.key,a.__deleteSearchNode(a,c,b,e)})}):f.numberActives===a.order-1&&g.numberActives===a.order-1&&a._mergeNodes(f,d.keys[b],g,function(f){d.children[b]=f,b++;for(var g=b;g<d.numberActives;g++)d.children[g]=d.children[g+1],d.keys[g-1]=d.keys[g];d.children[g]=null,d.keys[g-1]=null,d.numberActives--,0===d.numberActives&&a.root===d&&(a.root=f),a._diskWrite(d,function(b){a.__deleteSearchNode(a,c,f,e)})})})}),void(d.isLeaf&&d.numberActives>a.order-1&&a._deleteKeyFromNode(d,b,function(b){a.__deleteSearchNode(a,c,b,e)})))},i.prototype._moveKey=function(a,b,c,d){c===h&&b--;var e=this;e._diskRead(a.children[b],function(f){e._diskRead(a.children[b+1],function(h){if(c==g){f.keys[f.numberActives]=a.keys[b],f.children[f.numberActives+1]=h.children[0],h.children[0]=null,f.numberActives++,a.keys[b]=h.keys[0];for(var i=1;i<h.numberActives;i++)h.keys[i-1]=h.keys[i],h.children[i-1]=h.children[i];h.children[h.numberActives-1]=h.children[h.numberActives],h.numberActives--}else{h.children[h.numberActives+1]=h.children[h.numberActives];for(var i=h.numberActives;i>0;i--)h.children[i]=h.children[i-1],h.keys[i]=h.keys[i-1];h.keys[0]=null,h.children[0]=null,h.children[0]=f.children[f.numberActives],h.keys[0]=a.keys[b],h.numberActives++,f.children[f.numberActives]=null,a.keys[b]=f.keys[f.numberActives-1],f.keys[f.numberActives-1]=null,f.numberActives--}e._diskWrite(f,function(b){e._diskWrite(h,function(b){e._diskWrite(a,function(a){return d(a)})})})})})},i.prototype._mergeSiblings=function(a,b,c,d){var e,f,g,h;b===a.numberActives?(b--,g=a.children[a.numberActives-1],h=a.children[a.numberActives]):(g=a.children[b],h=a.children[b+1]);var i=this;i._diskRead(g,function(c){i._diskRead(h,function(g){var h=i._allocateNode();for(h.isLeaf=c.isLeaf,h.level=c.level,f=0;f<i.order-1;f++)h.keys[f]=c.keys[f],h.children[f]=c.children[f];for(h.keys[i.order-1]=a.keys[b],h.children[i.order-1]=c.children[i.order-1],f=0;f<i.order-1;f++)h.keys[f+i.order]=g.keys[f],h.children[f+i.order]=g.children[f];for(h.children[2*i.order-1]=g.children[i.order-1],a.children[b]=h,f=b;f<a.numberActives;f++)a.keys[f]=a.keys[f+1],a.children[f+1]=a.children[f+2];for(h.numberActives=c.numberActives+g.numberActives+1,a.numberActives--,e=a.numberActives;e<2*i.order-1;e++)a.keys[e]=null;0===a.numberActives&&i.root===a&&(i.root=h,h.level?h.isLeaf=!1:h.isLeaf=!0),i._diskWrite(h,function(b){i._diskWrite(a,function(a){i._diskDelete(c,function(){i._diskDelete(g,function(){return i.root!==b?d(b):void i._updateRootNode(i.root,function(){return d(b)})})})})})})})},i.prototype._deleteKeyFromNode=function(a,b,c){var d=2*this.order-1;a.numberActives<d&&(d=a.numberActives);var e;if(a.isLeaf===!1)return!1;a.keys[b];for(e=b;d-1>e;e++)a.keys[e]=a.keys[e+1];a.keys.pop(),a.numberActives--,this._diskWrite(a,function(a){return c(a)})},i.prototype._mergeNodes=function(a,b,c,d){var e,f;for(e=this._allocateNode(),e.isLeaf=!0,f=0;f<a.numberActives;f++)e.keys[f]=a.keys[f],e.children[f]=a.children[f];for(e.children[a.numberActives]=a.children[a.numberActives],e.keys[a.numberActives]=b,f=0;f<c.numberActives;f++)e.keys[f+a.numberActives+1]=c.keys[f],e.children[f+a.numberActives+1]=c.children[f];e.children[2*this.order-1]=c.children[c.numberActives],e.numberActives=a.numberActives+c.numberActives+1,e.isLeaf=a.isLeaf,e.level=a.level;var g=this;this._diskWrite(e,function(b){g._diskDelete(a,function(){g._diskDelete(c,function(){return d(b)})})})},i.prototype.audit=function(a){var b=[],c=[],d=this,e=function(e){for(var f=0;f<c.length;f++)if(0===d.comparator(c[f],e)){var g=" !!! duplicated key "+e;a===!0&&console.log(g),b.push(g)}},f=null,d=this;return this.walkNodes(function(g){a===!0&&(console.log("--- Node at "+g.level+" level"),console.log(" - leaf? "+g.isLeaf),console.log(" - num actives? "+g.numberActives),console.log(" - keys: "));for(var h=g.numberActives;h<g.keys.length;h++)null!=g.keys[h]&&a===!0&&(console.log(" * warning : redundant key data"),b.push(" * warning : redundant key data"));for(var h=g.numberActives+1;h<g.children.length;h++)null!=g.children[h]&&a===!0&&(console.log(" * warning : redundant children data"),b.push(" * warning : redundant key data"));if(g.isLeaf===!1)for(var h=0;h<g.numberActives;h++){var i=this._diskRead(g.children[h]).keys[this._diskRead(g.children[h]).numberActives-1].key,j=this._diskRead(g.children[h+1]).keys[0].key;if(a===!0&&console.log("   "+g.keys[h].key+"("+i+","+j+")"),-1===d.comparator(g.keys[h].key,i)){var k=" !!! value max left "+i+" > key "+g.keys[h].key;a===!0&&console.log(k),b.push(k)}if(1===d.comparator(g.keys[h].key,j)){var k=" !!! value min right "+j+" < key "+g.keys[h].key;a===!0&&console.log(k),b.push(k)}e(g.keys[h].key),c.push(g.keys[h].key)}else{if(null===f)f=g.level;else if(f!=g.level){var k=" !!! Leaf node with wrong level value";a===!0&&console.log(k),b.push(k)}for(var h=0;h<g.numberActives;h++)a===!0&&console.log(" "+g.keys[h].key),e(g.keys[h].key),c.push(g.keys[h].key)}if(g!=d.root){if(g.numberActives>2*d.order-1){if(a===!0)var k=" !!!! MAX num keys restriction violated ";console.log(k),b.push(k)}if(g.numberActives<d.order-1){if(a===!0)var k=" !!!! MIN num keys restriction violated ";console.log(k),b.push(k)}}}),b},i.prototype._getMaxKeyPos=function(a,b,c){var d={};return null===b?c(null):b.isLeaf===!0?(d.node=b,d.index=b.numberActives-1,c(d)):(d.node=b,d.index=b.numberActives-1,a._diskRead(b.children[b.numberActives],function(b){return a._getMaxKeyPos(a,b,c)}),void 0)},i.prototype._getMinKeyPos=function(a,b,c){var d={};return null===b&&c(null),b.isLeaf===!0?(d.node=b,d.index=0,c(d)):(d.node=b,d.index=0,a._diskRead(b.children[0],function(b){return a._getMinKeyPos(a,b,c)}),void 0)};var j=function(){this.numberActives=0,this.isLeaf=null,this.keys=[],this.children=[],this.level=0};b.exports={Tree:i,Node:j}},{"./utils":57}],41:[function(a,b,c){var d=a("./query_engine").QueryEngine,e=a("./quad_backend").QuadBackend,f=a("./persistent_quad_backend").PersistentQuadBackend,g=a("./lexicon").Lexicon,h=a("./persistent_lexicon").PersistentLexicon,i=a("./rdf_model"),j=a("./utils");Store=function(a,b){var c=null,i=null;if(0==arguments.length)i={};else if(1==arguments.length)i={},c=a;else{if(!(arguments.length>1))throw"An optional argument map and a callback must be provided";i=a,c=b}null==i.treeOrder&&(i.treeOrder=15);var j=g,k=e;i.persistent===!0&&(j=h,k=f),this.functionMap={};var l=this;this.customFns={},new j(function(a){var b=function(){new k(i,function(b){var e=function(){i.backend=b,i.lexicon=a,l.engine=new d(i),c(null,l)};i.overwrite?b.clear(e):e()})};i.overwrite===!0?a.clear(b):b()},i.name)},Store.prototype.rdf=i.rdf,Store.prototype.rdf.api=i,Store.prototype.registerCustomFunction=function(a,b){this.customFns[a]=b,this.engine.setCustomFunctions(this.customFns)},Store.prototype.execute=function(){if(3===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(4===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var a,b;if(1===arguments.length){a=arguments[0];var b=function(){}}else 2===arguments.length&&(a=arguments[0],b=arguments[1]);this.engine.execute(a,b)}},Store.prototype.executeWithEnvironment=function(){var a,b,c;if(3===arguments.length){a=arguments[0];var d=function(){};b=arguments[1],c=arguments[2]}else if(4===arguments.length){a=arguments[0];var d=arguments[3];b=arguments[1],c=arguments[2]}b=j.map(b,function(a){return{token:"uri",value:a}}),c=j.map(c,function(a){return{token:"uri",value:a}}),this.engine.execute(a,d,b,c)},Store.prototype.graph=function(){var a=null,b=null;if(1===arguments.length)b=arguments[0]||function(){},a=this.engine.lexicon.defaultGraphUri;else{if(2!==arguments.length)throw"An optional graph URI and a callback function must be provided";b=arguments[1]||function(){},a=arguments[0]}null!=this.rdf.resolve(a)&&(a=this.rdf.resolve(a)),this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",b)},Store.prototype.node=function(){var a=null,b=null,c=null;if(2===arguments.length)c=arguments[0],b=arguments[1]||function(){},a=this.engine.lexicon.defaultGraphUri;else{if(3!==arguments.length)throw"An optional graph URI, node URI and a callback function must be provided";c=arguments[0],a=arguments[1],b=arguments[2]||function(){}}null!=this.rdf.resolve(a)&&(a=this.rdf.resolve(a)),null!=this.rdf.resolve(c)&&(c=this.rdf.resolve(c)),this.engine.execute("CONSTRUCT { <"+c+"> ?p ?o } WHERE { GRAPH <"+a+"> { <"+c+"> ?p ?o } }",b)},Store.prototype.startObservingNode=function(){var a,b,c;2===arguments.length?(a=arguments[0],c=arguments[1],this.engine.callbacksBackend.observeNode(a,c,function(){})):3===arguments.length&&(a=arguments[0],b=arguments[1],c=arguments[2],this.engine.callbacksBackend.observeNode(a,b,c,function(){}))},Store.prototype.stopObservingNode=function(a){this.engine.callbacksBackend.stopObservingNode(a)},Store.prototype.startObservingQuery=function(){var a=arguments[0],b=arguments[1],c=arguments[2];null!=c?this.engine.callbacksBackend.observeQuery(a,b,c):this.engine.callbacksBackend.observeQuery(a,b,function(){})},Store.prototype.stopObservingQuery=function(a){this.engine.callbacksBackend.stopObservingQuery(a)},Store.prototype.subscribe=function(a,b,c,d,e){var f=this,g=function(a,b){var c=[],d={blanks:{},outCache:{}},g=[];j.each(b,function(a){var b=i.buildRDFResource(a.subject,g,f.engine,d),e=i.buildRDFResource(a.predicate,g,f.engine,d),h=i.buildRDFResource(a.object,g,f.engine,d);null!=b&&null!=e&&null!=h&&(a=new i.Triple(b,e,h),c.push(a))}),e(a,c)};this.functionMap[e]=g,this.engine.callbacksBackend.subscribe(a,b,c,d,g,function(){})},Store.prototype.unsubscribe=function(a){var b=this.functionMap[a];this.engine.callbacksBackend.unsubscribe(b),delete this.functionMap[a]},Store.prototype.setPrefix=function(a,b){this.rdf.setPrefix(a,b)},Store.prototype.setDefaultPrefix=function(a){this.rdf.setDefaultPrefix(a)},Store.prototype.insert=function(){var a,b,c;if(1===arguments.length)b=arguments[0],c=function(){};else if(2===arguments.length)b=arguments[0],c=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to insert, an optional graph and callback must be provided";b=arguments[0],a=this.rdf.createNamedNode(arguments[1]),c=arguments[2]||function(){}}var d="",e=this;b.forEach(function(a){d=d+e._nodeToQuery(a.subject)+e._nodeToQuery(a.predicate)+e._nodeToQuery(a.object)+"."}),d=null!=a?"INSERT DATA { GRAPH "+this._nodeToQuery(a)+" { "+d+" } }":"INSERT DATA { "+d+" }",this.engine.execute(d,c)},Store.prototype._nodeToQuery=function(a){if("NamedNode"===a.interfaceName){var b=this.rdf.resolve(a.valueOf());return null!=b?"<"+b+">":"<"+a.valueOf()+">"}return a.toString(!0)},Store.prototype["delete"]=function(){var a,b,c;if(1===arguments.length)b=arguments[0],c=function(){};else if(2===arguments.length)b=arguments[0],c=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to delete, an optional graph and callback must be provided";b=arguments[0],a=this.rdf.createNamedNode(arguments[1]),c=arguments[2]||function(){}}var d="",e=this;b.forEach(function(a){d=d+e._nodeToQuery(a.subject)+e._nodeToQuery(a.predicate)+e._nodeToQuery(a.object)+"."}),d=null!=a?"DELETE DATA { GRAPH "+this._nodeToQuery(a)+" { "+d+" } }":"DELETE DATA { "+d+" }",this.engine.execute(d,c)},Store.prototype.clear=function(){var a,b;if(0===arguments.length){a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);var b=function(){}}else if(1===arguments.length)a=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),b=arguments[0]||function(){};else{if(2!==arguments.length)throw"The optional graph and a callback must be provided";a=this.rdf.createNamedNode(arguments[0]),b=arguments[1]||function(){}}var c="CLEAR GRAPH "+this._nodeToQuery(a);this.engine.execute(c,b)},Store.prototype.setBatchLoadEvents=function(a){this.engine.eventsOnBatchLoad=a},Store.prototype.registerDefaultNamespace=function(a,b){this.rdf.prefixes.set(a,b),this.engine.registerDefaultNamespace(a,b)},Store.prototype.registerDefaultProfileNamespaces=function(){var a=this.rdf.prefixes.values();for(var b in a)this.registerDefaultNamespace(b,a[b])},Store.prototype.load=function(){var a,b,c,d,e={};if(3===arguments.length)c=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),a=arguments[0],b=arguments[1],d=arguments[2]||function(){};else if(4===arguments.length)a=arguments[0],b=arguments[1],e=arguments[2],"string"==typeof e?(c=this.rdf.createNamedNode(e),e={}):(c=this.rdf.createNamedNode(e.graph||this.engine.lexicon.defaultGraphUri),delete e.graph),d=arguments[3]||function(){};else if(2===arguments.length)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if("remote"===a){b=this.rdf.createNamedNode(b);var f="LOAD <"+b.valueOf()+"> INTO GRAPH <"+c.valueOf()+">";this.engine.execute(f,d)}else{var g=this,h=this.engine.rdfLoader.parsers[a];if(!h)return d(new Error("Cannot find parser for the provided media type:"+a));var i=function(a,b){a?d(a,b):g.engine.batchLoad(b,function(a){null!=a?d(null,a):d(new Error("Erro batch-loading triples."))})},j=[h,{token:"uri",value:c.valueOf()},b,e,i];b&&"string"==typeof b&&0===b.indexOf("file://")?this.engine.rdfLoader.loadFromFile.apply(null,j):this.engine.rdfLoader.tryToParse.apply(null,j)}},Store.prototype.registerParser=function(a,b){this.engine.rdfLoader.registerParser(a,b)},Store.prototype.registeredGraphs=function(a){this.engine.lexicon.registeredGraphs(!0,function(b){var c=j.map(b,function(a){return new i.NamedNode(a)});a(null,c)})},Store.prototype.getNetworkTransport=function(){return NetworkTransport},Store.prototype.setNetworkTransport=function(a){NetworkTransport=a},Store.prototype.close=function(a){null==a&&(a=function(){}),this.engine.close?this.engine.close(a):a()},Store.VERSION="0.9.17";var k=function(){var a;(a=1==arguments.length?arguments[0]:2==arguments.length?arguments[1]:arguments[2])(new Error("Store#connect is not supported in the 0.9.X series of the library"))},l=function(){return 1==arguments.length?new Store(arguments[0]):2==arguments.length?new Store(arguments[0],arguments[1]):new Store};Store.yieldFrequency=function(a){j.yieldFrequency(a)},b.exports.Store=Store,b.exports.create=l,b.exports.connect=k},{"./lexicon":44,"./persistent_lexicon":47,"./persistent_quad_backend":48,"./quad_backend":49,"./query_engine":51,"./rdf_model":55,"./utils":57}],42:[function(a,b,c){var d=a("./utils"),e=a("./utils"),f=(a("./quad_index").QuadIndex,a("./quad_index").Pattern),g=a("./rdf_model"),h=a("./abstract_query_tree").AbstractQueryTree;Callbacks={},Callbacks.ANYTHING={token:"var",value:"_"},Callbacks.added="added",Callbacks.deleted="deleted",Callbacks.eventsFlushed="eventsFlushed",Callbacks.CallbacksBackend=function(){this.aqt=new h,this.engine=arguments[0],this.indexMap={},this.observersMap={},this.queriesIndexMap={},this.emptyNotificationsMap={},this.queriesList=[],this.pendingQueries=[],this.matchedQueries=[],this.updateInProgress=null,this.indices=["SPOG","GP","OGS","POG","GSP","OS"],this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},this.callbackCounter=0,this.callbacksMap={},this.callbacksInverseMap={},
this.queryCounter=0,this.queriesMap={},this.queriesCallbacksMap={},this.queriesInverseMap={};for(var a=0;a<this.indices.length;a++){var b=this.indices[a];this.indexMap[b]={},this.queriesIndexMap[b]={}}},Callbacks.CallbacksBackend.prototype.startGraphModification=function(){this.ongoingModification!==!0&&(this.pendingQueries=[].concat(this.queriesList),this.matchedQueries=[],null==this.updateInProgress&&(this.updateInProgress={},this.updateInProgress[Callbacks.added]=[],this.updateInProgress[Callbacks.deleted]=[]))},Callbacks.CallbacksBackend.prototype.nextGraphModification=function(a,b){this.updateInProgress[a].push(b)},Callbacks.CallbacksBackend.prototype.endGraphModification=function(a){if(this.ongoingModification!==!0){var b=this;if(null!=this.updateInProgress){var c=b.updateInProgress;b.updateInProgress=null,this.sendNotification(Callbacks.deleted,c[Callbacks.deleted],function(){b.sendNotification(Callbacks.added,c[Callbacks.added],function(){b.sendEmptyNotification(Callbacks.eventsFlushed,null,function(){b.dispatchQueries(function(){a(!0)})})})})}else a(!0)}else a(!0)},Callbacks.CallbacksBackend.prototype.cancelGraphModification=function(){this.ongoingModification!==!0&&(this.updateInProgress=null)},Callbacks.CallbacksBackend.prototype.sendNotification=function(a,b,c){for(var d={},e=0;e<b.length;e++){var f=b[e];for(var g in this.indexMap){var h=this.indexMap[g],i=this.componentOrders[g];this._searchCallbacksInIndex(h,i,a,f,d),0!=this.pendingQueries.length&&(h=this.queriesIndexMap[g],this._searchQueriesInIndex(h,i,f))}}this.dispatchNotifications(d),null!=c&&c(!0)},Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(a,b,c){for(var d=this.emptyNotificationsMap[a]||[],e=0;e<d.length;e++)d[e](a,b);c()},Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(a){for(var b in a){var c=this.callbacksMap[b],d=a[b][Callbacks.deleted];if(null!=d)try{c(Callbacks.deleted,d)}catch(e){}for(var f in a[b])if(f!=Callbacks.deleted)try{c(f,a[b][f])}catch(e){}}},Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(a,b,c,d,e){for(var f=d[1],d=d[0],g=0;g<b.length+1;g++){for(var h=a._||[],i=[],j=0;j<h.length;j++){var k=h[j];null!=this.callbacksMap[k]&&(e[k]=e[k]||{},e[k][c]=e[k][c]||[],e[k][c].push(d),i.push(k))}a._=i;var l=b[g];if(null==a[""+f[l]])break;a=a[""+f[l]]}},Callbacks.CallbacksBackend.prototype.subscribeEmpty=function(a,b){var c=this.emptyNotificationsMap[a]||[];c.push(b),this.emptyNotificationsMap[a]=c},Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(a,b){var c=this.emptyNotificationsMap[a];null!=c&&(c=d.reject(c,function(a){return a===b})),this.emptyNotificationsMap[a]=c},Callbacks.CallbacksBackend.prototype.subscribe=function(a,b,c,d,e,g){var h=this._tokenizeComponents(a,b,c,d),i={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,i);var j=this;this.engine.normalizeQuad(h,i,!0,function(a){for(var b=new f(a),c=j._indexForPattern(b),d=j.componentOrders[c],h=j.indexMap[c],i=0;i<d.length;i++){var k=d[i],l=a[k];if("_"===l){null==h._&&(h._=[]),j.callbackCounter++,h._.push(j.callbackCounter),j.callbacksMap[j.callbackCounter]=e,j.callbacksInverseMap[e]=j.callbackCounter;break}i===d.length-1?(h[l]=h[l]||{_:[]},j.callbackCounter++,h[l]._.push(j.callbackCounter),j.callbacksMap[j.callbackCounter]=e,j.callbacksInverseMap[e]=j.callbackCounter):(h[l]=h[l]||{},h=h[l])}null!=g&&g(!0)})},Callbacks.CallbacksBackend.prototype.unsubscribe=function(a){var b=this.callbacksInverseMap[a];null!=b&&(delete this.callbacksInverseMap[a],delete this.callbacksMap[b])},Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(a,b,c,d){var e={};return null==a?e.subject=Callbacks.ANYTHING:0==a.indexOf("_:")?e.subject={token:"blank",value:a}:e.subject={token:"uri",value:a},null==b?e.predicate=Callbacks.ANYTHING:e.predicate={token:"uri",value:b},null==c?e.object=Callbacks.ANYTHING:e.object={token:"uri",value:c},null==d?e.graph=Callbacks.ANYTHING:e.graph={token:"uri",value:d},e},Callbacks.CallbacksBackend.prototype._indexForPattern=function(a){for(var b=a.indexKey,c=this.indices,e=0;e<c.length;e++)for(var f=c[e],g=this.componentOrders[f],h=0;h<g.length&&d.include(b,g[h])!==!1;h++)if(h==b.length-1)return f;return"SPOG"},Callbacks.CallbacksBackend.prototype.observeNode=function(){var a,b,c,d;4===arguments.length?(a=arguments[0],b=arguments[1],c=arguments[2],d=arguments[3]):(a=arguments[0],b=this.engine.lexicon.defaultGraphUri,c=arguments[1],d=arguments[2]);var e="CONSTRUCT { <"+a+"> ?p ?o } WHERE { GRAPH <"+b+"> { <"+a+"> ?p ?o } }",f=this,h={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,h);var i=[];this.engine.execute(e,function(b,e){if(b)d&&d(!1);else{var j=e,k=!1,l=function(a,b){if("eventsFlushed"===a&&k){k=!1;try{c(j)}catch(d){}}else if("eventsFlushed"!==a){k=!0;for(var e=0;e<b.length;e++){var l=b[e],m=g.buildRDFResource(l.subject,i,f.engine,h),n=g.buildRDFResource(l.predicate,i,f.engine,h),o=g.buildRDFResource(l.object,i,f.engine,h);null!=m&&null!=n&&null!=o&&(l=new g.Triple(m,n,o),a===Callbacks.added?j.add(l):a===Callbacks.deleted&&j.remove(l))}}};f.observersMap[c]=l,f.subscribeEmpty(Callbacks.eventsFlushed,l),f.subscribe(a,null,null,null,l,function(){try{c(j)}catch(a){}d&&d(!0)})}})},Callbacks.CallbacksBackend.prototype.stopObservingNode=function(a){var b=this.observersMap[a];return b?(this.unsubscribe(b),this.unsubscribeEmpty(Callbacks.eventsFlushed,b),!0):!1},Callbacks.CallbacksBackend.prototype.observeQuery=function(a,b,c){var d=this.aqt.parseQueryString(a),g=this.aqt.parseSelect(d.units[0]),h=this.aqt.collectBasicTriples(g),i=this,j={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,j);var k=this.queryCounter;this.queryCounter++,this.queriesMap[k]=a,this.queriesInverseMap[a]=k,this.queriesList.push(k),this.queriesCallbacksMap[k]=b,e.eachSeries(h,function(a,b){null==a.graph&&(a.graph=i.engine.lexicon.defaultGraphUriTerm),i.engine.normalizeQuad(a,j,!0,function(a){for(var c=new f(a),d=i._indexForPattern(c),e=i.componentOrders[d],g=i.queriesIndexMap[d],h=0;h<e.length;h++){var j=e[h],l=a[j];if("string"==typeof l){null==g._&&(g._=[]),g._.push(k);break}h===e.length-1?(g[l]=g[l]||{_:[]},g[l]._.push(k)):(g[l]=g[l]||{},g=g[l])}b()})},function(){i.engine.execute(a,function(a,c){a?console.log("ERROR in query callback "+c):b(c)}),null!=c&&c()})},Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(a){var b=this.queriesInverseMap[a];null!=b&&(delete this.queriesInverseMap[a],delete this.queriesMap[b],this.queriesList=d.reject(this.queriesList,function(a){return a===b}))},Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(a,b,c){for(var e=c[1],c=c[0],f=0;f<b.length+1;f++){for(var g=a._||[],h=[],i=0;i<g.length;i++){var j=g[i];d.include(this.pendingQueries,j)&&(d.remove(this.pendingQueries,function(a){return a===j}),this.matchedQueries.push(j)),null!=this.queriesMap[j]&&h.push(j)}a._=h;var k=b[f];if(null==a[""+e[k]])break;a=a[""+e[k]]}},Callbacks.CallbacksBackend.prototype.dispatchQueries=function(a){var b,c,d=this,f={};e.eachSeries(this.matchedQueries,function(a,e){null==f[a]?(f[a]=!0,b=d.queriesMap[a],c=d.queriesCallbacksMap[a],d.engine.execute(b,function(a,b){if(!a)try{c(b)}catch(d){}e()})):e()},function(){a()})},Callbacks.CallbacksBackend.added=Callbacks.added,Callbacks.CallbacksBackend.deleted=Callbacks.deleted,Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed,b.exports=Callbacks},{"./abstract_query_tree":39,"./quad_index":50,"./rdf_model":55,"./utils":57}],43:[function(a,b,c){var d=a("jsonld"),e=function(a,b,c){var e=null;d.normalize(a,{},function(a,d){if(a)c(a);else{var f=function(a){return"blank node"===a.type?{blank:a.value}:"IRI"===a.type?{token:"uri",value:a.value}:"literal"===a.type?null!=a.language?{literal:'"'+a.value+'"@'+a.language}:null!==a.datatype?{literal:'"'+a.value+'"^^<'+a.datatype+">"}:{literal:'"'+a.value+'"'}:void 0};e=[];var g=function(a,c,d){e.push({subject:f(a),predicate:f(c),object:f(d),graph:b})};for(var h in d)for(var i=d[h],j=0;j<i.length;j++){var k=i[j];g(k.subject,k.predicate,k.object)}c(null,e)}})};c.JSONLDParser={};var f=c.JSONLDParser;f.parser={async:!0,parse:function(a,b,c,d){try{"string"==typeof a&&(a=JSON.parse(a)),e(a,b,d)}catch(f){d(f)}}},b.exports={JSONLDParser:f}},{jsonld:26}],44:[function(a,b,c){var d=a("./utils"),e=a("./btree").Tree;Lexicon=function(a){var b=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,d.seq(function(a){new e(2,function(c){b.uris=c,a()})},function(a){new e(2,function(c){b.literals=c,a()})},function(a){new e(2,function(c){b.knownGraphs=c,a()})},function(a){new e(2,function(c){b.oidUris=c,a()})},function(a){new e(2,function(c){b.oidLiterals=c,a()})},function(a){new e(2,function(c){b.oidBlanks=c,a()})})(function(){null!=a&&a(b)})},Lexicon.prototype.registerGraph=function(a,b,c){a!=this.defaultGraphOid?this.knownGraphs.insert(a,b,function(){c()}):c()},Lexicon.prototype.registeredGraphs=function(a,b){var c=[];this.knownGraphs.walk(function(b){a===!0?c.push(b.data):c.push(b.key)},function(){b(c)})},Lexicon.prototype.registerUri=function(a,b){var c=this;a===this.defaultGraphUri?b(this.defaultGraphOid):this.uris.search(a,function(e){if(null==e){var f=c.oidCounter,g="u"+f;c.oidCounter++,d.seq(function(b){c.uris.insert(a,[f,0],function(){b()})},function(b){c.oidUris.insert(g,a,function(){b()})})(function(){b(f)})}else f=e[0],e[1]=e[1]+1,b(f)})},Lexicon.prototype.resolveUri=function(a,b){a===this.defaultGraphUri?b(this.defaultGraphOid):this.uris.search(a,function(a){b(null!=a?a[0]:-1)})},Lexicon.prototype.resolveUriCost=function(a,b){a===this.defaultGraphUri?b(0):this.uris.search(a,function(a){b(null!=a?a[1]:-1)})},Lexicon.prototype.registerBlank=function(a){var b=this.oidCounter;this.oidCounter++;var c=""+b;this.oidBlanks.insert(c,c,function(){a(b)})},Lexicon.prototype.resolveBlank=function(a,b){var c=this;this.oidBlanks.search(a,function(a){if(null!=a)b(a);else{var d=c.oidCounter;this.oidCounter++,b(""+d)}})},Lexicon.prototype.resolveBlankCost=function(a,b){b(0)},Lexicon.prototype.registerLiteral=function(a,b){var c=this;this.literals.search(a,function(e){if(null==e){var f=c.oidCounter,g="l"+f;c.oidCounter++,d.seq(function(b){c.literals.insert(a,[f,0],function(){b()})},function(b){c.oidLiterals.insert(g,a,function(){b()})})(function(){b(f)})}else{var f=e[0];e[1]=e[1]+1,b(f)}})},Lexicon.prototype.resolveLiteral=function(a,b){this.literals.search(a,function(a){b(null!=a?a[0]:-1)})},Lexicon.prototype.resolveLiteralCost=function(a,b){this.literals.search(a,function(a){b(null!=a?a[1]:-1)})},Lexicon.prototype.parseLiteral=function(a){var b=a.lastIndexOf("@");if(-1!=b&&'"'===a[b-1]&&null!=a.substring(b,a.length).match(/^@[a-zA-Z\-]+$/g)){var c=a.substring(1,b-1),d=a.substring(b+1,a.length);return{token:"literal",value:c,lang:d}}var b=a.lastIndexOf("^^");if(-1!=b&&'"'===a[b-1]&&"<"===a[b+2]&&">"===a[a.length-1]){var c=a.substring(1,b-1),e=a.substring(b+3,a.length-1);return{token:"literal",value:c,type:e}}var c=a.substring(1,a.length-1);return{token:"literal",value:c}},Lexicon.prototype.parseUri=function(a){return{token:"uri",value:a}},Lexicon.prototype.retrieve=function(a,b){var c=this;a===this.defaultGraphOid?b({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):d.seq(function(b,d){c.oidUris.search("u"+a,function(a){null!=a?d(null,c.parseUri(a)):d(null,null)})},function(b,d){null==b?c.oidLiterals.search("l"+a,function(a){null!=a?d(null,c.parseLiteral(a)):d(null,null)}):d(null,b)},function(b,d){null==b?c.oidBlanks.search(""+a,function(b){null!=b?d(null,{token:"blank",value:"_:"+a}):d(null,null)}):d(null,b)})(null,function(a,c){b(c)})},Lexicon.prototype.clear=function(a){var b=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,d.seq(function(a){new e(2,function(c){b.uris=c,a()})},function(a){new e(2,function(c){b.literals=c,a()})},function(a){new e(2,function(c){b.knownGraphs=c,a()})},function(a){new e(2,function(c){b.oidUris=c,a()})},function(a){new e(2,function(c){b.oidLiterals=c,a()})},function(a){new e(2,function(c){b.oidBlanks=c,a()})})(function(){null!=a&&a()})},Lexicon.prototype.unregister=function(a,b,c){var e=this;d.seq(function(c){e._unregisterTerm(a.subject.token,b.subject,c)},function(c){e._unregisterTerm(a.predicate.token,b.predicate,c)},function(c){e._unregisterTerm(a.object.token,b.object,c)},function(c){null!=a.graph?e._unregisterTerm(a.graph.token,b.graph,c):c()})(function(){c(!0)})},Lexicon.prototype._unregisterTerm=function(a,b,c){var e=this;if("uri"===a)if(b!=this.defaultGraphOid){var f="u"+b;e.oidUris.search(f,function(a){e.uris.search(a,function(g){var h=g[1];""+g[0]==""+b?0===h?d.seq(function(a){e.oidUris["delete"](f,function(){a()})},function(b){e.uris["delete"](a,function(){b()})},function(a){e.knownGraphs["delete"](b,function(){a()})})(function(){c()}):e.uris.insert(a,[b,h-1],function(){c()}):c()})})}else c();else if("literal"===a){this.oidCounter++;var f="l"+b;e.oidLiterals.search(f,function(a){e.literals.search(a,function(g){var h=g[1];""+g[0]==""+b?0===h?d.seq(function(a){e.oidLiterals["delete"](f,function(){a()})},function(b){e.literals["delete"](a,function(){b()})})(function(){c()}):e.literals.insert(a,[b,h-1],function(){c()}):c()})})}else"blank"===a?e.oidBlanks["delete"](""+b,function(){c()}):c()},b.exports={Lexicon:Lexicon}},{"./btree":40,"./utils":57}],45:[function(a,b,c){var d=a("./utils");if(!d.isWorker()){var e=a("http"),f=a("https"),g=a("url");NetworkTransport={load:function(a,b,c,d){var h=null==d?3:d,i=g.parse(a,!0,!0),j={host:i.host,hostname:i.hostname,method:"GET",path:i.path,headers:{host:i.hostname,Accept:b}},k=null;"http:"===i.protocol?(j.port=i.port||80,k=e):"https:"===i.protocol&&(j.port=i.port||443,k=f);var l=k.request(j,function(a){var d=a.headers,e="";if("2"==(""+a.statusCode)[0])a.on("end",function(){c(null,{headers:d,data:e})}),a.on("data",function(a){e+=a});else if("3"==(""+a.statusCode)[0])if(0==h)c(new Error("Too many redirections"));else{var f=d.Location||d.location;null!=f?NetworkTransport.load(f,b,c,h-1):c(new Error("Redirection without location header"))}else c(new Error("HTTP error: "+a.statusCode))});l.on("error",c),l.end()}},b.exports={NetworkTransport:NetworkTransport}}},{"./utils":57,http:7,https:22,url:36}],46:[function(a,b,c){b.exports=function(){"use strict";function a(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function b(a,c,d,e){this.message=a,this.expected=c,this.found=d,this.location=e,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,b)}function c(a,c){function d(a,b){return{type:"literal",text:a,ignoreCase:b}}function e(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function f(){return{type:"end"}}function g(a){return{type:"other",description:a}}function h(b){var c,d=$q[b];if(d)return d;for(c=b-1;!$q[c];)c--;for(d=$q[c],d={line:d.line,column:d.column};b>c;)10===a.charCodeAt(c)?(d.line++,d.column=1):d.column++,c++;return $q[b]=d,d}function i(a,b){var c=h(a),d=h(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function j(a){_q>Yq||(Yq>_q&&(_q=Yq,ar=[]),ar.push(a))}function k(a,c,d){return new b(b.buildMessage(a,c),a,c,d)}function l(){var a;return a=m()}function m(){var a;return a=n(),a===xc&&(a=Q()),a}function n(){var a,b;return br++,a=o(),br--,a===xc&&(b=xc,0===br&&j(Ac)),a}function o(){var a,b,c,d;return br++,a=Yq,b=p(),b!==xc?(c=s(),c===xc&&(c=v(),c===xc&&(c=w(),c===xc&&(c=x()))),c!==xc?(d=P(),d!==xc?(Zq=a,b=Cc(b,c,d),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(Bc)),a}function p(){var a,b,c,d,e;if(br++,a=Yq,b=q(),b===xc&&(b=null),b!==xc){for(c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc){for(d=[],e=r();e!==xc;)d.push(e),e=r();d!==xc?(Zq=a,b=Ec(b,d),a=b):(Yq=a,a=xc)}else Yq=a,a=xc}else Yq=a,a=xc;return br--,a===xc&&(b=xc,0===br&&j(Dc)),a}function q(){var b,c,d,e,f;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,4)===Gc?(d=Gc,Yq+=4):(d=xc,0===br&&j(Hc)),d===xc&&(a.substr(Yq,4)===Ic?(d=Ic,Yq+=4):(d=xc,0===br&&j(Jc))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(f=Ob(),f!==xc?(Zq=b,c=Kc(f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Fc)),b}function r(){var b,c,d,e,f,g,h;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,6)===Mc?(d=Mc,Yq+=6):(d=xc,0===br&&j(Nc)),d===xc&&(a.substr(Yq,6)===Oc?(d=Oc,Yq+=6):(d=xc,0===br&&j(Pc))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=Pb(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=Ob(),h!==xc?(Zq=b,c=Qc(f,h),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Lc)),b}function s(){var a,b,c,d,e,f,g,h,i,k;if(br++,a=Yq,b=u(),b!==xc){for(c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc){for(d=[],e=y();e!==xc;)d.push(e),e=y();if(d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=C(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(h=D(),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=N(),k!==xc?(Zq=a,b=Sc(b,d,f,h),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc}else Yq=a,a=xc;else Yq=a,a=xc}else Yq=a,a=xc}else Yq=a,a=xc}else Yq=a,a=xc;return br--,a===xc&&(b=xc,0===br&&j(Rc)),a}function t(){var a,b,c,d;return br++,a=Yq,b=u(),b!==xc?(c=C(),c!==xc?(d=D(),d!==xc?(Zq=a,b=Uc(b,c,d),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(Tc)),a}function u(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,6)===Wc?(d=Wc,Yq+=6):(d=xc,0===br&&j(Xc)),d===xc&&(a.substr(Yq,6)===Yc?(d=Yc,Yq+=6):(d=xc,0===br&&j(Zc))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(a.substr(Yq,8)===$c?(f=$c,Yq+=8):(f=xc,0===br&&j(_c)),f===xc&&(a.substr(Yq,8)===ad?(f=ad,Yq+=8):(f=xc,0===br&&j(bd))),f===xc&&(a.substr(Yq,7)===cd?(f=cd,Yq+=7):(f=xc,0===br&&j(dd)),f===xc&&(a.substr(Yq,7)===ed?(f=ed,Yq+=7):(f=xc,0===br&&j(fd)))),f===xc&&(f=null),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc){for(h=[],i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=lb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(k=[k,l,m],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc;if(i===xc){for(i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(40===a.charCodeAt(Yq)?(l=gd,Yq++):(l=xc,0===br&&j(hd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc)if(n=nb(),n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(a.substr(Yq,2)===id?(p=id,Yq+=2):(p=xc,0===br&&j(jd)),p===xc&&(a.substr(Yq,2)===kd?(p=kd,Yq+=2):(p=xc,0===br&&j(ld))),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();if(q!==xc)if(r=lb(),r!==xc){for(s=[],t=jc();t!==xc;)s.push(t),t=jc();if(s!==xc)if(41===a.charCodeAt(Yq)?(t=md,Yq++):(t=xc,0===br&&j(nd)),t!==xc){for(u=[],v=jc();v!==xc;)u.push(v),v=jc();u!==xc?(k=[k,l,m,n,o,p,q,r,s,t,u],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}if(i!==xc)for(;i!==xc;){for(h.push(i),i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=lb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(k=[k,l,m],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc;if(i===xc){for(i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(40===a.charCodeAt(Yq)?(l=gd,Yq++):(l=xc,0===br&&j(hd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc)if(n=nb(),n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(a.substr(Yq,2)===id?(p=id,Yq+=2):(p=xc,0===br&&j(jd)),p===xc&&(a.substr(Yq,2)===kd?(p=kd,Yq+=2):(p=xc,0===br&&j(ld))),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();if(q!==xc)if(r=lb(),r!==xc){for(s=[],t=jc();t!==xc;)s.push(t),t=jc();if(s!==xc)if(41===a.charCodeAt(Yq)?(t=md,Yq++):(t=xc,0===br&&j(nd)),t!==xc){for(u=[],v=jc();v!==xc;)u.push(v),v=jc();u!==xc?(k=[k,l,m,n,o,p,q,r,s,t,u],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc}}else h=xc;if(h===xc){for(h=Yq,i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(42===a.charCodeAt(Yq)?(k=od,Yq++):(k=xc,0===br&&j(pd)),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)}else Yq=h,h=xc;else Yq=h,h=xc}h!==xc?(Zq=b,c=qd(f,h),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Vc)),b}function v(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,9)===sd?(d=sd,Yq+=9):(d=xc,0===br&&j(td)),d===xc&&(a.substr(Yq,9)===ud?(d=ud,Yq+=9):(d=xc,0===br&&j(vd))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=Da(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc){for(h=[],i=y();i!==xc;)h.push(i),i=y();if(h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(k=C(),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();l!==xc?(m=D(),m!==xc?(Zq=b,c=wd(f,h,k,m),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,9)===sd?(d=sd,Yq+=9):(d=xc,0===br&&j(td)),d===xc&&(a.substr(Yq,9)===ud?(d=ud,Yq+=9):(d=xc,0===br&&j(vd))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc){for(f=[],g=y();g!==xc;)f.push(g),g=y();if(f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(a.substr(Yq,5)===xd?(h=xd,Yq+=5):(h=xc,0===br&&j(yd)),h===xc&&(a.substr(Yq,5)===zd?(h=zd,Yq+=5):(h=xc,0===br&&j(Ad))),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(123===a.charCodeAt(Yq)?(k=Bd,Yq++):(k=xc,0===br&&j(Cd)),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();if(l!==xc)if(m=ia(),m===xc&&(m=null),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();if(n!==xc)if(125===a.charCodeAt(Yq)?(o=Dd,Yq++):(o=xc,0===br&&j(Ed)),o!==xc){for(p=[],q=jc();q!==xc;)p.push(q),q=jc();p!==xc?(q=D(),q!==xc?(Zq=b,c=Fd(f,m,q),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}return br--,b===xc&&(c=xc,0===br&&j(rd)),b}function w(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,8)===Hd?(c=Hd,Yq+=8):(c=xc,0===br&&j(Id)),c!==xc){if(d=[],e=kb(),e!==xc)for(;e!==xc;)d.push(e),e=kb();else d=xc;if(d===xc&&(42===a.charCodeAt(Yq)?(d=od,Yq++):(d=xc,0===br&&j(pd))),d!==xc){for(e=[],f=y();f!==xc;)e.push(f),f=y();e!==xc?(f=C(),f===xc&&(f=null),f!==xc?(g=D(),g!==xc?(c=[c,d,e,f,g],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Gd)),b}function x(){var b,c,d,e,f,g,h;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,3)===Kd?(d=Kd,Yq+=3):(d=xc,0===br&&j(Ld)),d===xc&&(a.substr(Yq,3)===Md?(d=Md,Yq+=3):(d=xc,0===br&&j(Nd))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc){for(f=[],g=y();g!==xc;)f.push(g),g=y();if(f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=C(),h!==xc?(Zq=b,c=Od(f,h),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Jd)),b}function y(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,4)===Qd?(c=Qd,Yq+=4):(c=xc,0===br&&j(Rd)),c===xc&&(a.substr(Yq,4)===Sd?(c=Sd,Yq+=4):(c=xc,0===br&&j(Td))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=z(),e===xc&&(e=A()),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(Zq=b,c=Ud(e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Pd)),b}function z(){var a,b,c;for(br++,a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();return b!==xc?(c=B(),c!==xc?(Zq=a,b=Wd(c),a=b):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(Vd)),a}function A(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,5)===Yd?(c=Yd,Yq+=5):(c=xc,0===br&&j(Zd)),c===xc&&(a.substr(Yq,5)===$d?(c=$d,Yq+=5):(c=xc,0===br&&j(_d))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=B(),e!==xc?(Zq=b,c=ae(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Xd)),b}function B(){var a,b;return br++,a=Lb(),br--,a===xc&&(b=xc,0===br&&j(be)),a}function C(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,5)===xd?(c=xd,Yq+=5):(c=xc,0===br&&j(yd)),c===xc&&(a.substr(Yq,5)===zd?(c=zd,Yq+=5):(c=xc,0===br&&j(Ad))),c===xc&&(c=null),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=ja(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(Zq=b,c=de(e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ce)),b}function D(){var a,b,c,d,e;return br++,a=Yq,b=E(),b===xc&&(b=null),b!==xc?(c=G(),c===xc&&(c=null),c!==xc?(d=I(),d===xc&&(d=null),d!==xc?(e=K(),e===xc&&(e=null),e!==xc?(Zq=a,b=fe(b,d,e),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(ee)),a}function E(){var b,c,d,e,f,g,h;if(br++,b=Yq,a.substr(Yq,5)===he?(c=he,Yq+=5):(c=xc,0===br&&j(ie)),c===xc&&(a.substr(Yq,5)===je?(c=je,Yq+=5):(c=xc,0===br&&j(ke))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,2)===le?(e=le,Yq+=2):(e=xc,0===br&&j(me)),e===xc&&(a.substr(Yq,2)===ne?(e=ne,Yq+=2):(e=xc,0===br&&j(oe))),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){if(g=[],h=F(),h!==xc)for(;h!==xc;)g.push(h),h=F();else g=xc;g!==xc?(Zq=b,c=pe(g),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ge)),b}function F(){var b,c,d,e,f,g,h,i,k,l,m;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=yb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(Zq=b,c=re(d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=Aa(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(Zq=b,c=se(d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(40===a.charCodeAt(Yq)?(d=gd,Yq++):(d=xc,0===br&&j(hd)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=nb(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc){if(h=Yq,a.substr(Yq,2)===id?(i=id,Yq+=2):(i=xc,0===br&&j(jd)),i===xc&&(a.substr(Yq,2)===kd?(i=kd,Yq+=2):(i=xc,0===br&&j(ld))),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=lb(),l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)}else Yq=h,h=xc;if(h===xc&&(h=null),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(41===a.charCodeAt(Yq)?(k=md,Yq++):(k=xc,0===br&&j(nd)),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();l!==xc?(Zq=b,c=te(f,h),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=lb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(Zq=b,c=ue(d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}}}return br--,b===xc&&(c=xc,0===br&&j(qe)),b}function G(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,6)===we?(c=we,Yq+=6):(c=xc,0===br&&j(xe)),c!==xc){if(d=[],e=H(),e!==xc)for(;e!==xc;)d.push(e),e=H();else d=xc;d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ve)),b}function H(){var a,b;return br++,a=ua(),br--,a===xc&&(b=xc,0===br&&j(ye)),a}function I(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,a.substr(Yq,5)===Ae?(c=Ae,Yq+=5):(c=xc,0===br&&j(Be)),c===xc&&(a.substr(Yq,5)===Ce?(c=Ce,Yq+=5):(c=xc,0===br&&j(De))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,2)===le?(e=le,Yq+=2):(e=xc,0===br&&j(me)),e===xc&&(a.substr(Yq,2)===ne?(e=ne,Yq+=2):(e=xc,0===br&&j(oe))),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){if(g=[],h=J(),h!==xc)for(;h!==xc;)g.push(h),h=J();else g=xc;if(g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(Zq=b,c=Ee(g),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ze)),b}function J(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,3)===Ge?(c=Ge,Yq+=3):(c=xc,0===br&&j(He)),c===xc&&(a.substr(Yq,3)===Ie?(c=Ie,Yq+=3):(c=xc,0===br&&j(Je)),c===xc&&(a.substr(Yq,4)===Ke?(c=Ke,Yq+=4):(c=xc,0===br&&j(Le)),c===xc&&(a.substr(Yq,4)===Me?(c=Me,Yq+=4):(c=xc,0===br&&j(Ne))))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=xb(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(Zq=b,c=Oe(c,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc)if(b=Yq,c=ua(),c===xc&&(c=lb()),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(Zq=b,c=Pe(c),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Fe)),b}function K(){var a,b,c,d;return br++,a=Yq,b=Yq,c=L(),c!==xc?(d=M(),d===xc&&(d=null),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc),b===xc&&(b=Yq,c=M(),c!==xc?(d=L(),d===xc&&(d=null),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)),b!==xc&&(Zq=a,b=Re(b)),a=b,br--,a===xc&&(b=xc,0===br&&j(Qe)),a}function L(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,5)===Te?(c=Te,Yq+=5):(c=xc,0===br&&j(Ue)),c===xc&&(a.substr(Yq,5)===Ve?(c=Ve,Yq+=5):(c=xc,0===br&&j(We))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Vb(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(Zq=b,c=Xe(e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Se)),b}function M(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,6)===Ze?(c=Ze,Yq+=6):(c=xc,0===br&&j($e)),c===xc&&(a.substr(Yq,6)===_e?(c=_e,Yq+=6):(c=xc,0===br&&j(af))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Vb(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(Zq=b,c=bf(e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ye)),b}function N(){var b,c,d,e,f,g,h,i,k;if(br++,b=Yq,a.substr(Yq,8)===df?(c=df,Yq+=8):(c=xc,0===br&&j(ef)),c!==xc){for(d=[],e=lb();e!==xc;)d.push(e),e=lb();if(d!==xc)if(123===a.charCodeAt(Yq)?(e=Bd,Yq++):(e=xc,0===br&&j(Cd)),e!==xc){if(f=[],g=Yq,40===a.charCodeAt(Yq)?(h=gd,Yq++):(h=xc,0===br&&j(hd)),h!==xc){if(i=[],k=O(),k!==xc)for(;k!==xc;)i.push(k),k=O();else i=xc;i!==xc?(41===a.charCodeAt(Yq)?(k=md,Yq++):(k=xc,0===br&&j(nd)),k!==xc?(h=[h,i,k],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;for(g===xc&&(g=ic());g!==xc;){if(f.push(g),g=Yq,40===a.charCodeAt(Yq)?(h=gd,Yq++):(h=xc,0===br&&j(hd)),h!==xc){if(i=[],k=O(),k!==xc)for(;k!==xc;)i.push(k),k=O();else i=xc;i!==xc?(41===a.charCodeAt(Yq)?(k=md,Yq++):(k=xc,0===br&&j(nd)),k!==xc?(h=[h,i,k],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;g===xc&&(g=ic())}f!==xc?(125===a.charCodeAt(Yq)?(g=Dd,Yq++):(g=xc,0===br&&j(Ed)),g!==xc?(c=[c,d,e,f,g],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return b===xc&&(b=null),br--,b===xc&&(c=xc,0===br&&j(cf)),b}function O(){var b,c;return br++,b=Lb(),b===xc&&(b=Eb(),b===xc&&(b=Fb(),b===xc&&(b=Jb(),b===xc&&(a.substr(Yq,5)===gf?(b=gf,Yq+=5):(b=xc,0===br&&j(hf)))))),br--,b===xc&&(c=xc,0===br&&j(ff)),b}function P(){var b,c,d,e;return br++,b=Yq,c=Yq,a.substr(Yq,6)===kf?(d=kf,Yq+=6):(d=xc,0===br&&j(lf)),d===xc&&(a.substr(Yq,6)===mf?(d=mf,Yq+=6):(d=xc,0===br&&j(nf))),d!==xc?(e=wa(),e!==xc?(d=[d,e],c=d):(Yq=c,c=xc)):(Yq=c,c=xc),c===xc&&(c=null),c!==xc&&(Zq=b,c=of(c)),b=c,br--,b===xc&&(c=xc,0===br&&j(jf)),b}function Q(){var a,b;return br++,a=R(),br--,a===xc&&(b=xc,0===br&&j(pf)),a}function R(){var b,c,d,e,f,g,h,i,k;if(br++,b=Yq,c=p(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),
e=jc();if(d!==xc)if(e=S(),e!==xc){for(f=Yq,g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(59===a.charCodeAt(Yq)?(h=rf,Yq++):(h=xc,0===br&&j(sf)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=R(),k===xc&&(k=null),k!==xc?(g=[g,h,i,k],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;else Yq=f,f=xc;f===xc&&(f=null),f!==xc?(Zq=b,c=tf(c,e,f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(qf)),b}function S(){var a,b;return br++,a=T(),a===xc&&(a=U(),a===xc&&(a=V(),a===xc&&(a=W(),a===xc&&(a=X(),a===xc&&(a=Y(),a===xc&&(a=Z(),a===xc&&(a=$()))))))),br--,a===xc&&(b=xc,0===br&&j(uf)),a}function T(){var b,c,d,e,f,g,h,i,k;if(br++,b=Yq,a.substr(Yq,4)===wf?(c=wf,Yq+=4):(c=xc,0===br&&j(xf)),c===xc&&(a.substr(Yq,4)===yf?(c=yf,Yq+=4):(c=xc,0===br&&j(zf))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Lb(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){if(g=Yq,a.substr(Yq,4)===Af?(h=Af,Yq+=4):(h=xc,0===br&&j(Bf)),h===xc&&(a.substr(Yq,4)===Cf?(h=Cf,Yq+=4):(h=xc,0===br&&j(Df))),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=ca(),k!==xc?(h=[h,i,k],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;g===xc&&(g=null),g!==xc?(Zq=b,c=Ef(e,g),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(vf)),b}function U(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,5)===Gf?(c=Gf,Yq+=5):(c=xc,0===br&&j(Hf)),c===xc&&(a.substr(Yq,5)===If?(c=If,Yq+=5):(c=xc,0===br&&j(Jf))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,6)===Kf?(e=Kf,Yq+=6):(e=xc,0===br&&j(Lf)),e===xc&&(a.substr(Yq,6)===Mf?(e=Mf,Yq+=6):(e=xc,0===br&&j(Nf))),e===xc&&(e=null),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=da(),g!==xc?(Zq=b,c=Of(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ff)),b}function V(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,4)===Qf?(c=Qf,Yq+=4):(c=xc,0===br&&j(Rf)),c===xc&&(a.substr(Yq,4)===Sf?(c=Sf,Yq+=4):(c=xc,0===br&&j(Tf))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,6)===Kf?(e=Kf,Yq+=6):(e=xc,0===br&&j(Lf)),e===xc&&(a.substr(Yq,6)===Mf?(e=Mf,Yq+=6):(e=xc,0===br&&j(Nf))),e===xc&&(e=null),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=da(),g!==xc?(Zq=b,c=Uf(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Pf)),b}function W(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,6)===Wf?(c=Wf,Yq+=6):(c=xc,0===br&&j(Xf)),c===xc&&(a.substr(Yq,6)===Yf?(c=Yf,Yq+=6):(c=xc,0===br&&j(Zf))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,6)===Kf?(e=Kf,Yq+=6):(e=xc,0===br&&j(Lf)),e===xc&&(a.substr(Yq,6)===Mf?(e=Mf,Yq+=6):(e=xc,0===br&&j(Nf))),e===xc&&(e=null),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=ca(),g!==xc?(Zq=b,c=$f(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Vf)),b}function X(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,6)===ag?(c=ag,Yq+=6):(c=xc,0===br&&j(bg)),c===xc&&(a.substr(Yq,6)===cg?(c=cg,Yq+=6):(c=xc,0===br&&j(dg))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,4)===eg?(e=eg,Yq+=4):(e=xc,0===br&&j(fg)),e===xc&&(a.substr(Yq,4)===gg?(e=gg,Yq+=4):(e=xc,0===br&&j(hg))),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=fa(),g!==xc?(Zq=b,c=ig(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(_f)),b}function Y(){var b,c,d,e,f;if(br++,b=Yq,a.substr(Yq,6)===kg?(c=kg,Yq+=6):(c=xc,0===br&&j(lg)),c===xc&&(a.substr(Yq,6)===mg?(c=mg,Yq+=6):(c=xc,0===br&&j(ng))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(a.substr(Yq,4)===eg?(e=eg,Yq+=4):(e=xc,0===br&&j(fg)),e===xc&&(a.substr(Yq,4)===gg?(e=gg,Yq+=4):(e=xc,0===br&&j(hg))),e!==xc?(f=fa(),f!==xc?(Zq=b,c=og(f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(jg)),b}function Z(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,6)===kg?(c=kg,Yq+=6):(c=xc,0===br&&j(lg)),c===xc&&(a.substr(Yq,6)===mg?(c=mg,Yq+=6):(c=xc,0===br&&j(ng))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,5)===xd?(e=xd,Yq+=5):(e=xc,0===br&&j(yd)),e===xc&&(a.substr(Yq,5)===zd?(e=zd,Yq+=5):(e=xc,0===br&&j(Ad))),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=ja(),g!==xc?(Zq=b,c=qg(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(pg)),b}function $(){var b,c,d,e,f,g,h,i,k,l,m,n;if(br++,b=Yq,c=Yq,a.substr(Yq,4)===sg?(d=sg,Yq+=4):(d=xc,0===br&&j(tg)),d===xc&&(a.substr(Yq,4)===ug?(d=ug,Yq+=4):(d=xc,0===br&&j(vg))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(f=Lb(),f!==xc?(d=[d,e,f],c=d):(Yq=c,c=xc)):(Yq=c,c=xc)}else Yq=c,c=xc;if(c===xc&&(c=null),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc){if(e=Yq,f=_(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=aa(),h===xc&&(h=null),h!==xc?(f=[f,g,h],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;if(e===xc&&(e=aa()),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){for(g=[],h=ba();h!==xc;)g.push(h),h=ba();if(g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(a.substr(Yq,5)===xd?(i=xd,Yq+=5):(i=xc,0===br&&j(yd)),i===xc&&(a.substr(Yq,5)===zd?(i=zd,Yq+=5):(i=xc,0===br&&j(Ad))),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=ja(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=wg(c,e,g,l),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(rg)),b}function _(){var b,c,d;return br++,b=Yq,a.substr(Yq,6)===kg?(c=kg,Yq+=6):(c=xc,0===br&&j(lg)),c===xc&&(a.substr(Yq,6)===mg?(c=mg,Yq+=6):(c=xc,0===br&&j(ng))),c!==xc?(d=ea(),d!==xc?(Zq=b,c=yg(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(xg)),b}function aa(){var b,c,d;return br++,b=Yq,a.substr(Yq,6)===ag?(c=ag,Yq+=6):(c=xc,0===br&&j(bg)),c===xc&&(a.substr(Yq,6)===cg?(c=cg,Yq+=6):(c=xc,0===br&&j(dg))),c!==xc?(d=ea(),d!==xc?(Zq=b,c=yg(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(zg)),b}function ba(){var b,c,d,e,f,g,h,i;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,5)===Bg?(d=Bg,Yq+=5):(d=xc,0===br&&j(Cg)),d===xc&&(a.substr(Yq,5)===Dg?(d=Dg,Yq+=5):(d=xc,0===br&&j(Eg))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc){if(f=Lb(),f===xc)if(f=Yq,a.substr(Yq,5)===Yd?(g=Yd,Yq+=5):(g=xc,0===br&&j(Zd)),g===xc&&(a.substr(Yq,5)===$d?(g=$d,Yq+=5):(g=xc,0===br&&j(_d))),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=Lb(),i!==xc?(g=[g,h,i],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;f!==xc?(Zq=b,c=Fg(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ag)),b}function ca(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,5)===Hg?(c=Hg,Yq+=5):(c=xc,0===br&&j(Ig)),c===xc&&(a.substr(Yq,5)===Jg?(c=Jg,Yq+=5):(c=xc,0===br&&j(Kg))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Lb(),e!==xc?(Zq=b,c=Lg(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Gg)),b}function da(){var b,c;return br++,b=Yq,c=ca(),c!==xc&&(Zq=b,c=de(c)),b=c,b===xc&&(b=Yq,a.substr(Yq,7)===Ng?(c=Ng,Yq+=7):(c=xc,0===br&&j(Og)),c===xc&&(a.substr(Yq,7)===Pg?(c=Pg,Yq+=7):(c=xc,0===br&&j(Qg))),c!==xc&&(Zq=b,c=Rg()),b=c,b===xc&&(b=Yq,a.substr(Yq,5)===Yd?(c=Yd,Yq+=5):(c=xc,0===br&&j(Zd)),c===xc&&(a.substr(Yq,5)===$d?(c=$d,Yq+=5):(c=xc,0===br&&j(_d))),c!==xc&&(Zq=b,c=Sg()),b=c,b===xc&&(b=Yq,a.substr(Yq,3)===Tg?(c=Tg,Yq+=3):(c=xc,0===br&&j(Ug)),c===xc&&(a.substr(Yq,3)===Vg?(c=Vg,Yq+=3):(c=xc,0===br&&j(Wg))),c!==xc&&(Zq=b,c=Xg()),b=c))),br--,b===xc&&(c=xc,0===br&&j(Mg)),b}function ea(){var b,c,d,e,f,g,h,i,k;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(123===a.charCodeAt(Yq)?(d=Bd,Yq++):(d=xc,0===br&&j(Cd)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=ga(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(125===a.charCodeAt(Yq)?(h=Dd,Yq++):(h=xc,0===br&&j(Ed)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(Zq=b,c=Zg(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Yg)),b}function fa(){var b,c,d,e,f,g,h,i,k;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(123===a.charCodeAt(Yq)?(d=Bd,Yq++):(d=xc,0===br&&j(Cd)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=ga(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(125===a.charCodeAt(Yq)?(h=Dd,Yq++):(h=xc,0===br&&j(Ed)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(Zq=b,c=Zg(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j($g)),b}function ga(){var b,c,d,e,f,g,h;if(br++,b=Yq,c=ia(),c===xc&&(c=null),c!==xc){for(d=[],e=Yq,f=ha(),f!==xc?(46===a.charCodeAt(Yq)?(g=ah,Yq++):(g=xc,0===br&&j(bh)),g===xc&&(g=null),g!==xc?(h=ia(),h===xc&&(h=null),h!==xc?(f=[f,g,h],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)):(Yq=e,e=xc);e!==xc;)d.push(e),e=Yq,f=ha(),f!==xc?(46===a.charCodeAt(Yq)?(g=ah,Yq++):(g=xc,0===br&&j(bh)),g===xc&&(g=null),g!==xc?(h=ia(),h===xc&&(h=null),h!==xc?(f=[f,g,h],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)):(Yq=e,e=xc);d!==xc?(Zq=b,c=ch(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(_g)),b}function ha(){var b,c,d,e,f,g,h,i,k,l,m,n,o;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,5)===Hg?(d=Hg,Yq+=5):(d=xc,0===br&&j(Ig)),d===xc&&(a.substr(Yq,5)===Jg?(d=Jg,Yq+=5):(d=xc,0===br&&j(Kg))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=kb(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(123===a.charCodeAt(Yq)?(h=Bd,Yq++):(h=xc,0===br&&j(Cd)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(k=ia(),k===xc&&(k=null),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();if(l!==xc)if(125===a.charCodeAt(Yq)?(m=Dd,Yq++):(m=xc,0===br&&j(Ed)),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(Zq=b,c=eh(f,k),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(dh)),b}function ia(){var b,c,d,e,f,g,h;if(br++,b=Yq,c=Fa(),c!==xc){for(d=Yq,e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(46===a.charCodeAt(Yq)?(f=ah,Yq++):(f=xc,0===br&&j(bh)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=ia(),h===xc&&(h=null),h!==xc?(e=[e,f,g,h],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)}else Yq=d,d=xc;else Yq=d,d=xc;d===xc&&(d=null),d!==xc?(Zq=b,c=gh(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(fh)),b}function ja(){var b,c,d,e,f,g;if(br++,b=Yq,123===a.charCodeAt(Yq)?(c=Bd,Yq++):(c=xc,0===br&&j(Cd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=t(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(125===a.charCodeAt(Yq)?(g=Dd,Yq++):(g=xc,0===br&&j(Ed)),g!==xc?(Zq=b,c=ih(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc)if(b=Yq,123===a.charCodeAt(Yq)?(c=Bd,Yq++):(c=xc,0===br&&j(Cd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=ka(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(125===a.charCodeAt(Yq)?(g=Dd,Yq++):(g=xc,0===br&&j(Ed)),g!==xc?(Zq=b,c=ih(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(hh)),b}function ka(){var b,c,d,e,f,g,h,i,k,l;if(br++,b=Yq,c=la(),c===xc&&(c=null),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc){if(e=[],f=Yq,g=ma(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(46===a.charCodeAt(Yq)?(i=ah,Yq++):(i=xc,0===br&&j(bh)),i===xc&&(i=null),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=la(),l===xc&&(l=null),l!==xc?(g=[g,h,i,k,l],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;else Yq=f,f=xc}else Yq=f,f=xc;for(;f!==xc;)if(e.push(f),f=Yq,g=ma(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(46===a.charCodeAt(Yq)?(i=ah,Yq++):(i=xc,0===br&&j(bh)),i===xc&&(i=null),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=la(),l===xc&&(l=null),l!==xc?(g=[g,h,i,k,l],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;else Yq=f,f=xc}else Yq=f,f=xc;e!==xc?(Zq=b,c=kh(c,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(jh)),b}function la(){var b,c,d,e,f,g;if(br++,b=Yq,c=Oa(),c!==xc){for(d=Yq,e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(46===a.charCodeAt(Yq)?(f=ah,Yq++):(f=xc,0===br&&j(bh)),f!==xc?(g=la(),g===xc&&(g=null),g!==xc?(e=[e,f,g],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)):(Yq=d,d=xc),d===xc&&(d=null),d!==xc?(Zq=b,c=mh(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(lh)),b}function ma(){var a,b;return br++,a=ra(),a===xc&&(a=na(),a===xc&&(a=qa(),a===xc&&(a=oa(),a===xc&&(a=pa(),a===xc&&(a=sa(),a===xc&&(a=ta(),a===xc&&(a=va()))))))),br--,a===xc&&(b=xc,0===br&&j(nh)),a}function na(){var b,c,d,e,f;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,8)===ph?(d=ph,Yq+=8):(d=xc,0===br&&j(qh)),d===xc&&(a.substr(Yq,8)===rh?(d=rh,Yq+=8):(d=xc,0===br&&j(sh))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(f=ja(),f!==xc?(Zq=b,c=th(f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(oh)),b}function oa(){var b,c,d,e,f,g,h;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,5)===Hg?(d=Hg,Yq+=5):(d=xc,0===br&&j(Ig)),d===xc&&(a.substr(Yq,5)===Jg?(d=Jg,Yq+=5):(d=xc,0===br&&j(Kg))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=kb(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=ja(),h!==xc?(Zq=b,c=vh(f,h),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(uh)),b}function pa(){var b,c,d,e;return br++,b=Yq,a.substr(Yq,7)===xh?(c=xh,Yq+=7):(c=xc,0===br&&j(yh)),c!==xc?(d=kb(),d!==xc?(e=ja(),e!==xc?(Zq=b,c=zh(d,e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(wh)),b}function qa(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,5)===Bh?(c=Bh,Yq+=5):(c=xc,0===br&&j(Ch)),c===xc&&(a.substr(Yq,5)===Dh?(c=Dh,Yq+=5):(c=xc,0===br&&j(Eh))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=ja(),e!==xc?(Zq=b,c=Fh(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ah)),b}function ra(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=ja(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,5)===Hh?(g=Hh,Yq+=5):(g=xc,0===br&&j(Ih)),g===xc&&(a.substr(Yq,5)===Jh?(g=Jh,Yq+=5):(g=xc,0===br&&j(Kh))),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ja(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,5)===Hh?(g=Hh,Yq+=5):(g=xc,0===br&&j(Ih)),g===xc&&(a.substr(Yq,5)===Jh?(g=Jh,Yq+=5):(g=xc,0===br&&j(Kh))),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ja(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}d!==xc?(Zq=b,c=Lh(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Gh)),b}function sa(){var b,c,d,e,f;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,6)===Nh?(d=Nh,Yq+=6):(d=xc,0===br&&j(Oh)),d===xc&&(a.substr(Yq,6)===Ph?(d=Ph,Yq+=6):(d=xc,0===br&&j(Qh))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(f=ua(),f!==xc?(Zq=b,c=Rh(f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Mh)),b}function ta(){var b,c,d,e,f,g,h,i,k,l,m,n,o;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,4)===Th?(d=Th,Yq+=4):(d=xc,0===br&&j(Uh)),d===xc&&(a.substr(Yq,4)===Vh?(d=Vh,Yq+=4):(d=xc,0===br&&j(Wh))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(40===a.charCodeAt(Yq)?(f=gd,Yq++):(f=xc,0===br&&j(hd)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(h=nb(),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();if(i!==xc)if(a.substr(Yq,2)===kd?(k=kd,Yq+=2):(k=xc,0===br&&j(ld)),k===xc&&(a.substr(Yq,2)===id?(k=id,Yq+=2):(k=xc,0===br&&j(jd))),k!==xc){for(l=[],m=jc();m!==xc;)l.push(m),m=jc();if(l!==xc)if(m=lb(),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(41===a.charCodeAt(Yq)?(o=md,Yq++):(o=xc,0===br&&j(nd)),o!==xc?(Zq=b,c=Xh(h,m),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Sh)),b}function ua(){var a,b;return br++,a=xb(),a===xc&&(a=yb(),a===xc&&(a=Aa())),br--,a===xc&&(b=xc,0===br&&j(Yh)),a}function va(){var b,c,d,e,f;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(a.substr(Yq,6)===kf?(d=kf,Yq+=6):(d=xc,0===br&&j(lf)),d===xc&&(a.substr(Yq,6)===mf?(d=mf,Yq+=6):(d=xc,0===br&&j(nf))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(f=wa(),f!==xc?(Zq=b,c=$h(f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Zh)),b}function wa(){var a,b;return br++,a=xa(),a===xc&&(a=ya()),br--,a===xc&&(b=xc,0===br&&j(_h)),a}function xa(){var b,c,d,e,f,g,h,i;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=lb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(123===a.charCodeAt(Yq)?(f=Bd,Yq++):(f=xc,0===br&&j(Cd)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc){for(h=[],i=za();i!==xc;)h.push(i),i=za();h!==xc?(125===a.charCodeAt(Yq)?(i=Dd,Yq++):(i=xc,0===br&&j(Ed)),i!==xc?(Zq=b,c=bi(d,h),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ai)),b}function ya(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc){if(d=ic(),d===xc)if(d=Yq,40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){for(g=[],h=lb();h!==xc;)g.push(h),h=lb();if(g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(e=[e,f,g,h,i],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)}else Yq=d,d=xc}else Yq=d,d=xc}else Yq=d,d=xc;if(d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(123===a.charCodeAt(Yq)?(f=Bd,Yq++):(f=xc,0===br&&j(Cd)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc){for(h=[],i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(40===a.charCodeAt(Yq)?(l=gd,Yq++):(l=xc,0===br&&j(hd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc){for(n=[],o=za();o!==xc;)n.push(o),o=za();if(n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(41===a.charCodeAt(Yq)?(p=md,Yq++):(p=xc,0===br&&j(nd)),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();q!==xc?(k=[k,l,m,n,o,p,q],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc}else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc;for(i===xc&&(i=ic());i!==xc;){for(h.push(i),i=Yq,k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(40===a.charCodeAt(Yq)?(l=gd,Yq++):(l=xc,0===br&&j(hd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc){for(n=[],o=za();o!==xc;)n.push(o),o=za();if(n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(41===a.charCodeAt(Yq)?(p=md,Yq++):(p=xc,0===br&&j(nd)),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();q!==xc?(k=[k,l,m,n,o,p,q],i=k):(Yq=i,i=xc)}else Yq=i,i=xc;else Yq=i,i=xc}else Yq=i,i=xc}else Yq=i,i=xc}else Yq=i,i=xc;else Yq=i,i=xc;i===xc&&(i=ic())}if(h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(125===a.charCodeAt(Yq)?(k=Dd,Yq++):(k=xc,0===br&&j(Ed)),k!==xc?(Zq=b,c=di(d,h),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ci)),b}function za(){var b,c,d,e,f;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=Ob(),d===xc&&(d=Eb(),d===xc&&(d=Fb(),d===xc&&(d=Jb(),d===xc&&(a.substr(Yq,5)===gf?(d=gf,Yq+=5):(d=xc,0===br&&j(hf)))))),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(Zq=b,c=ue(d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ei)),b}function Aa(){var a,b,c,d;if(br++,a=Yq,b=Lb(),b!==xc){for(c=[],d=jc();d!==xc;)c.push(d),d=jc();c!==xc?(d=Ba(),d!==xc?(Zq=a,b=gi(b,d),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;return br--,a===xc&&(b=xc,0===br&&j(fi)),a}function Ba(){var b,c,d,e,f,g,h,i,k,l,m,n;if(br++,b=Yq,c=ic(),c!==xc&&(Zq=b,c=ii()),b=c,b===xc)if(b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,8)===$c?(e=$c,Yq+=8):(e=xc,0===br&&j(_c)),e===xc&&(a.substr(Yq,8)===ad?(e=ad,Yq+=8):(e=xc,0===br&&j(bd))),e===xc&&(e=null),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc){if(i=[],k=Yq,44===a.charCodeAt(Yq)?(l=ji,Yq++):(l=xc,0===br&&j(ki)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(n=nb(),n!==xc?(l=[l,m,n],k=l):(Yq=k,k=xc)):(Yq=k,k=xc)}else Yq=k,k=xc;for(;k!==xc;)if(i.push(k),k=Yq,44===a.charCodeAt(Yq)?(l=ji,Yq++):(l=xc,0===br&&j(ki)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(n=nb(),n!==xc?(l=[l,m,n],k=l):(Yq=k,k=xc)):(Yq=k,k=xc)}else Yq=k,k=xc;i!==xc?(41===a.charCodeAt(Yq)?(k=md,Yq++):(k=xc,0===br&&j(nd)),k!==xc?(Zq=b,c=li(e,g,i),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(hi)),b}function Ca(){var b,c,d,e,f,g,h,i,k,l;if(br++,b=Yq,c=ic(),c!==xc&&(Zq=b,c=ii()),b=c,b===xc)if(b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Lb(),e===xc&&(e=nb()),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc){if(g=[],h=Yq,44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=Lb(),l===xc&&(l=nb()),l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)}else Yq=h,h=xc;for(;h!==xc;)if(g.push(h),h=Yq,44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=Lb(),l===xc&&(l=nb()),l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)}else Yq=h,h=xc;g!==xc?(41===a.charCodeAt(Yq)?(h=md,Yq++):(h=xc,0===br&&j(nd)),h!==xc?(Zq=b,c=ni(e,g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(mi)),b}function Da(){var b,c,d,e,f,g;if(br++,b=Yq,123===a.charCodeAt(Yq)?(c=Bd,Yq++):(c=xc,0===br&&j(Cd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Ea(),e===xc&&(e=null),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(125===a.charCodeAt(Yq)?(g=Dd,Yq++):(g=xc,0===br&&j(Ed)),g!==xc?(Zq=b,c=pi(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(oi)),b}function Ea(){var b,c,d,e,f,g,h;if(br++,b=Yq,c=Fa(),c!==xc){for(d=Yq,e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(46===a.charCodeAt(Yq)?(f=ah,Yq++):(f=xc,0===br&&j(bh)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();g!==xc?(h=Ea(),h===xc&&(h=null),h!==xc?(e=[e,f,g,h],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)}else Yq=d,d=xc;else Yq=d,d=xc;d===xc&&(d=null),d!==xc?(Zq=b,c=ri(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(qi)),b}function Fa(){var a,b,c,d,e;for(br++,a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();if(b!==xc)if(c=jb(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Ha(),e!==xc?(Zq=a,b=ti(c,e),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc;if(a===xc){for(a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();if(b!==xc)if(c=cb(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Ia(),e!==xc?(Zq=a,b=ui(c,e),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc}return br--,a===xc&&(b=xc,0===br&&j(si)),a}function Ga(){var b,c,d,e,f,g,h,i,k,l,m,n,o;if(br++,b=Yq,c=Ra(),c===xc&&(c=Sa()),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Ja(),e!==xc){for(f=[],g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc){if(l=Yq,m=Ra(),m===xc&&(m=Sa()),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ka(),o!==xc?(m=[m,n,o],l=m):(Yq=l,l=xc)):(Yq=l,l=xc)}else Yq=l,l=xc;l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)}else Yq=g,g=xc}else Yq=g,g=xc;else Yq=g,g=xc;for(;g!==xc;){for(f.push(g),g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc){if(l=Yq,m=Ra(),m===xc&&(m=Sa()),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ka(),o!==xc?(m=[m,n,o],l=m):(Yq=l,l=xc)):(Yq=l,l=xc)}else Yq=l,l=xc;l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)}else Yq=g,g=xc}else Yq=g,g=xc;else Yq=g,g=xc}f!==xc?(Zq=b,c=wi(c,e,f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(vi)),b}function Ha(){var b,c,d,e,f,g,h,i,k,l,m,n,o;if(br++,b=Yq,c=Na(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Ka(),e!==xc){for(f=[],g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc){if(l=Yq,m=Na(),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ka(),o!==xc?(m=[m,n,o],l=m):(Yq=l,l=xc)):(Yq=l,l=xc)}else Yq=l,l=xc;l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)}else Yq=g,g=xc}else Yq=g,g=xc;else Yq=g,g=xc;for(;g!==xc;){for(f.push(g),g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc){if(l=Yq,m=Na(),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ka(),o!==xc?(m=[m,n,o],l=m):(Yq=l,l=xc)):(Yq=l,l=xc)}else Yq=l,l=xc;l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)}else Yq=g,g=xc}else Yq=g,g=xc;else Yq=g,g=xc}f!==xc?(Zq=b,c=yi(c,e,f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(xi)),b}function Ia(){var a,b;return br++,a=Ha(),a===xc&&(a=null),br--,a===xc&&(b=xc,0===br&&j(zi)),a}function Ja(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=La(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc){if(e=[],f=Yq,44===a.charCodeAt(Yq)?(g=ji,Yq++):(g=xc,0===br&&j(ki)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=La(),i!==xc?(g=[g,h,i],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;for(;f!==xc;)if(e.push(f),f=Yq,44===a.charCodeAt(Yq)?(g=ji,Yq++):(g=xc,0===br&&j(ki)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=La(),i!==xc?(g=[g,h,i],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;e!==xc?(Zq=b,c=Bi(c,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ai)),b}function Ka(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=Ma(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc){if(e=[],f=Yq,44===a.charCodeAt(Yq)?(g=ji,Yq++):(g=xc,0===br&&j(ki)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=Ma(),i!==xc?(g=[g,h,i],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;for(;f!==xc;)if(e.push(f),f=Yq,44===a.charCodeAt(Yq)?(g=ji,Yq++):(g=xc,0===br&&j(ki)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=Ma(),i!==xc?(g=[g,h,i],f=g):(Yq=f,f=xc)):(Yq=f,f=xc)}else Yq=f,f=xc;e!==xc?(Zq=b,c=Di(c,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ci)),b}function La(){var a,b;return br++,a=hb(),br--,a===xc&&(b=xc,0===br&&j(Ei)),a}function Ma(){var a,b;return br++,a=ib(),br--,a===xc&&(b=xc,0===br&&j(Fi)),a}function Na(){var b,c;return br++,b=kb(),b===xc&&(b=Yq,97===a.charCodeAt(Yq)?(c=Hi,Yq++):(c=xc,0===br&&j(Ii)),c!==xc&&(Zq=b,c=Ji()),b=c),br--,b===xc&&(c=xc,0===br&&j(Gi)),b}function Oa(){var a,b,c,d,e;for(br++,a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();if(b!==xc)if(c=jb(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Pa(),e!==xc?(Zq=a,b=Li(c,e),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc;if(a===xc){for(a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();if(b!==xc)if(c=bb(),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Qa(),e!==xc?(Zq=a,b=Mi(c,e),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc}return br--,a===xc&&(b=xc,0===br&&j(Ki)),a}function Pa(){var b,c,d,e,f,g,h,i,k,l,m,n;if(br++,b=Yq,c=Ra(),c===xc&&(c=Sa()),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=Ja(),e!==xc){for(f=[],g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=Yq,m=Ra(),m===xc&&(m=Sa()),m!==xc?(n=Ka(),n!==xc?(m=[m,n],l=m):(Yq=l,l=xc)):(Yq=l,l=xc),l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc;for(;g!==xc;){for(f.push(g),g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(59===a.charCodeAt(Yq)?(i=rf,Yq++):(i=xc,0===br&&j(sf)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=Yq,m=Ra(),m===xc&&(m=Sa()),m!==xc?(n=Ka(),n!==xc?(m=[m,n],l=m):(Yq=l,l=xc)):(Yq=l,l=xc),l===xc&&(l=null),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc}f!==xc?(Zq=b,c=Oi(c,e,f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ni)),b}function Qa(){var a,b;return br++,a=Ga(),a===xc&&(a=null),br--,a===xc&&(b=xc,0===br&&j(Pi)),a}function Ra(){var a,b;return br++,a=Yq,b=Ta(),b!==xc&&(Zq=a,b=Ri(b)),a=b,br--,a===xc&&(b=xc,0===br&&j(Qi)),a}function Sa(){var a,b;return br++,a=lb(),br--,a===xc&&(b=xc,0===br&&j(Si)),a}function Ta(){var a,b;return br++,a=Ua(),br--,a===xc&&(b=xc,0===br&&j(Ti)),a}function Ua(){var b,c,d,e,f,g;if(br++,b=Yq,c=Va(),c!==xc){for(d=[],e=Yq,124===a.charCodeAt(Yq)?(f=Vi,Yq++):(f=xc,0===br&&j(Wi)),f!==xc?(g=Va(),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)):(Yq=e,e=xc);e!==xc;)d.push(e),e=Yq,124===a.charCodeAt(Yq)?(f=Vi,Yq++):(f=xc,0===br&&j(Wi)),f!==xc?(g=Va(),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)):(Yq=e,e=xc);d!==xc?(Zq=b,c=Xi(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ui)),b}function Va(){var b,c,d,e,f,g;if(br++,b=Yq,c=Xa(),c!==xc){for(d=[],e=Yq,47===a.charCodeAt(Yq)?(f=Zi,Yq++):(f=xc,0===br&&j($i)),f!==xc?(g=Xa(),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)):(Yq=e,e=xc);e!==xc;)d.push(e),e=Yq,47===a.charCodeAt(Yq)?(f=Zi,Yq++):(f=xc,0===br&&j($i)),f!==xc?(g=Xa(),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)):(Yq=e,e=xc);d!==xc?(Zq=b,c=_i(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Yi)),b}function Wa(){var a,b,c;return br++,a=Yq,b=Za(),b!==xc?(c=Ya(),c===xc&&(c=null),c!==xc?(Zq=a,b=bj(b,c),a=b):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(aj)),a}function Xa(){var b,c,d;return br++,b=Wa(),b===xc&&(b=Yq,94===a.charCodeAt(Yq)?(c=dj,Yq++):(c=xc,0===br&&j(ej)),c!==xc?(d=Wa(),d!==xc?(Zq=b,c=fj(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)),br--,b===xc&&(c=xc,0===br&&j(cj)),b}function Ya(){var b,c,d,e,f,g,h,i,k;return br++,42===a.charCodeAt(Yq)?(b=od,Yq++):(b=xc,0===br&&j(pd)),b===xc&&(63===a.charCodeAt(Yq)?(b=hj,Yq++):(b=xc,0===br&&j(ij)),b===xc&&(43===a.charCodeAt(Yq)?(b=jj,Yq++):(b=xc,0===br&&j(kj)),b===xc&&(b=Yq,123===a.charCodeAt(Yq)?(c=Bd,Yq++):(c=xc,0===br&&j(Cd)),c!==xc?(d=Yq,e=ab(),e!==xc?(f=Yq,44===a.charCodeAt(Yq)?(g=ji,Yq++):(g=xc,0===br&&j(ki)),g!==xc?(125===a.charCodeAt(Yq)?(h=Dd,Yq++):(h=xc,0===br&&j(Ed)),h===xc&&(h=Yq,i=ab(),i!==xc?(125===a.charCodeAt(Yq)?(k=Dd,Yq++):(k=xc,0===br&&j(Ed)),k!==xc?(i=[i,k],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)),h!==xc?(g=[g,h],f=g):(Yq=f,
f=xc)):(Yq=f,f=xc),f===xc&&(125===a.charCodeAt(Yq)?(f=Dd,Yq++):(f=xc,0===br&&j(Ed))),f!==xc?(e=[e,f],d=e):(Yq=d,d=xc)):(Yq=d,d=xc),d===xc&&(d=Yq,44===a.charCodeAt(Yq)?(e=ji,Yq++):(e=xc,0===br&&j(ki)),e!==xc?(f=ab(),f!==xc?(125===a.charCodeAt(Yq)?(g=Dd,Yq++):(g=xc,0===br&&j(Ed)),g!==xc?(e=[e,f,g],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)):(Yq=d,d=xc)),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)))),br--,b===xc&&(c=xc,0===br&&j(gj)),b}function Za(){var b,c,d,e;return br++,b=Lb(),b===xc&&(b=Yq,97===a.charCodeAt(Yq)?(c=Hi,Yq++):(c=xc,0===br&&j(Ii)),c!==xc&&(Zq=b,c=Ji()),b=c,b===xc&&(b=Yq,33===a.charCodeAt(Yq)?(c=mj,Yq++):(c=xc,0===br&&j(nj)),c!==xc?(d=$a(),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc),b===xc&&(b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc?(d=Ta(),d!==xc?(41===a.charCodeAt(Yq)?(e=md,Yq++):(e=xc,0===br&&j(nd)),e!==xc?(Zq=b,c=ih(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)):(Yq=b,b=xc)))),br--,b===xc&&(c=xc,0===br&&j(lj)),b}function $a(){var b,c,d,e,f,g,h,i;if(b=_a(),b===xc)if(b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc){if(d=Yq,e=_a(),e!==xc){for(f=[],g=Yq,124===a.charCodeAt(Yq)?(h=Vi,Yq++):(h=xc,0===br&&j(Wi)),h!==xc?(i=_a(),i!==xc?(h=[h,i],g=h):(Yq=g,g=xc)):(Yq=g,g=xc);g!==xc;)f.push(g),g=Yq,124===a.charCodeAt(Yq)?(h=Vi,Yq++):(h=xc,0===br&&j(Wi)),h!==xc?(i=_a(),i!==xc?(h=[h,i],g=h):(Yq=g,g=xc)):(Yq=g,g=xc);f!==xc?(e=[e,f],d=e):(Yq=d,d=xc)}else Yq=d,d=xc;d===xc&&(d=null),d!==xc?(41===a.charCodeAt(Yq)?(e=md,Yq++):(e=xc,0===br&&j(nd)),e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return b}function _a(){var b,c,d;return br++,b=Lb(),b===xc&&(97===a.charCodeAt(Yq)?(b=Hi,Yq++):(b=xc,0===br&&j(Ii)),b===xc&&(b=Yq,94===a.charCodeAt(Yq)?(c=dj,Yq++):(c=xc,0===br&&j(ej)),c!==xc?(d=Lb(),d===xc&&(97===a.charCodeAt(Yq)?(d=Hi,Yq++):(d=xc,0===br&&j(Ii))),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc))),br--,b===xc&&(c=xc,0===br&&j(oj)),b}function ab(){var a,b;return br++,a=Vb(),br--,a===xc&&(b=xc,0===br&&j(pj)),a}function bb(){var a,b;return br++,a=Yq,b=fb(),b!==xc&&(Zq=a,b=rj(b)),a=b,a===xc&&(a=db()),br--,a===xc&&(b=xc,0===br&&j(qj)),a}function cb(){var a,b;return br++,a=Yq,b=gb(),b!==xc&&(Zq=a,b=tj(b)),a=b,a===xc&&(a=eb()),br--,a===xc&&(b=xc,0===br&&j(sj)),a}function db(){var b,c,d,e,f,g,h,i;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(91===a.charCodeAt(Yq)?(d=vj,Yq++):(d=xc,0===br&&j(wj)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=Pa(),f!==xc)if(93===a.charCodeAt(Yq)?(g=xj,Yq++):(g=xc,0===br&&j(yj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(Zq=b,c=zj(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(uj)),b}function eb(){var b,c,d,e,f,g,h,i,k;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(91===a.charCodeAt(Yq)?(d=vj,Yq++):(d=xc,0===br&&j(wj)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(f=Ha(),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(93===a.charCodeAt(Yq)?(h=xj,Yq++):(h=xc,0===br&&j(yj)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(Zq=b,c=Bj(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Aj)),b}function fb(){var b,c,d,e,f,g,h,i,k;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(40===a.charCodeAt(Yq)?(d=gd,Yq++):(d=xc,0===br&&j(hd)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc){if(f=[],g=hb(),g!==xc)for(;g!==xc;)f.push(g),g=hb();else f=xc;if(f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(41===a.charCodeAt(Yq)?(h=md,Yq++):(h=xc,0===br&&j(nd)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(Zq=b,c=Dj(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Cj)),b}function gb(){var b,c,d,e,f,g,h,i,k;for(br++,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(40===a.charCodeAt(Yq)?(d=gd,Yq++):(d=xc,0===br&&j(hd)),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc){if(f=[],g=ib(),g!==xc)for(;g!==xc;)f.push(g),g=ib();else f=xc;if(f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(41===a.charCodeAt(Yq)?(h=md,Yq++):(h=xc,0===br&&j(nd)),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(Zq=b,c=Dj(f),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ej)),b}function hb(){var a,b,c,d,e,f;for(br++,a=Yq,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=jb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=bb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}return b!==xc&&(Zq=a,b=Gj(b)),a=b,br--,a===xc&&(b=xc,0===br&&j(Fj)),a}function ib(){var a,b,c,d,e,f;for(br++,a=Yq,b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=jb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){for(b=Yq,c=[],d=jc();d!==xc;)c.push(d),d=jc();if(c!==xc)if(d=cb(),d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}return b!==xc&&(Zq=a,b=Gj(b)),a=b,br--,a===xc&&(b=xc,0===br&&j(Hj)),a}function jb(){var a,b;return br++,a=lb(),a===xc&&(a=mb()),br--,a===xc&&(b=xc,0===br&&j(Ij)),a}function kb(){var a,b;return br++,a=lb(),a===xc&&(a=Lb()),br--,a===xc&&(b=xc,0===br&&j(Jj)),a}function lb(){var a,b,c,d,e;for(br++,a=Yq,b=[],c=jc();c!==xc;)b.push(c),c=jc();if(b!==xc)if(c=Sb(),c===xc&&(c=Tb()),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(Zq=a,b=Lj(c),a=b):(Yq=a,a=xc)}else Yq=a,a=xc;else Yq=a,a=xc;return br--,a===xc&&(b=xc,0===br&&j(Kj)),a}function mb(){var a,b;return br++,a=Lb(),a===xc&&(a=Eb(),a===xc&&(a=Fb(),a===xc&&(a=Jb(),a===xc&&(a=Nb(),a===xc&&(a=ic()))))),br--,a===xc&&(b=xc,0===br&&j(Mj)),a}function nb(){var a,b;return br++,a=ob(),br--,a===xc&&(b=xc,0===br&&j(Nj)),a}function ob(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=pb(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===Pj?(g=Pj,Yq+=2):(g=xc,0===br&&j(Qj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=pb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===Pj?(g=Pj,Yq+=2):(g=xc,0===br&&j(Qj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=pb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}d!==xc?(Zq=b,c=Rj(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Oj)),b}function pb(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=qb(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===Tj?(g=Tj,Yq+=2):(g=xc,0===br&&j(Uj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=qb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===Tj?(g=Tj,Yq+=2):(g=xc,0===br&&j(Uj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=qb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}d!==xc?(Zq=b,c=Vj(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Sj)),b}function qb(){var a,b;return br++,a=rb(),br--,a===xc&&(b=xc,0===br&&j(Wj)),a}function rb(){var b,c,d,e,f,g,h,i,k,l,m,n,o;if(br++,b=Yq,c=sb(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(61===a.charCodeAt(Yq)?(g=Yj,Yq++):(g=xc,0===br&&j(Zj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===$j?(g=$j,Yq+=2):(g=xc,0===br&&j(_j)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(60===a.charCodeAt(Yq)?(g=ak,Yq++):(g=xc,0===br&&j(bk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(62===a.charCodeAt(Yq)?(g=ck,Yq++):(g=xc,0===br&&j(dk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===ek?(g=ek,Yq+=2):(g=xc,0===br&&j(fk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===gk?(g=gk,Yq+=2):(g=xc,0===br&&j(hk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(73===a.charCodeAt(Yq)?(g=ik,Yq++):(g=xc,0===br&&j(jk)),g===xc&&(105===a.charCodeAt(Yq)?(g=kk,Yq++):(g=xc,0===br&&j(lk))),g!==xc)if(78===a.charCodeAt(Yq)?(h=mk,Yq++):(h=xc,0===br&&j(nk)),h===xc&&(110===a.charCodeAt(Yq)?(h=ok,Yq++):(h=xc,0===br&&j(pk))),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=Ca(),k!==xc?(f=[f,g,h,i,k],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(78===a.charCodeAt(Yq)?(g=mk,Yq++):(g=xc,0===br&&j(nk)),g===xc&&(110===a.charCodeAt(Yq)?(g=ok,Yq++):(g=xc,0===br&&j(pk))),g!==xc)if(79===a.charCodeAt(Yq)?(h=qk,Yq++):(h=xc,0===br&&j(rk)),h===xc&&(111===a.charCodeAt(Yq)?(h=sk,Yq++):(h=xc,0===br&&j(tk))),h!==xc)if(84===a.charCodeAt(Yq)?(i=uk,Yq++):(i=xc,0===br&&j(vk)),i===xc&&(116===a.charCodeAt(Yq)?(i=wk,Yq++):(i=xc,0===br&&j(xk))),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(73===a.charCodeAt(Yq)?(l=ik,Yq++):(l=xc,0===br&&j(jk)),l===xc&&(105===a.charCodeAt(Yq)?(l=kk,Yq++):(l=xc,0===br&&j(lk))),l!==xc)if(78===a.charCodeAt(Yq)?(m=mk,Yq++):(m=xc,0===br&&j(nk)),m===xc&&(110===a.charCodeAt(Yq)?(m=ok,Yq++):(m=xc,0===br&&j(pk))),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ca(),o!==xc?(f=[f,g,h,i,k,l,m,n,o],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc}}}}}}}for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(61===a.charCodeAt(Yq)?(g=Yj,Yq++):(g=xc,0===br&&j(Zj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===$j?(g=$j,Yq+=2):(g=xc,0===br&&j(_j)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(60===a.charCodeAt(Yq)?(g=ak,Yq++):(g=xc,0===br&&j(bk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(62===a.charCodeAt(Yq)?(g=ck,Yq++):(g=xc,0===br&&j(dk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===ek?(g=ek,Yq+=2):(g=xc,0===br&&j(fk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,2)===gk?(g=gk,Yq+=2):(g=xc,0===br&&j(hk)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=sb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(73===a.charCodeAt(Yq)?(g=ik,Yq++):(g=xc,0===br&&j(jk)),g===xc&&(105===a.charCodeAt(Yq)?(g=kk,Yq++):(g=xc,0===br&&j(lk))),g!==xc)if(78===a.charCodeAt(Yq)?(h=mk,Yq++):(h=xc,0===br&&j(nk)),h===xc&&(110===a.charCodeAt(Yq)?(h=ok,Yq++):(h=xc,0===br&&j(pk))),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=Ca(),k!==xc?(f=[f,g,h,i,k],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(78===a.charCodeAt(Yq)?(g=mk,Yq++):(g=xc,0===br&&j(nk)),g===xc&&(110===a.charCodeAt(Yq)?(g=ok,Yq++):(g=xc,0===br&&j(pk))),g!==xc)if(79===a.charCodeAt(Yq)?(h=qk,Yq++):(h=xc,0===br&&j(rk)),h===xc&&(111===a.charCodeAt(Yq)?(h=sk,Yq++):(h=xc,0===br&&j(tk))),h!==xc)if(84===a.charCodeAt(Yq)?(i=uk,Yq++):(i=xc,0===br&&j(vk)),i===xc&&(116===a.charCodeAt(Yq)?(i=wk,Yq++):(i=xc,0===br&&j(xk))),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(73===a.charCodeAt(Yq)?(l=ik,Yq++):(l=xc,0===br&&j(jk)),l===xc&&(105===a.charCodeAt(Yq)?(l=kk,Yq++):(l=xc,0===br&&j(lk))),l!==xc)if(78===a.charCodeAt(Yq)?(m=mk,Yq++):(m=xc,0===br&&j(nk)),m===xc&&(110===a.charCodeAt(Yq)?(m=ok,Yq++):(m=xc,0===br&&j(pk))),m!==xc){for(n=[],o=jc();o!==xc;)n.push(o),o=jc();n!==xc?(o=Ca(),o!==xc?(f=[f,g,h,i,k,l,m,n,o],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc}else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc;else Yq=e,e=xc}}}}}}}}d!==xc?(Zq=b,c=yk(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Xj)),b}function sb(){var a,b;return br++,a=tb(),br--,a===xc&&(b=xc,0===br&&j(zk)),a}function tb(){var b,c,d,e,f,g,h,i,k,l;if(br++,b=Yq,c=ub(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(43===a.charCodeAt(Yq)?(g=jj,Yq++):(g=xc,0===br&&j(kj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ub(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(45===a.charCodeAt(Yq)?(g=Bk,Yq++):(g=xc,0===br&&j(Ck)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ub(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc)if(e=Yq,f=Ib(),f===xc&&(f=Ib()),f!==xc){for(g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(42===a.charCodeAt(Yq)?(i=od,Yq++):(i=xc,0===br&&j(pd)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=vb(),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc;if(g===xc){for(g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(47===a.charCodeAt(Yq)?(i=Zi,Yq++):(i=xc,0===br&&j($i)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=vb(),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc}g===xc&&(g=null),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)}else Yq=e,e=xc}for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(43===a.charCodeAt(Yq)?(g=jj,Yq++):(g=xc,0===br&&j(kj)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ub(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(45===a.charCodeAt(Yq)?(g=Bk,Yq++):(g=xc,0===br&&j(Ck)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=ub(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc)if(e=Yq,f=Ib(),f===xc&&(f=Ib()),f!==xc){for(g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(42===a.charCodeAt(Yq)?(i=od,Yq++):(i=xc,0===br&&j(pd)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=vb(),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc;if(g===xc){for(g=Yq,h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(47===a.charCodeAt(Yq)?(i=Zi,Yq++):(i=xc,0===br&&j($i)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(l=vb(),l!==xc?(h=[h,i,k,l],g=h):(Yq=g,g=xc)):(Yq=g,g=xc)}else Yq=g,g=xc;else Yq=g,g=xc}g===xc&&(g=null),g!==xc?(f=[f,g],e=f):(Yq=e,e=xc)}else Yq=e,e=xc}}d!==xc?(Zq=b,c=Dk(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ak)),b}function ub(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,c=vb(),c!==xc){for(d=[],e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(42===a.charCodeAt(Yq)?(g=od,Yq++):(g=xc,0===br&&j(pd)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=vb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(47===a.charCodeAt(Yq)?(g=Zi,Yq++):(g=xc,0===br&&j($i)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=vb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}for(;e!==xc;){for(d.push(e),e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(42===a.charCodeAt(Yq)?(g=od,Yq++):(g=xc,0===br&&j(pd)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=vb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc;if(e===xc){for(e=Yq,f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(47===a.charCodeAt(Yq)?(g=Zi,Yq++):(g=xc,0===br&&j($i)),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(i=vb(),i!==xc?(f=[f,g,h,i],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}}d!==xc?(Zq=b,c=Fk(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ek)),b}function vb(){var b,c,d,e;if(br++,b=Yq,33===a.charCodeAt(Yq)?(c=mj,Yq++):(c=xc,0===br&&j(nj)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=wb(),e!==xc?(Zq=b,c=Hk(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;if(b===xc){if(b=Yq,43===a.charCodeAt(Yq)?(c=jj,Yq++):(c=xc,0===br&&j(kj)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=wb(),e!==xc?(Zq=b,c=Ik(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;if(b===xc){if(b=Yq,45===a.charCodeAt(Yq)?(c=Bk,Yq++):(c=xc,0===br&&j(Ck)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=wb(),e!==xc?(Zq=b,c=Jk(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;b===xc&&(b=wb())}}return br--,b===xc&&(c=xc,0===br&&j(Gk)),b}function wb(){var a,b;return br++,a=xb(),a===xc&&(a=yb(),a===xc&&(a=Db(),a===xc&&(a=Yq,b=Eb(),b!==xc&&(Zq=a,b=Lk(b)),a=b,a===xc&&(a=Yq,b=Fb(),b!==xc&&(Zq=a,b=Mk(b)),a=b,a===xc&&(a=Yq,b=Jb(),b!==xc&&(Zq=a,b=Nk(b)),a=b,a===xc&&(a=Cb(),a===xc&&(a=Yq,b=lb(),b!==xc&&(Zq=a,b=Ok(b)),a=b))))))),br--,a===xc&&(b=xc,0===br&&j(Kk)),a}function xb(){var b,c,d,e,f,g;if(br++,b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(e=nb(),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(41===a.charCodeAt(Yq)?(g=md,Yq++):(g=xc,0===br&&j(nd)),g!==xc?(Zq=b,c=Qk(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Pk)),b}function yb(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r;if(br++,b=Yq,a.substr(Yq,3)===Sk?(c=Sk,Yq+=3):(c=xc,0===br&&j(Tk)),c===xc&&(a.substr(Yq,3)===Uk?(c=Uk,Yq+=3):(c=xc,0===br&&j(Vk))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=Wk(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,4)===Xk?(c=Xk,Yq+=4):(c=xc,0===br&&j(Yk)),c===xc&&(a.substr(Yq,4)===Zk?(c=Zk,Yq+=4):(c=xc,0===br&&j($k))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=_k(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,11)===al?(c=al,Yq+=11):(c=xc,0===br&&j(bl)),c===xc&&(a.substr(Yq,11)===cl?(c=cl,Yq+=11):(c=xc,0===br&&j(dl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=nb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(41===a.charCodeAt(Yq)?(n=md,Yq++):(n=xc,0===br&&j(nd)),n!==xc?(Zq=b,c=el(g,l),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,8)===fl?(c=fl,Yq+=8):(c=xc,0===br&&j(gl)),c===xc&&(a.substr(Yq,8)===hl?(c=hl,Yq+=8):(c=xc,0===br&&j(il))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=jl(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,5)===kl?(c=kl,Yq+=5):(c=xc,0===br&&j(ll)),c===xc&&(a.substr(Yq,5)===ml?(c=ml,Yq+=5):(c=xc,0===br&&j(nl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=lb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=ol(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,3)===pl?(c=pl,Yq+=3):(c=xc,0===br&&j(ql)),c===xc&&(a.substr(Yq,3)===rl?(c=rl,Yq+=3):(c=xc,0===br&&j(sl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=tl(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,3)===ul?(c=ul,Yq+=3):(c=xc,0===br&&j(vl)),c===xc&&(a.substr(Yq,3)===wl?(c=wl,Yq+=3):(c=xc,0===br&&j(xl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=yl(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,5)===zl?(c=zl,Yq+=5):(c=xc,0===br&&j(Al)),c===xc&&(a.substr(Yq,5)===Bl?(c=Bl,Yq+=5):(c=xc,0===br&&j(Cl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc){if(e=Yq,40===a.charCodeAt(Yq)?(f=gd,Yq++):(f=xc,0===br&&j(hd)),f!==xc){for(g=[],h=jc();h!==xc;)g.push(h),h=jc();if(g!==xc)if(h=nb(),h!==xc){for(i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(41===a.charCodeAt(Yq)?(k=md,Yq++):(k=xc,0===br&&j(nd)),k!==xc?(f=[f,g,h,i,k],e=f):(Yq=e,e=xc)):(Yq=e,e=xc)}else Yq=e,e=xc;else Yq=e,e=xc}else Yq=e,e=xc;e===xc&&(e=ic()),e!==xc?(Zq=b,c=Dl(e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,8)===El?(c=El,Yq+=8):(c=xc,0===br&&j(Fl)),c===xc&&(a.substr(Yq,8)===Gl?(c=Gl,Yq+=8):(c=xc,0===br&&j(Hl))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=Ca(),e!==xc?(Zq=b,c=Il(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,2)===Jl?(c=Jl,Yq+=2):(c=xc,0===br&&j(Kl)),c===xc&&(a.substr(Yq,2)===Ll?(c=Ll,Yq+=2):(c=xc,0===br&&j(Ml))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=nb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc)if(44===a.charCodeAt(Yq)?(n=ji,Yq++):(n=xc,0===br&&j(ki)),n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(p=nb(),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();q!==xc?(41===a.charCodeAt(Yq)?(r=md,Yq++):(r=xc,0===br&&j(nd)),r!==xc?(Zq=b,c=Nl(g,l,p),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,9)===Ol?(c=Ol,Yq+=9):(c=xc,0===br&&j(Pl)),c===xc&&(a.substr(Yq,9)===Ql?(c=Ql,Yq+=9):(c=xc,0===br&&j(Rl)),c===xc&&(a.substr(Yq,9)===Sl?(c=Sl,Yq+=9):(c=xc,0===br&&j(Tl)))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=Ul(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,7)===Vl?(c=Vl,Yq+=7):(c=xc,0===br&&j(Wl)),c===xc&&(a.substr(Yq,7)===Xl?(c=Xl,Yq+=7):(c=xc,0===br&&j(Yl)),c===xc&&(a.substr(Yq,7)===Zl?(c=Zl,Yq+=7):(c=xc,0===br&&j($l)))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=_l(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,8)===am?(c=am,Yq+=8):(c=xc,0===br&&j(bm)),c===xc&&(a.substr(Yq,8)===cm?(c=cm,Yq+=8):(c=xc,0===br&&j(dm))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=nb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(41===a.charCodeAt(Yq)?(n=md,Yq++):(n=xc,0===br&&j(nd)),n!==xc?(Zq=b,c=em(g,l),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,5)===fm?(c=fm,Yq+=5):(c=xc,0===br&&j(gm)),c===xc&&(a.substr(Yq,5)===hm?(c=hm,Yq+=5):(c=xc,0===br&&j(im)),c===xc&&(a.substr(Yq,5)===jm?(c=jm,Yq+=5):(c=xc,0===br&&j(km)),c===xc&&(a.substr(Yq,5)===lm?(c=lm,Yq+=5):(c=xc,0===br&&j(mm)),c===xc&&(a.substr(Yq,5)===nm?(c=nm,Yq+=5):(c=xc,0===br&&j(om)),c===xc&&(a.substr(Yq,5)===pm?(c=pm,Yq+=5):(c=xc,0===br&&j(qm))))))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();h!==xc?(41===a.charCodeAt(Yq)?(i=md,Yq++):(i=xc,0===br&&j(nd)),i!==xc?(Zq=b,c=rm(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,7)===sm?(c=sm,Yq+=7):(c=xc,0===br&&j(tm)),c===xc&&(a.substr(Yq,7)===um?(c=um,Yq+=7):(c=xc,0===br&&j(vm))),c!==xc){if(d=[],wm.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(xm)),e!==xc)for(;e!==xc;)d.push(e),wm.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(xm));else d=xc;if(d!==xc){for(e=[],f=jc();f!==xc;)e.push(f),f=jc();if(e!==xc)if(40===a.charCodeAt(Yq)?(f=gd,Yq++):(f=xc,0===br&&j(hd)),f!==xc){for(g=[],h=Yq,i=[],k=jc();k!==xc;)i.push(k),k=jc();for(i!==xc?(k=nb(),k!==xc?(44===a.charCodeAt(Yq)?(l=ji,Yq++):(l=xc,0===br&&j(ki)),l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)):(Yq=h,h=xc);h!==xc;){for(g.push(h),h=Yq,i=[],k=jc();k!==xc;)i.push(k),k=jc();i!==xc?(k=nb(),k!==xc?(44===a.charCodeAt(Yq)?(l=ji,Yq++):(l=xc,0===br&&j(ki)),l!==xc?(i=[i,k,l],h=i):(Yq=h,h=xc)):(Yq=h,h=xc)):(Yq=h,h=xc)}if(g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();k!==xc?(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc?(Zq=b,c=ym(d,g,i),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;b===xc&&(b=zb(),b===xc&&(b=Ab(),b===xc&&(b=Bb())))}}}}}}}}}}}}}}return br--,b===xc&&(c=xc,0===br&&j(Rk)),b}function zb(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q;if(br++,b=Yq,a.substr(Yq,5)===Am?(c=Am,Yq+=5):(c=xc,0===br&&j(Bm)),c===xc&&(a.substr(Yq,5)===Cm?(c=Cm,Yq+=5):(c=xc,0===br&&j(Dm))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(g=nb(),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(44===a.charCodeAt(Yq)?(i=ji,Yq++):(i=xc,0===br&&j(ki)),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(l=nb(),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc){if(n=Yq,44===a.charCodeAt(Yq)?(o=ji,Yq++):(o=xc,0===br&&j(ki)),o!==xc){for(p=[],q=jc();q!==xc;)p.push(q),q=jc();p!==xc?(q=nb(),q!==xc?(o=[o,p,q],n=o):(Yq=n,n=xc)):(Yq=n,n=xc)}else Yq=n,n=xc;if(n===xc&&(n=null),n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();o!==xc?(41===a.charCodeAt(Yq)?(p=md,Yq++):(p=xc,0===br&&j(nd)),p!==xc?(Zq=b,c=Em(g,l,n),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(zm)),b}function Ab(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,6)===Gm?(c=Gm,Yq+=6):(c=xc,0===br&&j(Hm)),c===xc&&(a.substr(Yq,6)===Im?(c=Im,Yq+=6):(c=xc,0===br&&j(Jm))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(e=ja(),e!==xc?(Zq=b,c=Km(e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Fm)),b}function Bb(){var b,c,d,e,f,g;if(br++,b=Yq,a.substr(Yq,3)===Mm?(c=Mm,Yq+=3):(c=xc,0===br&&j(Nm)),c===xc&&(a.substr(Yq,3)===Om?(c=Om,Yq+=3):(c=xc,0===br&&j(Pm))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(a.substr(Yq,6)===Gm?(e=Gm,Yq+=6):(e=xc,0===br&&j(Hm)),e===xc&&(a.substr(Yq,6)===Im?(e=Im,Yq+=6):(e=xc,0===br&&j(Jm))),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();f!==xc?(g=ja(),g!==xc?(Zq=b,c=Qm(g),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Lm)),b}function Cb(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t;if(br++,b=Yq,a.substr(Yq,5)===Sm?(c=Sm,Yq+=5):(c=xc,0===br&&j(Tm)),c===xc&&(a.substr(Yq,5)===Um?(c=Um,Yq+=5):(c=xc,0===br&&j(Vm))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,
Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(42===a.charCodeAt(Yq)?(i=od,Yq++):(i=xc,0===br&&j(pd)),i===xc&&(i=nb()),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=Wm(g,i),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,12)===Xm?(c=Xm,Yq+=12):(c=xc,0===br&&j(Ym)),c===xc&&(a.substr(Yq,12)===Zm?(c=Zm,Yq+=12):(c=xc,0===br&&j($m))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){if(k=Yq,59===a.charCodeAt(Yq)?(l=rf,Yq++):(l=xc,0===br&&j(sf)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();if(m!==xc)if(a.substr(Yq,9)===_m?(n=_m,Yq+=9):(n=xc,0===br&&j(an)),n!==xc){for(o=[],p=jc();p!==xc;)o.push(p),p=jc();if(o!==xc)if(61===a.charCodeAt(Yq)?(p=Yj,Yq++):(p=xc,0===br&&j(Zj)),p!==xc){for(q=[],r=jc();r!==xc;)q.push(r),r=jc();if(q!==xc)if(r=Kb(),r!==xc){for(s=[],t=jc();t!==xc;)s.push(t),t=jc();s!==xc?(l=[l,m,n,o,p,q,r,s],k=l):(Yq=k,k=xc)}else Yq=k,k=xc;else Yq=k,k=xc}else Yq=k,k=xc;else Yq=k,k=xc}else Yq=k,k=xc;else Yq=k,k=xc}else Yq=k,k=xc;if(k===xc&&(k=null),k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=bn(g,i,k),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,3)===cn?(c=cn,Yq+=3):(c=xc,0===br&&j(dn)),c===xc&&(a.substr(Yq,3)===en?(c=en,Yq+=3):(c=xc,0===br&&j(fn))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=gn(g,i),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,3)===hn?(c=hn,Yq+=3):(c=xc,0===br&&j(jn)),c===xc&&(a.substr(Yq,3)===kn?(c=kn,Yq+=3):(c=xc,0===br&&j(ln))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=mn(g,i),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc){if(b=Yq,a.substr(Yq,3)===nn?(c=nn,Yq+=3):(c=xc,0===br&&j(on)),c===xc&&(a.substr(Yq,3)===pn?(c=pn,Yq+=3):(c=xc,0===br&&j(qn))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=rn(g,i),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;if(b===xc)if(b=Yq,a.substr(Yq,3)===sn?(c=sn,Yq+=3):(c=xc,0===br&&j(tn)),c===xc&&(a.substr(Yq,3)===un?(c=un,Yq+=3):(c=xc,0===br&&j(vn))),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();if(d!==xc)if(40===a.charCodeAt(Yq)?(e=gd,Yq++):(e=xc,0===br&&j(hd)),e!==xc){for(f=[],g=jc();g!==xc;)f.push(g),g=jc();if(f!==xc)if(a.substr(Yq,8)===$c?(g=$c,Yq+=8):(g=xc,0===br&&j(_c)),g===xc&&(a.substr(Yq,8)===ad?(g=ad,Yq+=8):(g=xc,0===br&&j(bd))),g===xc&&(g=null),g!==xc){for(h=[],i=jc();i!==xc;)h.push(i),i=jc();if(h!==xc)if(i=nb(),i!==xc){for(k=[],l=jc();l!==xc;)k.push(l),l=jc();if(k!==xc)if(41===a.charCodeAt(Yq)?(l=md,Yq++):(l=xc,0===br&&j(nd)),l!==xc){for(m=[],n=jc();n!==xc;)m.push(n),n=jc();m!==xc?(Zq=b,c=wn(g,i),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc;else Yq=b,b=xc}else Yq=b,b=xc}}}}return br--,b===xc&&(c=xc,0===br&&j(Rm)),b}function Db(){var a,b,c,d;if(br++,a=Yq,b=Lb(),b!==xc){for(c=[],d=jc();d!==xc;)c.push(d),d=jc();c!==xc?(d=Ba(),d===xc&&(d=null),d!==xc?(Zq=a,b=yn(b,d),a=b):(Yq=a,a=xc)):(Yq=a,a=xc)}else Yq=a,a=xc;return br--,a===xc&&(b=xc,0===br&&j(xn)),a}function Eb(){var b,c,d,e,f;return br++,b=Yq,c=Kb(),c!==xc?(d=Ub(),d===xc&&(d=Yq,a.substr(Yq,2)===An?(e=An,Yq+=2):(e=xc,0===br&&j(Bn)),e!==xc?(f=Lb(),f!==xc?(e=[e,f],d=e):(Yq=d,d=xc)):(Yq=d,d=xc)),d===xc&&(d=null),d!==xc?(Zq=b,c=Cn(c,d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(zn)),b}function Fb(){var a,b;return br++,a=Gb(),a===xc&&(a=Hb(),a===xc&&(a=Ib())),br--,a===xc&&(b=xc,0===br&&j(Dn)),a}function Gb(){var a,b;return br++,a=Xb(),a===xc&&(a=Wb(),a===xc&&(a=Vb())),br--,a===xc&&(b=xc,0===br&&j(En)),a}function Hb(){var a,b;return br++,a=$b(),a===xc&&(a=Zb(),a===xc&&(a=Yb())),br--,a===xc&&(b=xc,0===br&&j(Fn)),a}function Ib(){var a,b;return br++,a=bc(),a===xc&&(a=ac(),a===xc&&(a=_b())),br--,a===xc&&(b=xc,0===br&&j(Gn)),a}function Jb(){var b,c;return br++,b=Yq,a.substr(Yq,4)===In?(c=In,Yq+=4):(c=xc,0===br&&j(Jn)),c===xc&&(a.substr(Yq,4)===Kn?(c=Kn,Yq+=4):(c=xc,0===br&&j(Ln))),c!==xc&&(Zq=b,c=Mn()),b=c,b===xc&&(b=Yq,a.substr(Yq,5)===Nn?(c=Nn,Yq+=5):(c=xc,0===br&&j(On)),c===xc&&(a.substr(Yq,5)===Pn?(c=Pn,Yq+=5):(c=xc,0===br&&j(Qn))),c!==xc&&(Zq=b,c=Rn()),b=c),br--,b===xc&&(c=xc,0===br&&j(Hn)),b}function Kb(){var a,b;return br++,a=Yq,b=fc(),b!==xc&&(Zq=a,b=Tn(b)),a=b,a===xc&&(a=Yq,b=gc(),b!==xc&&(Zq=a,b=Tn(b)),a=b,a===xc&&(a=Yq,b=dc(),b!==xc&&(Zq=a,b=Tn(b)),a=b,a===xc&&(a=Yq,b=ec(),b!==xc&&(Zq=a,b=Tn(b)),a=b))),br--,a===xc&&(b=xc,0===br&&j(Sn)),a}function Lb(){var a,b;return br++,a=Yq,b=Ob(),b!==xc&&(Zq=a,b=Vn(b)),a=b,a===xc&&(a=Yq,b=Mb(),b!==xc&&(Zq=a,b=Wn(b)),a=b),br--,a===xc&&(b=xc,0===br&&j(Un)),a}function Mb(){var a,b;return br++,a=Yq,b=Qb(),b!==xc&&(Zq=a,b=Yn(b)),a=b,a===xc&&(a=Yq,b=Pb(),b!==xc&&(Zq=a,b=Zn(b)),a=b),br--,a===xc&&(b=xc,0===br&&j(Xn)),a}function Nb(){var a,b;return br++,a=Yq,b=Rb(),b!==xc&&(Zq=a,b=_n(b)),a=b,a===xc&&(a=Yq,b=lc(),b!==xc&&(Zq=a,b=ao()),a=b),br--,a===xc&&(b=xc,0===br&&j($n)),a}function Ob(){var b,c,d,e;if(br++,b=Yq,60===a.charCodeAt(Yq)?(c=ak,Yq++):(c=xc,0===br&&j(bk)),c!==xc){for(d=[],co.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(eo));e!==xc;)d.push(e),co.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(eo));d!==xc?(62===a.charCodeAt(Yq)?(e=ck,Yq++):(e=xc,0===br&&j(dk)),e!==xc?(Zq=b,c=fo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(bo)),b}function Pb(){var b,c,d;return br++,b=Yq,c=qc(),c===xc&&(c=null),c!==xc?(58===a.charCodeAt(Yq)?(d=ho,Yq++):(d=xc,0===br&&j(io)),d!==xc?(Zq=b,c=Wn(c),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(go)),b}function Qb(){var a,b,c;return br++,a=Yq,b=Pb(),b!==xc?(c=rc(),c!==xc?(Zq=a,b=ko(b,c),a=b):(Yq=a,a=xc)):(Yq=a,a=xc),br--,a===xc&&(b=xc,0===br&&j(jo)),a}function Rb(){var b,c,d;return br++,b=Yq,a.substr(Yq,2)===mo?(c=mo,Yq+=2):(c=xc,0===br&&j(no)),c!==xc?(d=rc(),d!==xc?(Zq=b,c=oo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(lo)),b}function Sb(){var b,c,d;return br++,b=Yq,63===a.charCodeAt(Yq)?(c=hj,Yq++):(c=xc,0===br&&j(ij)),c!==xc?(d=oc(),d!==xc?(Zq=b,c=qo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(po)),b}function Tb(){var b,c,d;return br++,b=Yq,36===a.charCodeAt(Yq)?(c=so,Yq++):(c=xc,0===br&&j(to)),c!==xc?(d=oc(),d!==xc?(Zq=b,c=qo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(ro)),b}function Ub(){var b,c,d,e,f,g,h,i;if(br++,b=Yq,64===a.charCodeAt(Yq)?(c=vo,Yq++):(c=xc,0===br&&j(wo)),c!==xc){if(d=[],xo.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(yo)),e!==xc)for(;e!==xc;)d.push(e),xo.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(yo));else d=xc;if(d!==xc){if(e=[],f=Yq,45===a.charCodeAt(Yq)?(g=Bk,Yq++):(g=xc,0===br&&j(Ck)),g!==xc){if(h=[],zo.test(a.charAt(Yq))?(i=a.charAt(Yq),Yq++):(i=xc,0===br&&j(Ao)),i!==xc)for(;i!==xc;)h.push(i),zo.test(a.charAt(Yq))?(i=a.charAt(Yq),Yq++):(i=xc,0===br&&j(Ao));else h=xc;h!==xc?(g=[g,h],f=g):(Yq=f,f=xc)}else Yq=f,f=xc;for(;f!==xc;)if(e.push(f),f=Yq,45===a.charCodeAt(Yq)?(g=Bk,Yq++):(g=xc,0===br&&j(Ck)),g!==xc){if(h=[],zo.test(a.charAt(Yq))?(i=a.charAt(Yq),Yq++):(i=xc,0===br&&j(Ao)),i!==xc)for(;i!==xc;)h.push(i),zo.test(a.charAt(Yq))?(i=a.charAt(Yq),Yq++):(i=xc,0===br&&j(Ao));else h=xc;h!==xc?(g=[g,h],f=g):(Yq=f,f=xc)}else Yq=f,f=xc;e!==xc?(Zq=b,c=Bo(d,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(uo)),b}function Vb(){var b,c,d;if(br++,b=Yq,c=[],Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo)),d!==xc)for(;d!==xc;)c.push(d),Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo));else c=xc;return c!==xc&&(Zq=b,c=Fo(c)),b=c,br--,b===xc&&(c=xc,0===br&&j(Co)),b}function Wb(){var b,c,d,e,f;if(br++,b=Yq,c=[],Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo)),d!==xc)for(;d!==xc;)c.push(d),Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo));else c=xc;if(c!==xc)if(46===a.charCodeAt(Yq)?(d=ah,Yq++):(d=xc,0===br&&j(bh)),d!==xc){for(e=[],Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo));f!==xc;)e.push(f),Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo));e!==xc?(Zq=b,c=Ho(c,d,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc)if(b=Yq,46===a.charCodeAt(Yq)?(c=ah,Yq++):(c=xc,0===br&&j(bh)),c!==xc){if(d=[],Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo)),e!==xc)for(;e!==xc;)d.push(e),Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo));else d=xc;d!==xc?(Zq=b,c=Io(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Go)),b}function Xb(){var b,c,d,e,f;if(br++,b=Yq,c=[],Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo)),d!==xc)for(;d!==xc;)c.push(d),Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo));else c=xc;if(c!==xc)if(46===a.charCodeAt(Yq)?(d=ah,Yq++):(d=xc,0===br&&j(bh)),d!==xc){for(e=[],Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo));f!==xc;)e.push(f),Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo));e!==xc?(f=cc(),f!==xc?(Zq=b,c=Ko(c,d,e,f),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;if(b===xc){if(b=Yq,46===a.charCodeAt(Yq)?(c=ah,Yq++):(c=xc,0===br&&j(bh)),c!==xc){if(d=[],Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo)),e!==xc)for(;e!==xc;)d.push(e),Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo));else d=xc;d!==xc?(e=cc(),e!==xc?(Zq=b,c=Lo(c,d,e),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;if(b===xc){if(b=Yq,c=[],Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo)),d!==xc)for(;d!==xc;)c.push(d),Do.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(Eo));else c=xc;c!==xc?(d=cc(),d!==xc?(Zq=b,c=Mo(c,d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}}return br--,b===xc&&(c=xc,0===br&&j(Jo)),b}function Yb(){var b,c,d;return br++,b=Yq,43===a.charCodeAt(Yq)?(c=jj,Yq++):(c=xc,0===br&&j(kj)),c!==xc?(d=Vb(),d!==xc?(Zq=b,c=Oo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(No)),b}function Zb(){var b,c,d;return br++,b=Yq,43===a.charCodeAt(Yq)?(c=jj,Yq++):(c=xc,0===br&&j(kj)),c!==xc?(d=Wb(),d!==xc?(Zq=b,c=Qo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(Po)),b}function $b(){var b,c,d;return br++,b=Yq,43===a.charCodeAt(Yq)?(c=jj,Yq++):(c=xc,0===br&&j(kj)),c!==xc?(d=Xb(),d!==xc?(Zq=b,c=Qo(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(Ro)),b}function _b(){var b,c,d;return br++,b=Yq,45===a.charCodeAt(Yq)?(c=Bk,Yq++):(c=xc,0===br&&j(Ck)),c!==xc?(d=Vb(),d!==xc?(Zq=b,c=To(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(So)),b}function ac(){var b,c,d;return br++,b=Yq,45===a.charCodeAt(Yq)?(c=Bk,Yq++):(c=xc,0===br&&j(Ck)),c!==xc?(d=Wb(),d!==xc?(Zq=b,c=To(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(Uo)),b}function bc(){var b,c,d;return br++,b=Yq,45===a.charCodeAt(Yq)?(c=Bk,Yq++):(c=xc,0===br&&j(Ck)),c!==xc?(d=Xb(),d!==xc?(Zq=b,c=To(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(Vo)),b}function cc(){var b,c,d,e,f;if(br++,b=Yq,Xo.test(a.charAt(Yq))?(c=a.charAt(Yq),Yq++):(c=xc,0===br&&j(Yo)),c!==xc)if(Zo.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j($o)),d===xc&&(d=null),d!==xc){if(e=[],Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo)),f!==xc)for(;f!==xc;)e.push(f),Do.test(a.charAt(Yq))?(f=a.charAt(Yq),Yq++):(f=xc,0===br&&j(Eo));else e=xc;e!==xc?(Zq=b,c=_o(c,d,e),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Wo)),b}function dc(){var b,c,d,e;if(br++,b=Yq,39===a.charCodeAt(Yq)?(c=bp,Yq++):(c=xc,0===br&&j(cp)),c!==xc){for(d=[],dp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(ep)),e===xc&&(e=hc());e!==xc;)d.push(e),dp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(ep)),e===xc&&(e=hc());d!==xc?(39===a.charCodeAt(Yq)?(e=bp,Yq++):(e=xc,0===br&&j(cp)),e!==xc?(Zq=b,c=fp(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(ap)),b}function ec(){var b,c,d,e;if(br++,b=Yq,34===a.charCodeAt(Yq)?(c=hp,Yq++):(c=xc,0===br&&j(ip)),c!==xc){for(d=[],jp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(kp)),e===xc&&(e=hc());e!==xc;)d.push(e),jp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(kp)),e===xc&&(e=hc());d!==xc?(34===a.charCodeAt(Yq)?(e=hp,Yq++):(e=xc,0===br&&j(ip)),e!==xc?(Zq=b,c=fp(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(gp)),b}function fc(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,3)===mp?(c=mp,Yq+=3):(c=xc,0===br&&j(np)),c!==xc){for(d=[],op.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(pp)),e===xc&&(e=hc());e!==xc;)d.push(e),op.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(pp)),e===xc&&(e=hc());d!==xc?(a.substr(Yq,3)===mp?(e=mp,Yq+=3):(e=xc,0===br&&j(np)),e!==xc?(Zq=b,c=fp(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(lp)),b}function gc(){var b,c,d,e;if(br++,b=Yq,a.substr(Yq,3)===rp?(c=rp,Yq+=3):(c=xc,0===br&&j(sp)),c!==xc){for(d=[],tp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(up)),e===xc&&(e=hc());e!==xc;)d.push(e),tp.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(up)),e===xc&&(e=hc());d!==xc?(a.substr(Yq,3)===rp?(e=rp,Yq+=3):(e=xc,0===br&&j(sp)),e!==xc?(Zq=b,c=fp(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(qp)),b}function hc(){var b,c,d;return br++,b=Yq,92===a.charCodeAt(Yq)?(c=wp,Yq++):(c=xc,0===br&&j(xp)),c!==xc?(yp.test(a.charAt(Yq))?(d=a.charAt(Yq),Yq++):(d=xc,0===br&&j(zp)),d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(vp)),b}function ic(){var b,c,d,e;if(br++,b=Yq,40===a.charCodeAt(Yq)?(c=gd,Yq++):(c=xc,0===br&&j(hd)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(41===a.charCodeAt(Yq)?(e=md,Yq++):(e=xc,0===br&&j(nd)),e!==xc?(Zq=b,c=Bp(),b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Ap)),b}function jc(){var b,c;return br++,Dp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Ep)),b===xc&&(Fp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Gp)),b===xc&&(Hp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Ip)),b===xc&&(Jp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Kp)),b===xc&&(b=kc())))),br--,b===xc&&(c=xc,0===br&&j(Cp)),b}function kc(){var b,c,d,e;if(br++,b=Yq,35===a.charCodeAt(Yq)?(c=Mp,Yq++):(c=xc,0===br&&j(Np)),c!==xc){for(d=[],Op.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Pp));e!==xc;)d.push(e),Op.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Pp));d!==xc?(c=[c,d],b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Lp)),b}function lc(){var b,c,d,e;if(br++,b=Yq,91===a.charCodeAt(Yq)?(c=vj,Yq++):(c=xc,0===br&&j(wj)),c!==xc){for(d=[],e=jc();e!==xc;)d.push(e),e=jc();d!==xc?(93===a.charCodeAt(Yq)?(e=xj,Yq++):(e=xc,0===br&&j(yj)),e!==xc?(c=[c,d,e],b=c):(Yq=b,b=xc)):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Qp)),b}function mc(){var b,c;return br++,Sp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Tp)),b===xc&&(Up.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Vp)),b===xc&&(Wp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Xp)),b===xc&&(Yp.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Zp)),b===xc&&($p.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(_p)),b===xc&&(aq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(bq)),b===xc&&(cq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(dq)),b===xc&&(eq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(fq)),b===xc&&(gq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(hq)),b===xc&&(iq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(jq)),b===xc&&(kq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(lq)),b===xc&&(mq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(nq)),b===xc&&(oq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(pq)),b===xc&&(qq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(rq))))))))))))))),br--,b===xc&&(c=xc,0===br&&j(Rp)),b}function nc(){var b,c;return br++,b=mc(),b===xc&&(95===a.charCodeAt(Yq)?(b=tq,Yq++):(b=xc,0===br&&j(uq))),br--,b===xc&&(c=xc,0===br&&j(sq)),b}function oc(){var b,c,d,e;if(br++,b=Yq,c=nc(),c===xc&&(Do.test(a.charAt(Yq))?(c=a.charAt(Yq),Yq++):(c=xc,0===br&&j(Eo))),c!==xc){for(d=[],e=nc(),e===xc&&(Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo)),e===xc&&(wq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(xq)),e===xc&&(yq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(zq)),e===xc&&(Aq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Bq))))));e!==xc;)d.push(e),e=nc(),e===xc&&(Do.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Eo)),e===xc&&(wq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(xq)),e===xc&&(yq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(zq)),e===xc&&(Aq.test(a.charAt(Yq))?(e=a.charAt(Yq),Yq++):(e=xc,0===br&&j(Bq))))));d!==xc?(Zq=b,c=Cq(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(vq)),b}function pc(){var b,c;return br++,b=nc(),b===xc&&(45===a.charCodeAt(Yq)?(b=Bk,Yq++):(b=xc,0===br&&j(Ck)),b===xc&&(Do.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Eo)),b===xc&&(wq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(xq)),b===xc&&(yq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(zq)),b===xc&&(Aq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Bq))))))),br--,b===xc&&(c=xc,0===br&&j(Dq)),b}function qc(){var b,c,d,e;if(br++,b=Yq,c=mc(),c!==xc){for(d=[],e=pc(),e===xc&&(46===a.charCodeAt(Yq)?(e=ah,Yq++):(e=xc,0===br&&j(bh)));e!==xc;)d.push(e),e=pc(),e===xc&&(46===a.charCodeAt(Yq)?(e=ah,Yq++):(e=xc,0===br&&j(bh)));d!==xc?(Zq=b,c=Fq(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Eq)),b}function rc(){var b,c,d,e;if(br++,b=Yq,c=nc(),c===xc&&(Do.test(a.charAt(Yq))?(c=a.charAt(Yq),Yq++):(c=xc,0===br&&j(Eo)),c===xc&&(58===a.charCodeAt(Yq)?(c=ho,Yq++):(c=xc,0===br&&j(io)),c===xc&&(c=sc()))),c!==xc){for(d=[],e=pc(),e===xc&&(46===a.charCodeAt(Yq)?(e=ah,Yq++):(e=xc,0===br&&j(bh)),e===xc&&(58===a.charCodeAt(Yq)?(e=ho,Yq++):(e=xc,0===br&&j(io)),e===xc&&(e=sc())));e!==xc;)d.push(e),e=pc(),e===xc&&(46===a.charCodeAt(Yq)?(e=ah,Yq++):(e=xc,0===br&&j(bh)),e===xc&&(58===a.charCodeAt(Yq)?(e=ho,Yq++):(e=xc,0===br&&j(io)),e===xc&&(e=sc())));d!==xc?(Zq=b,c=Hq(c,d),b=c):(Yq=b,b=xc)}else Yq=b,b=xc;return br--,b===xc&&(c=xc,0===br&&j(Gq)),b}function sc(){var a,b;return br++,a=tc(),a===xc&&(a=vc()),br--,a===xc&&(b=xc,0===br&&j(Iq)),a}function tc(){var b,c,d,e,f;return br++,b=Yq,c=Yq,37===a.charCodeAt(Yq)?(d=Kq,Yq++):(d=xc,0===br&&j(Lq)),d!==xc?(e=uc(),e!==xc?(f=uc(),f!==xc?(d=[d,e,f],c=d):(Yq=c,c=xc)):(Yq=c,c=xc)):(Yq=c,c=xc),c!==xc&&(Zq=b,c=Mq(c)),b=c,br--,b===xc&&(c=xc,0===br&&j(Jq)),b}function uc(){var b,c;return br++,Do.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Eo)),b===xc&&(Oq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Pq)),b===xc&&(Qq.test(a.charAt(Yq))?(b=a.charAt(Yq),Yq++):(b=xc,0===br&&j(Rq)))),br--,b===xc&&(c=xc,0===br&&j(Nq)),b}function vc(){var b,c,d;return br++,b=Yq,92===a.charCodeAt(Yq)?(c=wp,Yq++):(c=xc,0===br&&j(xp)),c!==xc?(95===a.charCodeAt(Yq)?(d=tq,Yq++):(d=xc,0===br&&j(uq)),d===xc&&(126===a.charCodeAt(Yq)?(d=Tq,Yq++):(d=xc,0===br&&j(Uq)),d===xc&&(46===a.charCodeAt(Yq)?(d=ah,Yq++):(d=xc,0===br&&j(bh)),d===xc&&(45===a.charCodeAt(Yq)?(d=Bk,Yq++):(d=xc,0===br&&j(Ck)),d===xc&&(33===a.charCodeAt(Yq)?(d=mj,Yq++):(d=xc,0===br&&j(nj)),d===xc&&(36===a.charCodeAt(Yq)?(d=so,Yq++):(d=xc,0===br&&j(to)),d===xc&&(38===a.charCodeAt(Yq)?(d=Vq,Yq++):(d=xc,0===br&&j(Wq)),d===xc&&(39===a.charCodeAt(Yq)?(d=bp,Yq++):(d=xc,0===br&&j(cp)),d===xc&&(40===a.charCodeAt(Yq)?(d=gd,Yq++):(d=xc,0===br&&j(hd)),d===xc&&(41===a.charCodeAt(Yq)?(d=md,Yq++):(d=xc,0===br&&j(nd)),d===xc&&(42===a.charCodeAt(Yq)?(d=od,Yq++):(d=xc,0===br&&j(pd)),d===xc&&(43===a.charCodeAt(Yq)?(d=jj,Yq++):(d=xc,0===br&&j(kj)),d===xc&&(44===a.charCodeAt(Yq)?(d=ji,Yq++):(d=xc,0===br&&j(ki)),d===xc&&(59===a.charCodeAt(Yq)?(d=rf,Yq++):(d=xc,0===br&&j(sf)),d===xc&&(58===a.charCodeAt(Yq)?(d=ho,Yq++):(d=xc,0===br&&j(io)),d===xc&&(61===a.charCodeAt(Yq)?(d=Yj,Yq++):(d=xc,0===br&&j(Zj)),d===xc&&(47===a.charCodeAt(Yq)?(d=Zi,Yq++):(d=xc,0===br&&j($i)),d===xc&&(63===a.charCodeAt(Yq)?(d=hj,Yq++):(d=xc,0===br&&j(ij)),d===xc&&(35===a.charCodeAt(Yq)?(d=Mp,Yq++):(d=xc,0===br&&j(Np)),d===xc&&(64===a.charCodeAt(Yq)?(d=vo,Yq++):(d=xc,0===br&&j(wo)),d===xc&&(37===a.charCodeAt(Yq)?(d=Kq,Yq++):(d=xc,0===br&&j(Lq)))))))))))))))))))))),d!==xc?(Zq=b,c=Xq(d),b=c):(Yq=b,b=xc)):(Yq=b,b=xc),br--,b===xc&&(c=xc,0===br&&j(Sq)),b}c=void 0!==c?c:{};var wc,xc={},yc={DOCUMENT:l},zc=l,Ac=g("[1] QueryUnit"),Bc=g("[2] Query"),Cc=function(a,b,c){return{token:"query",kind:"query",prologue:a,units:[b],inlineData:c}},Dc=g("[3] Prologue"),Ec=function(a,b){return{token:"prologue",base:a,prefixes:b}},Fc=g("[4] BaseDecl"),Gc="BASE",Hc=d("BASE",!1),Ic="base",Jc=d("base",!1),Kc=function(a){gr(a);var b={};return b.token="base",b.value=a,b},Lc=g("[5] PrefixDecl"),Mc="PREFIX",Nc=d("PREFIX",!1),Oc="prefix",Pc=d("prefix",!1),Qc=function(a,b){fr(a,b);var c={};return c.token="prefix",c.prefix=a,c.local=b,c},Rc=g("[6] SelectQuery"),Sc=function(a,b,c,d){for(var e={named:[],implicit:[]},f=0;f<b.length;f++){var g=b[f];"default"===g.kind?e.implicit.push(g.graph):e.named.push(g.graph)}0===e.named.length&&0===e.implicit.length&&e.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var h={};return h.kind="select",h.token="executableunit",h.dataset=e,h.projection=a.vars,h.modifier=a.modifier,h.pattern=c,null!=d&&null!=d.limit&&(h.limit=d.limit),null!=d&&null!=d.offset&&(h.offset=d.offset),null!=d&&null!=d.order&&""!=d.order&&(h.order=d.order),null!=d&&null!=d.group&&(h.group=d.group),h},Tc=g("[7] SubSelect"),Uc=function(a,b,c){var d={};return d.kind="select",d.token="subselect",d.projection=a.vars,d.modifier=a.modifier,d.pattern=b,null!=c&&null!=c.limit&&(d.limit=c.limit),null!=c&&null!=c.offset&&(d.offset=c.offset),null!=c&&null!=c.order&&""!=c.order&&(d.order=c.order),null!=c&&null!=c.group&&(d.group=c.group),d},Vc=g("[8] SelectClause"),Wc="SELECT",Xc=d("SELECT",!1),Yc="select",Zc=d("select",!1),$c="DISTINCT",_c=d("DISTINCT",!1),ad="distinct",bd=d("distinct",!1),cd="REDUCED",dd=d("REDUCED",!1),ed="reduced",fd=d("reduced",!1),gd="(",hd=d("(",!1),id="AS",jd=d("AS",!1),kd="as",ld=d("as",!1),md=")",nd=d(")",!1),od="*",pd=d("*",!1),qd=function(a,b){var c=[];if(3===b.length&&"*"===b[1])return{vars:[{token:"variable",kind:"*"}],modifier:hr(a)};for(var d=0;d<b.length;d++){var e=b[d];3===e.length?c.push({token:"variable",kind:"var",value:e[1]}):c.push({token:"variable",kind:"aliased",expression:e[3],alias:e[7]})}return{vars:c,modifier:hr(a)}},rd=g("[9] ConstructQuery"),sd="CONSTRUCT",td=d("CONSTRUCT",!1),ud="construct",vd=d("construct",!1),wd=function(a,b,c,d){for(var e={named:[],implicit:[]},f=0;f<b.length;f++){var g=b[f];"default"===g.kind?e.implicit.push(g.graph):e.named.push(g.graph)}0===e.named.length&&0===e.implicit.length&&e.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var h={};return h.kind="construct",h.token="executableunit",h.dataset=e,h.template=a,h.pattern=c,null!=d&&null!=d.limit&&(h.limit=d.limit),null!=d&&null!=d.offset&&(h.offset=d.offset),null!=d&&null!=d.order&&""!=d.order&&(h.order=d.order),h},xd="WHERE",yd=d("WHERE",!1),zd="where",Ad=d("where",!1),Bd="{",Cd=d("{",!1),Dd="}",Ed=d("}",!1),Fd=function(a,b,c){for(var d={named:[],implicit:[]},e=0;e<a.length;e++){var f=a[e];"default"===f.kind?d.implicit.push(f.graph):d.named.push(f.graph)}0===d.named.length&&0===d.implicit.length&&d.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var g={};return g.kind="construct",g.token="executableunit",g.dataset=d,g.template=b,g.pattern={token:"basicgraphpattern",triplesContext:b.triplesContext},null!=c&&null!=c.limit&&(g.limit=c.limit),null!=c&&null!=c.offset&&(g.offset=c.offset),null!=c&&null!=c.order&&""!=c.order&&(g.order=c.order),g},Gd=g("[10] DescribeQuery"),Hd="DESCRIBE",Id=d("DESCRIBE",!1),Jd=g("[11] AskQuery"),Kd="ASK",Ld=d("ASK",!1),Md="ask",Nd=d("ask",!1),Od=function(a,b){for(var c={named:[],implicit:[]},d=0;d<a.length;d++){var e=a[d];"implicit"===e.kind?c.implicit.push(e.graph):c.named.push(e.graph)}0===c.named.length&&0===c.implicit.length&&c.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var f={};return f.kind="ask",f.token="executableunit",f.dataset=c,f.pattern=b,f},Pd=g("[12] DatasetClause"),Qd="FROM",Rd=d("FROM",!1),Sd="from",Td=d("from",!1),Ud=function(a){return a},Vd=g("[13] DefaultGraphClause"),Wd=function(a){return{graph:a,kind:"default",token:"graphClause"}},Xd=g("[14] NamedGraphClause"),Yd="NAMED",Zd=d("NAMED",!1),$d="named",_d=d("named",!1),ae=function(a){return{graph:a,kind:"named",token:"graphCluase"}},be=g("[15] SourceSelector"),ce=g("[16] WhereClause"),de=function(a){return a},ee=g("[17] SolutionModifier"),fe=function(a,b,c){var d={};return null!=c&&(null!=c.limit&&(d.limit=c.limit),null!=c.offset&&(d.offset=c.offset)),null!=a&&(d.group=a),d.order=b,d},ge=g("[18] GroupClause"),he="GROUP",ie=d("GROUP",!1),je="group",ke=d("group",!1),le="BY",me=d("BY",!1),ne="by",oe=d("by",!1),pe=function(a){return a},qe=g("[19] GroupCondition"),re=function(a){return a},se=function(a){return a},te=function(a,b){return 0!=b.length?{token:"aliased_expression",expression:a,alias:b[2]}:a},ue=function(a){return a},ve=g("[20] HavingClause"),we="HAVING",xe=d("HAVING",!1),ye=g("[21] HavingCondition"),ze=g("[22] OrderClause"),Ae="ORDER",Be=d("ORDER",!1),Ce="order",De=d("order",!1),Ee=function(a){return a},Fe=g("[23] OrderCondition"),Ge="ASC",He=d("ASC",!1),Ie="asc",Je=d("asc",!1),Ke="DESC",Le=d("DESC",!1),Me="desc",Ne=d("desc",!1),Oe=function(a,b){return{direction:a.toUpperCase(),expression:b}},Pe=function(a){if("var"===a.token)var a={token:"expression",expressionType:"atomic",primaryexpression:"var",value:a};return{direction:"ASC",expression:a}},Qe=g("[24] LimitOffsetClauses"),Re=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];null!=d&&null!=d.limit?b.limit=d.limit:null!=d&&null!=d.offset&&(b.offset=d.offset)}return b},Se=g("[25] LimitClause"),Te="LIMIT",Ue=d("LIMIT",!1),Ve="limit",We=d("limit",!1),Xe=function(a){return{limit:parseInt(a.value)}},Ye=g("[26] OffsetClause"),Ze="OFFSET",$e=d("OFFSET",!1),_e="offset",af=d("offset",!1),bf=function(a){return{offset:parseInt(a.value)}},cf=g("[27] BindingsClause"),df="BINDINGS",ef=d("BINDINGS",!1),ff=g("[28] BindingValue"),gf="UNDEF",hf=d("UNDEF",!1),jf=g("[28]	ValuesClause	  ::=	( 'VALUES' DataBlock )?"),kf="VALUES",lf=d("VALUES",!1),mf="values",nf=d("values",!1),of=function(a){return null!=a?a[1]:null},pf=g("[29] UpdateUnit"),qf=g("[30] Update"),rf=";",sf=d(";",!1),tf=function(a,b,c){var d={};d.token="query",d.kind="update",d.prologue=a;var e=[b];return null!=c&&null!=c.length&&null!=c[3]&&null!=c[3].units&&(e=e.concat(c[3].units)),d.units=e,d},uf=g("[31] Update1"),vf=g("[32] Load"),wf="LOAD",xf=d("LOAD",!1),yf="load",zf=d("load",!1),Af="INTO",Bf=d("INTO",!1),Cf="into",Df=d("into",!1),Ef=function(a,b){var c={};return c.kind="load",c.token="executableunit",c.sourceGraph=a,null!=b&&(c.destinyGraph=b[2]),c},Ff=g("[33] Clear"),Gf="CLEAR",Hf=d("CLEAR",!1),If="clear",Jf=d("clear",!1),Kf="SILENT",Lf=d("SILENT",!1),Mf="silent",Nf=d("silent",!1),Of=function(a){var b={};return b.kind="clear",b.token="executableunit",b.destinyGraph=a,b},Pf=g("[34] Drop"),Qf="DROP",Rf=d("DROP",!1),Sf="drop",Tf=d("drop",!1),Uf=function(a){var b={};return b.kind="drop",b.token="executableunit",b.destinyGraph=a,b},Vf=g("[35] Create"),Wf="CREATE",Xf=d("CREATE",!1),Yf="create",Zf=d("create",!1),$f=function(a){var b={};return b.kind="create",b.token="executableunit",b.destinyGraph=a,b},_f=g("[36] InsertData"),ag="INSERT",bg=d("INSERT",!1),cg="insert",dg=d("insert",!1),eg="DATA",fg=d("DATA",!1),gg="data",hg=d("data",!1),ig=function(a){var b={};return b.kind="insertdata",b.token="executableunit",b.quads=a,b},jg=g("[37] DeleteData"),kg="DELETE",lg=d("DELETE",!1),mg="delete",ng=d("delete",!1),og=function(a){var b={};return b.kind="deletedata",b.token="executableunit",b.quads=a,b},pg=g("[38] DeleteWhere"),qg=function(a){var b={};b.kind="modify",b.pattern=a,b["with"]=null,b.using=null;var c=[],d=a.patterns[0];d=null==d.triplesContext&&null!=d.patterns?d.patterns[0].triplesContext:d.triplesContext;for(var e=0;e<d.length;e++){var f={},g=d[e];f.subject=g.subject,f.predicate=g.predicate,f.object=g.object,f.graph=g.graph,c.push(f)}return b["delete"]=c,b},rg=g("[39] Modify"),sg="WITH",tg=d("WITH",!1),ug="with",vg=d("with",!1),wg=function(a,b,c,d){var e={};return e.kind="modify",""!=a&&null!=a?e["with"]=a[2]:e["with"]=null,3!==b.length||""!==b[2]&&null!=b[2]?3===b.length&&null!=b[0].length&&null!=b[1].length&&null!=b[2].length?(e["delete"]=b[0],e.insert=b[2]):(e.insert=b,e["delete"]=null):(e["delete"]=b[0],e.insert=null),""!=c&&(e.using=c),e.pattern=d,e},xg=g("[40] DeleteClause"),yg=function(a){return a},zg=g("[41] InsertClause"),Ag=g("[42] UsingClause"),Bg="USING",Cg=d("USING",!1),Dg="using",Eg=d("using",!1),Fg=function(a){
return null!=a.length?{kind:"named",uri:a[2]}:{kind:"default",uri:a}},Gg=g("[43] GraphRef"),Hg="GRAPH",Ig=d("GRAPH",!1),Jg="graph",Kg=d("graph",!1),Lg=function(a){return a},Mg=g("[44] GraphRefAll"),Ng="DEFAULT",Og=d("DEFAULT",!1),Pg="default",Qg=d("default",!1),Rg=function(){return"default"},Sg=function(){return"named"},Tg="ALL",Ug=d("ALL",!1),Vg="all",Wg=d("all",!1),Xg=function(){return"all"},Yg=g("[45] QuadPattern"),Zg=function(a){return a.quadsContext},$g=g("[46] QuadData"),_g=g("[47] Quads"),ah=".",bh=d(".",!1),ch=function(a,b){var c=[];if(null!=a&&null!=a.triplesContext)for(var d=0;d<a.triplesContext.length;d++){var e=a.triplesContext[d];e.graph=null,c.push(e)}if(b&&b.length>0&&b[0].length>0&&(c=c.concat(b[0][0].quadsContext),null!=b[0][2]&&null!=b[0][2].triplesContext))for(var d=0;d<b[0][2].triplesContext.length;d++){var e=b[0][2].triplesContext[d];e.graph=null,c.push(e)}return{token:"quads",quadsContext:c}},dh=g("[48] QuadsNotTriples"),eh=function(a,b){var c=[];if(null!=b)for(var d=0;d<b.triplesContext.length;d++){var e=b.triplesContext[d];e.graph=a,c.push(e)}return{token:"quadsnottriples",quadsContext:c}},fh=g("[49] TriplesTemplate"),gh=function(a,b){var c=a.triplesContext;return null!=b&&"object"==typeof b&&null!=b.length&&null!=b[3]&&null!=b[3].triplesContext&&(c=c.concat(b[3].triplesContext)),{token:"triplestemplate",triplesContext:c}},hh=g("[50] GroupGraphPattern"),ih=function(a){return a},jh=g("[51] GroupGraphPatternSub"),kh=function(a,b){var c=[];null!=a&&a!=[]&&c.push(a);for(var d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)null!=b[d][e]&&null!=b[d][e].token&&c.push(b[d][e]);for(var f=[],g=[],h=[],i=[],d=0;d<c.length;d++)if("triplespattern"!==c[d].token&&"filter"!==c[d].token&&"bind"!==c[d].token){if(0!=g.length||0!=h.length){for(var j=[],e=0;e<g.length;e++)j=j.concat(g[e].triplesContext);j.length>0&&f.push({token:"basicgraphpattern",triplesContext:j}),g=[]}f.push(c[d])}else"triplespattern"===c[d].token?g.push(c[d]):"bind"===c[d].token?i.push(c[d]):h.push(c[d]);if(0!=g.length||0!=h.length){for(var j=[],e=0;e<g.length;e++)j=j.concat(g[e].triplesContext);j.length>0&&f.push({token:"basicgraphpattern",triplesContext:j})}return{token:"groupgraphpattern",patterns:f,filters:h,binds:i}},lh=g("[54] TriplesBlock"),mh=function(a,b){var c=a.triplesContext;return null!=b&&"object"==typeof b&&null!=b&&null!=b.length&&null!=b[2]&&null!=b[2].triplesContext&&(c=c.concat(b[2].triplesContext)),{token:"triplespattern",triplesContext:c}},nh=g("[53] GraphPatternNotTriples"),oh=g("[54] OptionalGraphPattern"),ph="OPTIONAL",qh=d("OPTIONAL",!1),rh="optional",sh=d("optional",!1),th=function(a){return{token:"optionalgraphpattern",value:a}},uh=g("[55] GraphGraphPattern"),vh=function(a,b){for(var c=0;c<b.patterns.length;c++)for(var d=b.patterns[c],e=0;e<d.triplesContext.length;e++){var f=d.triplesContext[e];f.graph=a}return b.token="groupgraphpattern",b},wh=g("[56] ServiceGraphPattern"),xh="SERVICE",yh=d("SERVICE",!1),zh=function(a,b){return{token:"servicegraphpattern",status:"todo",value:[a,b]}},Ah=g("[57] MinusGraphPattern"),Bh="MINUS",Ch=d("MINUS",!1),Dh="minus",Eh=d("minus",!1),Fh=function(a){return{token:"minusgraphpattern",status:"todo",value:a}},Gh=g("[58] GroupOrUnionGraphPattern"),Hh="UNION",Ih=d("UNION",!1),Jh="union",Kh=d("union",!1),Lh=function(a,b){if(0===b.length)return a;for(var c={token:"graphunionpattern",value:[a]},d=0;d<b.length;d++)if(d==b.length-1)c.value.push(b[d][3]);else{c.value.push(b[d][3]);var e={token:"graphunionpattern",value:[c]};c=e}return c},Mh=g("[59] Filter"),Nh="FILTER",Oh=d("FILTER",!1),Ph="filter",Qh=d("filter",!1),Rh=function(a){return{token:"filter",value:a}},Sh=g("[60] Bind"),Th="BIND",Uh=d("BIND",!1),Vh="bind",Wh=d("bind",!1),Xh=function(a,b){return{token:"bind",expression:a,as:b}},Yh=g("[60] Constraint"),Zh=g("[61] InlineData"),$h=function(a){return a},_h=g("[62] DataBlock"),ai=g("[63] InlineDataOneVar"),bi=function(a,b){var c={token:"inlineData",values:[{"var":a,value:b}]};return c},ci=g("[64] InlineDataFull"),di=function(a,b){var c={token:"inlineData",values:[],todo:!0};return c},ei=g("[65] DataBlockValue"),fi=g("[61] FunctionCall"),gi=function(a,b){var c={};return c.token="expression",c.expressionType="irireforfunction",c.iriref=a,c.args=b.value,c},hi=g("[62] ArgList"),ii=function(){var a={};return a.token="args",a.value=[],a},ji=",",ki=d(",",!1),li=function(a,b,c){for(var d=[],e=0;e<c.length;e++)d.push(c[e][2]);var f={};return f.token="args",f.value=[b].concat(d),null!=a&&"DISTINCT"===a.toUpperCase()?f.distinct=!0:f.distinct=!1,f},mi=g("[63] ExpressionList"),ni=function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(b[d][2]);var e={};return e.token="args",e.value=[a].concat(c),e},oi=g("[64] ConstructTemplate"),pi=function(a){return a},qi=g("[65] ConstructTriples"),ri=function(a,b){var c=a.triplesContext;return null!=b&&"object"==typeof b&&null!=b.length&&null!=b[3]&&null!=b[3].triplesContext&&(c=c.concat(b[3].triplesContext)),{token:"triplestemplate",triplesContext:c}},si=g("[66] TriplesSameSubject"),ti=function(a,b){var c=b.triplesContext,d=a;if(b.pairs)for(var e=0;e<b.pairs.length;e++){var f=b.pairs[e],g=null;null!=f[1].length&&(f[1]=f[1][0]),d.token&&"triplesnodecollection"===d.token?(g={subject:d.chainSubject[0],predicate:f[0],object:f[1]},c.push(g),c=c.concat(d.triplesContext)):(g={subject:d,predicate:f[0],object:f[1]},c.push(g))}var h={};return h.token="triplessamesubject",h.triplesContext=c,h.chainSubject=d,h},ui=function(a,b){var c=a.triplesContext,d=a.chainSubject;if(b.pairs)for(var e=0;e<b.pairs.length;e++){var f=b.pairs[e];if(null!=f[1].length&&(f[1]=f[1][0]),"triplesnodecollection"===a.token)for(var g=0;g<d.length;g++){var h=d[g];if(null!=h.triplesContext){var i={subject:h.chainSubject,predicate:f[0],object:f[1]};c.concat(h.triplesContext)}else{var i={subject:d[g],predicate:f[0],object:f[1]};c.push(i)}}else{var i={subject:d,predicate:f[0],object:f[1]};c.push(i)}}var j={};return j.token="triplessamesubject",j.triplesContext=c,j.chainSubject=d,j},vi=g("[83] PropertyListPathNotEmpty"),wi=function(a,b,c){var d={};d.token="propertylist";for(var e=[],f=[],g=0;g<b.length;g++)null!=b[g].triplesContext?(e=e.concat(b[g].triplesContext),"triplesnodecollection"===b[g].token&&null!=b[g].chainSubject.length?f.push([a,b[g].chainSubject[0]]):f.push([a,b[g].chainSubject])):f.push([a,b[g]]);for(var g=0;g<c.length;g++)for(var h=c[g][3],i=h[0],j=h[2]||[],k=0;k<j.length;k++)null!=j[k].triplesContext?(e=e.concat(j[k].triplesContext),f.push([i,j[k].chainSubject])):f.push([i,j[k]]);return d.pairs=f,d.triplesContext=e,d},xi=g("[67] PropertyListNotEmpty"),yi=function(a,b,c){var d={};d.token="propertylist";for(var e=[],f=[],g=0;g<b.length;g++)null!=b[g].triplesContext?(e=e.concat(b[g].triplesContext),"triplesnodecollection"===b[g].token&&null!=b[g].chainSubject.length?f.push([a,b[g].chainSubject[0]]):f.push([a,b[g].chainSubject])):f.push([a,b[g]]);for(var g=0;g<c.length;g++)for(var h=c[g][3],i=h[0],j=h[2]||[],k=0;k<j.length;k++)null!=j[k].triplesContext?(e=e.concat(j[k].triplesContext),f.push([i,j[k].chainSubject])):f.push([i,j[k]]);return d.pairs=f,d.triplesContext=e,d},zi=g("[68] PropertyList"),Ai=g("[86] ObjectListPath"),Bi=function(a,b){var c=[];c.push(a);for(var d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)"object"==typeof b[d][e]&&null!=b[d][e].token&&c.push(b[d][e]);return c},Ci=g("[69] ObjectList"),Di=function(a,b){var c=[];c.push(a);for(var d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)"object"==typeof b[d][e]&&null!=b[d][e].token&&c.push(b[d][e]);return c},Ei=g("[87] ObjectPath"),Fi=g("[70] Object"),Gi=g("[71] Verb"),Hi="a",Ii=d("a",!1),Ji=function(){return{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}},Ki=g("[72] TriplesSameSubjectPath"),Li=function(a,b){var c=b.triplesContext,d=a;if(b.pairs)for(var e=0;e<b.pairs.length;e++){var f=b.pairs[e],g=null;null!=f[1].length&&(f[1]=f[1][0]),d.token&&"triplesnodecollection"===d.token?(g={subject:d.chainSubject[0],predicate:f[0],object:f[1]},"path"===g.predicate.token&&"element"===g.predicate.kind&&(g.predicate=g.predicate.value),c.push(g),c=c.concat(d.triplesContext)):(g={subject:d,predicate:f[0],object:f[1]},"path"===g.predicate.token&&"element"===g.predicate.kind&&(g.predicate=g.predicate.value),c.push(g))}var h={};return h.token="triplessamesubject",h.triplesContext=c,h.chainSubject=d,h},Mi=function(a,b){var c=a.triplesContext,d=a.chainSubject;if(null!=b&&null!=b.pairs)for(var e=0;e<b.pairs.length;e++){var f=b.pairs[e];if(null!=f[1].length&&(f[1]=f[1][0]),"triplesnodecollection"===a.token)for(var g=0;g<d.length;g++){var h=d[g];if(null!=h.triplesContext){var i={subject:h.chainSubject,predicate:f[0],object:f[1]};c.concat(h.triplesContext)}else{var i={subject:d[g],predicate:f[0],object:f[1]};c.push(i)}}else{var i={subject:d,predicate:f[0],object:f[1]};c.push(i)}}var j={};return j.token="triplessamesubject",j.triplesContext=c,j.chainSubject=d,j},Ni=g("[73] PropertyListNotEmptyPath"),Oi=function(a,b,c){var d={};d.token="propertylist";for(var e=[],f=[],g=0;g<b.length;g++)null!=b[g].triplesContext?(e=e.concat(b[g].triplesContext),"triplesnodecollection"===b[g].token&&null!=b[g].chainSubject.length?f.push([a,b[g].chainSubject[0]]):f.push([a,b[g].chainSubject])):f.push([a,b[g]]);for(var g=0;g<c.length;g++)for(var h=c[g][3],i=h[0],j=h[1]||[],k=0;k<j.length;k++)null!=j[k].triplesContext?(e=e.concat(j[k].triplesContext),f.push([i,j[k].chainSubject])):f.push([i,j[k]]);return d.pairs=f,d.triplesContext=e,d},Pi=g("[74] PropertyListPath"),Qi=g("[75]"),Ri=function(a){var b={};return b.token="path",b.kind="element",b.value=a,a},Si=g("[76] VerbSimple"),Ti=g("[77] Path"),Ui=g("[78] PathAlternative"),Vi="|",Wi=d("|",!1),Xi=function(a,b){if(null==b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++)c.push(b[1]);var e={};return e.token="path",e.kind="alternative",e.value=c,e},Yi=g("[79] PathSequence"),Zi="/",$i=d("/",!1),_i=function(a,b){if(null==b||0===b.length)return a;for(var c=[a],d=0;d<b.length;d++)c.push(b[d][1]);var e={};return e.token="path",e.kind="sequence",e.value=c,e},aj=g("[88] PathElt"),bj=function(a,b){if(a.token&&"path"!=a.token&&""==b)return a;if(a.token&&a.token!=c&&""!=b){var c={};return c.token="path",c.kind="element",c.value=a,c.modifier=b,c}return a.modifier=b,a},cj=g("[81] PathEltOrInverse"),dj="^",ej=d("^",!1),fj=function(a){var b={};return b.token="path",b.kind="inversePath",b.value=a,b},gj=g("[82] PathMod"),hj="?",ij=d("?",!1),jj="+",kj=d("+",!1),lj=g("[83] PathPrimary"),mj="!",nj=d("!",!1),oj=g("[85] PathOneInPropertySet"),pj=g("[86] Integer"),qj=g("[100] TriplesNodePath"),rj=function(a){for(var b=[],c=[],d=null,e=0;e<a.length;e++){dr++;var f=null;null==a[e].chainSubject&&null==a[e].triplesContext?f=a[e]:(f=a[e].chainSubject,b=b.concat(a[e].triplesContext)),d={subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:f},0==e&&c.push(d.subject),b.push(d),d=e===a.length-1?{subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(dr+1)}},b.push(d)}return{token:"triplesnodecollection",triplesContext:b,chainSubject:c}},sj=g("[87] TriplesNode"),tj=function(a){for(var b=[],c=[],d=null,e=0;e<a.length;e++){dr++;var f=null;null==a[e].chainSubject&&null==a[e].triplesContext?f=a[e]:(f=a[e].chainSubject,b=b.concat(f.triplesContext)),d={subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:f},0==e&&c.push(d.subject),b.push(d),d=e===a.length-1?{subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+dr},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(dr+1)}},b.push(d)}return{token:"triplesnodecollection",triplesContext:b,chainSubject:c}},uj=g("[101] BlankNodePropertyListPath"),vj="[",wj=d("[",!1),xj="]",yj=d("]",!1),zj=function(a){dr++;for(var b={token:"blank",value:"_:"+dr},c=[],d=0;d<a.pairs.length;d++){var e=a.pairs[d],f={};f.subject=b,f.predicate=e[0],null!=e[1].length&&(e[1]=e[1][0]),f.object=e[1],c.push(f)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(c),chainSubject:b}},Aj=g("[88] BlankNodePropertyList"),Bj=function(a){dr++;for(var b={token:"blank",value:"_:"+dr},c=[],d=0;d<a.pairs.length;d++){var e=a.pairs[d],f={};f.subject=b,f.predicate=e[0],null!=e[1].length&&(e[1]=e[1][0]),f.object=e[1],c.push(f)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:a.triplesContext.concat(c),chainSubject:b}},Cj=g("[103] CollectionPath"),Dj=function(a){return a},Ej=g("[89] Collection"),Fj=g("[105] GraphNodePath"),Gj=function(a){return a[1]},Hj=g("[90] GraphNode"),Ij=g("[91] VarOrTerm"),Jj=g("[92] VarOrIRIref"),Kj=g("[93] Var"),Lj=function(a){var b={};return b.token="var",b.value=a,b},Mj=g("[94] GraphTerm"),Nj=g("[95] Expression"),Oj=g("[96] ConditionalOrExpression"),Pj="||",Qj=d("||",!1),Rj=function(a,b){if(0===b.length)return a;var c={};c.token="expression",c.expressionType="conditionalor";for(var d=[a],e=0;e<b.length;e++)d.push(b[e][3]);return c.operands=d,c},Sj=g("[97] ConditionalAndExpression"),Tj="&&",Uj=d("&&",!1),Vj=function(a,b){if(0===b.length)return a;var c={};c.token="expression",c.expressionType="conditionaland";for(var d=[a],e=0;e<b.length;e++)d.push(b[e][3]);return c.operands=d,c},Wj=g("[98] ValueLogical"),Xj=g("[99] RelationalExpression"),Yj="=",Zj=d("=",!1),$j="!=",_j=d("!=",!1),ak="<",bk=d("<",!1),ck=">",dk=d(">",!1),ek="<=",fk=d("<=",!1),gk=">=",hk=d(">=",!1),ik="I",jk=d("I",!1),kk="i",lk=d("i",!1),mk="N",nk=d("N",!1),ok="n",pk=d("n",!1),qk="O",rk=d("O",!1),sk="o",tk=d("o",!1),uk="T",vk=d("T",!1),wk="t",xk=d("t",!1),yk=function(a,b){if(0===b.length)return a;if("i"===b[0][1]||"I"===b[0][1]||"n"===b[0][1]||"N"===b[0][1]){var c={};if("i"===b[0][1]||"I"===b[0][1]){var d="=";c.expressionType="conditionalor"}else{var d="!=";c.expressionType="conditionaland"}for(var e=a,f=[],g=0;g<b[0].length;g++)if("args"===b[0][g].token){f=b[0][g].value;break}c.token="expression",c.operands=[];for(var h=0;h<f.length;h++){var i={};i.token="expression",i.expressionType="relationalexpression",i.operator=d,i.op1=e,i.op2=f[h],c.operands.push(i)}return c}var c={};return c.expressionType="relationalexpression",c.operator=b[0][1],c.op1=a,c.op2=b[0][3],c.token="expression",c},zk=g("[100] NumericExpression"),Ak=g("[101] AdditiveExpression"),Bk="-",Ck=d("-",!1),Dk=function(a,b){if(0===b.length)return a;var c={};c.token="expression",c.expressionType="additiveexpression",c.summand=a,c.summands=[];for(var d=0;d<b.length;d++){var e=b[d],f={};if(4==e.length&&"string"==typeof e[1])f.operator=e[1],f.expression=e[3];else{var g={},h=f[0],i=f[1][1],j=f[1][3],i=null;h.value<0?(f.operator="-",h.value=-h.value):f.operator="+",g.token="expression",g.expressionType="multiplicativeexpression",g.operator=h,g.factors=[{operator:i,expression:j}],f.expression=g}c.summands.push(f)}return c},Ek=g("[102] MultiplicativeExpression"),Fk=function(a,b){if(0===b.length)return a;var c={};c.token="expression",c.expressionType="multiplicativeexpression",c.factor=a,c.factors=[];for(var d=0;d<b.length;d++){var e=b[d],f={};f.operator=e[1],f.expression=e[3],c.factors.push(f)}return c},Gk=g("[103] UnaryExpression"),Hk=function(a){var b={};return b.token="expression",b.expressionType="unaryexpression",b.unaryexpression="!",b.expression=a,b},Ik=function(a){var b={};return b.token="expression",b.expressionType="unaryexpression",b.unaryexpression="+",b.expression=a,b},Jk=function(a){var b={};return b.token="expression",b.expressionType="unaryexpression",b.unaryexpression="-",b.expression=a,b},Kk=g("[104] PrimaryExpression"),Lk=function(a){var b={};return b.token="expression",b.expressionType="atomic",b.primaryexpression="rdfliteral",b.value=a,b},Mk=function(a){var b={};return b.token="expression",b.expressionType="atomic",b.primaryexpression="numericliteral",b.value=a,b},Nk=function(a){var b={};return b.token="expression",b.expressionType="atomic",b.primaryexpression="booleanliteral",b.value=a,b},Ok=function(a){var b={};return b.token="expression",b.expressionType="atomic",b.primaryexpression="var",b.value=a,b},Pk=g("[105] BrackettedExpression"),Qk=function(a){return a},Rk=g("[106] BuiltInCall"),Sk="STR",Tk=d("STR",!1),Uk="str",Vk=d("str",!1),Wk=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="str",b.args=[a],b},Xk="LANG",Yk=d("LANG",!1),Zk="lang",$k=d("lang",!1),_k=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="lang",b.args=[a],b},al="LANGMATCHES",bl=d("LANGMATCHES",!1),cl="langmatches",dl=d("langmatches",!1),el=function(a,b){var c={};return c.token="expression",c.expressionType="builtincall",c.builtincall="langmatches",c.args=[a,b],c},fl="DATATYPE",gl=d("DATATYPE",!1),hl="datatype",il=d("datatype",!1),jl=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="datatype",b.args=[a],b},kl="BOUND",ll=d("BOUND",!1),ml="bound",nl=d("bound",!1),ol=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="bound",b.args=[a],b},pl="IRI",ql=d("IRI",!1),rl="iri",sl=d("iri",!1),tl=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="iri",b.args=[a],b},ul="URI",vl=d("URI",!1),wl="uri",xl=d("uri",!1),yl=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="uri",b.args=[a],b},zl="BNODE",Al=d("BNODE",!1),Bl="bnode",Cl=d("bnode",!1),Dl=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="bnode",5===a.length?b.args=[a[2]]:b.args=null,b},El="COALESCE",Fl=d("COALESCE",!1),Gl="coalesce",Hl=d("coalesce",!1),Il=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="coalesce",b.args=a,b},Jl="IF",Kl=d("IF",!1),Ll="if",Ml=d("if",!1),Nl=function(a,b,c){var d={};return d.token="expression",d.expressionType="builtincall",d.builtincall="if",d.args=[a,b,c],d},Ol="ISLITERAL",Pl=d("ISLITERAL",!1),Ql="isliteral",Rl=d("isliteral",!1),Sl="isLITERAL",Tl=d("isLITERAL",!1),Ul=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="isliteral",b.args=[a],b},Vl="ISBLANK",Wl=d("ISBLANK",!1),Xl="isblank",Yl=d("isblank",!1),Zl="isBLANK",$l=d("isBLANK",!1),_l=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="isblank",b.args=[a],b},am="SAMETERM",bm=d("SAMETERM",!1),cm="sameterm",dm=d("sameterm",!1),em=function(a,b){var c={};return c.token="expression",c.expressionType="builtincall",c.builtincall="sameterm",c.args=[a,b],c},fm="ISURI",gm=d("ISURI",!1),hm="isuri",im=d("isuri",!1),jm="isURI",km=d("isURI",!1),lm="ISIRI",mm=d("ISIRI",!1),nm="isiri",om=d("isiri",!1),pm="isIRI",qm=d("isIRI",!1),rm=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="isuri",b.args=[a],b},sm="custom:",tm=d("custom:",!1),um="CUSTOM:",vm=d("CUSTOM:",!1),wm=/^[a-zA-Z0-9_]/,xm=e([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ym=function(a,b,c){var d={};d.token="expression",d.expressionType="custom",d.name=a.join("");for(var e=[],f=0;f<b.length;f++)e.push(b[f][1]);return e.push(c),d.args=e,d},zm=g("[107] RegexExpression"),Am="REGEX",Bm=d("REGEX",!1),Cm="regex",Dm=d("regex",!1),Em=function(a,b,c){var d={};return d.token="expression",d.expressionType="regex",d.text=a,d.pattern=b,null!=c&&(d.flags=c[2]),d},Fm=g("[108] ExistsFunc"),Gm="EXISTS",Hm=d("EXISTS",!1),Im="exists",Jm=d("exists",!1),Km=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="exists",b.args=[a],b},Lm=g("[109] NotExistsFunc"),Mm="NOT",Nm=d("NOT",!1),Om="not",Pm=d("not",!1),Qm=function(a){var b={};return b.token="expression",b.expressionType="builtincall",b.builtincall="notexists",b.args=[a],b},Rm=g("[110] Aggregate"),Sm="COUNT",Tm=d("COUNT",!1),Um="count",Vm=d("count",!1),Wm=function(a,b){var c={};return c.token="expression",c.expressionType="aggregate",c.aggregateType="count",c.distinct=""!=a&&null!=a?"DISTINCT":a,c.expression=b,c},Xm="GROUP_CONCAT",Ym=d("GROUP_CONCAT",!1),Zm="group_concat",$m=d("group_concat",!1),_m="SEPARATOR",an=d("SEPARATOR",!1),bn=function(a,b,c){var d={};return d.token="expression",d.expressionType="aggregate",d.aggregateType="group_concat",d.distinct=""!=a&&null!=a?"DISTINCT":a,d.expression=b,d.separator=c,d},cn="SUM",dn=d("SUM",!1),en="sum",fn=d("sum",!1),gn=function(a,b){var c={};return c.token="expression",c.expressionType="aggregate",c.aggregateType="sum",c.distinct=""!=a&&null!=a?"DISTINCT":a,c.expression=b,c},hn="MIN",jn=d("MIN",!1),kn="min",ln=d("min",!1),mn=function(a,b){var c={};return c.token="expression",c.expressionType="aggregate",c.aggregateType="min",c.distinct=""!=a&&null!=a?"DISTINCT":a,c.expression=b,c},nn="MAX",on=d("MAX",!1),pn="max",qn=d("max",!1),rn=function(a,b){var c={};return c.token="expression",c.expressionType="aggregate",c.aggregateType="max",c.distinct=""!=a&&null!=a?"DISTINCT":a,c.expression=b,c},sn="AVG",tn=d("AVG",!1),un="avg",vn=d("avg",!1),wn=function(a,b){var c={};return c.token="expression",c.expressionType="aggregate",c.aggregateType="avg",c.distinct=""!=a&&null!=a?"DISTINCT":a,c.expression=b,c},xn=g("[117] IRIrefOrFunction"),yn=function(a,b){var c={};return c.token="expression",c.expressionType="irireforfunction",c.iriref=a,c.args=null!=b?b.value:b,c},zn=g("[112] RDFLiteral"),An="^^",Bn=d("^^",!1),Cn=function(a,b){var c=a.value.replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");return"string"==typeof b&&b.length>0?{token:"literal",value:c,lang:b.slice(1),type:null}:null!=b&&"object"==typeof b?(b.shift(),{token:"literal",value:c,lang:null,type:b[0]}):{token:"literal",value:c,lang:null,type:null}},Dn=g("[113] NumericLiteral"),En=g("[114] NumericLiteralUnsigned"),Fn=g("[115] NumericLiteralPositive"),Gn=g("[116] NumericLiteralNegative"),Hn=g("[117] BooleanLiteral"),In="TRUE",Jn=d("TRUE",!1),Kn="true",Ln=d("true",!1),Mn=function(){var a={};return a.token="literal",a.lang=null,a.type="http://www.w3.org/2001/XMLSchema#boolean",a.value=!0,a},Nn="FALSE",On=d("FALSE",!1),Pn="false",Qn=d("false",!1),Rn=function(){var a={};return a.token="literal",a.lang=null,a.type="http://www.w3.org/2001/XMLSchema#boolean",a.value=!1,a},Sn=g("[118] String"),Tn=function(a){return{token:"string",value:a}},Un=g("[119] IRIref"),Vn=function(a){return{token:"uri",prefix:null,suffix:null,value:a}},Wn=function(a){return a},Xn=g("[120] PrefixedName"),Yn=function(a){return{token:"uri",prefix:a[0],suffix:a[1],value:null}},Zn=function(a){return{token:"uri",prefix:a,suffix:"",value:null}},$n=g("[121] BlankNode"),_n=function(a){return{token:"blank",value:a}},ao=function(){return dr++,{token:"blank",value:"_:"+dr}},bo=g("[122] IRI_REF"),co=/^[^<>"{}|\^`\\]/,eo=e(["<",">",'"',"{","}","|","^","`","\\"],!0,!1),fo=function(a){return a.join("")},go=g("[123] PNAME_NS"),ho=":",io=d(":",!1),jo=g("[124] PNAME_LN"),ko=function(a,b){return[a,b]},lo=g("[125] BLANK_NODE_LABEL"),mo="_:",no=d("_:",!1),oo=function(a){return a},po=g("[126] VAR1"),qo=function(a){return a},ro=g("[127] VAR2"),so="$",to=d("$",!1),uo=g("[128] LANGTAG"),vo="@",wo=d("@",!1),xo=/^[a-zA-Z]/,yo=e([["a","z"],["A","Z"]],!1,!1),zo=/^[a-zA-Z0-9]/,Ao=e([["a","z"],["A","Z"],["0","9"]],!1,!1),Bo=function(a,b){return 0===b.length?("@"+a.join("")).toLowerCase():("@"+a.join("")+"-"+b[0][1].join("")).toLowerCase()},Co=g("[129] INTEGER"),Do=/^[0-9]/,Eo=e([["0","9"]],!1,!1),Fo=function(a){var b={};return b.token="literal",b.lang=null,b.type="http://www.w3.org/2001/XMLSchema#integer",b.value=cr(a),b},Go=g("[130] DECIMAL"),Ho=function(a,b,c){var d={};return d.token="literal",d.lang=null,d.type="http://www.w3.org/2001/XMLSchema#decimal",d.value=cr([a,b,c]),d},Io=function(a,b){var c={};return c.token="literal",c.lang=null,c.type="http://www.w3.org/2001/XMLSchema#decimal",c.value=cr([a,b]),c},Jo=g("[131] DOUBLE"),Ko=function(a,b,c,d){var e={};return e.token="literal",e.lang=null,e.type="http://www.w3.org/2001/XMLSchema#double",e.value=cr([a,b,c,d]),e},Lo=function(a,b,c){var d={};return d.token="literal",d.lang=null,d.type="http://www.w3.org/2001/XMLSchema#double",d.value=cr([a,b,c]),d},Mo=function(a,b){var c={};return c.token="literal",c.lang=null,c.type="http://www.w3.org/2001/XMLSchema#double",c.value=cr([a,b]),c},No=g("[132] INTEGER_POSITIVE"),Oo=function(a){return a.value="+"+a.value,a},Po=g("[133] DECIMAL_POSITIVE"),Qo=function(a){return a.value="+"+a.value,a},Ro=g("[134] DOUBLE_POSITIVE"),So=g("[135] INTEGER_NEGATIVE"),To=function(a){return a.value="-"+a.value,a},Uo=g("[136] DECIMAL_NEGATIVE"),Vo=g("[137] DOUBLE_NEGATIVE"),Wo=g("[138] EXPONENT"),Xo=/^[eE]/,Yo=e(["e","E"],!1,!1),Zo=/^[+\-]/,$o=e(["+","-"],!1,!1),_o=function(a,b,c){return cr([a,b,c])},ap=g("[139] STRING_LITERAL1"),bp="'",cp=d("'",!1),dp=/^[^'\\\n\r]/,ep=e(["'","\\","\n","\r"],!0,!1),fp=function(a){return cr(a)},gp=g("[140] STRING_LITERAL2"),hp='"',ip=d('"',!1),jp=/^[^"\\\n\r]/,kp=e(['"',"\\","\n","\r"],!0,!1),lp=g("[141] STRING_LITERAL_LONG1"),mp="'''",np=d("'''",!1),op=/^[^'\\]/,pp=e(["'","\\"],!0,!1),qp=g("[142] STRING_LITERAL_LONG2"),rp='"""',sp=d('"""',!1),tp=/^[^"\\]/,up=e(['"',"\\"],!0,!1),vp=g("[143] ECHAR"),wp="\\",xp=d("\\",!1),yp=/^[tbnrf"']/,zp=e(["t","b","n","r","f",'"',"'"],!1,!1),Ap=g("[144] NIL"),Bp=function(){return{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}},Cp=g("[145] WS"),Dp=/^[ ]/,Ep=e([" "],!1,!1),Fp=/^[\t]/,Gp=e(["	"],!1,!1),Hp=/^[\r]/,Ip=e(["\r"],!1,!1),Jp=/^[\n]/,Kp=e(["\n"],!1,!1),Lp=g(" COMMENT"),Mp="#",Np=d("#",!1),Op=/^[^\n\r]/,Pp=e(["\n","\r"],!0,!1),Qp=g("[146] ANON"),Rp=g("[147] PN_CHARS_BASE"),Sp=/^[A-Z]/,Tp=e([["A","Z"]],!1,!1),Up=/^[a-z]/,Vp=e([["a","z"]],!1,!1),Wp=/^[\xC0-\xD6]/,Xp=e([["À","Ö"]],!1,!1),Yp=/^[\xD8-\xF6]/,Zp=e([["Ø","ö"]],!1,!1),$p=/^[\xF8-\u02FF]/,_p=e([["ø","˿"]],!1,!1),aq=/^[\u0370-\u037D]/,bq=e([["Ͱ","ͽ"]],!1,!1),cq=/^[\u037F-\u1FFF]/,dq=e([["Ϳ","῿"]],!1,!1),eq=/^[\u200C-\u200D]/,fq=e([["‌","‍"]],!1,!1),gq=/^[\u2070-\u218F]/,hq=e([["⁰","↏"]],!1,!1),iq=/^[\u2C00-\u2FEF]/,jq=e([["Ⰰ","⿯"]],!1,!1),kq=/^[\u3001-\uD7FF]/,lq=e([["、","퟿"]],!1,!1),mq=/^[\uF900-\uFDCF]/,nq=e([["豈","﷏"]],!1,!1),oq=/^[\uFDF0-\uFFFD]/,pq=e([["ﷰ","�"]],!1,!1),qq=/^[\u1000-\uEFFF]/,rq=e([["က",""]],!1,!1),sq=g("[148] PN_CHARS_U"),tq="_",uq=d("_",!1),vq=g("[149] VARNAME"),wq=/^[\xB7]/,xq=e(["·"],!1,!1),yq=/^[\u0300-\u036F]/,zq=e([["̀","ͯ"]],!1,!1),Aq=/^[\u203F-\u2040]/,Bq=e([["‿","⁀"]],!1,!1),Cq=function(a,b){return a+b.join("")},Dq=g("[150] PN_CHARS"),Eq=g("[151] PN_PREFIX"),Fq=function(a,b){if("."==b[b.length-1])throw new Error("Wrong PN_PREFIX, cannot finish with '.'");return a+b.join("")},Gq=g("[152] PN_LOCAL"),Hq=function(a,b){return a+(b||[]).join("")},Iq=g("[170] PLX"),Jq=g("[171] PERCENT"),Kq="%",Lq=d("%",!1),Mq=function(a){return a.join("")},Nq=g("[172] HEX"),Oq=/^[A-F]/,Pq=e([["A","F"]],!1,!1),Qq=/^[a-f]/,Rq=e([["a","f"]],!1,!1),Sq=g("[173] PN_LOCAL_ESC"),Tq="~",Uq=d("~",!1),Vq="&",Wq=d("&",!1),Xq=function(a){return"\\"+a},Yq=0,Zq=0,$q=[{line:1,column:1}],_q=0,ar=[],br=0;if("startRule"in c){if(!(c.startRule in yc))throw new Error("Can't start parsing from rule \""+c.startRule+'".');zc=yc[c.startRule]}var cr=function(a){for(var b="",c=0;c<a.length;c++)b+="string"==typeof a[c]?a[c]:a[c].join("");return b},dr=0,er={},fr=function(a,b){er[a]=b},gr=function(a){er[null]=a},hr=function(a){var b="";if(null==a)return null;for(var c=0;c<a.length;c++)b+=a[c];return b.toUpperCase()};if(wc=zc(),wc!==xc&&Yq===a.length)return wc;throw wc!==xc&&Yq<a.length&&j(f()),k(ar,_q<a.length?a.charAt(_q):null,_q<a.length?i(_q,_q+1):i(_q,_q))}return a(b,Error),b.buildMessage=function(a,b){function c(a){return a.charCodeAt(0).toString(16).toUpperCase()}function d(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function e(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+c(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+c(a)})}function f(a){return i[a.type](a)}function g(a){var b,c,d=new Array(a.length);for(b=0;b<a.length;b++)d[b]=f(a[b]);if(d.sort(),d.length>0){for(b=1,c=1;b<d.length;b++)d[b-1]!==d[b]&&(d[c]=d[b],c++);d.length=c}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function h(a){return a?'"'+d(a)+'"':"end of input"}var i={literal:function(a){return'"'+d(a.text)+'"'},"class":function(a){var b,c="";for(b=0;b<a.parts.length;b++)c+=a.parts[b]instanceof Array?e(a.parts[b][0])+"-"+e(a.parts[b][1]):e(a.parts[b]);return"["+(a.inverted?"^":"")+c+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+g(a)+" but "+h(b)+" found."},{SyntaxError:b,parse:c}}()},{}],47:[function(a,b,c){var d=(a("./btree").Tree,a("./utils")),e=d,f=a("./lexicon").Lexicon;PersistentLexicon=function(a,b){var c=this;d.registerIndexedDB(c),this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,c.dbName=b||"rdfstorejs";var e=c.indexedDB.open(this.dbName+"_lexicon",1);e.onerror=function(b){a(null,new Error("Error opening IndexedDB: "+b.target.errorCode))},e.onsuccess=function(b){c.db=b.target.result,a(c)},e.onupgradeneeded=function(a){c.db=a.target.result;var b=c.db.createObjectStore("knownGraphs",{keyPath:"oid"});b.createIndex("uriToken","uriToken",{unique:!0});var d=c.db.createObjectStore("components",{keyPath:"id",autoIncrement:!0});d.createIndex("value","value",{unique:!0})}},PersistentLexicon.prototype.registerGraph=function(a,b,c){if(a!=this.defaultGraphOid){var d=this.db.transaction(["knownGraphs"],"readwrite");d.onerror=function(a){c(null,new Error(a.target.statusCode))};var e=d.objectStore("knownGraphs"),f=e.get(b);f.onsuccess=function(d){var f=d.target.result;if(f)c(!0);else{var g=e.add({oid:a,uriToken:b});g.onsuccess=function(a){c(!0)}}}}else c()},PersistentLexicon.prototype.registeredGraphs=function(a,b){var c=[],d=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs"),e=d.openCursor();e.onsuccess=function(d){var e=d.target.result;e?(a===!0?c.push(e.value.uriToken):c.push(e.value.oid),e["continue"]()):b(c)},e.onerror=function(a){b(null,new Error("Error retrieving data from the cursor: "+a.target.errorCode))}},PersistentLexicon.prototype.registerUri=function(a,b){var c=this;if(a===this.defaultGraphUri)b(this.defaultGraphOid);else{var d=c.db.transaction(["components"],"readwrite").objectStore("components"),e=d.index("value").get("_u:"+a);e.onsuccess=function(c){var e=c.target.result;if(e){e.counter++;var f=e.id,g=d.put(e);g.onsuccess=function(a){b(f)},g.onerror=function(a){b(null,new Error("Error updating the URI data"+a.target.errorCode))}}else{var h=d.add({
value:"_u:"+a,counter:0,uri:!0});h.onsuccess=function(a){b(a.target.result)},h.onerror=function(a){b(null,new Error("Error inserting the URI data"+a.target.errorCode))}}},e.onerror=function(a){b(null,new Error("Error retrieving the URI data"+a.target.errorCode))}}},PersistentLexicon.prototype.resolveUri=function(a,b){if(a===this.defaultGraphUri)b(this.defaultGraphOid);else{var c=this.db.transaction(["components"]).objectStore("components"),d=c.index("value").get("_u:"+a);d.onsuccess=function(a){b(null!=a.target.result?a.target.result.id:-1)},d.onerror=function(a){b(null,new Error("Error retrieving uri data "+a.target.errorCode))}}},PersistentLexicon.prototype.resolveUriCost=function(a,b){if(a===this.defaultGraphUri)b(0);else{var c=that.db.transaction(["components"]).objectStore("components"),d=c.index("value").get("_u:"+a);d.onsuccess=function(a){b(null!=a.target.result?a.target.result.cost:-1)},d.onerror=function(a){b(null,new Error("Error retrieving uri data "+a.target.errorCode))}}},PersistentLexicon.prototype.registerBlank=function(a){var b=guid(),c=this,d=c.db.transaction(["components"],"readwrite").objectStore("components"),e=d.add({value:"_b:"+b,counter:0,label:!0});e.onsuccess=function(b){a(b.target.result)},e.onerror=function(b){a(null,new Error("Error inserting the URI data"+b.target.errorCode))}},PersistentLexicon.prototype.resolveBlankCost=function(a,b){b(0)},PersistentLexicon.prototype.registerLiteral=function(a,b){var c=this,d=c.db.transaction(["components"],"readwrite").objectStore("components"),e=d.index("value").get("_l:"+a);e.onsuccess=function(c){var e=c.target.result;if(e){e.counter++;var f=e.id,g=d.put(e);g.onsuccess=function(a){b(f)},g.onerror=function(a){b(null,new Error("Error updating the literal data"+a.target.errorCode))}}else{var h=d.add({value:"_l:"+a,counter:0,literal:!0});h.onsuccess=function(a){b(a.target.result)},h.onerror=function(a){b(null,new Error("Error inserting the literal data"+a.target.errorCode))}}},e.onerror=function(a){b(null,new Error("Error retrieving the literal data"+a.target.errorCode))}},PersistentLexicon.prototype.resolveLiteral=function(a,b){var c=that.db.transaction(["components"]).objectStore("components"),d=c.index("value").get("_l:"+a);d.onsuccess=function(a){b(null!=a.target.result?a.target.result.id:-1)},d.onerror=function(a){b(null,new Error("Error retrieving literal data "+a.target.errorCode))}},PersistentLexicon.prototype.resolveLiteralCost=function(a,b){var c=that.db.transaction(["components"]).objectStore("components"),d=c.index("components").get(a);d.onsuccess=function(a){b(null!=a.target.result?a.target.result.cost:-1)},d.onerror=function(a){b(null,new Error("Error retrieving literal data "+a.target.errorCode))}},PersistentLexicon.prototype.parseLiteral=function(a){return f.prototype.parseLiteral(a)},PersistentLexicon.prototype.parseUri=function(a){return f.prototype.parseUri(a)},PersistentLexicon.prototype.retrieve=function(a,b){var c,d,e=this;a===this.defaultGraphOid?b({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):(c=e.db.transaction(["components"]),d=c.objectStore("components").get(a),d.onsuccess=function(a){if(null!=a.target.result)if(null!=a.target.result.label){var c="_:"+a.target.result.id;b({token:"blank",value:c})}else null!=a.target.result.uri?b(e.parseUri(a.target.result.value.slice(3,a.target.result.value.length))):null!=a.target.result.literal?b(e.parseLiteral(a.target.result.value.slice(3,a.target.result.value.length))):(console.log(a.target.result),b(null,new Error("Unknown type of component "+a.target.result)));else b(null,null)},d.onerror=function(a){b(null,new Error("Error searching in blanks data "+a.target.errorCode))})},PersistentLexicon.prototype.clear=function(a){var b=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri};var c,d=b.db.transaction(["components"],"readwrite"),e=d.objectStore("components"),f=function(){null!=a&&a()};c=e.clear(),c.onsuccess=f,c.onerror=f},PersistentLexicon.prototype.unregister=function(a,b,c){var d=this;e.seq(function(c){d._unregisterTerm(a.subject.token,b.subject,c)},function(c){d._unregisterTerm(a.predicate.token,b.predicate,c)},function(c){d._unregisterTerm(a.object.token,b.object,c)},function(c){null!=a.graph?d._unregisterTerm(a.graph.token,b.graph,c):c()})(function(){c(!0)})},PersistentLexicon.prototype._unregisterTerm=function(a,b,c){var d,e=this,f=e.db.transaction(["components","knownGraphs"],"readwrite");if("uri"===a)if(b!=this.defaultGraphOid){var g=function(){var a=f.objectStore("knownGraphs")["delete"](b);a.onsuccess=function(){c()}};d=f.objectStore("components")["delete"](b),d.onsuccess=g()}else c();else d=f.objectStore("components")["delete"](b),d.onsuccess=function(){c()}},b.exports={PersistentLexicon:PersistentLexicon}},{"./btree":40,"./lexicon":44,"./utils":57}],48:[function(a,b,c){var d=a("./utils");PersistentQuadBackend=function(a,b){var c=this;if(0!==arguments){d.registerIndexedDB(c),this.indexMap={},this.indices=["S","P","O","G","SP","SO","SG","PO","PG","OG","SPO","SPG","SOG","POG","SPOG"],this.componentOrders={S:["subject","predicate","object","graph"],P:["predicate","subject","object","graph"],O:["object","subject","predicate","graph"],G:["graph","subject","predicate","object"],SP:["subject","predicate","object","graph"],SO:["subject","object","predicate","graph"],SG:["subject","graph","predicate","object"],PO:["predicate","object","subject","graph"],PG:["predicate","graph","subject","object"],OG:["object","graph","subject","predicate"],SPO:["subject","predicate","object","graph"],SPG:["subject","predicate","graph","object"],SOG:["subject","object","graph","predicate"],POG:["predicate","object","graph","subject"],SPOG:["subject","predicate","object","graph"]},this.componentOrdersMap={};for(var e in this.componentOrders){var f=this.componentOrders[e],g=f.slice(0,e.length).sort().join(".");this.componentOrdersMap[g]=e}c.dbName=a.name||"rdfstorejs";var h=c.indexedDB.open(this.dbName+"_db",1);h.onerror=function(a){b(null,new Error("Error opening IndexedDB: "+a.target.errorCode))},h.onsuccess=function(a){c.db=a.target.result,b(c)},h.onupgradeneeded=function(a){var b=a.target.result,e=b.createObjectStore(c.dbName,{keyPath:"SPOG"});d.each(c.indices,function(a){"SPOG"!==a&&e.createIndex(a,a,{unique:!1})})}}},PersistentQuadBackend.prototype.index=function(a,b){var c=this;d.each(this.indices,function(b){a[b]=c._genMinIndexKey(a,b)});var e=c.db.transaction([c.dbName],"readwrite");e.oncomplete=function(a){},e.onerror=function(a){b(null,new Error(a.target.statusCode))};var f=e.objectStore(c.dbName),g=f.add(a);g.onsuccess=function(a){b(!0)}},PersistentQuadBackend.prototype.range=function(a,b){var c,d=this,e=d.db.transaction([d.dbName]).objectStore(d.dbName),f=this._indexForPattern(a),g=this._genMinIndexKey(a,f),h=this._genMaxIndexKey(a,f),i=d.IDBKeyRange.bound(g,h,!1,!1),j=[];c="SPOG"===f?e:e.index(f),c.openCursor(i).onsuccess=function(a){var c=a.target.result;c?(j.push(c.value),c["continue"]()):b(j)}},PersistentQuadBackend.prototype.search=function(a,b){var c=this,d=c.db.transaction([c.dbName]).objectStore(c.dbName),e=this._genMinIndexKey(a,"SPOG"),f=d.get(e);f.onerror=function(a){b(null,new Error(a.target.statusCode))},f.onsuccess=function(a){b(null!=a.target.result)}},PersistentQuadBackend.prototype["delete"]=function(a,b){var c=this,d=c._genMinIndexKey(a,"SPOG"),e=c.db.transaction([c.dbName],"readwrite").objectStore(c.dbName)["delete"](d);e.onsuccess=function(){b(!0)},e.onerror=function(a){b(null,new Error(a.target.statusCode))}},PersistentQuadBackend.prototype._genMinIndexKey=function(a,b){var c=this.componentOrders[b];return d.map(c,function(b){return"string"==typeof a[b]||null==a[b]?"0":a[b]}).join(".")},PersistentQuadBackend.prototype._genMaxIndexKey=function(a,b){for(var c=this.componentOrders[b],e=[],f=0;f<c.length;f++){var g=c[f],h=a[g];"string"==typeof h?e[f]="z":e[f]=h}return d.map(e,function(a){return""+a}).join(".")},PersistentQuadBackend.prototype._indexForPattern=function(a){var b=this,c=a.indexKey,d=c.sort().join("."),e=b.componentOrdersMap[d];if(null==e)throw new Error("Error, cannot find index for indexKey "+d);return e},PersistentQuadBackend.prototype.clear=function(a){var b,c=this,d=c.db.transaction([c.dbName],"readwrite");b=d.objectStore(c.dbName).clear(),b.onsuccess=function(){a()},b.onerror=function(){a()}},b.exports.PersistentQuadBackend=PersistentQuadBackend},{"./utils":57}],49:[function(a,b,c){var d=a("./quad_index").QuadIndex,e=a("./utils");QuadBackend=function(a,b){this.indexMap={},this.treeOrder=a.treeOrder,this.indices=a.index||QuadBackend.allIndices,this.componentOrders=QuadBackend.componentOrders;var c=this;e.eachSeries(this.indices,function(a,b){new d({order:c.treeOrder,componentOrder:c.componentOrders[a]},function(d){c.indexMap[a]=d,b()})},function(){b(c)})},QuadBackend.allIndices=["SPOG","GP","OGS","POG","GSP","OS"],QuadBackend.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},QuadBackend.prototype._indexForPattern=function(a){for(var b=a.indexKey,c=0;c<QuadBackend.allIndices.length;c++)for(var d=QuadBackend.allIndices[c],f=QuadBackend.componentOrders[d],g=0;g<f.length&&e.include(b,f[g])!==!1;g++)if(g==b.length-1)return d;return"SPOG"},QuadBackend.prototype.index=function(a,b){var c=this;e.eachSeries(this.indices,function(b,d){var e=c.indexMap[b];e.insert(a,function(){d()})},function(){b(!0)})},QuadBackend.prototype.range=function(a,b){var c=this._indexForPattern(a),d=this.indexMap[c];null!=d&&d.range(a,function(a){b(a)})},QuadBackend.prototype.search=function(a,b){var c=this.indexMap.SPOG;null!=c&&c.search(a,function(a){b(null!=a)})},QuadBackend.prototype["delete"]=function(a,b){var c=this;e.eachSeries(this.indices,function(b,d){var e=c.indexMap[b];e["delete"](a,function(){d()})},function(){b(!0)})},QuadBackend.prototype.clear=function(a){var b=this;e.eachSeries(this.indices,function(a,c){new d({order:b.treeOrder,componentOrder:b.componentOrders[a]},function(d){b.indexMap[a]=d,c()})},function(){a(!0)})},b.exports.QuadBackend=QuadBackend},{"./quad_index":50,"./utils":57}],50:[function(a,b,c){var d=a("./btree").Tree,e=a("./utils"),f=a("./utils");NodeKey=function(a,b){this.subject=a.subject,this.predicate=a.predicate,this.object=a.object,this.graph=a.graph,this.order=b},NodeKey.prototype.comparator=function(a){for(var b=0;b<this.order.length;b++){var c=this.order[b];if(null==a[c])return 0;if(this[c]<a[c])return-1;if(this[c]>a[c])return 1}return 0},Pattern=function(a){this.subject=a.subject,this.predicate=a.predicate,this.object=a.object,this.graph=a.graph,this.indexKey=[],this.keyComponents={};var b=[],c=[],d=this;e.forEach(["subject","predicate","object","graph"],function(a){"string"==typeof d[a]?(c.push(a),d.keyComponents[a]=null):(b.push(a),d.keyComponents[a]=d[a],d.indexKey.push(a))}),this.order=b.concat(c),this.key=new NodeKey(this.keyComponents,this.order)},QuadIndex=function(a,b){0!=arguments&&(this.componentOrder=a.componentOrder,d.call(this,a.order,function(a){a.comparator=function(b,c){for(var d=0;d<a.componentOrder.length;d++){var e=a.componentOrder[d],f=b[e],g=c[e];if(g>f)return-1;if(f>g)return 1}return 0},a.rangeComparator=function(b,c){for(var d=0;d<a.componentOrder.length;d++){var e=a.componentOrder[d];if(null==c[e]||null==b[e])return 0;if(b[e]<c[e])return-1;if(b[e]>c[e])return 1}return 0},b(a)}))},QuadIndex.prototype=e.create(d.prototype,{constructor:d}),QuadIndex.prototype.insert=function(a,b){d.prototype.insert.call(this,a,null,function(a){b(a)})},QuadIndex.prototype.search=function(a,b){d.prototype.search.call(this,a,function(a){b(a)},!0)},QuadIndex.prototype.range=function(a,b){this._rangeTraverse(this,this.root,a,b)},QuadIndex.prototype._rangeTraverse=function(a,b,c,d){var e=c.key,g=[],h=[b];f.whilst(function(){return h.length>0},function(b){for(var c=h.shift(),d=0;d<c.numberActives&&-1===a.rangeComparator(c.keys[d].key,e);)d++;if(c.isLeaf===!0){for(var i=d;i<c.numberActives&&0===a.rangeComparator(c.keys[i].key,e);)g.push(c.keys[i].key),i++;b()}else a._diskRead(c.children[d],function(i){h.push(i);var j=d;f.whilst(function(){return j<c.numberActives&&0===a.rangeComparator(c.keys[j].key,e)},function(b){g.push(c.keys[j].key),j++,a._diskRead(c.children[j],function(a){h.push(a),b()})},function(){b()})})},function(){d(g)})},b.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":40,"./utils":57}],51:[function(a,b,c){function d(a,b,c){this.name="BindExpressionError",this.bind=b,this.error=c,this.message=a}var e=a("./abstract_query_tree").AbstractQueryTree,f=a("./abstract_query_tree").NonSupportedSparqlFeatureError,g=a("./utils"),h=a("./quad_index"),i=a("./query_plan").QueryPlan,j=a("./query_filters").QueryFilters,k=a("./rdf_model"),l=a("./rdf_loader").RDFLoader,m=a("./graph_callbacks").CallbacksBackend,n=a("./utils"),o=a("./utils");d.prototype=new Error,d.constructor=d,QueryEngine=function(a){0!=arguments.length&&(this.backend=a.backend,this.lexicon=a.lexicon,this.eventsOnBatchLoad=a.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new e,this.rdfLoader=new l(a.communication),this.callbacksBackend=new m(this),this.customFns=a.customFns||{})},QueryEngine.prototype.setCustomFunctions=function(a){this.customFns=a},QueryEngine.prototype.registerNsInEnvironment=function(a,b){var c=[];null!=a&&null!=a.prefixes&&(c=a.prefixes);var d={};for(var e in this.defaultPrefixes)d[e]=this.defaultPrefixes[e];for(var f=0;f<c.length;f++){var g=c[f];"prefix"===g.token&&(d[g.prefix]=g.local)}b.namespaces=d,null!=a&&a.base&&"object"==typeof a.base?b.base=a.base.value:b.base=null},QueryEngine.prototype.applyModifier=function(a,b){if("DISTINCT"==a){for(var c={},d=[],e=0;e<b.length;e++){var f=b[e],g="";for(var h in f){var i=f[h];null==i?g=g+h+"null":"literal"==i.token?(null!=i.value&&(g+=i.value),null!=i.lang&&(g+=i.lang),null!=i.type&&(g+=i.type)):g=i.value?g+h+i.value:g+h+i}null==c[g]&&(d.push(f),c[g]=!0)}return d}return b},QueryEngine.prototype.applyLimitOffset=function(a,b,c){return null==b&&null==a?c:(null==a&&(a=0),b=null==b?c.length:a+b,c.slice(a,b))},QueryEngine.prototype.applySingleOrderBy=function(a,b,c,d,e){var f=[],g=this;n.eachSeries(a,function(a,e){j.collect(a.expression,[b],c,d,g,function(a){f.push(a[0].value),e()})},function(){e({binding:b,value:f})})},QueryEngine.prototype.applyOrderBy=function(a,b,c,d,e){var f=this,g=[];null!=a&&a.length>0?n.eachSeries(b,function(b,e){f.applySingleOrderBy(a,b,c,d,function(a){g.push(a),e()})},function(){g.sort(function(b,c){return f.compareFilteredBindings(b,c,a,d)});for(var b=[],c=0;c<g.length;c++)b.push(g[c].binding);e(b)}):e(b)},QueryEngine.prototype.compareFilteredBindings=function(a,b,c,d){for(var e=!1,f=0;!e;){if(f==a.value.length)return 0;var g,h=c[f].direction;if(null!=a.value[f]||null!=b.value[f]){if(null==a.value[f])g={value:!1};else if(null==b.value[f])g={value:!0};else{if("blank"===a.value[f].token&&"blank"===b.value[f].token){f++;continue}if("blank"===a.value[f].token)g={value:!1};else if("blank"===b.value[f].token)g={value:!0};else if("uri"===a.value[f].token&&"uri"===b.value[f].token){if(1==j.runEqualityFunction(a.value[f],b.value[f],[],this,d).value){f++;continue}g=j.runTotalGtFunction(a.value[f],b.value[f],[])}else if("uri"===a.value[f].token)g={value:!1};else if("uri"===b.value[f].token)g={value:!0};else if("literal"===a.value[f].token&&"literal"===b.value[f].token&&null==a.value[f].type&&null==b.value[f].type){if(1==j.runEqualityFunction(a.value[f],b.value[f],[],this,d).value){f++;continue}g=j.runTotalGtFunction(a.value[f],b.value[f],[])}else if("literal"===a.value[f].token&&null==a.value[f].type)g={value:!1};else if("literal"===b.value[f].token&&null==b.value[f].type)g={value:!0};else{if(1==j.runEqualityFunction(a.value[f],b.value[f],[],this,d).value){f++;continue}g=j.runTotalGtFunction(a.value[f],b.value[f],[])}}return 1==g.value?"ASC"===h?1:-1:"ASC"===h?-1:1}f++}},QueryEngine.prototype.removeDefaultGraphBindings=function(a,b){for(var c=[],d={},e=0;e<b.named.length;e++)d[b.named[e].oid]=!0;for(e=0;e<b.implicit.length;e++)null==d[b.implicit[e].oid]&&c.push(b.implicit[e].oid);var f=[];for(e=0;e<a.length;e++){var g=a[e],h=!1;for(var i in g){for(var j=0;j<d.length;j++)if(g[i]===d[j]){h=!0;break}if(h)break}h||f.push(g)}return f},QueryEngine.prototype.aggregateBindings=function(a,b,c,d,e){this.copyDenormalizedBindings(b,d.outCache,function(b){for(var f={},g=0;g<a.length;g++){var h=j.runAggregator(a[g],b,this,c,d);a[g].alias?f[a[g].alias.value]=h:f[a[g].value.value]=h}e(f)})},QueryEngine.prototype.projectBindings=function(a,b,c){if("*"===a[0].kind)return b;for(var d=[],e=0;e<b.length;e++){for(var f=b[e],g={},h=!0,i=0;i<a.length;i++)if("variable"==a[i].token&&"aliased"!=a[i].kind)g[a[i].value.value]=f[a[i].value.value];else if("variable"==a[i].token&&"aliased"==a[i].kind){var k=j.runFilter(a[i].expression,f,this,c,{blanks:{},outCache:{}});if(j.isEbvError(k)){h=!1;break}g[a[i].alias.value]=k}h===!0&&d.push(g)}return d},QueryEngine.prototype.resolveNsInEnvironment=function(a,b){var c=b.namespaces;return c[a]},QueryEngine.prototype.normalizeTerm=function(a,b,c,d){if("uri"===a.token){var e=g.lexicalFormBaseUri(a,b);null==e?d(null):c?this.lexicon.registerUri(e,d):this.lexicon.resolveUri(e,d)}else if("literal"===a.token){var f=g.lexicalFormLiteral(a,b);c?this.lexicon.registerLiteral(f,d):this.lexicon.resolveLiteral(f,d)}else if("blank"===a.token){var h=a.value,i=b.blanks[h];null!=i?d(i):c?this.lexicon.registerBlank(function(a){b.blanks[h]=a,d(a)}):this.lexicon.resolveBlank(function(a){b.blanks[h]=a,d(a)})}else d("var"===a.token?a.value:null)},QueryEngine.prototype.normalizeDatasets=function(a,b,c){var d=this;n.eachSeries(a,function(a,c){a.value===d.lexicon.defaultGraphUri?(a.oid=d.lexicon.defaultGraphOid,c()):d.normalizeTerm(a,b,!1,function(b){null!=b&&(a.oid=b),c()})},function(){c(!0)})},QueryEngine.prototype.normalizeQuad=function(a,b,c,d){var e=null,f=null,h=null,i=null,j=this,k=!1;n.seq(function(d){if(null==a.graph||a.graph.value===j.lexicon.defaultGraphUri)i=0,d();else{var e=g.lexicalFormBaseUri(a.graph,b);j.normalizeTerm(a.graph,b,c,function(b){null!=b?(i=b,c===!0&&"var"!=a.graph.token?j.lexicon.registerGraph(b,e,function(){d()}):d()):(k=!0,d())})}},function(d){k===!1?j.normalizeTerm(a.subject,b,c,function(a){null!=a?(e=a,d()):(k=!0,d())}):d()},function(d){k===!1?j.normalizeTerm(a.predicate,b,c,function(a){null!=a?(f=a,d()):(k=!0,d())}):d()},function(d){k===!1?j.normalizeTerm(a.object,b,c,function(a){null!=a?(h=a,d()):(k=!0,d())}):d()})(function(){d(k===!0?null:{subject:e,predicate:f,object:h,graph:i})})},QueryEngine.prototype.denormalizeBindingsList=function(a,b,c){var d=this,e=[];n.eachSeries(a,function(a,c){d.denormalizeBindings(a,b,function(a){e.push(a),c()})},function(){c(e)})},QueryEngine.prototype.copyDenormalizedBindings=function(a,b,c){var d=this,e=[];n.eachSeries(a,function(a,c){var f={},g=o.keys(a);n.eachSeries(g,function(c,e){var g=a[c];if(null==g)f[c]=null,e();else if("object"==typeof g)f[c]=g,e();else{var h=b[g];null!=h?(f[c]=h,e()):d.lexicon.retrieve(g,function(a){b[g]=a,f[c]=a,e()})}},function(){e.push(f),c()})},function(){c(e)})},QueryEngine.prototype.denormalizeBindings=function(a,b,c){var d=o.keys(a),e=b.outCache,f=this;n.eachSeries(d,function(c,d){var g=a[c];null==g?(a[c]=null,d()):"object"==typeof g?d():null!=e[g]?(a[c]=e[g],d()):f.lexicon.retrieve(g,function(e){a[c]=e,"blank"===e.token&&(b.blanks[e.value]=g),d()})},function(){c(a)})},QueryEngine.prototype.execute=function(a,b,c,d){a=g.normalizeUnicodeLiterals(a);var e=this.abstractQueryTree.parseQueryString(a);if(null==e)b(!1,"Error parsing query string");else if("query"===e.token&&"update"==e.kind){this.callbacksBackend.startGraphModification();var f=this;this.executeUpdate(e,function(a,c){f.lexicon.updateAfterWrite&&f.lexicon.updateAfterWrite(),a?(f.callbacksBackend.cancelGraphModification(),b(a,c)):f.callbacksBackend.endGraphModification(function(){b(a,c)})})}else"query"===e.token&&"query"==e.kind&&this.executeQuery(e,b,c,d)},QueryEngine.prototype.executeQuery=function(a,b,c,d){var e=a.prologue,f=a.units,g=this,h={blanks:{},outCache:{}};this.registerNsInEnvironment(e,h);var i=g.abstractQueryTree.parseExecutableUnit(f[0]);"select"===i.kind?this.executeSelect(i,h,c,d,function(a,c){null==a?"object"==typeof c&&c.denorm===!0?b(null,c.bindings):g.denormalizeBindingsList(c,h,function(a){b(null,a)}):b(a)}):"ask"===i.kind?(i.projection=[{token:"variable",kind:"*"}],this.executeSelect(i,h,c,d,function(a,c){null==a?c.length>0?b(null,!0):b(null,!1):b(a)})):"construct"===i.kind&&(i.projection=[{token:"variable",kind:"*"}],g=this,this.executeSelect(i,h,c,d,function(a,c){null==a?g.denormalizeBindingsList(c,h,function(a){if(null!=a){var c=new k.Graph;null==i.template&&(i.template={triplesContext:i.pattern});for(var d=1,e=[],f=0;f<a.length;f++){for(var j=a[f],l=0;l<e.length;l++)delete e[l].valuetmp;for(var l=0;l<i.template.triplesContext.length;l++){for(var m=["subject","predicate","object"],n=i.template.triplesContext[l],o=0;o<m.length;o++){var p=m[o];if("blank"===n[p].token)if(n[p].valuetmp&&null!=n[p].valuetmp);else{var q="_:b"+d;d++,n[p].valuetmp=q,e.push(n[p])}}var r=k.buildRDFResource(n.subject,j,g,h),o=k.buildRDFResource(n.predicate,j,g,h),s=k.buildRDFResource(n.object,j,g,h);if(null!=r&&null!=o&&null!=s){var t=new k.Triple(r,o,s);c.add(t)}}}b(null,c)}else b(new Error("Error denormalizing bindings."))}):b(a)}))},QueryEngine.prototype.executeSelect=function(a,b,c,d,e){if("select"===a.kind||"ask"===a.kind||"construct"===a.kind||"modify"===a.kind){var f=a.projection,g=a.dataset,h=a.modifier,i=a.limit,j=a.offset,k=a.order,l=this;(null!=c||null!=d)&&(g.implicit=c||[],g.named=d||[]),null!=g.implicit&&0===g.implicit.length&&null!=g.named&&0===g.named.length&&g.implicit.push(this.lexicon.defaultGraphUriTerm),l.normalizeDatasets(g.implicit.concat(g.named),b,function(){try{l.executeSelectUnit(f,g,a.pattern,b,function(c){if(null!=c){if(null!=a.group&&""===a.group){for(var d=!1,m=0;m<a.projection.length;m++)if(null!=a.projection[m].expression&&"aggregate"===a.projection[m].expression.expressionType){d=!0;break}d===!0&&(a.group="singleGroup")}a.group&&""!=a.group?l.checkGroupSemantics(a.group,f)?l.groupSolution(c,a.group,g,b,function(a){var c=[];n.eachSeries(a,function(a,d){l.aggregateBindings(f,a,g,b,function(a){c.push(a),d()})},function(){e(null,{bindings:c,denorm:!0})})}):e(new Error("Incompatible Group and Projection variables")):l.applyOrderBy(k,c,g,b,function(a){var b=l.projectBindings(f,a,g),c=l.applyModifier(h,b),d=l.applyLimitOffset(j,i,c),k=l.removeDefaultGraphBindings(d,g);e(null,k)})}else e(new Error("Error executing SELECT query."))})}catch(c){e(c)}})}else e(new Error("Cannot execute "+a.kind+" query as a select query"))},QueryEngine.prototype.groupSolution=function(a,b,c,d,e){var f=[],g=[],h=!1,i=this;"singleGroup"===b?e([a]):n.eachSeries(a,function(a,e){var k=!0;n.eachSeries(b,function(b,e){var g=null;if("var"===b.token)g=b.value,0==h&&f.push(g),e();else if("aliased_expression"===b.token){if(g=b.alias.value,0==h&&f.push(g),"var"===b.expression.primaryexpression)a[b.alias.value]=a[b.expression.value.value];else{var l=i.copyDenormalizedBindings([a],d.outCache),m=j.runFilter(b.expression,l[0],i,c,d);j.isEbvError(m)?k=!1:(null!=m.value&&(m.value=""+m.value),a[b.alias.value]=m)}e()}else i.copyDenormalizedBindings([a],d.outCache,function(c){var l=j.runFilter(b,c[0],i,d);j.isEbvError(l)?k=!1:(a["groupCondition"+env._i]=l,g="groupCondition"+env._i,0==h&&f.push(g)),e()})},function(){0==h&&(h=!0),k===!0&&g.push(a),e()})},function(){for(var a={},b={},c=0,d=0;d<g.length;d++){for(var h=g[d],i="",j=0;j<f.length;j++){var k=h[f[j]];i+="object"==typeof k?k.value:k}null==a[i]?(b[i]=c,a[i]=[h]):a[i].push(h)}var l=[];for(var m in a)l.push(a[m]);e(l)})},QueryEngine.prototype.executeSelectUnit=function(a,b,c,d,e){if("BGP"===c.kind)this.executeAndBGP(a,b,c,d,e);else if("UNION"===c.kind)this.executeUNION(a,b,c.value,d,e);else if("JOIN"===c.kind)this.executeJOIN(a,b,c,d,e);else if("LEFT_JOIN"===c.kind)this.executeLEFT_JOIN(a,b,c,d,e);else if("FILTER"===c.kind){var g=this;this.executeSelectUnit(a,b,c.value,d,function(a){null!=a?j.checkFilters(c,a,!1,b,d,g,e):e([])})}else{if("EMPTY_PATTERN"!==c.kind)throw new f(c.kind);e([])}},QueryEngine.prototype.executeUNION=function(a,b,c,e,f){var g,h,k=c[0],l=c[1],m=null;if(2!=c.length)throw"SPARQL algebra UNION with more than two components";var o=this;n.seq(function(c){try{o.executeSelectUnit(a,b,k,e,function(a){g=a,c()})}catch(d){m=d,c()}},function(c){if(null==m)try{o.executeSelectUnit(a,b,l,e,function(a){h=a,c()})}catch(d){m=d,c()}else c()})(function(){if(null!=m)f(m);else{var a=i.unionBindings(g,h);o.runBinds(c.binds,a,b,e,function(a,g){if(null!=a)throw new d("Error processing bind expressions",c.binds,a);j.checkFilters(c,g,!1,b,e,o,f)})}})},QueryEngine.prototype.executeAndBGP=function(a,b,c,e,f){var g=this;i.executeAndBGPsDPSize(c.value,b,this,e,function(a){null!=a?g.runBinds(c.binds,a,b,e,function(a,h){if(null!=a)throw new d("Error processing bind expressions",c.binds,a);j.checkFilters(c,h,!1,b,e,g,f)}):f(null)})},QueryEngine.prototype.executeLEFT_JOIN=function(a,b,c,e,f){var g=c.lvalue,h=c.rvalue;if("EMPTY_PATTERN"===g.kind)this.executeSelectUnit(a,b,h,e,f);else{var k,l,m=null,o=null,p=null,q=this;n.seq(function(c){try{q.executeSelectUnit(a,b,g,e,function(a){m=a,c()})}catch(d){p=d,c()}},function(c){if(null!=p)c();else try{q.executeSelectUnit(a,b,h,e,function(a){o=a,c()})}catch(d){p=d,c()}})(function(){if(null!=p)f(p);else{var a=i.leftOuterJoinBindings(m,o);q.runBinds(c.binds,a,b,e,function(g,h){if(null!=g)throw new d("Error processing bind expressions",c.binds,g);j.checkFilters(c,a,!0,b,e,q,function(a){if(m.length>1&&o.length>1){var b=[],c={};for(var d in m[0])c[d]=!0;for(d in o[0])1!=c[d]&&b.push(d);k=[],l={};for(var e=0;e<a.length;e++)if(a[e].__nullify__===!0){for(var g=0;g<b.length;g++)a[e].bindings[b[g]]=null;var h=[],i=[];for(var d in a[e].bindings)null!=a[e].bindings[d]&&(h.push(d+a[e].bindings[d]),h.sort(),i.push(h.join("")));if(null==l[h.join("")]){for(g=0;g<i.length;g++)l[i[g]]=!0;k.push(a[e].bindings)}}else{k.push(a[e]);var h=[],i=[];for(var d in a[e])h.push(d+a[e][d]),h.sort(),l[h.join("")]=!0}f(k)}else f(a)})})}})}},QueryEngine.prototype.executeJOIN=function(a,b,c,e,f){var g=c.lvalue,h=c.rvalue,k=null,l=null,m=null,o=this;n.seq(function(c){try{o.executeSelectUnit(a,b,g,e,function(a){k=a,c()})}catch(d){m=d,c()}},function(c){if(null!=m)c();else try{o.executeSelectUnit(a,b,h,e,function(a){l=a,c()})}catch(d){m=d,c()}})(function(){var a=null;if(null!=m)f(m);else if(0===k.length||0===l.length)f([]);else{var n={},p=[];for(var q in k[0])n[q]=!1;for(var q in l[0])n[q]===!1&&p.push(q);a=0==p.length?i.joinBindings(k,l):o.abstractQueryTree.treeWithUnion(g)||o.abstractQueryTree.treeWithUnion(h)?i.joinBindings(k,l):i.joinBindings2(p,k,l),o.runBinds(c.binds,a,b,e,function(a,g){if(null!=a)throw new d("Error processing bind expressions",c.binds,a);j.checkFilters(c,g,!1,b,e,o,f)})}})},QueryEngine.prototype.rangeQuery=function(a,b,c){var d=this;d.normalizeQuad(a,b,!1,function(a){null!=a?d.backend.range(new h.Pattern(a),function(a){c(null==a||0==a.length?[]:a)}):c(null)})},QueryEngine.prototype.executeUpdate=function(a,b){var c=a.prologue,d=a.units,e=this,f={blanks:{},outCache:{}};this.registerNsInEnvironment(c,f);for(var h=0;h<d.length;h++){var i=e.abstractQueryTree.parseExecutableUnit(d[h]);if("insertdata"===i.kind){var j=null;n.eachSeries(i.quads,function(a,b){null===j?e._executeQuadInsert(a,f,function(a){null!=a&&(j=a),b()}):b()},function(){null===j?b(null,!0):b(j)})}else if("deletedata"===i.kind){var j=null;n.eachSeries(i.quads,function(a,b){null===j?e._executeQuadDelete(a,f,function(a){null!=a&&(j=a),b()}):b()},function(){null===j?b(null,!0):b(j)})}else if("modify"===i.kind)this._executeModifyQuery(i,f,b);else if("create"===i.kind)b(!0);else if("load"===i.kind){var k={uri:g.lexicalFormBaseUri(i.sourceGraph,f)};null!=i.destinyGraph&&(k={uri:g.lexicalFormBaseUri(i.destinyGraph,f)});var e=this;this.rdfLoader.load(i.sourceGraph.value,k,function(a,c){a?b(new Error("error batch loading quads")):e.batchLoad(c,function(a){null!==a?b(null,a):b(new Error("Error batch loading quads"))})})}else if("drop"===i.kind)this._executeClearGraph(i.destinyGraph,f,b);else{if("clear"!==i.kind)throw new Error("not supported execution unit");this._executeClearGraph(i.destinyGraph,f,b)}}},QueryEngine.prototype.batchLoad=function(a,b){var c=0,d={},e=this;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();var f=function(a,b,c,f){var g,a;if(a[b].uri||"uri"===a[b].token){var h=a[b].uri||a[b].value;e.lexicon.registerUri(h,function(d){var g=function(){null!=a[b].uri&&(a[b]={token:"uri",value:a[b].uri},delete a[b].uri),c[b]=d,f()};"graph"===b?e.lexicon.registerGraph(d,h,function(){g()}):g()})}else a[b].literal||"literal"===a[b].token?e.lexicon.registerLiteral(a[b].literal||a[b].value,function(d){null!=a[b].literal&&(a[b]=e.lexicon.parseLiteral(a[b].literal),delete a[b].literal),c[b]=d,f()}):(g=d[a[b].blank||a[b].value],null==g?e.lexicon.registerBlank(function(e){d[a[b].blank||a[b].value]=e,null==a[b].token&&(a[b].token="blank",a[b].value=a[b].blank,delete a[b].blank),c[b]=e,f()}):(null==a[b].token&&(a[b].token="blank",a[b].value=a[b].blank,delete a[b].blank),c[b]=g,f()))};n.eachSeries(a,function(a,b){var d={};n.eachSeries(["subject","predicate","object","graph"],function(b,c){f(a,b,d,c)},function(){var f=a;a=d;var g=new h.NodeKey(a);e.backend.search(g,function(d){d?b():e.backend.index(g,function(d){d&&(e.eventsOnBatchLoad&&e.callbacksBackend.nextGraphModification(m.added,[f,a]),c+=1),b()})})})},function(){null!=e.lexicon.updateAfterWrite&&e.lexicon.updateAfterWrite();var a=function(){b(c)};e.eventsOnBatchLoad?e.callbacksBackend.endGraphModification(a()):a()})},QueryEngine.prototype._executeModifyQuery=function(a,b,c){var d=this,e=!0,f=new Error("Error executing modify query"),g=null,h=["subject","predicate","object","graph"];a.insert=null==a.insert?[]:a.insert,a["delete"]=null==a["delete"]?[]:a["delete"],n.seq(function(c){var h=[],i=[];if(null!=a["with"]&&h.push(a["with"]),null!=a.using){i=[];for(var j=0;j<a.using.length;j++){var k=a.using[j];"named"===k.kind?i.push(k.uri):h.push(k.uri)}}a.dataset={},a.projection=[{token:"variable",kind:"*"}],d.executeSelect(a,b,h,i,function(a,h){return a?(f=a,e=!1,c()):void d.denormalizeBindingsList(h,b,function(a){null!=a?g=a:(f=new Error("Error denormalizing bindings list"),e=!1),c()})})},function(c){var f=a["with"];if(e){for(var i=[],j=0;j<a["delete"].length;j++)for(var k=a["delete"][j],l=0;l<g.length;l++){for(var m={},o=g[l],p=0;p<h.length;p++){var q=h[p];"graph"==q&&null==k[q]?m.graph=f:"var"===k[q].token?m[q]=o[k[q].value]:m[q]=k[q]}i.push(m)}n.eachSeries(i,function(a,c){d._executeQuadDelete(a,b,function(){c()})},function(){c()})}else c()},function(c){var f=a["with"];if(e){for(var i=[],j=0;j<a.insert.length;j++)for(var k=a.insert[j],l=0;l<g.length;l++){for(var m={},o=g[l],p=0;p<h.length;p++){var q=h[p];"graph"==q&&null==k[q]?m.graph=f:"var"===k[q].token?m[q]=o[k[q].value]:m[q]=k[q]}i.push(m)}n.eachSeries(i,function(a,c){d._executeQuadInsert(a,b,function(){c()})},function(){c()})}else c()})(function(){c(e?null:f)})},QueryEngine.prototype._executeQuadInsert=function(a,b,c){var d,e=this,f=!1,g=null;n.seq(function(c){e.normalizeQuad(a,b,!0,function(a){null!=a?d=a:(f=!0,g="Error normalizing quad."),c()})},function(b){if(f===!1){var c=new h.NodeKey(d);e.backend.search(c,function(f){f===!0?b():e.backend.index(c,function(){e.callbacksBackend.nextGraphModification(m.added,[a,d]),b()})})}else b()})(function(){f?c(new Error(g)):c(null,!0);
})},QueryEngine.prototype._executeQuadDelete=function(a,b,c){var d,e,f,g=this,i=!1;n.seq(function(c){g.normalizeQuad(a,b,!0,function(a){null!=a?d=a:(i=!0,e="Error normalizing quad."),c()})},function(a){i===!1?(f=new h.NodeKey(d),g.backend["delete"](f,function(){a()})):a()},function(b){i===!1?g.lexicon.unregister(a,f,function(){g.callbacksBackend.nextGraphModification(m.deleted,[a,d]),b()}):b()})(function(){i?c(new Error(e)):c(null,!0)})},QueryEngine.prototype._executeClearGraph=function(a,b,c){var d=this;if("default"===a)this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",c);else if("named"===a)d.lexicon.registeredGraphs(!0,function(a){if(null!=a){var b=!1;n.eachSeries(a,function(a,c){b?c():d.execute("DELETE { GRAPH <"+a+"> { ?s ?p ?o } } WHERE { GRAPH <"+a+"> { ?s ?p ?o } }",function(e,f){e?(b=e,c()):d.lexicon.resolveUri(a,function(e){-1!=e?d.lexicon.knownGraphs["delete"](e,function(){c()}):(b="Cannot find graph "+a+" to clear it",c())})})},function(){c(!b)})}else c(!1,"Error deleting named graphs")});else if("all"===a){var d=this;this.execute("CLEAR DEFAULT",function(a,b){a?c(!1,b):d.execute("CLEAR NAMED",c)})}else if("uri"==a.token){var e=g.lexicalFormBaseUri(a,b);null!=e?(this.callbacksBackend.ongoingModification=!0,this.execute("DELETE { GRAPH <"+e+"> { ?s ?p ?o } } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",function(a){d.callbacksBackend.ongoingModification=!1,c(a)})):c(!1,"wrong graph URI")}else c(!1,"wrong graph URI")},QueryEngine.prototype.checkGroupSemantics=function(a,b){if("singleGroup"===a)return!0;for(var c={},d=0;d<a.length;d++){var e=a[d];"var"===e.token?c[e.value]=!0:"aliased_expression"===e.token&&(c[e.alias.value]=!0)}for(d=0;d<b.length;d++){var f=b[d];if("var"===f.kind){if(null==c[f.value.value])return!1}else if("aliased"===f.kind&&f.expression&&"var"===f.expression.primaryexpression&&null==c[f.expression.value.value])return!1}return!0},QueryEngine.prototype.runBinds=function(a,b,c,d,e){var f=this,g=b;null!=a&&a.length>0?f.copyDenormalizedBindings(b,d.outCache,function(h){for(var i=0;i<b.length;i++)for(var k=0;k<a.length;k++){var l=a[k],m=h[i],n=j.runFilter(l.expression,m,f,c,d);j.isEbvError(n)?e(n):g[i][l.as.value]=n}e(null,b)}):e(null,b)},QueryEngine.prototype.computeCosts=function(a,b,c){for(var d=0;d<a.length;d++)a[d]._cost=this.quadCost(a[d],b);c(a)},QueryEngine.prototype.quadCost=function(a,b){return 1},QueryEngine.prototype.registerDefaultNamespace=function(a,b){this.defaultPrefixes[a]=b},b.exports={QueryEngine:QueryEngine}},{"./abstract_query_tree":39,"./graph_callbacks":42,"./quad_index":50,"./query_filters":52,"./query_plan":53,"./rdf_loader":54,"./rdf_model":55,"./utils":57}],52:[function(a,b,c){var d=a("./utils"),e=d,f=a("./utils");QueryFilters={};var g="http://www.w3.org/2001/XMLSchema#";QueryFilters.checkFilters=function(a,b,c,d,e,g,h){var i=[];a.filter&&"function"!=typeof a.filter&&(i=a.filter);var j=[];return null==i||0===i.length||null!=a.length?h(b):void QueryFilters.preprocessExistentialFilters(i,b,g,d,e,function(a){f.eachSeries(a,function(a,f){QueryFilters.run(a.value,b,c,d,e,g,function(a){for(var c=[],d=0;d<a.length;d++){var e=a[d];null!=e.__nullify__?j.push(e):c.push(e)}b=c,f()})},function(){h(b.concat(j))})})},QueryFilters.preprocessExistentialFilters=function(a,b,c,d,g,h){var i=[];f.eachSeries(a,function(a,h){if("builtincall"!==a.value.expressionType||"exists"!==a.value.builtincall&&"notexists"!==a.value.builtincall)if("conditionalor"===a.value.expressionType||"conditionaland"===a.value.expressionType){var j=e.map(a.value.operands,function(a){return{value:a}});QueryFilters.preprocessExistentialFilters(j,b,c,d,g,function(b){a.value.operands=b.map(function(a){return a.value}),i.push(a),h()})}else if("multiplicativeexpression"===a.value.expressionType){var j=e.map(a.value.factors,function(a){return{value:a}});QueryFilters.preprocessExistentialFilters(j,b,c,d,g,function(b){a.value.factors=b.map(function(a){return a.value}),i.push(a),h()})}else if("additiveexpression"===a.value.expressionType){var j=e.map(a.value.summands,function(a){return{value:a}});QueryFilters.preprocessExistentialFilters(j,b,c,d,g,function(b){a.value.summands=b.map(function(a){return a.value}),i.push(a),h()})}else if("relationalexpression"===a.value.expressionType){var j=[{value:a.value.op1},{value:a.value.op2}];QueryFilters.preprocessExistentialFilters(j,b,c,d,g,function(b){a.value.op1=b[0].value,a.value.op2=b[1].value,i.push(a),h()})}else if("irireforfunction"===a.value.expressionType||"custom"===a.value.expressionType)if(null!=a.value.args){var j=e.map(a.value.args,function(a){return{value:a}});QueryFilters.preprocessExistentialFilters(j,b,c,d,g,function(b){a.value.args=b.map(function(a){return a.value}),i.push(a),h()})}else i.push(a),h();else i.push(a),h();else{var k=a.value.builtincall,l=a.value.args,m={};c.copyDenormalizedBindings(b,g.outCache,function(b){f.eachSeries(b,function(a,b){var f=e.clone(l[0],!0),h=c.abstractQueryTree.parseSelect({pattern:f},a);h=c.abstractQueryTree.bind(h.pattern,a),c.executeSelectUnit([{kind:"*"}],d,h,g,function(c){var d=null;d="exists"===k?QueryFilters.ebvBoolean(0!==c.length):QueryFilters.ebvBoolean(0===c.length);var e=[];for(var f in a)e.push(JSON.stringify(a[f]));e=e.sort().join(""),m[e]=d,b()})},function(){a.value.origArgs=a.value.args,a.value.args=m,i.push(a),h()})})}},function(){h(i)})},QueryFilters.boundVars=function(a){if(null==a.expressionType)throw"Cannot find bound expressions in a no expression token";var b=a.expressionType;if("relationalexpression"==b){var c=a.op1,d=a.op2;return QueryFilters.boundVars(c)+QueryFilters.boundVars(d)}if("conditionalor"==b||"conditionaland"==b){for(var e=[],f=0;f<a.operands;f++)e=e.concat(QueryFilters.boundVars(a.operands[f]));return e}if("builtincall"==b){if(null==a.args)return[];for(var g=[],f=0;f<a.args.length;f++)g=g.concat(QueryFilters.boundVars(a.args[f]));return g}if("multiplicativeexpression"==b){for(var g=QueryFilters.boundVars(a.factor),f=0;f<a.factors.length;f++)g=g.concat(QueryFilters.boundVars(a.factors[f].expression));return g}if("additiveexpression"==b){for(var g=QueryFilters.boundVars(a.summand),f=0;f<a.summands.length;f++)g=g.concat(QueryFilters.boundVars(a.summands[f].expression));return g}if("regex"==b){var g=QueryFilters.boundVars(a.expression1);return g.concat(QueryFilters.boundVars(a.expression2))}return"unaryexpression"==b?QueryFilters.boundVars(a.expression):"atomic"==b?"var"==a.primaryexpression?[a.value]:[]:void 0},QueryFilters.run=function(a,b,c,d,e,f,g){f.copyDenormalizedBindings(b,e.outCache,function(h){for(var i=[],j=0;j<b.length;j++){var k=h[j],l=QueryFilters.runFilter(a,k,f,d,e),l=QueryFilters.ebv(l);if(QueryFilters.isEbvError(l)){if(c){var m={__nullify__:!0,bindings:b[j]};i.push(m)}}else if(l===!0)i.push(b[j]);else if(c){var m={__nullify__:!0,bindings:b[j]};i.push(m)}}g(i)})},QueryFilters.collect=function(a,b,c,d,e,f){e.copyDenormalizedBindings(b,d.outCache,function(g){for(var h=[],i=0;i<g.length;i++){var j=g[i],k=QueryFilters.runFilter(a,j,e,c,d);h.push({binding:b[i],value:k})}return f(h)})},QueryFilters.runDistinct=function(a,b){},QueryFilters.runAggregator=function(a,b,c,e,f){if(null==b||0===b.length)return QueryFilters.ebvError();if("variable"===a.token&&"var"==a.kind)return b[0][a.value.value];if("variable"===a.token&&"aliased"===a.kind){if("atomic"===a.expression.expressionType&&"var"===a.expression.primaryexpression)return b[0][a.expression.value.value];if("aggregate"===a.expression.expressionType){if("max"===a.expression.aggregateType){for(var h=null,i=0;i<b.length;i++){var j=b[i],k=QueryFilters.runFilter(a.expression.expression,j,c,e,f);QueryFilters.isEbvError(k)||(null===h?h=k:QueryFilters.runLtFunction(h,k).value===!0&&(h=k))}return null===h?QueryFilters.ebvError():h}if("min"===a.expression.aggregateType){for(var l=null,i=0;i<b.length;i++){var j=b[i],k=QueryFilters.runFilter(a.expression.expression,j,c,e,f);QueryFilters.isEbvError(k)||(null===l?l=k:QueryFilters.runGtFunction(l,k).value===!0&&(l=k))}return null===l?QueryFilters.ebvError():l}if("count"===a.expression.aggregateType){var m={},n=0;if("*"===a.expression.expression)if(null!=a.expression.distinct&&""!=a.expression.distinct)for(var i=0;i<b.length;i++){var j=b[i],o=d.hashTerm(j);null==m[o]&&(m[o]=!0,n++)}else n=b.length;else for(var i=0;i<b.length;i++){var j=b[i],k=QueryFilters.runFilter(a.expression.expression,j,c,e,f);if(!QueryFilters.isEbvError(k))if(null!=a.expression.distinct&&""!=a.expression.distinct){var o=d.hashTerm(k);null==m[o]&&(m[o]=!0,n++)}else n++}return{token:"literal",type:g+"integer",value:""+n}}if("avg"===a.expression.aggregateType){for(var m={},p={token:"literal",type:g+"integer",value:"0"},n=0,i=0;i<b.length;i++){var j=b[i],k=QueryFilters.runFilter(a.expression.expression,j,c,e,f);if(!QueryFilters.isEbvError(k))if(null!=a.expression.distinct&&""!=a.expression.distinct){var o=d.hashTerm(k);null==m[o]&&(m[o]=!0,QueryFilters.isNumeric(k)&&(p=QueryFilters.runSumFunction(p,k),n++))}else QueryFilters.isNumeric(k)&&(p=QueryFilters.runSumFunction(p,k),n++)}var q=QueryFilters.runDivFunction(p,{token:"literal",type:g+"integer",value:""+n});return q.value=""+q.value,q}if("sum"===a.expression.aggregateType){for(var m={},p={token:"literal",type:g+"integer",value:"0"},i=0;i<b.length;i++){var j=b[i],k=QueryFilters.runFilter(a.expression.expression,j,c,e,f);if(!QueryFilters.isEbvError(k))if(null!=a.expression.distinct&&""!=a.expression.distinct){var o=d.hashTerm(k);null==m[o]&&(m[o]=!0,QueryFilters.isNumeric(k)&&(p=QueryFilters.runSumFunction(p,k)))}else QueryFilters.isNumeric(k)&&(p=QueryFilters.runSumFunction(p,k))}return p.value=""+p.value,p}var k=QueryFilters.runFilter(aggregate.expression,b[0],e,{blanks:{},outCache:{}});return k}}},QueryFilters.runFilter=function(a,b,c,e,f){if(null!=a.expressionType){var g=a.expressionType;if("relationalexpression"==g){var h=QueryFilters.runFilter(a.op1,b,c,e,f),i=QueryFilters.runFilter(a.op2,b,c,e,f);return QueryFilters.runRelationalFilter(a,h,i,b,c,e,f)}if("conditionalor"==g)return QueryFilters.runOrFunction(a,b,c,e,f);if("conditionaland"==g)return QueryFilters.runAndFunction(a,b,c,e,f);if("additiveexpression"==g)return QueryFilters.runAddition(a.summand,a.summands,b,c,e,f);if("builtincall"==g)return QueryFilters.runBuiltInCall(a.builtincall,a.args,b,c,e,f);if("multiplicativeexpression"==g)return QueryFilters.runMultiplication(a.factor,a.factors,b,c,e,f);if("unaryexpression"==g)return QueryFilters.runUnaryExpression(a.unaryexpression,a.expression,b,c,e,f);if("irireforfunction"==g)return QueryFilters.runIriRefOrFunction(a.iriref,a.args,b,c,e,f);if("regex"==g)return QueryFilters.runRegex(a.text,a.pattern,a.flags,b,c,e,f);if("custom"==g)return QueryFilters.runBuiltInCall(a.name,a.args,b,c,e,f);if("atomic"==g)return"var"==a.primaryexpression?b[a.value.value]:"object"!=typeof a.value?a.value:null==a.value.type||"object"!=typeof a.value.type?a.value:(a.value.type=d.lexicalFormBaseUri(a.value.type,f),a.value);throw"Unknown filter expression type"}throw"Cannot find bound expressions in a no expression token"},QueryFilters.isRDFTerm=function(a){return null==a?!1:a.token&&"literal"==a.token||a.token&&"uri"==a.token||a.token&&"blank"==a.token?!0:!1},QueryFilters.RDFTermEquality=function(a,b,c,e){return"literal"===a.token&&"literal"===b.token?a.lang==b.lang&&a.type==b.type&&a.value==b.value?!0:null!=a.type&&null!=b.type?QueryFilters.ebvError():QueryFilters.isSimpleLiteral(a)&&null!=b.type?QueryFilters.ebvError():QueryFilters.isSimpleLiteral(b)&&null!=a.type?QueryFilters.ebvError():!1:"uri"===a.token&&"uri"===b.token?d.lexicalFormBaseUri(a,e)==d.lexicalFormBaseUri(b,e):"blank"===a.token&&"blank"===b.token?a.value==b.value:!1},QueryFilters.isInteger=function(a){return null==a?!1:"literal"===a.token&&(a.type==g+"integer"||a.type==g+"decimal"||a.type==g+"double"||a.type==g+"nonPositiveInteger"||a.type==g+"negativeInteger"||a.type==g+"long"||a.type==g+"int"||a.type==g+"short"||a.type==g+"byte"||a.type==g+"nonNegativeInteger"||a.type==g+"unsignedLong"||a.type==g+"unsignedInt"||a.type==g+"unsignedShort"||a.type==g+"unsignedByte"||a.type==g+"positiveInteger")?!0:!1},QueryFilters.isFloat=function(a){return null==a?!1:"literal"===a.token&&a.type==g+"float"?!0:!1},QueryFilters.isDecimal=function(a){return null==a?!1:"literal"===a.token&&a.type==g+"decimal"?!0:!1},QueryFilters.isDouble=function(a){return null==a?!1:"literal"===a.token&&a.type==g+"double"?!0:!1},QueryFilters.isNumeric=function(a){return null==a?!1:"literal"===a.token&&(a.type==g+"integer"||a.type==g+"decimal"||a.type==g+"float"||a.type==g+"double"||a.type==g+"nonPositiveInteger"||a.type==g+"negativeInteger"||a.type==g+"long"||a.type==g+"int"||a.type==g+"short"||a.type==g+"byte"||a.type==g+"nonNegativeInteger"||a.type==g+"unsignedLong"||a.type==g+"unsignedInt"||a.type==g+"unsignedShort"||a.type==g+"unsignedByte"||a.type==g+"positiveInteger")?!0:!1},QueryFilters.isSimpleLiteral=function(a){return a&&"literal"==a.token&&null==a.type&&null==a.lang?!0:!1},QueryFilters.isXsdType=function(a,b){return b&&"literal"==b.token?b.type==g+""+a:!1},QueryFilters.ebv=function(a){if(null==a||QueryFilters.isEbvError(a))return QueryFilters.ebvError();if(a.token&&"literal"===a.token){if(a.type==g+"integer"||a.type==g+"decimal"||a.type==g+"double"||a.type==g+"nonPositiveInteger"||a.type==g+"negativeInteger"||a.type==g+"long"||a.type==g+"int"||a.type==g+"short"||a.type==g+"byte"||a.type==g+"nonNegativeInteger"||a.type==g+"unsignedLong"||a.type==g+"unsignedInt"||a.type==g+"unsignedShort"||a.type==g+"unsignedByte"||a.type==g+"positiveInteger"){var b=parseFloat(a.value);return isNaN(b)?!1:0!=parseFloat(a.value)}return a.type===g+"boolean"?"true"===a.value||a.value===!0||"True"===a.value:a.type===g+"string"?""!=a.value:a.type===g+"dateTime"?null!=new Date(a.value):QueryFilters.isEbvError(a)?a:null==a.type?""!=a.value?!0:!1:QueryFilters.ebvError()}return a.value===!0},QueryFilters.effectiveBooleanValue=QueryFilters.ebv,QueryFilters.ebvTrue=function(){var a={token:"literal",type:g+"boolean",value:!0};return a},QueryFilters.ebvFalse=function(){var a={token:"literal",type:g+"boolean",value:!1};return a},QueryFilters.ebvError=function(){var a={token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null};return a},QueryFilters.isEbvError=function(a){return"object"==typeof a&&null!=a?"https://github.com/antoniogarrote/js-tools/types#error"===a.type:!1},QueryFilters.ebvBoolean=function(a){return QueryFilters.isEbvError(a)?a:a===!0?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.runRelationalFilter=function(a,b,c,d,e,f,g){var h=a.operator;if("="===h)return QueryFilters.runEqualityFunction(b,c,d,e,f,g);if("!="===h){var i=QueryFilters.runEqualityFunction(b,c,d,e,f,g);return QueryFilters.isEbvError(i)?i:(i.value=!i.value,i)}if("<"===h)return QueryFilters.runLtFunction(b,c,d);if(">"===h)return QueryFilters.runGtFunction(b,c,d);if("<="===h)return QueryFilters.runLtEqFunction(b,c,d);if(">="===h)return QueryFilters.runGtEqFunction(b,c,d);throw"Error applying relational filter, unknown operator"},QueryFilters.effectiveTypeValue=function(a){if("literal"!=a.token)throw console.log("not implemented yet"),console.log(a),"value not supported in operations yet";if(a.type==g+"integer"){var b=parseInt(a.value);return b}if(a.type==g+"decimal"){var b=parseFloat(a.value);return b}if(a.type==g+"float"){var b=parseFloat(a.value);return b}if(a.type==g+"double"){var b=parseFloat(a.value);return b}if(a.type==g+"nonPositiveInteger"){var b=parseFloat(a.value);return b}if(a.type==g+"negativeInteger"){var b=parseInt(a.value);return b}if(a.type==g+"long"){var b=parseInt(a.value);return b}if(a.type==g+"int"){var b=parseInt(a.value);return b}if(a.type==g+"short"){var b=parseInt(a.value);return b}if(a.type==g+"byte"){var b=parseInt(a.value);return b}if(a.type==g+"nonNegativeInteger"){var b=parseInt(a.value);return b}if(a.type==g+"unsignedLong"){var b=parseInt(a.value);return b}if(a.type==g+"unsignedInt"){var b=parseInt(a.value);return b}if(a.type==g+"unsignedShort"){var b=parseInt(a.value);return b}if(a.type==g+"unsignedByte"){var b=parseInt(a.value);return b}if(a.type==g+"positiveInteger"){var b=parseInt(a.value);return b}if(a.type!=g+"date"&&a.type!=g+"dateTime")return a.type==g+"boolean"?a.value===!0||"true"===a.value||"1"===a.value||1===a.value||a.value===!0?!0:a.value===!1||"false"===a.value||"0"===a.value||0===a.value||a.value===!1?!1:void 0:a.type==g+"string"?null===a.value||void 0===a.value?void 0:""+a.value:null==a.type?a.value:a.value;try{var c=d.parseISO8601(a.value);return c}catch(e){return null}},QueryFilters.runOrFunction=function(a,b,c,d,e){for(var f=null,g=0;g<a.operands.length;g++){var h=QueryFilters.runFilter(a.operands[g],b,c,d,e);0==QueryFilters.isEbvError(h)&&(h=QueryFilters.ebv(h)),null==f?f=h:QueryFilters.isEbvError(h)?f=QueryFilters.isEbvError(f)?QueryFilters.ebvError():f===!0?!0:QueryFilters.ebvError():h===!0?f=!0:QueryFilters.isEbvError(f)&&(f=QueryFilters.ebvError())}return QueryFilters.ebvBoolean(f)},QueryFilters.runAndFunction=function(a,b,c,d,e){for(var f=null,g=0;g<a.operands.length;g++){var h=QueryFilters.runFilter(a.operands[g],b,c,d,e);0==QueryFilters.isEbvError(h)&&(h=QueryFilters.ebv(h)),null==f?f=h:QueryFilters.isEbvError(h)?f=QueryFilters.isEbvError(f)?QueryFilters.ebvError():f===!0?QueryFilters.ebvError():!1:h===!0?QueryFilters.isEbvError(f)&&(f=QueryFilters.ebvError()):f=!1}return QueryFilters.ebvBoolean(f)},QueryFilters.runEqualityFunction=function(a,b,c,e,f,g){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();if(QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b)){var h=QueryFilters.effectiveTypeValue(a),i=QueryFilters.effectiveTypeValue(b);return isNaN(h)||isNaN(i)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(a,b,e,g)):QueryFilters.ebvBoolean(h==i)}if((QueryFilters.isSimpleLiteral(a)||QueryFilters.isXsdType("string",a))&&(QueryFilters.isSimpleLiteral(b)||QueryFilters.isXsdType("string",b)))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)==QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("boolean",a)&&QueryFilters.isXsdType("boolean",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)==QueryFilters.effectiveTypeValue(b));if((QueryFilters.isXsdType("dateTime",a)||QueryFilters.isXsdType("date",a))&&(QueryFilters.isXsdType("dateTime",b)||QueryFilters.isXsdType("date",b))){if(QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isXsdType("date",b))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",a)&&QueryFilters.isXsdType("dateTime",b))return QueryFilters.ebvFalse();var j=d.compareDateComponents(a.value,b.value);return null!=j?0==j?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.isRDFTerm(a)&&QueryFilters.isRDFTerm(b)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(a,b,e,g)):QueryFilters.ebvFalse()},QueryFilters.runGtFunction=function(a,b,c){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();if(QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>QueryFilters.effectiveTypeValue(b));if(QueryFilters.isSimpleLiteral(a)&&QueryFilters.isSimpleLiteral(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("string",a)&&QueryFilters.isXsdType("string",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("boolean",a)&&QueryFilters.isXsdType("boolean",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>QueryFilters.effectiveTypeValue(b));if((QueryFilters.isXsdType("dateTime",a)||QueryFilters.isXsdType("date",a))&&(QueryFilters.isXsdType("dateTime",b)||QueryFilters.isXsdType("date",b))){if(QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isXsdType("date",b))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",a)&&QueryFilters.isXsdType("dateTime",b))return QueryFilters.ebvFalse();var e=d.compareDateComponents(a.value,b.value);return null!=e?1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runTotalGtFunction=function(a,b){return QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b)?QueryFilters.ebvError():QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b)||QueryFilters.isSimpleLiteral(a)&&QueryFilters.isSimpleLiteral(b)||QueryFilters.isXsdType("string",a)&&QueryFilters.isSimpleLiteral("string",b)||QueryFilters.isXsdType("boolean",a)&&QueryFilters.isSimpleLiteral("boolean",b)||QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isSimpleLiteral("dateTime",b)?QueryFilters.runGtFunction(a,b,[]):a.token&&"uri"===a.token&&b.token&&"uri"===b.token?QueryFilters.ebvBoolean(a.value>b.value):a.token&&"literal"===a.token&&b.token&&"literal"===b.token?QueryFilters.ebvBoolean(""+a.value+a.type+a.lang>""+b.value+b.type+b.lang):a.token&&"blank"===a.token&&b.token&&"blank"===b.token?QueryFilters.ebvBoolean(a.value>b.value):a.value&&b.value?QueryFilters.ebvBoolean(a.value>b.value):QueryFilters.ebvTrue()},QueryFilters.runLtFunction=function(a,b,c){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();if(QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<QueryFilters.effectiveTypeValue(b));if(QueryFilters.isSimpleLiteral(a)&&QueryFilters.isSimpleLiteral(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("string",a)&&QueryFilters.isXsdType("string",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("boolean",a)&&QueryFilters.isXsdType("boolean",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<QueryFilters.effectiveTypeValue(b));if((QueryFilters.isXsdType("dateTime",a)||QueryFilters.isXsdType("date",a))&&(QueryFilters.isXsdType("dateTime",b)||QueryFilters.isXsdType("date",b))){if(QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isXsdType("date",b))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",a)&&QueryFilters.isXsdType("dateTime",b))return QueryFilters.ebvFalse();var e=d.compareDateComponents(a.value,b.value);return null!=e?-1==e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runGtEqFunction=function(a,b,c){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();if(QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isSimpleLiteral(a)&&QueryFilters.isSimpleLiteral(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("string",a)&&QueryFilters.isXsdType("string",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("boolean",a)&&QueryFilters.isXsdType("boolean",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)>=QueryFilters.effectiveTypeValue(b));if((QueryFilters.isXsdType("dateTime",a)||QueryFilters.isXsdType("date",a))&&(QueryFilters.isXsdType("dateTime",b)||QueryFilters.isXsdType("date",b))){if(QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isXsdType("date",b))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",a)&&QueryFilters.isXsdType("dateTime",b))return QueryFilters.ebvFalse();var e=d.compareDateComponents(a.value,b.value);return null!=e?-1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runLtEqFunction=function(a,b,c){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();if(QueryFilters.isNumeric(a)&&QueryFilters.isNumeric(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isSimpleLiteral(a)&&QueryFilters.isSimpleLiteral(b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("string",a)&&QueryFilters.isXsdType("string",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<=QueryFilters.effectiveTypeValue(b));if(QueryFilters.isXsdType("boolean",a)&&QueryFilters.isXsdType("boolean",b))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(a)<=QueryFilters.effectiveTypeValue(b));if((QueryFilters.isXsdType("dateTime",a)||QueryFilters.isXsdType("date",a))&&(QueryFilters.isXsdType("dateTime",b)||QueryFilters.isXsdType("date",b))){if(QueryFilters.isXsdType("dateTime",a)&&QueryFilters.isXsdType("date",b))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",a)&&QueryFilters.isXsdType("dateTime",b))return QueryFilters.ebvFalse();var e=d.compareDateComponents(a.value,b.value);return null!=e?1!=e?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()}return QueryFilters.ebvFalse()},QueryFilters.runAddition=function(a,b,c,d,e,f){var g=QueryFilters.runFilter(a,c,d,e,f);if(QueryFilters.isEbvError(g))return QueryFilters.ebvError();var h=g;if(QueryFilters.isNumeric(g)){for(var i=0;i<b.length;i++){var j=QueryFilters.runFilter(b[i].expression,c,d,e,f);if(!QueryFilters.isNumeric(j))return QueryFilters.ebvFalse();"+"===b[i].operator?h=QueryFilters.runSumFunction(h,j):"-"===b[i].operator&&(h=QueryFilters.runSubFunction(h,j))}return h}return QueryFilters.ebvFalse()},QueryFilters.runSumFunction=function(a,b){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();var c=QueryFilters.effectiveTypeValue(a)+QueryFilters.effectiveTypeValue(b);return QueryFilters.isDouble(a)||QueryFilters.isDouble(b)?{token:"literal",type:g+"double",value:c}:QueryFilters.isFloat(a)||QueryFilters.isFloat(b)?{token:"literal",type:g+"float",value:c}:QueryFilters.isDecimal(a)||QueryFilters.isDecimal(b)?{token:"literal",type:g+"decimal",value:c}:{token:"literal",type:g+"integer",value:c}},QueryFilters.runSubFunction=function(a,b){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();var c=QueryFilters.effectiveTypeValue(a)-QueryFilters.effectiveTypeValue(b);return QueryFilters.isDouble(a)||QueryFilters.isDouble(b)?{token:"literal",type:g+"double",value:c}:QueryFilters.isFloat(a)||QueryFilters.isFloat(b)?{token:"literal",type:g+"float",value:c}:QueryFilters.isDecimal(a)||QueryFilters.isDecimal(b)?{token:"literal",type:g+"decimal",value:c}:{token:"literal",type:g+"integer",value:c}},QueryFilters.runMultiplication=function(a,b,c,d,e,f){var g=QueryFilters.runFilter(a,c,d,e,f);if(QueryFilters.isEbvError(g))return g;var h=g;if(QueryFilters.isNumeric(g)){for(var i=0;i<b.length;i++){var j=QueryFilters.runFilter(b[i].expression,c,d,e,f);if(QueryFilters.isEbvError(j))return g;if(!QueryFilters.isNumeric(j))return QueryFilters.ebvFalse();"*"===b[i].operator?h=QueryFilters.runMulFunction(h,j):"/"===b[i].operator&&(h=QueryFilters.runDivFunction(h,j))}return h}return QueryFilters.ebvFalse()},QueryFilters.runMulFunction=function(a,b){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();var c=QueryFilters.effectiveTypeValue(a)*QueryFilters.effectiveTypeValue(b);return QueryFilters.isDouble(a)||QueryFilters.isDouble(b)?{token:"literal",type:g+"double",value:c}:QueryFilters.isFloat(a)||QueryFilters.isFloat(b)?{token:"literal",type:g+"float",value:c}:QueryFilters.isDecimal(a)||QueryFilters.isDecimal(b)?{token:"literal",type:g+"decimal",value:c}:{token:"literal",type:g+"integer",value:c}},QueryFilters.runDivFunction=function(a,b){if(QueryFilters.isEbvError(a)||QueryFilters.isEbvError(b))return QueryFilters.ebvError();var c=QueryFilters.effectiveTypeValue(a)/QueryFilters.effectiveTypeValue(b);return QueryFilters.isDouble(a)||QueryFilters.isDouble(b)?{token:"literal",type:g+"double",value:c}:QueryFilters.isFloat(a)||QueryFilters.isFloat(b)?{token:"literal",type:g+"float",value:c}:QueryFilters.isDecimal(a)||QueryFilters.isDecimal(b)?{token:"literal",type:g+"decimal",value:c}:{token:"literal",type:g+"integer",value:c}},QueryFilters.runBuiltInCall=function(a,b,c,d,e,f){if("notexists"===a||"exists"===a){var g=[];for(var h in c)g.push(JSON.stringify(c[h]));return g=g.sort().join(""),b[g]}for(var i=[],j=0;j<b.length;j++)if("var"===b[j].token)i.push(b[j]);else{var k=QueryFilters.runFilter(b[j],c,d,e,f);if(QueryFilters.isEbvError(k))return k;i.push(k)}if("str"===a)return"literal"===i[0].token?{token:"literal",type:null,value:""+i[0].value}:"uri"===i[0].token?{token:"literal",type:null,value:i[0].value}:QueryFilters.ebvFalse();if("lang"===a)return"literal"===i[0].token?null!=i[0].lang?{token:"literal",value:""+i[0].lang}:{token:"literal",value:""}:QueryFilters.ebvError();if("datatype"===a){if("literal"===i[0].token){var l=i[0];return null!=l.type?"string"==typeof l.type?{token:"uri",value:l.type,prefix:null,suffix:null}:l.type:null==l.lang?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:QueryFilters.ebvError()}return QueryFilters.ebvError()}if("isliteral"===a)return"literal"===i[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isblank"===a)return"blank"===i[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isuri"===a||"isiri"===a)return"uri"===i[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("sameterm"===a){var m=i[0],n=i[1],o=QueryFilters.RDFTermEquality(m,n,d,f);return QueryFilters.isEbvError(o)&&(o=!1),QueryFilters.ebvBoolean(o)}if("langmatches"===a){var p=i[0],q=i[1];return"literal"===p.token&&"literal"===q.token?"*"===q.value&&""!=p.value?QueryFilters.ebvTrue():QueryFilters.ebvBoolean(0===p.value.toLowerCase().indexOf(q.value.toLowerCase())):QueryFilters.ebvError()}if("bound"===a){var r=i[0].value;return null==r?QueryFilters.ebvError():null!=c[r]?QueryFilters.ebvTrue():QueryFilters.ebvFalse()}if(null!=d.customFns[a])return d.customFns[a](QueryFilters,i);throw"Builtin call "+a+" not implemented yet"},QueryFilters.runUnaryExpression=function(a,b,c,d,e,f){var g=QueryFilters.runFilter(b,c,d,e,f);if(QueryFilters.isEbvError(g))return g;if("!"===a){var h=QueryFilters.ebv(g);return QueryFilters.isEbvError(h)?QueryFilters.ebvFalse():(h=!h,QueryFilters.ebvBoolean(h))}if("+"===a)return QueryFilters.isNumeric(g)?g:QueryFilters.ebvError();if("-"===a){if(QueryFilters.isNumeric(g)){var i={};for(var j in g)i[j]=g[j];return i.value=-i.value,i}return QueryFilters.ebvError()}},QueryFilters.runRegex=function(a,b,c,d,e,f,g){if(null==a)return QueryFilters.ebvError();if(a=QueryFilters.runFilter(a,d,e,f,g),null==b)return QueryFilters.ebvError();if(b=QueryFilters.runFilter(b,d,e,f,g),null!=c&&(c=QueryFilters.runFilter(c,d,e,f,g)),null==b||"literal"!==b.token||null!=c&&"literal"!==c.token)return QueryFilters.ebvError();if(b=b.value,c=null==c?null:c.value,null!=a&&"var"==a.token){if(null==d[a.value])return QueryFilters.ebvError();a=d[a.value]}else{if(null==a||"literal"!==a.token)return QueryFilters.ebvError();if(null!=a.type&&!QueryFilters.isXsdType("string",a))return QueryFilters.ebvError();a=a.value}var h;return h=null==c?new RegExp(b):new RegExp(b,c.toLowerCase()),h.exec(a)?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.normalizeLiteralDatatype=function(a,b,c){return null==a.value.type||"object"!=typeof a.value.type?a:(a.value.type=d.lexicalFormBaseUri(a.value.type,c),a)},QueryFilters.runIriRefOrFunction=function(a,b,c,e,f,h){if(null==b)return a;for(var i=[],j=0;j<b.length;j++)i.push(QueryFilters.runFilter(b[j],c,e,f,h));var k=d.lexicalFormBaseUri(a,h);if(k==g+"integer"||k==g+"decimal"||k==g+"double"||k==g+"nonPositiveInteger"||k==g+"negativeInteger"||k==g+"long"||k==g+"int"||k==g+"short"||k==g+"byte"||k==g+"nonNegativeInteger"||k==g+"unsignedLong"||k==g+"unsignedInt"||k==g+"unsignedShort"||k==g+"unsignedByte"||k==g+"positiveInteger"){
var l=i[0];if("literal"!==l.token)return QueryFilters.ebvError();if(l=QueryFilters.normalizeLiteralDatatype(l,e,h),l.type==g+"integer"||l.type==g+"decimal"||l.type==g+"double"||l.type==g+"nonPositiveInteger"||l.type==g+"negativeInteger"||l.type==g+"long"||l.type==g+"int"||l.type==g+"short"||l.type==g+"byte"||l.type==g+"nonNegativeInteger"||l.type==g+"unsignedLong"||l.type==g+"unsignedInt"||l.type==g+"unsignedShort"||l.type==g+"unsignedByte"||l.type==g+"positiveInteger")return l.type=k,l;if("http://www.w3.org/2001/XMLSchema#boolean"==l.type)return 1==QueryFilters.ebv(l)?(l.type=k,l.value=1):(l.type=k,l.value=0),l;if("http://www.w3.org/2001/XMLSchema#float"==l.type||"http://www.w3.org/2001/XMLSchema#double"==l.type)return l.type=k,l.value=parseInt(l.value),l;if("http://www.w3.org/2001/XMLSchema#string"!=l.type&&null!=l.type)return QueryFilters.ebvError();if(l.value.split(".").length>2)return QueryFilters.ebvError();if(l.value.split("-").length>2)return QueryFilters.ebvError();if(l.value.split("/").length>2)return QueryFilters.ebvError();if(l.value.split("+").length>2)return QueryFilters.ebvError();if(k==g+"decimal"&&(-1!=l.value.indexOf("e")||-1!=l.value.indexOf("E")))return QueryFilters.ebvError();if(!(k!=g+"int"&&k!=g+"integer"||-1==l.value.indexOf("e")&&-1==l.value.indexOf("E")&&-1==l.value.indexOf(".")))return QueryFilters.ebvError();try{return l.value=parseInt(parseFloat(l.value)),isNaN(l.value)?QueryFilters.ebvError():(l.type=k,l)}catch(m){return QueryFilters.ebvError()}}else{if(k==g+"boolean"){var l=i[0];return"literal"===l.token&&null==l.type?"true"===l.value||"1"===l.value?QueryFilters.ebvTrue():"false"===l.value||"0"===l.value?QueryFilters.ebvFalse():QueryFilters.ebvError():"literal"===l.token?QueryFilters.isEbvError(l)?l:QueryFilters.ebvBoolean(l):QueryFilters.ebvError()}if(k==g+"string"){var l=i[0];return"literal"===l.token?(l=QueryFilters.normalizeLiteralDatatype(l,e,h),l.type==g+"integer"||l.type==g+"decimal"||l.type==g+"double"||l.type==g+"nonPositiveInteger"||l.type==g+"negativeInteger"||l.type==g+"long"||l.type==g+"int"||l.type==g+"short"||l.type==g+"byte"||l.type==g+"nonNegativeInteger"||l.type==g+"unsignedLong"||l.type==g+"unsignedInt"||l.type==g+"unsignedShort"||l.type==g+"unsignedByte"||l.type==g+"positiveInteger"||l.type==g+"float"?(l.type=k,l.value=""+l.value,l):l.type==g+"string"?l:l.type==g+"boolean"?(QueryFilters.ebv(l)?(l.type=k,l.value="true"):(l.type=k,l.value="false"),l):l.type==g+"dateTime"||l.type==g+"date"?(l.type=k,"string"!=typeof l.value&&(l.value=d.iso8601(l.value)),l):null==l.type?(l.value=""+l.value,l.type=k,l):QueryFilters.ebvError()):"uri"===l.token?{token:"literal",value:d.lexicalFormBaseUri(l,h),type:k,lang:null}:QueryFilters.ebvError()}if(k==g+"dateTime"||k==g+"date"){if(l=i[0],l.type==g+"dateTime"||l.type==g+"date")return l;if(l.type!=g+"string"&&null!=l.type)return QueryFilters.ebvError();try{return l.value=d.iso8601(d.parseISO8601(l.value)),l.type=k,l}catch(m){return QueryFilters.ebvError()}}else{if(k!=g+"float")return null!=e.customFns[k]?e.customFns[k](QueryFilters,i):QueryFilters.ebvError();var l=i[0];if("literal"!==l.token)return QueryFilters.ebvError();if(l=QueryFilters.normalizeLiteralDatatype(l,e,h),"http://www.w3.org/2001/XMLSchema#decimal"==l.type||"http://www.w3.org/2001/XMLSchema#int"==l.type)return l.type=k,l.value=parseFloat(l.value),l;if("http://www.w3.org/2001/XMLSchema#boolean"==l.type)return 1==QueryFilters.ebv(l)?(l.type=k,l.value=1):(l.type=k,l.value=0),l;if("http://www.w3.org/2001/XMLSchema#float"==l.type||"http://www.w3.org/2001/XMLSchema#double"==l.type)return l.type=k,l.value=parseFloat(l.value),l;if("http://www.w3.org/2001/XMLSchema#string"==l.type)try{return l.value=parseFloat(l.value),isNaN(l.value)?QueryFilters.ebvError():(l.type=k,l)}catch(m){return QueryFilters.ebvError()}else{if(null!=l.type)return QueryFilters.ebvError();if(l.value.split(".").length>2)return QueryFilters.ebvError();if(l.value.split("-").length>2)return QueryFilters.ebvError();if(l.value.split("/").length>2)return QueryFilters.ebvError();if(l.value.split("+").length>2)return QueryFilters.ebvError();try{return l.value=parseFloat(l.value),isNaN(l.value)?QueryFilters.ebvError():(l.type=k,l)}catch(m){return QueryFilters.ebvError()}}}}},b.exports={QueryFilters:QueryFilters}},{"./utils":57}],53:[function(a,b,c){var d=a("./utils"),e=a("./utils"),f={};f.variablesInBGP=function(a){var b=a.variables;if(b)return b;var c=a.value||a;b=[];for(var d in c)c[d]&&"var"===c[d].token?b.push(c[d].value):c[d]&&"blank"===c[d].token&&b.push("blank:"+c[d].value);return a.variables=b,b},f.connected=function(a,b){for(var c="/"+a.vars.join("/")+"/",d=0;d<b.vars.length;d++)if(-1!=c.indexOf("/"+b.vars[d]+"/"))return!0;return!1};var g=function(a,b){for(var c={},d=0;d<a.lenght;d++)c[a[d]]=1;for(d=0;d<b.length;d++){var e=c[b[d]]||0;e++,c[b[d]]=e}var f=[];for(var g in c)2==c[g]&&f.push(c[g]);return f};f.variablesIntersectionBGP=function(a,b){return g(f.variablesInBGP(a),f.variablesInBGP(b))},f.executeAndBGPsGroups=function(a){for(var b={},c={},e=0,g=function(a,b){for(var c=0;c<a.length;c++){var d="/"+a[c]+"/";if(-1!=b.indexOf(d))return!0}return!1},h=function(a,d,e,f){var g=[],h="",i="";for(var j in d)h+=j,g=g.concat(b[j]),i+=c[j];i=i+m.join("/")+"/",g.push(a),e[h]=g,f[h]=i},i=0;i<a.length;i++){var j=a[i],k={},l={},m=f.variablesInBGP(j),n={};for(var o in c)g(m,c[o])?n[o]=!0:(k[o]=b[o],l[o]=c[o]);0===d.size(n)?(k["g"+e]=[j],l["g"+e]="/"+m.join("/")+"/",e++):h(j,n,k,l),b=k,c=l}return d.values(b)},f.intersectionSize=function(a,b){for(var c=b.i.split("_"),d=0;d<c.length;d++)if(""!=c[d]&&-1!=a.i.indexOf("_"+c[d]+"_"))return 1;return 0},f.createJoinTree=function(a,b){for(var c="/"+a.vars.join("/")+"/",e=a.vars.concat([]),f=[],g=0;g<b.vars.length;g++)-1!=c.indexOf("/"+b.vars[g]+"/")?0==b.vars[g].indexOf("_:")?f.push("blank:"+b.vars[g]):f.push(b.vars[g]):e.push(b.vars[g]);for(var h=b.i.split("_"),i=a.i.split("_"),j={},g=0;g<h.length;g++)""!=h[g]&&(j[h[g]]=!0);for(var g=0;g<i.length;g++)""!=i[g]&&(j[i[g]]=!0);var k=d.keys(j);return{left:a,right:b,cost:a.cost+b.cost,i:"_"+k.sort().join("_")+"_",vars:e,join:f}},f.executeBushyTree=function(a,b,c,d,e){null==a.left?f.executeEmptyJoinBGP(a.right,b,c,d,e):null==a.right?f.executeEmptyJoinBGP(a.left,b,c,d,e):f.executeBushyTree(a.left,b,c,d,function(g){null!=g?f.executeBushyTree(a.right,b,c,d,function(b){e(null!=b?f.joinBindings2(a.join,g,b):null)}):e(null)})},f.executeAndBGPsDPSize=function(a,b,c,d,g){var h=f.executeAndBGPsGroups(a),i=[];e.eachSeries(h,function(a,b){c.computeCosts(a,d,function(a){var c={},d={},e={},g=1,h=null,j={};e[1]=[];for(var k=0;k<a.length;k++){var l=[];delete a[k].variables;for(var m in a[k])"_cost"!=m&&("var"===a[k][m].token?l.push(a[k][m].value):"blank"===a[k][m].token&&l.push(a[k][m].value));d["_"+k+"_"]={left:a[k],right:null,cost:a[k]._cost,i:"_"+k+"_",vars:l};var n={left:a[k],right:null,cost:a[k]._cost,i:"_"+k+"_",vars:l};c["_"+k+"_"]=n,delete a[k]._cost,j["_"+k+"_"]=!0,e[1].push("_"+k+"_"),(null==h||h.cost>n.cost)&&(h=n)}for(var o=2;o<=a.length;o++)for(var p=1;o>p;p++)for(var q=o-p,r=e[""+p]||[],s=e[""+q]||[],k=0;k<r.length;k++)for(var t=0;t<s.length;t++)if(r[k]!==s[t]){var u=d[r[k]],v=d[s[t]];if(0==f.intersectionSize(u,v)&&f.connected(u,v)){g=o;var w=c[u.i],x=c[v.i],y=f.createJoinTree(w,x);if(!j[y.i]){j[y.i]=!0;var z=y.cost+1;null!=c[y.i]&&(z=c[y.i].cost);var A=e[o]||[];A.push(y.i),d[y.i]=y,e[o]=A,z>y.cost&&(g===o&&(h=y),c[y.i]=y)}}}i.push(h),b()})},function(){var a=null;e.eachSeries(i,function(e,g){f.executeBushyTree(e,b,c,d,function(b){b?null==a?(a=b,g()):(a=f.crossProductBindings(a,b),g()):g("Error executing bushy tree")})},function(b){b?g(null,b):g(a)})})},f.executeEmptyJoinBGP=function(a,b,c,d,e){return f.executeBGPDatasets(a,b,c,d,e)},f.executeBGPDatasets=function(a,b,c,d,g){var h={};if(null==a.graph){var i=[];e.eachSeries(b.implicit,function(b,e){null==h[b.oid]?(h[b.oid]=!0,a.graph=b,c.rangeQuery(a,d,function(b){b=f.buildBindingsFromRange(b,a),i.push(b),e()})):e()},function(){var a=f.unionManyBindings(i);g(a)})}else if("var"===a.graph.token){var j=a.graph.value,i=[];e.eachSeries(b.named,function(b,e){null==h[b.oid]?(h[b.oid]=!0,a.graph=b,null!=i?c.rangeQuery(a,d,function(c){if(null!=c){c=f.buildBindingsFromRange(c,a);for(var d=0;d<c.length;d++)c[d][j]=b.oid;i.push(c)}else i=null;e()}):e()):e()},function(){if(null==i)g(null);else{var a=f.unionManyBindings(i);g(a)}})}else c.rangeQuery(a,d,function(b){null!=b?(b=f.buildBindingsFromRange(b,a),g(b)):g(null)})},f.buildBindingsFromRange=function(a,b){f.variablesInBGP(b);var c=b.value||b,d={};for(k in c)c[k]&&"var"===c[k].token?d[k]=c[k].value:c[k]&&"blank"===c[k].token&&(d[k]="blank:"+c[k].value);var e=[];if(null!=a)for(var g=0;g<a.length;g++){var h={},i=a[g],j=!1;for(var k in d){var l=i[k];if(null!=h[d[k]]&&h[d[k]]!==l){j=!0;break}h[d[k]]=l}j||e.push(h)}return e},f.areCompatibleBindings=function(a,b){for(var c in a)if(null!=b[c]&&b[c]!=a[c])return!1;return!0},f.mergeBindings=function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c},f.joinBindings2=function(a,b,c){for(var d,e,g,h,i,j={},k=[],l=0;l<b.length;l++){d=b[l],i=j;for(var m=0;m<a.length;m++)e=a[m],g=d[e],m==a.length-1?(h=i[g]||[],h.push(d),i[g]=h):(h=i[g]||{},i[g]=h,i=h)}for(var l=0;l<c.length;l++){d=c[l],i=j;for(var m=0;m<a.length;m++)if(e=a[m],g=d[e],null!=i[g])if(m==a.length-1)for(var n=0;n<i[g].length;n++)k.push(f.mergeBindings(i[g][n],d));else i=i[g]}return k},f.joinBindings=function(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=a[d],g=0;g<b.length;g++){var h=b[g];f.areCompatibleBindings(e,h)&&c.push(f.mergeBindings(e,h))}return c},f.augmentMissingBindings=function(a,b){for(var c in b)null==a[c]&&(a[c]=null);return a},f.leftOuterJoinBindings=function(a,b){for(var c=[],d=0;d<a.length;d++){for(var e=a[d],g=!1,h=0;h<b.length;h++){var i=b[h];f.areCompatibleBindings(e,i)&&(g=!0,c.push(f.mergeBindings(e,i)))}g===!1&&(f.augmentMissingBindings(e,i),c.push(e))}return c},f.crossProductBindings=function(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=a[d],g=0;g<b.length;g++){var h=b[g];c.push(f.mergeBindings(e,h))}return c},f.unionBindings=function(a,b){return a.concat(b)},f.unionManyBindings=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b=f.unionBindings(b,d)}return b},b.exports={QueryPlan:f}},{"./utils":57}],54:[function(a,b,c){var d=a("./network_transport").NetworkTransport,e=a("./rvn3_parser").RVN3Parser,f=a("./jsonld_parser").JSONLDParser,g=a("./utils"),h=function(a){if(this.precedences=["text/turtle","text/n3","application/ld+json","application/json"],this.parsers={"text/turtle":e.parser,"text/n3":e.parser,"application/ld+json":f.parser,"application/json":f.parser},"undefined"!=typeof RDFXMLParser&&(this.precedences.push("application/rdf+xml"),this.parsers["application/rdf+xml"]=RDFXMLParser.parser),null!=a)for(var b in a.parsers)this.parsers[b]=a.parsers[b];if(a&&null!=a.precedences){this.precedences=a.precedences;for(var b in a.parsers)g.include(this.precedences,b)||this.precedences.push(b)}this.acceptHeaderValue="";for(var c=0;c<this.precedences.length;c++)0!=c?this.acceptHeaderValue=this.acceptHeaderValue+","+this.precedences[c]:this.acceptHeaderValue=this.acceptHeaderValue+this.precedences[c]};h.prototype.registerParser=function(a,b){this.parsers[a]=b,this.precedences.push(a)},h.prototype.unregisterParser=function(a){delete this.parsers[a];for(var b=[],c=0;c<this.precedences.length;c++)this.precedences[c]!=a&&b.push(this.precedences[c]);this.precedences=b},h.prototype.setAcceptHeaderPrecedence=function(a){this.precedences=a},h.prototype.load=function(a,b,c){var e=this;d.load(a,this.acceptHeaderValue,function(d,f){if(d)c(d);else{var g=f.headers["Content-Type"]||f.headers["content-type"],h=f.data;if(null!=g){g=g.split(";")[0];for(var i in e.parsers)if(-1!=i.indexOf("/")){var j=i.split("/");if("*"===j[1]){if(-1!=g.indexOf(j[0]))return e.tryToParse(e.parsers[i],b,h,{documentURI:a},c)}else{if(-1!=g.indexOf(i))return e.tryToParse(e.parsers[i],b,h,{documentURI:a},c);if(-1!=g.indexOf(j[1]))return e.tryToParse(e.parsers[i],b,h,{documentURI:a},c)}}else if(-1!=g.indexOf(i))return e.tryToParse(e.parsers[i],b,h,{documentURI:a},c);c(new Error("Unknown media type : "+g))}else c(new Error("Uknown media type"))}})},h.prototype.loadFromFile=function(b,c,d,e){try{var f=this,g=a("fs");g.readFile(d.split("file:/")[1],function(a,g){if(a)e(a);else{var g=g.toString("utf8");f.tryToParse(b,c,g,{documentURI:d},e)}})}catch(h){e(h)}},h.prototype.tryToParse=function(a,b,c,d,e){try{"string"==typeof c&&(c=g.normalizeUnicodeLiterals(c)),a.parse(c,b,d,e)}catch(f){console.log(f.message),console.log(f.stack),e(f)}},b.exports={RDFLoader:h}},{"./jsonld_parser":43,"./network_transport":45,"./rvn3_parser":56,"./utils":57,fs:5}],55:[function(a,b,c){var d=a("./utils"),e=a("./query_filters").QueryFilters;RDFModel={},RDFModel.defaultContext={rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#",ldp:"http://www.w3.org/ns/ldp#"},RDFModel.UrisMap=function(){this.defaultNs="",this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]},RDFModel.UrisMap.prototype.values=function(){var a={};for(var b in this)d.include(this.interfaceProperties,b)||"function"==typeof this[b]||"defaultNs"===b||"interfaceProperties"===b||(a[b]=this[b]);return a},RDFModel.UrisMap.prototype.get=function(a){if(-1!=a.indexOf(" "))throw"Prefix must not contain any whitespaces";return this[a]},RDFModel.UrisMap.prototype.remove=function(a){if(-1!=a.indexOf(" "))throw"Prefix must not contain any whitespaces";return delete this[a],null},RDFModel.UrisMap.prototype.set=function(a,b){if(-1!=a.indexOf(" "))throw"Prefix must not contain any whitespaces";this[a]=b},RDFModel.UrisMap.prototype.setDefault=function(a){this.defaultNs=a},RDFModel.UrisMap.prototype.addAll=function(a,b){for(var c in a)d.include(this.interfaceProperties,c)||(null!=this[c]?b===!0&&(this[c]=a[c]):this[c]=a[c]);return this},RDFModel.UrisMap.prototype.resolve=function(a){var b=a.split(":"),c=b[0],d=b[1];return""===c?null==this.defaultNs?null:this.defaultNs+d:null!=this[c]?this[c]+d:null},RDFModel.UrisMap.prototype.shrink=function(a){for(var b in this){var c=this[b];if(0===a.indexOf(c)&&""!==c&&"defaultNs"!=b){var d=a.split(c)[1];return b+":"+d}}return a},RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap,this.terms=new RDFModel.UrisMap},RDFModel.Profile.prototype.importProfile=function(a,b){this.prefixes.addAll(a.prefixes,b),this.terms.addAll(a.terms,b)},RDFModel.Profile.prototype.resolve=function(a){return-1!=a.indexOf(":")?this.prefixes.resolve(a):null!=this.terms[a]?this.terms.resolve(a):null},RDFModel.Profile.prototype.setDefaultPrefix=function(a){this.prefixes.setDefault(a)},RDFModel.Profile.prototype.setDefaultVocabulary=function(a){this.terms.setDefault(a)},RDFModel.Profile.prototype.setPrefix=function(a,b){this.prefixes.set(a,b)},RDFModel.Profile.prototype.setTerm=function(a,b){this.terms.set(a,b)},RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this),this.blankNodeCounter=0;var a=this;this.filters={s:function(a){return function(b){return b.subject.equals(a)}},p:function(a){return function(b){return b.predicate.equals(a)}},o:function(a){return function(b){return b.object.equals(a)}},sp:function(a,b){return function(c){return c.subject.equals(a)&&c.predicate.equals(b)}},so:function(a,b){return function(c){return c.subject.equals(a)&&c.object.equals(b)}},po:function(a,b){return function(c){return c.predicate.equals(a)&&c.object.equals(b)}},spo:function(a,b,c){return function(d){return d.subject.equals(a)&&d.predicate.equals(b)&&d.object.equals(c)}},describes:function(a){return function(b){return b.subject.equals(a)||b.object.equals(a)}},type:function(b){var c=a.resolve("rdf:type");return function(a){return a.predicate.equals(c)&&a.object.equals(b)}}};for(var b in RDFModel.defaultContext)this.prefixes.set(b,RDFModel.defaultContext[b])},RDFModel.RDFEnvironment.prototype=d.create(RDFModel.Profile.prototype,{constructor:RDFModel.RDFEnvironment}),RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var a=new RDFModel.BlankNode(this.blankNodeCounter);return this.blankNodeCounter++,a},RDFModel.RDFEnvironment.prototype.createNamedNode=function(a){var b=this.resolve(a);return null!=b?new RDFModel.NamedNode(b):new RDFModel.NamedNode(a)},RDFModel.RDFEnvironment.prototype.createLiteral=function(a,b,c){return null!=c?new RDFModel.Literal(a,b,c.toString()):new RDFModel.Literal(a,b,c)},RDFModel.RDFEnvironment.prototype.createTriple=function(a,b,c){return new RDFModel.Triple(a,b,c)},RDFModel.RDFEnvironment.prototype.createGraph=function(a){var b=new RDFModel.Graph;if(null!=a)for(var c=0;c<a.length;c++)b.add(a[c]);return b},RDFModel.RDFEnvironment.prototype.createAction=function(a,b){return function(c){return a(c)?b(c):c}},RDFModel.RDFEnvironment.prototype.createProfile=function(a){if(a===!0)return new RDFModel.RDFEnvironment.Profile;var b=new RDFModel.RDFEnvironment.Profile;return b.importProfile(this),b},RDFModel.RDFEnvironment.prototype.createTermMap=function(a){if(a===!0)return new RDFModel.UrisMap;var b=this.terms.values(),c=new RDFModel.UrisMap;for(var d in b)c[d]=b[d];return c},RDFModel.RDFEnvironment.prototype.createPrefixMap=function(a){if(a===!0)return new RDFModel.UrisMap;var b=this.prefixes.values(),c=new RDFModel.UrisMap;for(var d in b)c[d]=b[d];return c},RDFModel.RDFNode=function(a){this.interfaceName=a,this.attributes=["interfaceName","nominalValue"]},RDFModel.RDFNode.prototype.equals=function(a){if(null==a.interfaceName)return this.valueOf()==a;for(var b in this.attributes){var c=this.attributes[b];if(this[c]!=a[c])return!1}return!0},RDFModel.BlankNode=function(a){RDFModel.RDFNode.call(this,"BlankNode"),this.nominalValue="_:"+a,this.bnodeId=a},RDFModel.BlankNode.prototype=d.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.BlankNode}),RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue},RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue},RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Literal=function(a,b,c){RDFModel.RDFNode.call(this,"Literal");var d=a.replace(/\\"/g,'"').replace(/\\t/g,"	").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");this.nominalValue=d,null!=b?this.language=b:null!=c&&(this.datatype=c)},RDFModel.Literal.prototype=d.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.Literal}),RDFModel.Literal.prototype.toString=function(a){var b=this.nominalValue;a&&(b=b.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"'));var b='"'+b+'"';return null!=this.language?b=b+"@"+this.language:(null!=this.datatype||this.type)&&(b=b+"^^<"+(this.datatype||this.type)+">"),b},RDFModel.Literal.prototype.toNT=function(){return this.toString(!0)},RDFModel.Literal.prototype.valueOf=function(){return e.effectiveTypeValue({token:"literal",type:this.type||this.datatype,value:this.nominalValue,language:this.language})},RDFModel.NamedNode=function(a){RDFModel.RDFNode.call(this,"NamedNode"),null!=a.value?this.nominalValue=a.value:this.nominalValue=a},RDFModel.NamedNode.prototype=d.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.NamedNode}),RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue},RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"},RDFModel.NamedNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Triple=function(a,b,c){this.subject=a,this.predicate=b,this.object=c},RDFModel.Triple.prototype.equals=function(a){return this.subject.equals(a.subject)&&this.predicate.equals(a.predicate)&&this.object.equals(a.object)},RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"},RDFModel.Graph=function(){this.triples=[],this.duplicates={},this.actions=[],this.length=0},RDFModel.Graph.prototype.add=function(a){for(var b=0;b<this.actions.length;b++)a=this.actions[b](a);var c=a.subject.toString()+a.predicate.toString()+a.object.toString();return this.duplicates[c]||(this.duplicates[c]=!0,this.triples.push(a)),this.length=this.triples.length,this},RDFModel.Graph.prototype.addAction=function(a,b){if(this.actions.push(a),1==b)for(var c=0;c<this.triples.length;c++)this.triples[c]=a(this.triples[c]);return this},RDFModel.Graph.prototype.addAll=function(a){for(var b=a.toArray(),c=0;c<b.length;c++)this.add(b[c]);return this.length=this.triples.length,this},RDFModel.Graph.prototype.remove=function(a){for(var b=null,c=0;c<this.triples.length;c++)if(this.triples[c].equals(a)){var d=a.subject.toString()+a.predicate.toString()+a.object.toString();delete this.duplicates[d],b=c;break}return null!=b&&this.triples.splice(b,1),this.length=this.triples.length,this},RDFModel.Graph.prototype.toArray=function(){return this.triples},RDFModel.Graph.prototype.some=function(a){for(var b=0;b<this.triples.length;b++)if(a(this.triples[b],this)===!0)return!0;return!1},RDFModel.Graph.prototype.every=function(a){for(var b=0;b<this.triples.length;b++)if(a(this.triples[b],this)===!1)return!1;return!0},RDFModel.Graph.prototype.filter=function(a){for(var b=new RDFModel.Graph,c=0;c<this.triples.length;c++)a(this.triples[c],this)===!0&&b.add(this.triples[c]);return b},RDFModel.Graph.prototype.forEach=function(a){for(var b=0;b<this.triples.length;b++)a(this.triples[b],this)},RDFModel.Graph.prototype.merge=function(a){for(var b=new RDFModel.Graph,c=0;c<this.triples.length;c++)b.add(this.triples[c]);return b},RDFModel.Graph.prototype.match=function(a,b,c,d){for(var e=new RDFModel.Graph,f=0,g=0;g<this.triples.length;g++){var h=this.triples[g];if((null==a||h.subject.equals(a))&&(null==b||h.predicate.equals(b))&&(null==c||h.object.equals(c))){if(!(null==d||d>f))return e;f++,e.add(h)}}return e},RDFModel.Graph.prototype.removeMatches=function(a,b,c){for(var d=[],e=0;e<this.triples.length;e++){var f=this.triples[e];(null==a||f.subject.equals(a))&&(null==b||f.predicate.equals(b))&&(null==c||f.object.equals(c))&&d.push(f)}for(var e=0;e<d.length;e++)this.remove(d[e]);return this},RDFModel.Graph.prototype.toNT=function(){var a="";return this.forEach(function(b){a+=b.toString()}),a},RDFModel.buildRDFResource=function(a,b,c,d){if("blank"===a.token)return RDFModel.buildBlankNode(a,b,c,d);if("literal"===a.token)return RDFModel.buildLiteral(a,b,c,d);if("uri"===a.token)return RDFModel.buildNamedNode(a,b,c,d);if("var"===a.token){var e=b[a.value];return null!=e?RDFModel.buildRDFResource(e,b,c,d):null}return null},RDFModel.buildBlankNode=function(a,b,c,d){return null!=a.valuetmp&&(a.value=a.valuetmp),0===a.value.indexOf("_:")&&(a.value=a.value.split("_:")[1]),new RDFModel.BlankNode(a.value)},RDFModel.buildLiteral=function(a,b,c,d){return new RDFModel.Literal(a.value,a.lang,a.type)},RDFModel.buildNamedNode=function(a,b,c,d){if(null!=a.value)return new RDFModel.NamedNode(a);if(null!=a.prefix){var e=c.resolveNsInEnvironment(a.prefix,d);return a.value=e+a.suffix,new RDFModel.NamedNode(a)}return new RDFModel.NamedNode(a)},RDFModel.rdf=new RDFModel.RDFEnvironment,b.exports=RDFModel},{"./query_filters":52,"./utils":57}],56:[function(a,b,c){function d(a){switch(a[0]){case'"':if(a.indexOf("^^")>0){var b=a.split("^^");return{literal:b[0]+"^^<"+b[1]+">"}}return{literal:a};case"_":return{blank:a.replace("b","")};default:return{token:"uri",value:a,prefix:null,suffix:null}}}var e=a("n3").Parser,f={};f.parser={async:!0,parse:function(a,b,c,f){f||(f=c,c=b,b=null),b&&"string"==typeof b&&(b={token:"uri",value:b,prefix:null,suffix:null}),c&&c.baseURI&&(c.documentIRI=c.baseURI);var g=[];new e(c).parse(a,function(a,c){a?f(a):c?g.push({subject:d(c.subject),predicate:d(c.predicate),object:d(c.object),graph:b}):f(!1,g)})},resetBlankNodeIds:function(){e._resetBlankNodeIds()}},b.exports={RVN3Parser:f}},{n3:27}],57:[function(_dereq_,module,exports){(function(process){var slowNextTick=function(){return"undefined"!=typeof process&&process.nextTick?process.nextTick:"undefined"!=typeof window&&window.setImmediate?window.setImmediate:function(a){setTimeout(a,0)}}(),spin=0,yieldFrequency=100,nextTick=function(a){spin++,yieldFrequency>spin?a():(spin=0,slowNextTick(a))},hashTerm=function(a){try{if(null==a)return"";if("uri"===a.token)return"u"+a.value;if("blank"===a.token)return"b"+a.value;if("literal"===a.token){var b="l"+a.value;return b+=a.type||"",b+=a.lang||""}}catch(c){if("object"==typeof a){var d="";for(p in a)d=d+p+a[p];return d}return a}},lexicalFormBaseUri=function(a,b){var c=null;if(b=b||{},null==a.value){var d=a.prefix,e=a.suffix,f=b.namespaces[d];c=null!=f?f+e:d+":"+e}else c=a.value;return null===c?null:(-1==c.indexOf(":")&&(c=(b.base||"")+c),c)};parseISO8601=function(a){return Date.parse(a)},Date.prototype.toISOString||!function(){function a(a){return 10>a?"0"+a:a}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),iso8601=function(a){return a.toISOString()},compareDateComponents=function(a,b){var c=parseISO8601(a),d=parseISO8601(b);return c==d?0:d>c?-1:1},lexicalFormLiteral=function(a,b){var c=a.value,d=a.lang,e=a.type,f=null;if(null!=c&&null!=e&&"string"!=typeof e){var g=e.value;if(null==g){var h=e.prefix,i=e.suffix,j=b.namespaces[h];a.type=j+i,g=j+i}f='"'+a.value+'"^^<'+g+">"}else f=null==d&&null==e?'"'+c+'"':null==e?'"'+c+'"@'+d:'"'+a.value+'"^^<'+e+">";return f},normalizeUnicodeLiterals=function(string){for(var escapedUnicode=string.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],dups={},i=0;i<escapedUnicode.length;i++)null==dups[escapedUnicode[i]]&&(dups[escapedUnicode[i]]=!0,string=string.replace(new RegExp("\\"+escapedUnicode[i],"g"),eval("'"+escapedUnicode[i]+"'")));return string},registerIndexedDB=function(a){if("undefined"==typeof window&&"undefined"!=typeof process&&process.browser===!1){var b=_dereq_("sqlite3"),c=_dereq_("indexeddb-js"),d=new b.Database(":memory:"),e=c.makeScope("sqlite3",d);a.indexedDB=e.indexedDB,a.IDBKeyRange=e.IDBKeyRange}else{var f;f="undefined"==typeof window?self:window,f.indexedDB=f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,f.IDBKeyRange=f.IDBKeyRange||f.webkitIDBKeyRange||f.msIDBKeyRange,f.indexedDB?(a.indexedDB=f.indexedDB,a.IDBKeyRange=f.IDBKeyRange):console.log("The browser does not support IndexDB.")}},guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},hashTerm=function(a){try{if(null==a)return"";if("uri"===a.token)return"u"+a.value;if("blank"===a.token)return"b"+a.value;if("literal"===a.token){var b="l"+a.value;return b+=a.type||"",b+=a.lang||""}}catch(c){if("object"==typeof a){var d="";for(p in a)d=d+p+a[p];return d}return a}};var reject=function(a,b){for(var c=[],d=0;d<a.length;d++)b(a[d])&&c.push(a[d]);return c},include=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1},each=function(a,b){if(a.forEach)a.forEach(b);else for(var c=0;c<a.length;c++)b(a[c])},map=function(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c[d]=b(a[d]);return c},keys=function(a){var b=[];for(var c in a)b.push(c);return b},values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},size=function(a){if(a.length)return a.length;var b=0;for(var c in a)b++;return b};clone=function(a){return JSON.parse(JSON.stringify(a))};var isObject=function(a){var b=typeof a;return"function"==b||a&&"object"==b||!1},create=function(){function a(){}return function(b){if(isObject(b)){a.prototype=b;var c=new a;a.prototype=null}return c||a()}}(),whilst=function(a,b,c){a()?b(function(d){return d?c(d):void whilst(a,b,c)}):c()},eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():nextTick(e))})};e()},eachParallel=function(a,b,c){if(c=c||function(){},!a.length)return c();for(var d=!1,e=0,f=function(b){if(b)throw d=!0,new Error(b);d||(e++,e===a.length&&c())},g=0;g<a.length;g++)!function(a,b,c,d){nextTick(function(){try{d(a[b],function(){c()})}catch(e){c(e)}})}(a,g,f,b)},reduce=function(a,b,c,d){eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},seq=function(){var a=arguments;return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},isWorker=function(){return("undefined"==typeof process||process.browser===!0)&&"undefined"==typeof window?!0:!1};module.exports={isWorker:isWorker,nextTick:nextTick,hasTerm:hashTerm,lexicalFormBaseUri:lexicalFormBaseUri,parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:hashTerm,keys:keys,values:values,size:size,map:map,each:each,forEach:each,include:include,reject:reject,remove:reject,clone:clone,create:create,whilst:whilst,eachSeries:eachSeries,eachParallel:eachParallel,seq:seq,yieldFrequency:function(a){yieldFrequency=a}}}).call(this,_dereq_("7YKIPe"))},{"7YKIPe":10}]},{},[41])(41)});var TabulatorRDFXMLParser=function(){function a(a){return"string"==typeof a||"[object String]"===Object.prototype.toString.call(a)}function b(b,c){var g=b;a(b)&&(g=e(b));var h=new f(c),i=new d(h);return i.parse(g,"http://nobase"),h.statements}var c=function(a,b){var c=b.indexOf("#");if(c>0&&(b=b.slice(0,c)),0==a.length)return b;if(0==a.indexOf("#"))return b+a;var d=a.indexOf(":");if(d>=0)return a;var e=b.indexOf(":");if(""==b)return a;if(0>e)throw"Invalid Base URI";var f=b.slice(0,e+1);if(0==a.indexOf("//"))return f+a;if(b.indexOf("//",e)==e+1){var g=b.indexOf("/",e+3);if(0>g)return b.length-e-3>0?b+"/"+a:f+a}else{var g=b.indexOf("/",e+1);if(0>g)return b.length-e-1>0?b+"/"+a:f+a}if(0==a.indexOf("/"))return b.slice(0,g)+a;var h=b.slice(g),i=h.lastIndexOf("/");if(0>i)return f+a;for(i>=0&&i<h.length-1&&(h=h.slice(0,i+1)),h+=a;h.match(/[^\/]*\/\.\.\//);)h=h.replace(/[^\/]*\/\.\.\//,"");return h=h.replace(/\.\//g,""),h=h.replace(/\/\.$/,"/"),b.slice(0,g)+h},d=function(a){var b={};b.ns={RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},b.nodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},this.frameFactory=function(a,d,e){return{NODE:1,ARC:2,parent:d,parser:a,store:a.store,element:e,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(a,b){b=c(b,this.base),this.node=this.store.sym(b),this.nodeType=a},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var a=this.store.sym(c("#"+this.parent.rdfid,this.base));this.store.add(a,this.store.sym(b.ns.RDF+"type"),this.store.sym(b.ns.RDF+"Statement"),this.parser.why),this.store.add(a,this.store.sym(b.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),
this.store.add(a,this.store.sym(b.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(a,this.store.sym(b.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType==this.NODE&&this.parent.nodeType==this.ARC&&this.parent.parent.nodeType==this.NODE},addNode:function(a){this.addSymbol(this.NODE,a),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(a){null!=a?null!=this.parser.bnodes[a]?this.node=this.parser.bnodes[a]:this.node=this.parser.bnodes[a]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(a){a==b.ns.RDF+"li"&&(a=b.ns.RDF+"_"+this.parent.listIndex++),this.addSymbol(this.ARC,a)},addLiteral:function(a){this.parent.datatype?this.node=this.store.literal(a,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(a,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(a,b,c){var d=null;if(a.getAttributeNodeNS)d=a.getAttributeNodeNS(b,c);else for(var e,f,g=a.attributes,h=0;h<g.length;++h)if(e=g[h],e.namespaceURI==b&&(f=e.prefix?e.prefix+":"+c:c,f==e.nodeName)){d=e;break}return d},this.store=a,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(a,c,d){var e=a.childNodes;if(this.cleanParser(),a.nodeType==b.nodeType.DOCUMENT){for(var f=0;f<e.length;f++)if(e[f].nodeType==b.nodeType.ELEMENT){var g=e[f];break}}else{if(a.nodeType!=b.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+c+". Halting. ");var g=a}this.why=d;var h=this.frameFactory(this);return this.base=c,h.base=c,h.lang="",this.parseDOM(this.buildFrame(h,g)),!0},this.parseDOM=function(a){for(var d=function(a){var b="";return a.namespaceURI&&(b+=a.namespaceURI),a.localName?b+=a.localName:a.nodeName&&(b+=a.nodeName.indexOf(":")>=0?a.nodeName.split(":")[1]:a.nodeName),b},e=!0;a.parent;){var f=a.element,g=f.attributes;if(f.nodeType==b.nodeType.TEXT||f.nodeType==b.nodeType.CDATA_SECTION)a.addLiteral(f.nodeValue);else if(d(f)!=b.ns.RDF+"RDF")if(a.parent&&a.parent.collection&&(a.addCollectionArc(),a=this.buildFrame(a,a.element),a.parent.element=null),a.parent&&a.parent.nodeType&&a.parent.nodeType!=a.ARC){if(a.addArc(d(f)),this.reify){var h=this.getAttributeNodeNS(f,b.ns.RDF,"ID");h&&(a.rdfid=h.nodeValue,f.removeAttributeNode(h))}var i=this.getAttributeNodeNS(f,b.ns.RDF,"parseType"),j=this.getAttributeNodeNS(f,b.ns.RDF,"datatype");if(j&&(a.datatype=j.nodeValue,f.removeAttributeNode(j)),i){var k=i.nodeValue;"Literal"==k?(a.datatype=b.ns.RDF+"XMLLiteral",a=this.buildFrame(a),a.addLiteral(f),e=!1):"Resource"==k?(a=this.buildFrame(a,a.element),a.parent.element=null,a.addBNode()):"Collection"==k&&(a=this.buildFrame(a,a.element),a.parent.element=null,a.addCollection()),f.removeAttributeNode(i)}if(0!=g.length){var l=this.getAttributeNodeNS(f,b.ns.RDF,"resource"),m=this.getAttributeNodeNS(f,b.ns.RDF,"nodeID");a=this.buildFrame(a),l?(a.addNode(l.nodeValue),f.removeAttributeNode(l)):m?(a.addBNode(m.nodeValue),f.removeAttributeNode(m)):a.addBNode();for(var n=g.length-1;n>=0;n--){var o=this.buildFrame(a);o.addArc(d(g[n])),d(g[n])==b.ns.RDF+"type"?this.buildFrame(o).addNode(g[n].nodeValue):this.buildFrame(o).addLiteral(g[n].nodeValue)}}else 0==f.childNodes.length&&this.buildFrame(a).addLiteral("")}else{var p=this.getAttributeNodeNS(f,b.ns.RDF,"about"),h=this.getAttributeNodeNS(f,b.ns.RDF,"ID");if(p&&h)throw new Error("RDFParser: "+f.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(null==p&&h)a.addNode("#"+h.nodeValue),f.removeAttributeNode(h);else if(null==p&&null==h){var m=this.getAttributeNodeNS(f,b.ns.RDF,"nodeID");m?(a.addBNode(m.nodeValue),f.removeAttributeNode(m)):a.addBNode()}else a.addNode(p.nodeValue),f.removeAttributeNode(p);var q=this.getAttributeNodeNS(f,b.ns.RDF,"type");b.ns.RDF+"Description"!=d(f)&&(q={nodeValue:d(f)}),null!=q&&(this.store.add(a.node,this.store.sym(b.ns.RDF+"type"),this.store.sym(c(q.nodeValue,a.base)),this.why),q.nodeName&&f.removeAttributeNode(q));for(var n=g.length-1;n>=0;n--)this.store.add(a.node,this.store.sym(d(g[n])),this.store.literal(g[n].nodeValue,a.lang),this.why)}for(f=a.element;a.parent;){for(var r=a;null==f;)a=a.parent,f=a.element;var s=f.childNodes[a.lastChild];if(null!=s&&e){if((s.nodeType==b.nodeType.ELEMENT||s.nodeType==b.nodeType.TEXT||s.nodeType==b.nodeType.CDATA_SECTION)&&(s.nodeType!=b.nodeType.TEXT&&s.nodeType!=b.nodeType.CDATA_SECTION||1==f.childNodes.length)){a.lastChild++,a=this.buildFrame(r,f.childNodes[a.lastChild-1]);break}a.lastChild++}else{if(a.terminateFrame(),!(a=a.parent))break;f=a.element,e=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(a,d){var e=this.frameFactory(this,a,d);if(a&&(e.base=a.base,e.lang=a.lang),null==d||d.nodeType==b.nodeType.TEXT||d.nodeType==b.nodeType.CDATA_SECTION)return e;var f=d.attributes,g=d.getAttributeNode("xml:base");null!=g&&(e.base=g.nodeValue,d.removeAttribute("xml:base"));var h=d.getAttributeNode("xml:lang");null!=h&&(e.lang=h.nodeValue,d.removeAttribute("xml:lang"));for(var i=f.length-1;i>=0;i--)if("xml"==f[i].nodeName.substr(0,3)){if("xmlns:"==f[i].name.slice(0,6)){var j=f[i].nodeValue;this.base&&(j=c(j,this.base)),this.store.setPrefixForURI(f[i].name.slice(6),j)}d.removeAttributeNode(f[i])}return e}},e=function(a){var b,c;if("undefined"!=typeof module){var d=require("jsdom");c=d.jsdom(a,d.level(2,"core"),{})}else window.DOMParser?(b=new DOMParser,c=b.parseFromString(a,"text/xml")):window.ActiveXObject&&(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a));return c},f=function(a){this.statements=[],this.namespaces={},this.add=function(b,c,d){this.statements.push({subject:b,predicate:c,object:d,graph:a})},this.sym=function(a){return{token:"uri",value:a}},this.literal=function(a,b,c){return a=a.replace(/\\/g,"\\\\"),a=a.replace(/\"/g,'\\"'),a=a.replace(/\n/g,"\\n"),a='"'+a+'"',c&&(a=a+"^^"+c),b&&(a=a+"@"+b),{literal:a}};var b=0;this.bnode=function(a){return a=a||"_:bnid"+b++,{blank:a}},this.setPrefixForURI=function(a,b){if(this.namespaces[a]||b!==b)throw"Can't redefine prefix "+a;this.namespaces[a]=b}};return{parse:b}}(),RDFXMLParser={};RDFXMLParser.parser={},RDFXMLParser.parser.parse=function(a,b,c,d){d||(d=c,c=b,b=null),b&&"string"==typeof b&&(b={token:"uri",value:b,prefix:null,suffix:null}),c&&c.baseURI&&(c.documentIRI=c.baseURI);try{var e=TabulatorRDFXMLParser.parse(a,b);d(!1,e)}catch(f){d(f)}},window.RDFE||(window.RDFE={}),RDFE.Utils={},RDFE.Utils.createTitle=function(a){if(a){a=a.replace(/_/g," ");var b=a.replace(/^\s*/,"");return b=b.replace(/^[a-z]|[^\sA-Z][A-Z]/g,function(a,b){return 0==b?a.toUpperCase():a.substr(0,1)+" "+a.substr(1).toUpperCase()})}return a},RDFE.Utils.escapeXml=function(a){return a.replace(/[<>&'"]/g,function(a){switch(a){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})},RDFE.Utils.trim=function(a,b){if(a){for(b||(b=" ");a.substring(0,1)==b;)a=a.substring(1,a.length);for(;a.substring(a.length-1,a.length)==b;)a=a.substring(0,a.length-1)}return a},RDFE.Utils.namingSchemaLabel=function(a,b,c,d){var e=c===!0?1:0,f=b[a][e];return d===!0?f.toLowerCase():f},RDFE.Utils.uriParams=function(){var a={},b=location.search;if(b.length>1&&(b=b.substring(1)),b||(b=location.hash,b=b.substring(b.indexOf("?")+1)),b)for(var c=b.split("&"),d=0;d<c.length;d++){var e=c[d];if(e){var f=e.indexOf("=");if(-1==f)a[decodeURIComponent(e)]="";else{var g=e.substring(0,f),h=e.substring(f+1);g=decodeURIComponent(g),h=decodeURIComponent(h.replace(/\+/g," "));var i=!1;(i=g.match(/(.*)\[\]$/))?(g=i[1],g in a?a[g].push(h):a[g]=[h]):a[g]=h}}}return a},RDFE.Utils.uri2name=function(a){if(a){var b=a.lastIndexOf("#");if((0>b||-1!==["this","me","i"].indexOf(a.substring(b+1,a.length)))&&(b=a.lastIndexOf("/"),b+1===a.length&&(a=a.substring(0,a.length-1),b=a.lastIndexOf("/"))),b>=0)return a.substring(b+1,a.length);if(b=a.lastIndexOf(":"),b>=0)return a.substring(b+1,a.length)}return a},RDFE.Utils.uriAbbreviate=function(a,b){if(a&&b){if(a.length<=b)return a;var c="",d="...",e=RDFE.Utils.uri2name(a);if(e.length>b-3)return e;if(a=a.substring(0,a.length-e.length),a.match(/http:\/\/.*/))c="http://",a=a.substring(c.length,a.length),a.length<=3?d=a:c+=a.substring(0,b-3-c.length-e.length);else{var f=a.indexOf(":");f>0?f===a.length-1?(c=a,d=""):(c=a.substring(0,f+1),a=a.substring(c.length,a.length),a.length<=3?d=a:c+=a.substring(0,b-3-c.length-e.length)):c+=a.substring(0,b-3-c.length-e.length)}return c+d+e}return a},RDFE.Utils.strAbbreviate=function(a,b){if(a&&b){var c="...";if(a.length<=b||a.length<=c.length+2)return a;b<c.length+2&&(b=c.length+2);var d=a.substring(0,Math.ceil((b-3)/2)),e=a.substr(-(b-d.length-c.length));return d+c+e}return a},RDFE.Utils.getLabel=function(a,b){return a&&a[b]?a[b]:b},RDFE.Utils.getUrl=function(a){var b=RDFE.Utils.splitUrl(a);return b.protocol+"//"+b.host+b.path},RDFE.Utils.getUrlBase=function(a){var b=RDFE.Utils.splitUrl(a);return b.protocol+"//"+b.host},RDFE.Utils.getProtocol=function(a){var b=RDFE.Utils.splitUrl(a);return b.protocol},RDFE.Utils.splitUrl=function(a){var b=document.createElement("a");return b.href=a,{protocol:b.protocol,host:b.host,hostname:b.hostname,path:b.pathname,port:b.port,search:b.search}},RDFE.Utils.resolveStorageLocations=function(a,b){function c(e){if(e>=a.length)return void b(d);var f=a[e].uri,g=a[e].sparqlEndpoint;if(g){var h=new RDFE.IO.Folder(g);h.ioType="sparql",h.sparqlEndpoint=g;var i=new RDFE.IO.File(f);return i.parent=h,i.ioType="sparql",i.sparqlEndpoint=g,h.children.push(i),d.push(h),void c(e+1)}RDFE.IO.openUrl(f,{checkForFiles:!0},function(a){d.push(a),c(e+1)},function(a,b){var g=new RDFE.IO.File(f);g.errorMessage=a,g.httpStatus=b,d.push(g),c(e+1)})}var d=[];c(0)},RDFE.Utils.extractDomain=function(a){var b;return b=a.indexOf("://")>-1?a.split("/")[2]:a.split("/")[0],b=b.split(":")[0]},RDFE.Validate={},RDFE.Validate.error=function(a,b){return $.notify({message:b},{type:"danger"}),setTimeout(function(){a.focus()},1),!1},RDFE.Validate.integer=function(a,b){var c=/^[0-9]+$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid integer value: "+b)},RDFE.Validate["float"]=function(a,b){var c=/^[-+]?([0-9]*\.)?[0-9]+([eE][-+]?[0-9]+)?$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid float value: "+b)},RDFE.Validate.date=function(a,b){var c=/^((?:19|20)[0-9][0-9])[- \/.](0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid date value: "+b)},RDFE.Validate.time=function(a,b){var c=/^([01]?[0-9]|[2][0-3])(:[0-5][0-9])?$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid time value: "+b)},RDFE.Validate.dateTime=function(a,b){var c=/^((?:19|20)[0-9][0-9])[- \/.](0[1-9]|1[012])[- \/.](0[1-9]|[12][0-9]|3[01])( ([01]?[0-9]|[2][0-3])(:[0-5][0-9])?)?$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid date value: "+b)},RDFE.Validate.mail=function(a,b){if(0==b.length||b.length>40)return RDFE.Validate.error(a,"E-mail address cannot be empty or longer then 40 chars");var c=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid E-mail address: "+b)},RDFE.Validate.URL=function(a,b){var c=/^(ftp|http|https):(\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return c.test(b)?!0:RDFE.Validate.error(a,"Invalid URL address: "+b)},RDFE.Validate.URI=function(a,b){var c=/^([a-z0-9+.-]+):(\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/,d=/^acct:([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return c.test(b)||d.test(b)?!0:RDFE.Validate.error(a,"Invalid URI address: "+b)},RDFE.Validate.WebID=function(a,b){if("foaf:Agent"==b)return!0;var c=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return c.test(b)?!0:(c=/^acct:([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-:])+)+\.?([a-zA-Z0-9]{0,4})+$/,c.test(b)?!0:(c=/^acct:([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,c.test(b)?!0:RDFE.Validate.error(a,"Invalid URI address: "+b)))},RDFE.Validate.check=function(a,b,c){return b=RDFE.Utils.trim(b),c=c||[],0==b.length&&-1!==c.indexOf("canEmpty")?!0:-1!==c.indexOf("integer")?RDFE.Validate.integer(a,b):-1!==c.indexOf("float")?RDFE.Validate["float"](a,b):-1!==c.indexOf("date")?RDFE.Validate.date(a,b):-1!==c.indexOf("time")?RDFE.Validate.time(a,b):-1!==c.indexOf("dateTime")?RDFE.Validate.dateTime(a,b):-1!==c.indexOf("mail")?RDFE.Validate.mail(a,b):-1!==c.indexOf("URL")?RDFE.Validate.URL(a,b):-1!==c.indexOf("URI")?RDFE.Validate.URI(a,b):-1!==c.indexOf("WebID")?RDFE.Validate.WebID(a,b):0==b.length?RDFE.Validate.error(a,"Field cannot be empty"):!0},rdfstore.Store.prototype.curiToUri=function(a){return this.rdf.resolve(a)},rdfstore.Store.prototype.parseLiteral=function(a){var b=a.lastIndexOf("@");if(-1!=b&&'"'===a[b-1]&&null!=a.substring(b,a.length).match(/^@[a-zA-Z\-]+$/g)){var c=a.substring(1,b-1),d=a.substring(b+1,a.length);return{token:"literal",value:c,lang:d}}if(b=a.lastIndexOf("^^"),-1!=b&&'"'===a[b-1]&&"<"===a[b+2]&&">"===a[a.length-1]){var c=a.substring(1,b-1),e=a.substring(b+3,a.length-1);return{token:"literal",value:c,type:e}}var c=a.substring(1,a.length-1);return{token:"literal",value:c}},rdfstore.Store.prototype.termToNode=function(a){return"literal"==a.token?this.rdf.createLiteral(a.value,a.lang,a.type):"uri"==a.token?this.rdf.createNamedNode(a.value):this.rdf.createNamedNode(a.value)},rdfstore.Store.prototype.rdf.api.RDFNode.prototype.localeCompare=function(a,b,c){return this.toString().localeCompare(a.toString(),b,c)},rdfstore.Store.prototype.loadTurtle=function(a,b,c,d,e){var f=this,g=N3.Parser(),h=[],i=[],j=function(a){switch(a[0]){case'"':if(a.indexOf("^^")>0){var b=a.split("^^");return{literal:b[0]+"^^<"+b[1]+">"}}return{literal:a};case"_":return{blank:a.replace("b","")};default:return{token:"uri",value:a,prefix:null,suffix:null}}},k=function(a){return f.rdf.createTriple(j(a.subject),j(a.predicate),j(a.object))},l=function(){try{f.insert(f.rdf.createGraph(h),b,function(a){if(a)e&&e(a);else if(i.length)try{f.insert(f.rdf.createGraph(i),b,function(a){a?e&&e(a):e&&e(null)})}catch(c){e&&e(c)}else e&&e(null)})}catch(a){e&&e(a)}};g.parse(a,function(g,j,m){if(g){if(g.message.startsWith("Undefined prefix")&&d){var n=g.message.indexOf('"'),o=g.message.substring(n+1);if(n=o.indexOf('"'),o=o.substring(0,n-1),d[o])return a="@prefix "+o+": <"+d[o]+"> ."+a,f.loadTurtle(a,b,c,d,e)}return void(e&&e(g))}if(null===j)l();else{var j=k(j);"BlankNode"===j.subject.interfaceName||"BlankNode"===j.object.interfaceName?i.push(j):h.push(j)}})},RDFModel.Graph.prototype.toNTBeatify=function(a){var b="",c={};this.forEach(function(d){b+=d.toNTBeatify(a,c)});var d="";for(var e in c)d=d+"@prefix "+e+": <"+c[e]+">. \r\n";return d+"\r\n"+b},RDFModel.NamedNode.prototype.toNTBeatify=function(a,b){var c=this.toString();for(var d in a){var e=a[d];if(e.length>0&&c.startsWith(e))return b[d]=e,c.replace(e,d+":")}return"<"+c+">"},RDFModel.BlankNode.prototype.toNTBeatify=function(){return this.toNT()},RDFModel.Literal.prototype.toNTBeatify=function(){return this.toNT()},RDFModel.Triple.prototype.toNTBeatify=function(a,b){var c=this.subject.toNTBeatify(a,b),d=this.predicate.toNTBeatify(a,b),e=this.object.toNTBeatify(a,b);return"rdf:type"===d&&(d="a"),c+" "+d+" "+e+" . \r\n"},String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})},function(a){window.RDFE||(window.RDFE={}),RDFE.IO={},a.ajaxSetup({cache:!1}),RDFE.IO.createIO=function(a,b){var c="http",d={};if("string"==typeof a?(c=a,d=b):"object"==typeof a&&(d=a,d.type&&(c=d.type)),"sparql"===c)return new RDFE.IO.SPARQL(d);if("gsp"===c)return new RDFE.IO.GSP(d);if("ldp"===c||"webdav"===c||"dav"===c)return new RDFE.IO.LDP(d);if("http"===c)return new RDFE.IO.HTTP(d);throw"Unsupport IO type: "+c};var b=function(b,c){return a.extend({},c,b)},c=function(){},d=function(a,b,d){d=d||c,a.clear(b,d)};RDFE.IO.Base=function(){var b=function(){};return b.inherit=function(a){var b=function(){};return b.prototype=this.prototype,a.prototype=new b,a.prototype.constructor=a,a["super"]=this,a},b.prototype.baseExec=function(b,c){var d=this;a(document).ajaxError(c.ajaxError),a(document).ajaxSuccess(c.ajaxSuccess),b.headers=b.headers||{},b.headers["WebID-TLS"]="true",c.username&&(b.headers.Authorization="Basic "+btoa(c.username+":"+c.password),b=a.extend({withCredentials:!0},b)),c.authFunction&&RDFE.Utils.getUrlBase(b.url)===RDFE.Utils.getUrlBase(window.location.href)&&(b.headers["X-Requested-With"]="XMLHttpRequest"),b=a.extend({crossDomain:!0,cache:!0},b),d.options.ioTimeout&&(b=a.extend({timeout:d.options.ioTimeout},b));var e=a.jStorage.get("rdfe:settings",{});return e.userID&&(b.headers["On-Behalf-Of"]=e.userID),RDFE.Utils.getProtocol(b.url)!==document.location.protocol&&"https:"===document.location.protocol?void(c&&c.error&&c.error({httpCode:"",message:"Mixed Content Error: This request has been blocked; the content must be served over HTTPS"})):void a.ajax(b).done(function(a,b,d){c&&c.success&&c.success(a,b,d)}).fail(function(a,e,f){if(c&&c.error){var g={httpCode:a.status,message:a.statusText};this.crossDomain&&"error"===g.message&&0===a.status?g.message="CORS Error: "+("sparql"!==d.type?b.url:"The document")+" failed to load - this could be related to missing CORS settings on the server.":401!==a.status&&403!==a.status||!c.authFunction?"timeout"===e?(g={httpCode:e,message:"Timeout Error: Failed to load "+("sparql"!==d.type?b.url:"document")},c.error(g,f,e,a)):c.error(g,f,e,a):c.authFunction(b.url,function(a){c.username=a.username,c.password=a.password,d.baseExec(b,c)},function(){g="Error: "+a.status+" - "+a.statusText+("sparql"!==d.type?" ("+b.url+")":""),c.error(g,f,e,a)})}})},b.prototype.acceptParameter=function(a){var b=this;return a&&a.accept?a.accept:b.options.accept},b}(),RDFE.IO.SPARQL=function(){var c=RDFE.IO.Base.inherit(function(b){var c=this;c.constructor["super"].call(this);var d={sparqlEndpoint:window.location.protocol+"//"+window.location.host+"/sparql"};c.options=a.extend({},d,b),c.options.sparqlEndpoint&&0!==c.options.sparqlEndpoint.length||(c.options.sparqlEndpoint=d.sparqlEndpoint)}),e='define get:soft "add" CONSTRUCT {?s ?p ?o} WHERE {GRAPH <{0}> {?s ?p ?o}}',f="INSERT DATA {GRAPH <{0}> { {1}}}",g="<{0}> <{1}> {2}",h="DELETE DATA {GRAPH <{0}> { <{1}> <{2}> {3} . }}",i="CLEAR GRAPH <{0}>";return c.prototype.retrieve=function(a,c,d){var f=this;c=b(c,f.options),d&&(c.ajaxError=null,c.ajaxSuccess=null),f.exec(e.format(a),c)},c.prototype.retrieveToStore=function(a,c,e,f){var g=this;f=b(f,g.options);var h=function(b,g,h){d(c,e,function(){c.load("text/turtle",b,a,function(a){a?f.error&&f.error(a):f.__success&&f.__success(b,g,h)})})};f.__success=f.success,f.success=h,g.retrieve(a,f,!0)},c.prototype.insert=function(a,c,d,e,h){var i=this;h=b(h,i.options),i.exec(f.format(a,g.format(c,d,e)),h)},c.prototype.insertFromStore=function(c,d,e,h){var i=this;h=b(h,i.options),d.graph(e,function(b,d){if(b)return void(h.error&&h.error(d));var e=function(b,e){var j=h.chunkSize||400,k=function(b){if(b>=d.length)h.success=h.__success,h.__success=null,h.success();else{for(var e="",l="\n",m=b;b+j>m&&m<d.length;m+=1)e+=l+g.format(d.toArray()[m].subject,d.toArray()[m].predicate,d.toArray()[m].object.toNT()),l=" .\n";h.success=function(){k(b+j)},i.exec(f.format(c,e),a.extend({method:"POST"},h))}};k(0)};h.__success=h.success,h.success=e,i.clear(c,h)})},c.prototype["delete"]=function(a,c,d,e,f){var g=this;f=b(f,g.options),g.exec(h.format(a,c,d,e),f)},c.prototype.clear=function(a,c,d){var e=this;c=b(c,e.options),d&&(c.ajaxError=null,c.ajaxSuccess=null),e.exec(i.format(a),c)},c.prototype.exec=function(a,b){var c=this,d={url:b.sparqlEndpoint,type:b.method||"GET",data:{query:a,format:b.format},dataType:"text"};return c.baseExec(d,b)},c}(),RDFE.IO.GSP=function(){var c=RDFE.IO.Base.inherit(function(b){console.log("GSP");var c=this;c.constructor["super"].call(this);var d={contentType:"application/octet-stream",processData:!1,gspEndpoint:window.location.protocol+"//"+window.location.host+"/sparql-graph-crud"};c.options=a.extend({},d,b),c.options.gspEndpoint&&0!==c.options.gspEndpoint.length||(c.options.gspEndpoint=d.gspEndpoint)});return c.prototype.retrieve=function(a,c,d){var e=this;c=b(c,e.options),d&&(c.ajaxError=null,c.ajaxSuccess=null),this.exec("GET",a,null,c)},c.prototype.retrieveToStore=function(a,c,e,f){var g=this;f=b(f,g.options);var h=function(b,g,h){d(c,e,function(){c.loadTurtle(b,e,a,null,function(a){a?f.error&&f.error(a):f.__success&&f.__success(b,g,h)})})};f.__success=f.success,f.success=h,this.retrieve(a,f,!0)},c.prototype.insert=function(a,c,d){d=b(d,this.options),this.exec("PUT",a,c,d)},c.prototype.insertFromStore=function(a,c,d,e){var f=this;e=b(e,f.options),c.graph(d,function(b,c){if(b)return void(e.error&&e.error(b));var d=function(b,d){e.success=e.__success,f.insert(a,c.toNT(),e)};e.__success=e.success,e.success=d,f.clear(a,e,!0)})},c.prototype.update=function(a,c,d){var e=this;d=b(d,e.options),e.exec("POST",a,c,d)},c.prototype["delete"]=function(a,c,d){var e=this;c=b(c,e.options),d&&(c.ajaxError=null,c.ajaxSuccess=null),e.exec("DELETE",a,null,c)},c.prototype.clear=c.prototype["delete"],c.prototype.exec=function(a,b,c,d){var e=this,f=d.gspEndpoint+"?graph="+encodeURIComponent(b),g={url:f,type:a,contentType:d.contentType,processData:d.processData,data:c,dataType:"text"};return e.baseExec(g,d)},c}(),RDFE.IO.LDP=function(){var c=RDFE.IO.Base.inherit(function(b){var c=this;c.constructor["super"].call(this);var d={dataType:"text"};c.options=a.extend({},d,b)}),e="INSERT DATA {GRAPH <{0}> { <{1}> <{2}> {3} . }}";return c.prototype.retrieve=function(a,c,d){c=b(c,this.options),d&&(c.ajaxError=null,c.ajaxSuccess=null);var e={};"webdav"!=this.type&&(e={Accept:"text/turtle, */*;q=0.1"}),this.exec("GET",a,e,null,c)},c.prototype.retrieveToStore=function(a,c,e,f){f=b(f,this.options);var g=function(a,b,g){d(c,e,function(){c.load("text/turtle",a,e,function(c){c?f.error&&f.error(c):f.__success&&f.__success(a,b,g)})})};f.__success=f.success,f.success=g,this.retrieve(a,f,!0)},c.prototype.insert=function(a,c,d){d=b(d,this.options);var e,f;"webdav"!==this.type?(f="PUT",e={"Content-Type":"text/turtle"}):f="PUT",this.exec(f,a,e,c,d)},c.prototype.insertFromStore=function(a,c,d,e){var f=this;e=b(e,f.options),c.graph(d,function(b,d){if(b)return void(e.error&&e.error(b));var g=d.toNTBeatify(c.rdf.prefixes);d.toNT();f.insert(a,g,e)})},c.prototype.update=function(a,c,d,f,g,h){var i=this;h=b(h,i.options);var j=e.format(c,d,f,g),k={"Content-Type":"application/sparql-update"};i.exec("PATCH",a,k,j,h)},c.prototype["delete"]=function(a,c){var d=this;c=b(c,d.options),d.exec("DELETE",a,null,null,c)},c.prototype.clear=c.prototype["delete"],c.prototype.exec=function(a,b,c,d,e){var f=this,g={url:b,type:a,headers:c,contentType:e.contentType?e.contentType:"text/turtle",processData:!1,data:d,dataType:e.dataType};return f.baseExec(g,e)},c}(),RDFE.IO.HTTP=function(){var b=RDFE.IO.Base.inherit(function(b){var c=this;c.constructor["super"].call(this);var d={dataType:"text",httpTemplate:"{0}",httpProxyTemplate:document.location.protocol+"//"+document.location.host+"/proxy?url={0}&output-format=turtle&force=rdf"};c.options=a.extend({},d,b),c.options.httpTemplate&&0!==c.options.httpTemplate.length||(c.options.httpTemplate=d.httpTemplate),c.options.httpProxyTemplate&&0!==c.options.httpProxyTemplate.length||(c.options.httpProxyTemplate=d.httpProxyTemplate)});return b.prototype.retrieve=function(a,b){var c=this,d=b.proxy?c.options.httpProxyTemplate.format(encodeURIComponent(a)):c.options.httpTemplate.format(a),e=c.acceptParameter();e||(e="text/turtle; q=1, text/n3; q=0.9, application/ld+json; q=0.7, application/rdf+xml; q=0.6");var f={url:d,type:"GET",dataType:"text",beforeSend:function(a){a.setRequestHeader("Accept",e)}};return c.baseExec(f,b)},b.prototype.retrieveToStore=function(a,b,c,d){var e=this;d.__success=d.success,d.success=function(a,d){return function(e,f,g){var h=(g.getResponseHeader("content-type")||"").split(";")[0],i=function(a){a?(console.error("URI load error =>",c,a),d&&d.error&&d.error(a)):d&&d.__success&&d.__success(e,f,g)};b.load(h,e,a,i)}}(c,d);var f=d.proxy?e.options.httpProxyTemplate.format(encodeURIComponent(a)):e.options.httpTemplate.format(a),g=e.acceptParameter();g||(g="text/turtle; q=1, text/n3; q=0.9, application/ld+json; q=0.7, application/rdf+xml; q=0.6");var h={url:f,type:"GET",dataType:"text",beforeSend:function(a){a.setRequestHeader("Accept",g)}};return e.baseExec(h,d)},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.IO||(RDFE.IO={}),RDFE.IO.Resource=function(){var a=function(a){this.url=a||"",a&&(this.path=decodeURIComponent(RDFE.Utils.splitUrl(a).path),this.host=RDFE.Utils.splitUrl(a).host,this.name=this.path.match(/([^\/]+)\/?$/),this.name&&this.name.length>1?this.name=this.name[1]:this.name=this.url),this.options={}};return a.inherit=function(a){var b=function(){};return b.prototype=this.prototype,a.prototype=new b,a.prototype.constructor=a,a["super"]=this,a.inherit=this.inherit,a},a.prototype.isFolder=function(){return"folder"===this.type},a.prototype.isFile=function(){return"file"===this.type},a.prototype.getOption=function(a){return this.options[a]?this.options[a]:this.parent?this.parent.getOption(a):void 0},a.prototype.standardAjaxHeaders=function(a){var b=this.getOption("username");return a=a||{},b&&(a.Authorization="Basic "+btoa(b+":"+this.getOption("password"))),a},a}(),RDFE.IO.File=function(){var b=RDFE.IO.Resource.inherit(function(b,c){var d=this;d.constructor["super"].call(this,b),d.type="file",d.dirty=!0;var e={};d.options=a.extend({},e,c)});return b}(),RDFE.IO.Folder=function(){var b=RDFE.IO.Resource.inherit(function(b,c){var d=this;RDFE.IO.Resource.call(this,b),d.type="folder",d.dirty=!0,d.url.length>0&&"/"!=d.url.substring(d.url.length-1)&&(d.url+="/"),d.rootUrl=d.url,d.children=[];var e={};d.options=a.extend({},e,c)});b.prototype.update=function(b,c,d){var e=this,f=b,g=c,h=d;"function"==typeof f&&(h=g,g=f,f=!1),f||this.dirty?this.listDir(function(){a(e.children).each(function(){this.rootUrl=e.rootUrl,this.parent=e}),e.dirty=!1,g&&g(e)},function(a,b){401!==b&&403!==b||!e.options.authFunction?h&&h(e,a,b):e.options.authFunction(e.url,function(a){e.options.username=a.username,e.options.password=a.password,e.update(f,g,h)},function(){h&&h(e,a,b)})}):g(e)},b.prototype.listDir=function(a){a()};var c={sort:"name",foldersFirst:!0,sortOrder:"asc"};return b.prototype.getChildren=function(b){for(var d=a.extend({},c,b),e=[],f=[],g=0;g<this.children.length;g++)"folder"!==d.type&&"file"===this.children[g].type||"file"!==d.type&&!d.foldersFirst?e.push(this.children[g]):"file"!==d.type&&f.push(this.children[g]);var h="desc"===d.sortOrder.toLowerCase(),i=function(a,b){return h?a[d.sort]>b[d.sort]:a[d.sort]<b[d.sort]};return d.sort&&(e.sort(i),f.sort(i)),a.merge(f,e)},b}(),RDFE.IO.WebDavFolder=function(){function b(b,c){for(var d=RDFE.Utils.getUrlBase(b),e=[],f=!1,g=function(a,b){for(var c=[],d=a.getElementsByTagName("*"),e=0;e<d.length;e++)(d[e].localName===b||d[e].baseName===b)&&c.push(d[e]);return c},h=function(b,c){var d=g(b,c);return d.length?a(d[0]).text():null},i=g(c,"response"),j=0;j<i.length;j++){var k=null,l=i[j],m=g(l,"href");if(m.length){var n=d+a(m[0]).text();if(n!==b){var o=g(l,"propstat");if(!o.length)continue;var p=g(o[0],"prop");if(!p.length)continue;if(g(p[0],"collection").length)k=new RDFE.IO.WebDavFolder(n);else{k=new RDFE.IO.File(n);var q=h(p[0],"getcontentlength");q&&(k.size=parseInt(a(q[0]).text())),k.dirty=!1,k.ioType="dav"}var r=h(p[0],"creationdate");r&&(k.creationDate=new Date(r)),r=h(p[0],"getlastmodified"),r&&(k.modificationDate=new Date(r)),r=h(p[0],"virtpermissions"),r&&(k.permissions=r),r=h(p[0],"virtowneruid"),r&&(k.uid=r),r=h(p[0],"virtownergid"),r&&(k.gid=r),r=h(p[0],"getcontenttype"),r&&(k.contentType=r),e.push(k)}else f=!0}}return 0!==e.length||f?e:null}var c=RDFE.IO.Folder.inherit(function(b,c){var d=this;d.constructor["super"].call(this,b);var e={};d.ioType="webdav",d.options=a.extend({},e,c)});return c.prototype.listDir=function(c,d){var e=this,f=this.standardAjaxHeaders(),g='<?xml version="1.0" encoding="utf-8" ?><propfind xmlns="DAV:">  <prop>    <creationdate />    <getlastmodified />    <href />    <resourcetype />    <getcontentlength />    <getcontenttype />    <virtpermissions xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />    <virtowneruid xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />    <virtownergid xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />  </prop></propfind>',h=function(a){e.children=b(e.url,a),e.children?c():d('Failed to parse WebDAV result for "'+e.url+'".',200)};f.Depth=1,a.ajax({url:this.url,method:"PROPFIND",contentType:"text/xml",data:g,dataType:"xml",headers:f}).done(h).fail(function(a){d(RDFE.IO.ajaxFailMessage(a,'Failed to list WebDAV folder for "{0}"',e.url),a.status)})},c}(),RDFE.IO.LDPFolder=function(){function b(a,b,c,d){a.registerDefaultNamespace("rdfs","http://www.w3.org/2000/01/rdf-schema#"),a.registerDefaultNamespace("posix","http://www.w3.org/ns/posix/stat#"),a.registerDefaultNamespace("ldp","http://www.w3.org/ns/ldp#");var e=[],f=function(a){for(var b=0;b<e.length;b++)if(e[b].url==a)return!0;return!1};a.execute(" select distinct ?s ?mtime ?contains   from <urn:default>    where {            ?s a ?t .            FILTER(str(?t) = 'http://www.w3.org/ns/posix/stat#Directory' || str(?t) = 'http://www.w3.org/ns/ldp#Container' || str(?t) = 'http://www.w3.org/ns/ldp#BasicContainer') .            optional { ?s posix:mtime ?mtime }            optional { ?s ldp:contains ?contains }          }  order by asc(?s)",function(g,h){if(g)return void d("Failed to query LDP the container at "+b+".");for(var i=0;i<h.length;i++)if(!h[i].contains){var j=h[i].s.value;if(j.startsWith("http")||(j=b+j),!f(j)&&j!=b){var k=new RDFE.IO.LDPFolder(j);h[i].mtime&&(k.modificationDate=new Date(1e3*h[i].mtime.value)),e.push(k)}}a.execute(" select distinct ?s ?size ?mtime    from <urn:default>    where {            ?s a ?t .           FILTER (str(?t) = 'http://www.w3.org/ns/posix/stat#File' || str(?t) = 'http://www.w3.org/2000/01/rdf-schema#Resource' || str(?t) = 'http://www.w3.org/ns/ldp#Resource') .            FILTER (str(?t) != 'http://www.w3.org/ns/posix/stat#Directory' && str(?t) != 'http://www.w3.org/ns/ldp#Container' && str(?t) != 'http://www.w3.org/ns/ldp#BasicContainer') .            optional { ?s posix:size ?size . } .            optional { ?s posix:mtime ?mtime . }          }  order by asc(?s)",function(a,g){if(a)return void d("Failed to query LDP the container at "+b+".");for(var h=0;h<g.length;h++){var i=g[h].s.value;if(i.startsWith("http")||(i=b+i),!f(i)){var j=new RDFE.IO.File(i);g[h].mtime&&(j.modificationDate=new Date(1e3*g[h].mtime.value)),g[h].size&&(j.size=g[h].size.value),j.dirty=!1,j.ioType="ldp",e.push(j)}}c(e)})})}var c=RDFE.IO.Folder.inherit(function(b,c){var d=this;d.constructor["super"].call(this,b),d.ioType="ldp";var e={};d.options=a.extend({},e,c)});return c.prototype.listDir=function(c,d){var e=this;a.ajax({url:e.url,headers:e.standardAjaxHeaders({Accept:"text/turtle"})}).done(function(a,f,g){var h=!1,i=g.getResponseHeader("Link");if(i)for(var j=i.split(","),k=0;k<j.length;k++)if(j[k].replace(/ /g,"").toLowerCase().indexOf('rel="type"')>=0&&j[k].indexOf("http://www.w3.org/ns/ldp#BasicContainer")>=0){h=!0;break}h?g.getResponseHeader("Content-Type").indexOf("turtle")<0?d("The LDP container at "+e.url+" does not return Turtle content."):rdfstore.create(function(f,g){g.load("text/turtle",a,"urn:default",function(){b(g,e.url,function(a){
e.children=a,c&&c()},d)})}):d("Only LDP Basic containers are supported at the moment.")}).fail(function(a){d&&d(RDFE.IO.ajaxFailMessage(a,'Failed to fetch turtle content from "{0}"',e.url),a.status)})},c}(),RDFE.IO.openUrl=function(b,c,d,e){var f=d,g=e,h=c;"function"==typeof c&&(g=f,f=h,h=void 0);var i=new RDFE.IO.LDPFolder(b,h);i.update(function(){f(i)},function(c,d,e){if(401===e||403===e)g(d,e);else{var j=new RDFE.IO.WebDavFolder(b,i.options);j.update(function(){f(j)},function(c,d,e){h&&h.checkForFiles?a.ajax({url:b,headers:c.standardAjaxHeaders()}).done(function(a,d,e){var g=new RDFE.IO.File(b,c.options);g.content=a,g.contentType=e.getResponseHeader("Content-Type"),g.size=parseInt(e.getResponseHeader("Content-Length")),g.dirty=!1,g.ioType="http",f(g)}).fail(function(a){g&&g(RDFE.IO.ajaxFailMessage(a,'Failed to get "{0}"',b),a.status)}):g&&g(d,e)})}})},RDFE.IO.ajaxFailMessage=function(a,b,c){return"error"===a.statusText&&RDFE.Utils.extractDomain(c)!==window.location.hostname?b.format(c)+" - this could be related to missing CORS settings on the server.":b.format(c)+". "+a.status+" - "+(a.responseText?a.responseText:a.statusText)}}(jQuery),window.RDFE||(window.RDFE={}),RDFE.Config=function(a,b,c){var d=this;this.options=RDFE.Config.defaults,a&&$.ajax({url:a,type:"GET",dataType:"json",success:function(a){return function(b){var c=RDFE.Utils.uriParams();d.options=$.extend(d.options,b),d.options.ontology=$.extend(RDFE.Config.defaults.ontology,b.ontology),("EAV"===c.uiMode||"SPO"===c.uiMode)&&(d.options.namingSchema=c.uiMode),d.options.labelProps&&0!=d.options.labelProps.length||(d.options.labelProps=RDFE.Config.defaults.labelProps),a&&a(d)}}(b),error:function(a,b,d){console.error("config load =>",d),c&&c()}})},RDFE.Config.defaults={ontology:{proxy:!1,nonTTLProxy:!0,fresnelLenses:!0,fresnelFormats:!0,fresnelGroups:!0,forceLoad:!1,preloadOnly:!1},bookmarks:[],actions:["new","open","save","saveAs","bookmarks","entities","triples"],labelProps:["http://www.w3.org/2004/02/skos/core#prefLabel","http://www.w3.org/2000/01/rdf-schema#"],sparqlEndpoint:window.location.protocol+"//"+window.location.host+"/sparql",gspEndpoint:window.location.protocol+"//"+window.location.host+"/sparql-graph-crud",prefixes:{},entityUriTmpl:"{DOC-URI}#{NAME}",autoInverseOfHandling:!1,entityTypesFiler:null,defaultView:"statements",namingSchema:"EAV",EAV:{spo:["Statement","Statements"],s:["Entity","Entities"],p:["Attribute","Attributes"],o:["Value","Values"]},SPO:{spo:["Triple","Triples"],s:["Subject","Subjects"],p:["Predicate","Predicates"],o:["Object","Objects"]},useEntityEditor:!1,maxLabelLength:0,pageSettings:{pageNo:1,pageSize:10}},window.RDFE||(window.RDFE={}),RDFE.RdfNode=function(a,b,c,d){this.type=a,this.value=b,this.datatype=c,this.language=d},RDFE.RdfNode.prototype.toStoreNode=function(a){return"uri"==this.type?a.rdf.createNamedNode(this.value):a.rdf.createLiteral(this.value,this.language,this.datatype)},RDFE.RdfNode.prototype.toString=function(){return this.value},RDFE.RdfNode.fromStoreNode=function(a){if("string"==typeof a)return new RDFE.RdfNode("uri",a);if("number"==typeof a)return new RDFE.RdfNode("literal",a);if(a instanceof RDFE.RdfNode)return a;if(a.token)return new RDFE.RdfNode(a.token,a.value,a.type,a.lang);if(a.interfaceName){var b;if("NamedNode"===a.interfaceName)b="uri";else{if("Literal"!==a.interfaceName)throw"Blank nodes cannot be converted into RDFE.RdfNode values.";b="literal"}return new RDFE.RdfNode(b,a.nominalValue,a.datatype,a.language)}if(a.uri)return new RDFE.RdfNode("uri",a.uri);throw"Unsupported node type for RDFE.RdfNode conversion."},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0==this.indexOf(a)}),window.RDFE||(window.RDFE={}),RDFE.prefixes={},RDFE.prefixes.adms="http://www.w3.org/ns/adms#",RDFE.prefixes.annotation="http://www.w3.org/2000/10/annotation-ns#",RDFE.prefixes.atom="http://atomowl.org/ontologies/atomrdf#",RDFE.prefixes.bibo="http://purl.org/ontology/bibo/",RDFE.prefixes.book="http://purl.org/NET/book/vocab#",RDFE.prefixes.cc="http://web.resource.org/cc/",RDFE.prefixes.cert="http://www.w3.org/ns/auth/cert#",RDFE.prefixes.dataview="http://www.w3.org/2003/g/data-view#",RDFE.prefixes.dbpedia="http://dbpedia.org/resource/",RDFE.prefixes.dc="http://purl.org/dc/elements/1.1/",RDFE.prefixes.dcam="http://purl.org/dc/dcam/",RDFE.prefixes.dcterms="http://purl.org/dc/terms/",RDFE.prefixes.dctype="http://purl.org/dc/dcmitype/",RDFE.prefixes.doap="http://usefulinc.com/ns/doap#",RDFE.prefixes.foaf="http://xmlns.com/foaf/0.1/",RDFE.prefixes.fresnel="http://www.w3.org/2004/09/fresnel#",RDFE.prefixes.geo="http://www.w3.org/2003/01/geo/wgs84_pos#",RDFE.prefixes.gr="http://purl.org/goodrelations/v1#",RDFE.prefixes.gso="http://www.w3.org/ns/adms#",RDFE.prefixes.ibis="http://purl.org/ibis#",RDFE.prefixes.ical="http://www.w3.org/2002/12/cal/icaltzd#",RDFE.prefixes.like="http://ontologi.es/like#",RDFE.prefixes.mo="http://purl.org/ontology/mo/",RDFE.prefixes.owl="http://www.w3.org/2002/07/owl#",RDFE.prefixes.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFE.prefixes.rdfs="http://www.w3.org/2000/01/rdf-schema#",RDFE.prefixes.rev="http://purl.org/stuff/rev#",RDFE.prefixes.rss="http://purl.org/rss/1.0/",RDFE.prefixes.schema="http://schema.org/",RDFE.prefixes.scot="http://scot-project.org/scot/ns",RDFE.prefixes.sioc="http://rdfs.org/sioc/ns#",RDFE.prefixes.sioct="http://rdfs.org/sioc/types#",RDFE.prefixes.skos="http://www.w3.org/2004/02/skos/core#",RDFE.prefixes.vcard="http://www.w3.org/2006/vcard/ns#",RDFE.prefixes["void"]="http://rdfs.org/ns/void#",RDFE.prefixes.vs="http://www.w3.org/2003/06/sw-vocab-status/ns#",RDFE.prefixes.wot="http://xmlns.com/wot/0.1/",RDFE.prefixes.wdrs="http://www.w3.org/2007/05/powder-s#",RDFE.prefixes.ws="http://www.w3.org/ns/pim/space#",RDFE.prefixes.xhtml="http://www.w3.org/1999/xhtml",RDFE.prefixes.xsd="http://www.w3.org/2001/XMLSchema#",RDFE.coalesce=function(){for(var a=0;a<arguments.length;a++)if("undefined"!=typeof arguments[a]&&null!==arguments[a])return arguments[a]},RDFE.uriPrefix=function(a){var b=Math.max(a.lastIndexOf(":"),a.lastIndexOf("/"),a.lastIndexOf("#"));return-1!=b&&b==a.lastIndexOf(":")?a.substring(0,b):null},RDFE.uriLabel=function(a){var b=Math.max(a.lastIndexOf(":"),a.lastIndexOf("/"),a.lastIndexOf("#"));return-1==b?a:b!=a.length-1?a.substring(b+1):null},RDFE.isUriPrefix=function(a){return-1==Math.max(a.lastIndexOf(":"),a.lastIndexOf("/"),a.lastIndexOf("#"))},RDFE.uriOntology=function(a){if(!a)return null;var b=Math.max(a.lastIndexOf(":"),a.lastIndexOf("/"),a.lastIndexOf("#"));return-1!=b?a.substring(0,b+1):null},RDFE.isBlankNode=function(a){return _.isString(a)?a.match(/^\_\:*/)?!0:!1:_.isObject(a)&&a.URI?RDFE.isBlankNode(a.URI):!1},RDFE.ontologyByPrefix=function(a,b){var c=location.protocol+"//prefix.cc/{0}.file.json".format(a);return $.ajax({url:c,type:"GET",async:b?!0:!1}).done(function(c){RDFE.prefixes[a]=c[a],b&&b(c[a])}),RDFE.prefixes[a]},RDFE.prefixByOntology=function(a,b){var c=location.protocol+"//lov.okfn.org/dataset/lov/api/v2/vocabulary/autocomplete?q="+encodeURIComponent(RDFE.Utils.trim(a,"#"));$.ajax({url:c,type:"GET",dataType:"json",async:!1}).done(function(c){for(var d=c.results,e=0;e<d.length;e++)for(var f=0;f<d[e].uri.length;e++)if(RDFE.Utils.trim(d[e].uri[f],"#")===RDFE.Utils.trim(a,"#"))return void(b&&b(d[e].prefix[f]))})},RDFE.schema2ontology_range=function(a){var b=a;return"http://schema.org/Boolean"===a?b="http://www.w3.org/2001/XMLSchema#boolean":"http://schema.org/Date"===a?b="http://www.w3.org/2001/XMLSchema#boolean":"http://schema.org/DateTime"===a?b="http://www.w3.org/2001/XMLSchema#datetime":"http://schema.org/Time"===a?b="http://www.w3.org/2001/XMLSchema#datetime":"http://schema.org/Number"===a?b="http://www.w3.org/2001/XMLSchema#decimal":"http://schema.org/Float"===a?b="http://www.w3.org/2001/XMLSchema#float":"http://schema.org/Integer"===a?b="http://www.w3.org/2001/XMLSchema#integer":"http://schema.org/Text"===a?b="http://www.w3.org/2001/XMLSchema#string":"http://schema.org/URL"===a&&(b="http://www.w3.org/2001/XMLSchema#string"),b},RDFE.OntologyManager=function(a){this.config=a||{},this.options=$.extend(RDFE.Config.defaults.ontology,this.config.ontology),this.reset(),this.prefixes=$.extend({},RDFE.prefixes,this.config.prefixes)},RDFE.OntologyManager.prototype.init=function(a){var b=this;this.reset();var a=$.extend({},a),c=b.options.preloadOntologies||[],d=function(a,e){if(a<c.length){var f=c[a],g=function(c,e){return function(){$(b).trigger(e,[b,f]),d(a+1,c)}},h={success:g(e,"loadingFinished"),error:g(e,"loadingFailed")};$(b).trigger("loading",[b,f]),b.parseOntologyFile(f,h)}else e.success&&e.success()};d(0,a)},RDFE.OntologyManager.prototype.reset=function(a){this.ontologies={},this.ontologyClasses={},this.ontologyProperties={},this.individuals={},this.fresnelLenses={}},RDFE.OntologyManager.prototype.prefixByOntology=function(a){for(var b in this.prefixes)if(this.prefixes[b]===a)return b;return null},RDFE.OntologyManager.prototype.uriDenormalize=function(a){var b=RDFE.uriPrefix(a);return b&&(this.prefixes[b]||RDFE.ontologyByPrefix(b),this.prefixes[b])?this.prefixes[b]+a.substring(b.length+1):a},RDFE.OntologyManager.prototype.uriNormalize=function(a,b){var c=RDFE.uriOntology(a);if(c)for(var d in this.prefixes)if(this.prefixes[d]==c)return d+":"+a.substring(c.length);return b},RDFE.OntologyManager.prototype.ontologiesAsArray=function(){return _.values(this.ontologies)},RDFE.OntologyManager.prototype.ontologyByURI=function(a,b){var c=this.ontologies[a];return c||b!==!0||(this.ontologies[a]=c=new RDFE.Ontology(this,a)),c},RDFE.OntologyManager.prototype.ontologyByPrefix=function(a){return this.ontologies[this.prefixes[a]]},RDFE.OntologyManager.prototype.ontologyRemove=function(a){var b=this.ontologyByURI(a);if(b){delete this.ontologies[a];for(var c=b.classesAsArray(),d=0;d<c.length;d++)this.ontologyClassRemove(c[d].URI);var e=b.allProperties();for(d=0;d<e.length;d++)this.ontologyPropertyRemove(e[d].URI);$(this).trigger("changed",[this])}},RDFE.OntologyManager.prototype.ontologyClassRemove=function(a){delete this.ontologyClasses[a]},RDFE.OntologyManager.prototype.ontologyPropertyRemove=function(a){delete this.ontologyProperties[a]},RDFE.OntologyManager.prototype.ontologyClassByURI=function(a,b){var c=this.ontologyClasses[a];return c||b!==!0||(this.ontologyClasses[a]=c=new RDFE.OntologyClass(this,a),c.ontology=this.ontologyByURI(RDFE.uriOntology(a),!0),c.ontology.classes[a]=c),c},RDFE.OntologyManager.prototype.ontologyPropertyByURI=function(a,b){var c=this.ontologyProperties[a];return c||b!==!0||(this.ontologyProperties[a]=c=new RDFE.OntologyProperty(this,a),c.ontology=this.ontologyByURI(RDFE.uriOntology(a),!0),c.ontology.properties[a]=c),c},RDFE.OntologyManager.prototype.individualByURI=function(a){return this.individuals[a]},RDFE.OntologyManager.prototype.load=function(a,b){var c=this,d=b.ioType?b.ioType:"http",e={};c.options.nonTTLProxyUrl&&(e.httpProxyTemplate=c.options.nonTTLProxyUrl[document.location.protocol]);var f=RDFE.IO.createIO(d,e);f.type=d,b.__success=b.success,b.success=function(d,e,g){if(c.options.nonTTLProxy&&c.options.proxy!==c.options.nonTTLProxy){var h=(g.getResponseHeader("content-type")||"").split(";")[0];if(h.length>0&&h.indexOf("turtle")<0)return void f.retrieve(a,$.extend({proxy:c.options.nonTTLProxy},b))}b.__success&&b.__success(d,e,g)},b.__error=b.error,b.error=function(d,e,g,h){return c.options.nonTTLProxy&&c.options.proxy!==c.options.nonTTLProxy?(b.error=b.__error,void f.retrieve(a,$.extend({proxy:c.options.nonTTLProxy},b))):void(b.__error&&b.__error(d,e,g,h))};var g=RDFE.Utils.getProtocol(a)!==document.location.protocol&&"https:"===document.location.protocol?!0:c.options.proxy;f.retrieve(a,$.extend({proxy:g},b))},RDFE.OntologyManager.prototype.parseOntologyFile=function(a,b){function c(a){return N3.Util.isBlank(a)?null:h.ontologyClassByURI(a,!0)}function d(a){return N3.Util.isBlank(a)?null:h.ontologyPropertyByURI(a,!0)}function e(a){return h.individuals[a]=h.individuals[a]||new RDFE.OntologyIndividual(h,a)}function f(a){return n[a]=n[a]||new RDFE.FresnelLens(h,a)}function g(a){for(var b=[],c=a;c;){var d=m[c];d?(d.first&&b.push(d.first),c=d.rest):c=null}return b}var h=this,i={},j={},k={},l={},m={},n={},o=function(a,b){var c;(c=h.ontologyProperties[a])?c.label=c.label||b:(c=h.ontologyClasses[a])?c.label=c.label||b:(c=h.ontologies[a])?c.label=c.label||b:(c=h.individuals[a])?c.label=c.label||b:(c=n[a])?c.label=c.label||b:i[a]=b},p=function(a,b){var c;(c=h.ontologyProperties[a])?c.comment=c.comment||b:(c=h.ontologyClasses[a])?c.comment=c.comment||b:(c=h.ontologies[a])?c.comment=c.comment||b:(c=h.individuals[a])?c.comment=c.comment||b:(c=n[a])?c.comment=c.comment||b:j[a]=b},q=function(a){var b=a.subject,g=a.predicate,h=a.object;if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===g){switch(h){case"http://www.w3.org/2002/07/owl#ObjectProperty":case"http://www.w3.org/2002/07/owl#DatatypeProperty":case"http://www.w3.org/1999/02/22-rdf-syntax-ns#Property":d(b);break;case"http://www.w3.org/2000/01/rdf-schema#Class":case"http://www.w3.org/2002/07/owl#Class":c(b);break;case"http://www.w3.org/2002/07/owl#Restriction":k[b]=k[b]||{};break;case"http://www.openlinksw.com/ontology/oplowl#AggregateRestriction":k[b]=k[b]||{},k[b].isAggregate=!0;break;case"http://www.openlinksw.com/ontology/oplowl#UniqueIdRestriction":k[b]=k[b]||{},k[b].isUniqueId=!0;break;case"http://www.w3.org/2004/09/fresnel#Lens":f(b)}var i=e(b),j=c(h);i.type=j,j.individuals[b]=i}else if("http://www.w3.org/2000/01/rdf-schema#label"===g)o(b,N3.Util.getLiteralValue(h));else if("http://www.w3.org/2000/01/rdf-schema#comment"===g)p(b,N3.Util.getLiteralValue(h));else if("http://www.w3.org/2000/01/rdf-schema#subClassOf"===g){var n=c(b);if(N3.Util.isBlank(h)){var q=l[b]=l[b]||[];q.push(h)}else r=c(h),n.subClassOf.push(r),r.superClassOf.push(n)}else if("http://www.w3.org/2000/01/rdf-schema#subPropertyOf"===g){var r=d(h),n=d(b);n.subPropertyOf.push(r),r.superPropertyOf.push(n)}else if("http://www.w3.org/2000/01/rdf-schema#domain"===g||"http://schema.org/domainIncludes"===g){var s=d(b);N3.Util.isBlank(h)?s.domain.push(h):s.domain.push(c(h))}else if("http://www.w3.org/2000/01/rdf-schema#range"===g){var s=d(b);s.range.push(h)}else if("http://schema.org/rangeIncludes"===g){var s=d(b),q=RDFE.schema2ontology_range(h);s.range.push(q)}else if("http://www.w3.org/2002/07/owl#onProperty"===g){var q=k[b]=k[b]||{};(q.onProperty=q.onProperty||[]).push(h)}else if("http://www.w3.org/2002/07/owl#cardinality"===g||"http://www.w3.org/2002/07/owl#maxCardinality"===g||"http://www.w3.org/2002/07/owl#minCardinality"===g||"http://www.openlinksw.com/ontology/oplowl#hasCustomLabel"===g||"http://www.openlinksw.com/ontology/oplowl#hasCustomComment"===g){var q=k[b]=k[b]||{};q[RDFE.uriLabel(g)]=N3.Util.getLiteralValue(h)}else if("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"===g||"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"===g){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"!==h){var s=m[b]=m[b]||{};s[RDFE.uriLabel(g)]=h}}else if("http://www.w3.org/2002/07/owl#unionOf"===g)m[b]={rest:h};else if("http://www.w3.org/2004/09/fresnel#showProperties"===g||"http://www.w3.org/2004/09/fresnel#hideProperties"===g||"http://www.w3.org/2004/09/fresnel#classLensDomain"===g){var t=f(b);t[RDFE.uriLabel(g)]=h}},r=function(){for(var a in h.ontologyClasses){var b=h.ontologyClasses[a];b.label=b.label||i[a],b.comment=b.comment||j[a],delete i[a],delete j[a];var d=l[a];if(d){for(var e=0;e<d.length;e++){for(var f=k[d[e]],m=_.clone(f),o=0;o<f.onProperty.length;o++)b.restrictions[f.onProperty[o]]=m;delete m.onProperty}delete l[a]}}for(var a in h.ontologyProperties){var p=h.ontologyProperties[a];p.label=p.label||i[a],p.comment=p.comment||j[a],delete i[a],delete j[a];var q=_.clone(p.range);p.range=[];for(var e=0;e<q.length;e++)N3.Util.isBlank(q[e])?p.range=_.union(p.range,g(q[e])):p.range.push(q[e]);var r=_.clone(p.domain);p.domain=[];for(var e=0;e<r.length;e++)!r[e].URI&&N3.Util.isBlank(r[e])?p.domain=_.union(p.domain,g(r[e])):p.domain.push(r[e])}for(a in n){var p=n[a];p.label=p.label||i[a],p.comment=p.comment||j[a],delete i[a],delete j[a],p.showProperties=g(p.showProperties),p.hideProperties=g(p.hideProperties),h.fresnelLenses[a]=p,p.classLensDomain&&(c(p.classLensDomain).fresnelLens=p)}for(a in h.ontologies){var s=h.ontologies[a];s.label=s.label||i[a]||i[a.substring(0,a.length-1)],s.comment=s.comment||j[a]||j[a.substring(0,a.length-1)],delete i[a],delete j[a]}for(a in h.individuals){var p=h.individuals[a];p.label=p.label||i[a],p.comment=p.comment||j[a],delete i[a],delete j[a]}$(h).trigger("changed",[h])},s=function(a,c,d){var e=(d.getResponseHeader("content-type")||"").split(";")[0];if(e.length>0&&e.indexOf("turtle")<0){var f="Only Turtle files can be parsed in the ontology manager.";console.error(f),b.error&&b.error({message:f})}else{var g=N3.Parser();g.parse(a,function(a,c){a?b.error&&b.error():c?q(c):(r(),b.success&&b.success())})}},t={ioType:b.ioType,success:s,error:b.error};a.startsWith(RDFE.Utils.getUrlBase(a))||(a=RDFE.Utils.getUrl(a)),h.load(a,t)},RDFE.OntologyManager.prototype.findFresnelLens=function(a){var b=this.ontologyClasses[a];return b?b.getFresnelLens():null},RDFE.OntologyManager.prototype.ontologyDetermine=function(a){var b,c=this,d=RDFE.uriPrefix(a);return d?(b=c.ontologyByPrefix(d),b=b?b.URI:RDFE.ontologyByPrefix(d)):b=RDFE.uriOntology(a),b},RDFE.OntologyManager.prototype.allOntologies=function(){return _.values(this.ontologies)},RDFE.OntologyManager.prototype.allClasses=function(){return _.values(this.ontologyClasses)},RDFE.OntologyManager.prototype.allProperties=function(a){var b=[];for(var c in this.ontologyProperties){var d=this.ontologyProperties[c];(!a||d.domain.indexOf(a))&&b.push(d)}return b},RDFE.OntologyManager.prototype.typesToLabel=function(a,b){var c=this;return _.uniq(_.map(a,function(a){var d,e=c.ontologyClassByURI(a);return d=e?e.label:RDFE.Utils.uri2name(a),b?'<a href="'+a+'">'+d+"</a>":d})).join(", ")},RDFE.Ontology=function(a,b,c){var d=this;if(d.options=$.extend({},c),d.URI=b,d.classes={},d.properties={},d.manager=a,d.manager.ontologies[b]=d,d.prefix=a.prefixByOntology(b),!d.prefix){var e=function(a){a&&(d.prefix=a,d.manager.prefixes[a]=b,$(d.manager).trigger("changed",[d.manager]))};RDFE.prefixByOntology(b,e)}},RDFE.Ontology.prototype.classesAsArray=function(){return _.values(this.classes)},RDFE.Ontology.prototype.classesLength=function(){return this.classesAsArray().length},RDFE.Ontology.prototype.ontologyClassByURI=function(a){return this.classes[a]},RDFE.Ontology.prototype.propertyByURI=function(a){return this.properties[a]},RDFE.Ontology.prototype.propertiesLength=function(){return _.values(this.properties).length},RDFE.Ontology.prototype.allProperties=function(a){var b=[];for(var c in this.properties){var d=this.properties[c];(!a||d.domain.indexOf(a))&&b.push(d)}return b},RDFE.OntologyClass=function(a,b){this.URI=b,this.curi=a.uriNormalize(b),this.name=RDFE.Utils.uri2name(b),this.subClassOf=[],this.superClassOf=[],this.disjointWith=[],this.properties={},this.individuals={},this.restrictions={},this.manager=a},RDFE.OntologyClass.prototype.propertiesAsArray=function(){var a=this,b=[];for(var c in a.properties)b.push(a.properties[c]);return b},RDFE.OntologyClass.prototype.maxCardinalityForProperty=function(a,b){var c=this.restrictions[a],d=null;if(c&&(d=c.cardinality||c.maxCardinality))return d;var e=this.manager.ontologyPropertyByURI(a);if(e)for(var f=e.getSuperProperties(),g=0;g<f.length;g++){var h=this.restrictions[f[g].URI];if(h&&(d=h.cardinality||h.maxCardinality))return d}for(var g=0;g<this.subClassOf.length;g++){var i=this.subClassOf[g];if($.inArray(i.URI,b)<0){if(b=b||[],b.push(i.URI),d=i.maxCardinalityForProperty(a,b))return d}else console.log("CAUTION: Found sub-class loop in ",b)}return null},RDFE.OntologyClass.prototype.isAggregateProperty=function(a,b){var c=this.restrictions[a];if(c&&c.isAggregate)return!0;for(var d=0;d<this.subClassOf.length;d++){var e=this.subClassOf[d];if($.inArray(e.URI,b)<0){if(b=b||[],b.push(e.URI),e.isAggregateProperty(a,b))return!0}else console.log("CAUTION: Found sub-class loop in ",b)}return!1},RDFE.OntologyClass.prototype.getSubClasses=function(a,b,c){if(b=b||[],b=_.union(b,this.superClassOf),a!==!1){c=c||[],c.push(this.URI);for(var d=0;d<this.superClassOf.length;d++){var e=this.superClassOf[d];$.inArray(e.URI,c)<0&&e.getSubClasses(a,b,c)}}return b},RDFE.OntologyClass.prototype.getSuperClasses=function(a,b,c){if(b=b||[],b=_.union(b,this.subClassOf),a!==!1){c=c||[],c.push(this.URI);for(var d=0;d<this.subClassOf.length;d++){var e=this.subClassOf[d];$.inArray(e.URI,c)<0&&e.getSuperClasses(a,b,c)}}return b},RDFE.OntologyClass.prototype.getUniqueRestrictions=function(){var a=[];if(this.restrictions)for(var b in this.restrictions){var c=this.restrictions[b];c.isUniqueId===!0&&a.push(this.manager.ontologyPropertyByURI(b))}return a},RDFE.OntologyClass.prototype.getIndividuals=function(a){var b=this.individuals;if(a)for(var c=this.getSubClasses(!0),d=0;d<c.length;d++)b=_.union(b,c[d].individuals);return b},RDFE.OntologyClass.prototype.getFresnelLens=function(){var a=this.fresnelLens;if(!a)for(var b=this.getSuperClasses(!0),c=0;c<b.length;c++)if(a=b[c].fresnelLens)return a;return a},RDFE.OntologyProperty=function(a,b){this.URI=b,this.curi=a.uriNormalize(b),this.name=RDFE.Utils.uri2name(b),this.subPropertyOf=[],this.superPropertyOf=[],this.domain=[],this.range=[],this.manager=a,this.manager.ontologyProperties[b]=this},RDFE.OntologyProperty.prototype.hasDomain=function(a){var b=this;if(b.domain)for(var c=0;c<b.domain.length;c++)if(a==b.domain[c])return!0;return!1},RDFE.OntologyProperty.prototype.getRange=function(a){var b=this,c=b.range;if(!_.isEmpty(c))return c;for(var d=0;d<b.subPropertyOf.length;d++){var e=b.subPropertyOf[d];if($.inArray(e.URI,a)<0){if(a=a||[],a.push(e.URI),c=e.getRange(a),!_.isEmpty(c))return c}else console.log("CAUTION: Found sub-property loop in ",a)}return void 0},RDFE.OntologyProperty.prototype.getSuperProperties=function(a,b,c){if(b=b||[],b=_.union(b,this.subPropertyOf),a!==!1){c=c||[],c.push(this.URI);for(var d=0;d<this.subPropertyOf.length;d++){var e=this.subPropertyOf[d];$.inArray(e.URI,c)<0&&e.getSuperProperties(a,b,c)}}return b},RDFE.OntologyIndividual=function(a,b,c){this.URI=b,this.curi=a.uriNormalize(b),this.name=RDFE.Utils.uri2name(b),this.manager=a,this.manager.individuals[b]=this},RDFE.FresnelLens=function(a,b){this.URI=b,this.manager=a,this.showProperties=[],this.hideProperties=[]},window.RDFE||(window.RDFE={}),RDFE.Document=function(a,b){var c=this;c.ontologyManager=a.ontologyManager,c.config=a.config,c.documentTree=a.documentTree,c.graph="urn:graph:default",c.dirty=!1,rdfstore.create(function(a,d){a||(c.store=d,c.store.registerDefaultNamespace("skos","http://www.w3.org/2004/02/skos/core#"),b&&b(c))})},RDFE.Document.prototype.setChanged=function(a){var b=this;b.dirty=a,b.dirty&&$(b).trigger("changed",b),$(b).trigger("docChanged",b)},RDFE.Document.prototype.load=function(a,b,c,d){var e=this,f=function(d,f,g){e.url=a,e.io=b,e.setChanged(!1),e.srcParams={length:d.length,md5:$.md5(d)},c&&c()};e.store.clear(function(){b.retrieveToStore(a,e.store,e.graph,{success:f,error:d})})},RDFE.Document.prototype.verifyData=function(a){var b=this;if(!b.config.options.validateEmptyNodes)return a&&a(),!0;var c="select * from <"+b.graph+"> where {{ <> ?p ?o } union { ?s2 ?p2 <> }}";b.store.execute(c,function(b,c){return b?(a&&a(b),!1):c.length>0?(a&&a(new Error("The document is not valid. It contains empty URI nodes.")),!1):(a&&a(),!0)})},RDFE.Document.prototype.save=function(a,b,c,d){var e=this,f=a,g=b,h=c,i=d;"string"!=typeof a&&(f=e.url,g=a,h=b,i=c),"function"!=typeof g&&g||(i=h,h=g,g=e.io),f?(g.insertFromStore||(g=RDFE.IO.createIO("webdav",g.options),g.type="webdav"),e.verifyData(function(a){if(a)i&&i(a);else{var b=function(){e.url=f,e.io=g,e.setChanged(!1),e.documentTree.addRecentDoc(e.url,e.io.type),g.retrieve(f,{success:function(a,b,c){e.srcParams={length:a.length,md5:$.md5(a)}},error:function(){e.srcParams=null}}),h&&h()};g.insertFromStore(f,e.store,e.graph,{success:b,error:i})}})):i&&i("No document loaded")},RDFE.Document.prototype["new"]=function(a,b){var c=this;c.url=null,c.io=null,c.srcParams=null,c.signature=null,c.store.clear(c.graph,function(d){d?d&&b&&b(d):(c.setChanged(!1),a&&a())})},RDFE.Document.prototype["import"]=function(a,b,c,d){var e=this;if("function"==typeof b&&(d=c,c=b,b=null),"application/ld+json"===b)e.importJSON(a,c,d);else if("application/rdf+xml"===b)e.importRDF(a,c,d);else if("text/turtle"===b)e.importTurtle(a,c,d);else{var f=function(b){var f=function(f){var g=function(a){var c=new Error;c.name="SyntaxError",c.message="<b>TTL</b>: "+b.message+" or <b>JSON-LP</b>: "+f.message+" or <b>RDF</b>: "+a.message,d(c)};e.importRDF(a,c,g)};e.importJSON(a,c,f)};e.importTurtle(a,c,f)}},RDFE.Document.prototype.importTurtle=function(a,b,c){var d=this;d.store.load("text/turtle",a,d.graph,function(e,f){if(e){if(e.message.startsWith("Undefined prefix")){var g=e.message.indexOf('"'),h=e.message.substring(g+1);g=h.indexOf('"'),h=h.substring(0,g-1);var i=d.ontologyManager.prefixes[h];if(i)return a="@prefix {0}: <{1}> .".format(h,i)+a,d.importTurtle(a,b,c)}c&&c(e)}else b&&b(f)})},RDFE.Document.prototype.importJSON=function(a,b,c){var d=this;d.store.load("application/ld+json",a,d.graph,function(a,d){!a&&b?b(d):a&&c&&c(a)})},RDFE.Document.prototype.importRDF=function(a,b,c){var d=this;try{$.parseXML(a),d.store.load("application/rdf+xml",a,d.graph,function(a,d){!a&&b?b(d):a&&c&&c(a)})}catch(e){c({message:"RDF syntax error!"})}},RDFE.Document.prototype.deleteBySubject=function(a,b,c){var d=this;if(d.config.options.autoInverseOfHandling){var e="construct { <{1}> ?p ?o } from <{0}> where { <{1}> ?p ?o. } ".format(d.graph,a);d.store.execute(e,function(a,e){a?c&&c(a):d.deleteTriples(e.triples,b,c)})}else{var e="with <{0}> delete { <{1}> ?p ?o } where { <{1}> ?p ?o }".format(d.graph,a);d.store.execute(e,function(a,d){!a&&b?b():a&&c&&c(a)})}},RDFE.Document.prototype.deleteByPredicate=function(a,b,c){var d=this;if(d.config.options.autoInverseOfHandling){var e="construct { ?s <{1}> ?o} from <{0}> where { ?s <{1}> ?o . } ".format(d.graph,a);d.store.execute(e,function(a,e){a?c&&c(a):d.deleteTriples(e.triples,b,c)})}else{var e="with <{0}> delete { ?s <{1}> ?o} where { ?s <{1}> ?o . }".format(d.graph,a);d.store.execute(e,function(a,d){!a&&b?b():a&&c&&c(a)})}},RDFE.Document.prototype.deleteByObjectIRI=function(a,b,c){var d=this;if(d.config.options.autoInverseOfHandling){var e="construct { ?s ?p <{1}> } from <{0}> where { ?s ?p <{1}> . } ".format(d.graph,a);d.store.execute(e,function(a,e){a?c&&c(a):d.deleteTriples(e.triples,b,c)})}else{var e="with <{0}> delete { ?s ?p <{1}> } where { ?s ?p <{1}> . }".format(d.graph,a);d.store.execute(e,function(a,d){!a&&b?b():a&&c&&c(a)})}},RDFE.Document.prototype.deleteByObject=function(a,b,c){var d,e=this;d="Literal"===a.interfaceName?'construct { ?s ?p ?o } from <{0}> where { ?s ?p ?o. FILTER (str(?o) = "{1}"). } '.format(e.graph,"http://www.w3.org/2001/XMLSchema#dateTime"==a.datatype?new Date(a.nominalValue).toString():a.nominalValue):"construct { ?s ?p <{1}> } from <{0}> where { ?s ?p <{1}> . } ".format(e.graph,a.toString()),e.store.execute(d,function(a,d){a?c&&c(a):e.deleteTriples(d.triples,b,c)})},RDFE.Document.prototype.deleteEntity=function(a,b,c){var d=this;a?d.deleteBySubject(a,function(){d.deleteByObjectIRI(a,b,c)},c):c&&c("Need Entity URI for deletion.")},RDFE.Document.prototype.deleteEntities=function(a,b,c){function d(d){d<a.length?e.deleteEntity(a[d],function(){delUri(d+1)},c):b()}var e=this;d(0)},RDFE.Document.prototype.deletePredicate=function(a,b,c){var d=this;a?d.deleteByPredicate(a,b,c):c&&c("Need Predicate URI for deletion.")},RDFE.Document.prototype.deleteObject=function(a,b,c){var d=this;a?d.deleteByObject(a,b,c):c&&c("Need object for deletion.")},RDFE.Document.prototype.checkTriple=function(a,b,c){var d=this;d.store.node(a.subject.nominalValue,d.graph,function(d,e){if(d)c&&c(!1);else if(b){var f=e.match(null,a.predicate,a.object);b(f.triples.length>0)}})},RDFE.Document.prototype.addTriples=function(a,b,c,d){var e=this,f=_.isArray(a)?a:[a];return _.isEmpty(f)?void(b&&b()):void e.store.insert(e.store.rdf.createGraph(f),e.graph,function(a,g){if(a)c&&c();else if(e.config.options.autoInverseOfHandling!==!0||d)e.setChanged(!0),b&&b();else{var h=e.inverseTriples(f);_.isEmpty(h)?(e.setChanged(!0),b&&b()):e.addTriples(h,b,c,!0)}})},RDFE.Document.prototype.addTriple=RDFE.Document.prototype.addTriples,RDFE.Document.prototype.deleteTriples=function(a,b,c,d){var e=this,f=_.isArray(a)?a:[a];return _.isEmpty(f)?void(b&&b()):void e.store["delete"](e.store.rdf.createGraph(f),e.graph,function(a,g){if(a)c&&c(a);else if(e.setChanged(!0),e.config.options.autoInverseOfHandling!==!0||d)e.setChanged(!0),b&&b();else{var h=e.inverseTriples(f);_.isEmpty(h)?(e.setChanged(!0),b&&b()):e.deleteTriples(h,b,c,!0)}})},RDFE.Document.prototype.deleteTriple=RDFE.Document.prototype.deleteTriples,RDFE.Document.prototype.updateTriple=function(a,b,c,d){var e=this;e.deleteTriple(a,function(){e.addTriple(b,function(){e.setChanged(!0),c&&c()},function(){d&&d("Adding new triple failed")})},function(){d&&d("Deleting triple failed")})},RDFE.Document.prototype.inverseTriple=function(a){var b=this,c=null,d=a.subject,e=a.object;if("NamedNode"==d.interfaceName&&"NamedNode"==e.interfaceName){var f=a.predicate,g=b.ontologyManager.ontologyPropertyByURI(f.nominalValue);if(g){var h=g.inverseOf;h&&(c=b.store.rdf.createTriple(b.store.rdf.createNamedNode(e.nominalValue),b.store.rdf.createNamedNode(h.URI),b.store.rdf.createNamedNode(d.nominalValue)))}}return c},RDFE.Document.prototype.inverseTriples=function(a){for(var b=this,c=[],d=0,e=a.length;e>d;d++){var f=b.inverseTriple(a[d]);f&&c.push(f)}return c},RDFE.Document.prototype.getEntityLabel=function(a,b,c){var d=this,e=b,f=c;"function"==typeof e&&(f=e,e=void 0);var g=function(b,c){c>=b.length?f(RDFE.Utils.uri2name(a),!1):d.store.execute("select ?l from <"+d.graph+"> where { <"+a+"> <"+b[c]+"> ?l . }",function(a,d){!a&&d.length>0&&d[0].l.value.length>0?f(d[0].l.value,!0):g(b,c+1)})};g(e||d.config.options.labelProps,0)},RDFE.Document.prototype.getEntity=function(a,b){var c=this;c.store.node(a,c.graph,function(d,e){var f={uri:a,label:RDFE.Utils.uri2name(a),types:[],properties:{}};if(!d){for(var g=e.triples,h=0;h<g.length;h++){var i=g[h].predicate.nominalValue;(f.properties[i]=f.properties[i]||[]).push(RDFE.RdfNode.fromStoreNode(g[h].object)),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"==i&&f.types.push(g[h].object.nominalValue)}for(var h=0;h<c.config.options.labelProps.length;h++)if(f.properties[c.config.options.labelProps[h]]){f.label=f.properties[c.config.options.labelProps[h]][0].toString();break}}b(f)})},RDFE.Document.prototype.listProperties=function(a){var b=this;b.store.execute("select distinct ?p from <"+b.graph+"> where { ?s ?p ?o }",function(b,c){var d=[];if(!b)for(var e=0;e<c.length;e++)d.push(c[e].p.value);a(d)})},RDFE.Document.prototype.listEntities=function(a,b,c){var d=this;"string"==typeof a&&(a=[a]);var e="select ?s ?p ?o from <{0}> where { ?s ?p ?o . ".format(d.graph);if(a.length>0){e+="?s a ?t . filter(";for(var f=0;f<a.length;f++)f>0&&(e+=" || "),e+='(str(?t) = "{0}")'.format(a[f]);e+=") . "}e+="}",d.store.execute(e,function(a,e){var f={};if(a)c&&c(a);else{for(var g=0;g<e.length;g++){var h=e[g].s.value,i=e[g].p.value;f[h]||(f[h]={uri:h,types:[]});var j=f[h];"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"==i?j.types.push(e[g].o.value):_.indexOf(d.config.options.labelProps,i)>=0&&(j[i]=e[g].o.value)}f=_.values(f);for(var g=0;g<f.length;g++)f[g].label=d.getEntityLabel(f[g])}b(f)})},RDFE.Document.prototype.itemsByRange=function(a){var b,c=this;if(a){for(var d=0;d<a.length;d++){var e=c.ontologyManager.ontologyClassByURI(a[d]);if(e){b=b||[];for(var f=_.values(e.getIndividuals()),g=0;g<f.length;g++){
var h=RDFE.RdfNode.fromStoreNode(f[g].URI);h.label=f[g].curi||f[g].URI,b.push(h)}c.listEntities(a[d],function(a){for(var c=0;c<a.length;c++){var d=RDFE.RdfNode.fromStoreNode(a[c].uri);d.label=a[c].label||a[c].uri,b.push(d)}})}}return b}},RDFE.Document.prototype.buildEntityUri=function(a){var b=this.config.options.entityUriTmpl;b&&0!=b.length||(b="urn:entities:{NAME}"),b=b.replace("{DOC-URI}",this.url||"urn:entities:");var c=a||"entity",d=b.indexOf("{NAME}");d>=0?b=b.replace("{NAME}",encodeURIComponent(c)):("#"!=b[b.length-1]&&"/"!=b[b.length-1]&&":"!=b[b.length-1]&&(b+="#"),b+=encodeURIComponent(c));var e=b,f=this,g=function(a){f.store.node(e,f.graph,function(c,d){console.log(c,d),!c&&d.length&&(e=b+a,g(a+1))})};return g(1),e},RDFE.Document.prototype.addEntity=function(a,b,c,d,e){var f=this;a&&0!=a.length||(a=f.buildEntityUri(b));var g=[f.store.rdf.createTriple(f.store.rdf.createNamedNode(a),f.store.rdf.createNamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),f.store.rdf.createNamedNode(c))];if(b&&b.length>0){var h=f.ontologyManager.uriDenormalize(f.config.options.labelProps[0]);g.push(f.store.rdf.createTriple(f.store.rdf.createNamedNode(a),f.store.rdf.createNamedNode(h),f.store.rdf.createLiteral(b)))}for(var i=f.ontologyManager.ontologyClassByURI(c),j=i?i.getUniqueRestrictions():[],k=0;k<j.length;k++){var l=j[k],m=f.getUniqueValue(a,l);m&&g.push(f.store.rdf.createTriple(f.store.rdf.createNamedNode(a),f.store.rdf.createNamedNode(l.URI),f.store.rdf.createLiteral(m.toString(),null,l.range)))}f.addTriples(g,function(){d&&d({uri:a,label:b})},function(){e&&e()})},RDFE.Document.prototype.listSubjects=function(a,b){var c=this;c.store.graph(c.graph,function(d,e){if(d)b&&b(d);else{for(var f={},g=e.toArray(),h=0;h<g.length;h+=1){var i=g[h].subject.toString();f[i]||(f[i]=c.newSubject(i)),f[i].items.push(g[h])}f=_.values(f),a(f)}})},RDFE.Document.prototype.getSubject=function(a,b,c){var d=this;d.store.graph(d.graph,function(e,f){if(e)c&&c(e);else{for(var g=d.newSubject(a),h=f.toArray(),i=0;i<h.length;i+=1)h[i].subject.toString()===a&&g.items.push(h[i]);b&&b(g)}})},RDFE.Document.prototype.newSubject=function(a){return{uri:a,items:[]}},RDFE.Document.prototype.listPredicates=function(a,b){var c=this;c.store.graph(c.graph,function(d,e){if(d)b&&b(d);else{for(var f={},g=e.toArray(),h=0;h<g.length;h+=1){var i=g[h].predicate.toString();f[i]||(f[i]=c.newPredicate(i)),f[i].items.push(g[h])}f=_.values(f),a(f)}})},RDFE.Document.prototype.getPredicate=function(a,b,c){var d=this;d.store.graph(d.graph,function(e,f){if(e)c&&c(e);else{for(var g=d.newPredicate(a),h=f.toArray(),i=0;i<h.length;i+=1)h[i].predicate.toString()===a&&g.items.push(h[i]);b&&b(g)}})},RDFE.Document.prototype.newPredicate=function(a){return{uri:a,items:[]}},RDFE.Document.prototype.listObjects=function(a,b){var c=this;c.store.graph(c.graph,function(d,e){if(d)b&&b(d);else{for(var f={},g=e.toArray(),h=0;h<g.length;h+=1){var i=g[h].object,j=c.formatObjectID(i);f[j]||(f[j]=c.newObject(i)),f[j].items.push(g[h])}f=_.values(f),a(f)}})},RDFE.Document.prototype.getObject=function(a,b,c){var d=this;d.store.graph(d.graph,function(e,f){if(e)c&&c(e);else{for(var g=d.newObject(a),h=f.toArray(),i=0;i<h.length;i+=1)d.formatObjectID(h[i].object)===g.id&&g.items.push(h[i]);b&&b(g)}})},RDFE.Document.prototype.newObject=function(a){var b=this;return"string"==typeof a&&(a=new RDFE.RdfNode("literal",a)),{id:b.formatObjectID(a),label:b.formatObjectLabel(a),type:b.formatObjectType(a),object:a,items:[]}},RDFE.Document.prototype.formatObjectID=function(a){if("Literal"==a.interfaceName){var b="http://www.w3.org/2001/XMLSchema#dateTime"==a.datatype?new Date(a.nominalValue).toString():a.nominalValue,c=a.datatype?a.datatype:"literal";return c+" - "+b}return a.toString()},RDFE.Document.prototype.formatObjectLabel=function(a){return"Literal"===a.interfaceName?"http://www.w3.org/2001/XMLSchema#dateTime"==a.datatype?new Date(a.nominalValue).toString():a.nominalValue:a.toString()},RDFE.Document.prototype.formatObjectType=function(a){return"Literal"===a.interfaceName?a.datatype?a.datatype:"http://www.w3.org/2000/01/rdf-schema#Literal":"IRI"},RDFE.Document.prototype.getEntityLabel=function(a){for(var b=this,c=0;c<b.config.options.labelProps.length;c++)if(a[b.config.options.labelProps[c]])return a[b.config.options.labelProps[c]];return RDFE.Utils.uri2name(a.uri)},RDFE.Document.prototype.getUniqueValue=function(){var a=["http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#string"],b=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#positiveInteger"];return function(c,d){var e,f=this,g=d.range;if(-1!==a.indexOf(g))e=c;else if(-1!==b.indexOf(g)){e=1;var h="select (MAX(?v) as ?mv) from <{0}> where {?s <{1}> ?v}".format(f.graph,d.URI);f.store.execute(h,function(a,b){a?console.log("Failed to determine unique value for ",c," and ",d.URI,b):0!==b.length&&(e=parseInt(RDFE.coalesce(b[0].mv.value,0)),isNaN(e)&&(e=0),e++)})}return e}}(),RDFE.Document.prototype.checkForSignature=function(a){var b=this;b.store.registerDefaultNamespace("rdfs","http://www.w3.org/2000/01/rdf-schema#"),b.store.registerDefaultNamespace("cert","http://www.w3.org/ns/auth/cert#"),b.store.registerDefaultNamespace("oplcert","http://www.openlinksw.com/schemas/cert#");var c="SELECT ?signatureDocURI        FROM <{0}>        WHERE {                <{1}> oplcert:hasSignature ?signatureDocURI .              }";c=c.format(b.graph,b.url),b.store.execute(c,function(c,d){!c&&d.length?b.signature=d[0].signatureDocURI.value:b.signature=null,a&&a(b.signature)})},function(a,b){"function"==typeof define&&define.amd?define("sifter",b):"object"==typeof exports?module.exports=b():a.Sifter=b()}(this,function(){var a=function(a,b){this.items=a,this.settings=b||{diacritics:!0}};a.prototype.tokenize=function(a){if(a=e(String(a||"").toLowerCase()),!a||!a.length)return[];var b,c,d,g,i=[],j=a.split(/ +/);for(b=0,c=j.length;c>b;b++){if(d=f(j[b]),this.settings.diacritics)for(g in h)h.hasOwnProperty(g)&&(d=d.replace(new RegExp(g,"g"),h[g]));i.push({string:j[b],regex:new RegExp(d,"i")})}return i},a.prototype.iterator=function(a,b){var c;c=g(a)?Array.prototype.forEach||function(a){for(var b=0,c=this.length;c>b;b++)a(this[b],b,this)}:function(a){for(var b in this)this.hasOwnProperty(b)&&a(this[b],b,this)},c.apply(a,[b])},a.prototype.getScoreFunction=function(a,b){var c,e,f,g,h;c=this,a=c.prepareSearch(a,b),f=a.tokens,e=a.options.fields,g=f.length,h=a.options.nesting;var i=function(a,b){var c,d;return a?(a=String(a||""),d=a.search(b.regex),-1===d?0:(c=b.string.length/a.length,0===d&&(c+=.5),c)):0},j=function(){var a=e.length;return a?1===a?function(a,b){return i(d(b,e[0],h),a)}:function(b,c){for(var f=0,g=0;a>f;f++)g+=i(d(c,e[f],h),b);return g/a}:function(){return 0}}();return g?1===g?function(a){return j(f[0],a)}:"and"===a.options.conjunction?function(a){for(var b,c=0,d=0;g>c;c++){if(b=j(f[c],a),0>=b)return 0;d+=b}return d/g}:function(a){for(var b=0,c=0;g>b;b++)c+=j(f[b],a);return c/g}:function(){return 0}},a.prototype.getSortFunction=function(a,c){var e,f,g,h,i,j,k,l,m,n,o;if(g=this,a=g.prepareSearch(a,c),o=!a.query&&c.sort_empty||c.sort,m=function(a,b){return"$score"===a?b.score:d(g.items[b.id],a,c.nesting)},i=[],o)for(e=0,f=o.length;f>e;e++)(a.query||"$score"!==o[e].field)&&i.push(o[e]);if(a.query){for(n=!0,e=0,f=i.length;f>e;e++)if("$score"===i[e].field){n=!1;break}n&&i.unshift({field:"$score",direction:"desc"})}else for(e=0,f=i.length;f>e;e++)if("$score"===i[e].field){i.splice(e,1);break}for(l=[],e=0,f=i.length;f>e;e++)l.push("desc"===i[e].direction?-1:1);return j=i.length,j?1===j?(h=i[0].field,k=l[0],function(a,c){return k*b(m(h,a),m(h,c))}):function(a,c){var d,e,f;for(d=0;j>d;d++)if(f=i[d].field,e=l[d]*b(m(f,a),m(f,c)))return e;return 0}:null},a.prototype.prepareSearch=function(a,b){if("object"==typeof a)return a;b=c({},b);var d=b.fields,e=b.sort,f=b.sort_empty;return d&&!g(d)&&(b.fields=[d]),e&&!g(e)&&(b.sort=[e]),f&&!g(f)&&(b.sort_empty=[f]),{options:b,query:String(a||"").toLowerCase(),tokens:this.tokenize(a),total:0,items:[]}},a.prototype.search=function(a,b){var c,d,e,f,g=this;return d=this.prepareSearch(a,b),b=d.options,a=d.query,f=b.score||g.getScoreFunction(d),a.length?g.iterator(g.items,function(a,e){c=f(a),(b.filter===!1||c>0)&&d.items.push({score:c,id:e})}):g.iterator(g.items,function(a,b){d.items.push({score:1,id:b})}),e=g.getSortFunction(d,b),e&&d.items.sort(e),d.total=d.items.length,"number"==typeof b.limit&&(d.items=d.items.slice(0,b.limit)),d};var b=function(a,b){return"number"==typeof a&&"number"==typeof b?a>b?1:b>a?-1:0:(a=i(String(a||"")),b=i(String(b||"")),a>b?1:b>a?-1:0)},c=function(a,b){var c,d,e,f;for(c=1,d=arguments.length;d>c;c++)if(f=arguments[c])for(e in f)f.hasOwnProperty(e)&&(a[e]=f[e]);return a},d=function(a,b,c){if(a&&b){if(!c)return a[b];for(var d=b.split(".");d.length&&(a=a[d.shift()]););return a}},e=function(a){return(a+"").replace(/^\s+|\s+$|/g,"")},f=function(a){return(a+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},g=Array.isArray||"undefined"!=typeof $&&$.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},h={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},i=function(){var a,b,c,d,e="",f={};for(c in h)if(h.hasOwnProperty(c))for(d=h[c].substring(2,h[c].length-1),e+=d,a=0,b=d.length;b>a;a++)f[d.charAt(a)]=c;var g=new RegExp("["+e+"]","g");return function(a){return a.replace(g,function(a){return f[a]}).toLowerCase()}}();return a}),function(a,b){"function"==typeof define&&define.amd?define("microplugin",b):"object"==typeof exports?module.exports=b():a.MicroPlugin=b()}(this,function(){var a={};a.mixin=function(a){a.plugins={},a.prototype.initializePlugins=function(a){var c,d,e,f=this,g=[];if(f.plugins={names:[],settings:{},requested:{},loaded:{}},b.isArray(a))for(c=0,d=a.length;d>c;c++)"string"==typeof a[c]?g.push(a[c]):(f.plugins.settings[a[c].name]=a[c].options,g.push(a[c].name));else if(a)for(e in a)a.hasOwnProperty(e)&&(f.plugins.settings[e]=a[e],g.push(e));for(;g.length;)f.require(g.shift())},a.prototype.loadPlugin=function(b){var c=this,d=c.plugins,e=a.plugins[b];if(!a.plugins.hasOwnProperty(b))throw new Error('Unable to find "'+b+'" plugin');d.requested[b]=!0,d.loaded[b]=e.fn.apply(c,[c.plugins.settings[b]||{}]),d.names.push(b)},a.prototype.require=function(a){var b=this,c=b.plugins;if(!b.plugins.loaded.hasOwnProperty(a)){if(c.requested[a])throw new Error('Plugin has circular dependency ("'+a+'")');b.loadPlugin(a)}return c.loaded[a]},a.define=function(b,c){a.plugins[b]={name:b,fn:c}}};var b={isArray:Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}};return a}),function(a,b){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],b):"object"==typeof exports?module.exports=b(require("jquery"),require("sifter"),require("microplugin")):a.Selectize=b(a.jQuery,a.Sifter,a.MicroPlugin)}(this,function(a,b,c){"use strict";var d=function(a,b){if("string"!=typeof b||b.length){var c="string"==typeof b?new RegExp(b,"i"):b,d=function(a){var b=0;if(3===a.nodeType){var e=a.data.search(c);if(e>=0&&a.data.length>0){var f=a.data.match(c),g=document.createElement("span");g.className="highlight";var h=a.splitText(e),i=(h.splitText(f[0].length),h.cloneNode(!0));g.appendChild(i),h.parentNode.replaceChild(g,h),b=1}}else if(1===a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(var j=0;j<a.childNodes.length;++j)j+=d(a.childNodes[j]);return b};return a.each(function(){d(this)})}};a.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var a=this.parentNode;a.replaceChild(this.firstChild,this),a.normalize()}).end()};var e=function(){};e.prototype={on:function(a,b){this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)},off:function(a,b){var c=arguments.length;return 0===c?delete this._events:1===c?delete this._events[a]:(this._events=this._events||{},void(a in this._events!=!1&&this._events[a].splice(this._events[a].indexOf(b),1)))},trigger:function(a){if(this._events=this._events||{},a in this._events!=!1)for(var b=0;b<this._events[a].length;b++)this._events[a][b].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(a){for(var b=["on","off","trigger"],c=0;c<b.length;c++)a.prototype[b[c]]=e.prototype[b[c]]};var f=/Mac/.test(navigator.userAgent),g=65,h=13,i=27,j=37,k=38,l=80,m=39,n=40,o=78,p=8,q=46,r=16,s=f?91:17,t=f?18:17,u=9,v=1,w=2,x=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,y=function(a){return"undefined"!=typeof a},z=function(a){return"undefined"==typeof a||null===a?null:"boolean"==typeof a?a?"1":"0":a+""},A=function(a){return(a+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},B={};B.before=function(a,b,c){var d=a[b];a[b]=function(){return c.apply(a,arguments),d.apply(a,arguments)}},B.after=function(a,b,c){var d=a[b];a[b]=function(){var b=d.apply(a,arguments);return c.apply(a,arguments),b}};var C=function(a){var b=!1;return function(){b||(b=!0,a.apply(this,arguments))}},D=function(a,b){var c;return function(){var d=this,e=arguments;window.clearTimeout(c),c=window.setTimeout(function(){a.apply(d,e)},b)}},E=function(a,b,c){var d,e=a.trigger,f={};a.trigger=function(){var c=arguments[0];return-1===b.indexOf(c)?e.apply(a,arguments):void(f[c]=arguments)},c.apply(a,[]),a.trigger=e;for(d in f)f.hasOwnProperty(d)&&e.apply(a,f[d])},F=function(a,b,c,d){a.on(b,c,function(b){for(var c=b.target;c&&c.parentNode!==a[0];)c=c.parentNode;return b.currentTarget=c,d.apply(this,[b])})},G=function(a){var b={};if("selectionStart"in a)b.start=a.selectionStart,b.length=a.selectionEnd-b.start;else if(document.selection){a.focus();var c=document.selection.createRange(),d=document.selection.createRange().text.length;c.moveStart("character",-a.value.length),b.start=c.text.length-d,b.length=d}return b},H=function(a,b,c){var d,e,f={};if(c)for(d=0,e=c.length;e>d;d++)f[c[d]]=a.css(c[d]);else f=a.css();b.css(f)},I=function(b,c){if(!b)return 0;var d=a("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(b).appendTo("body");H(c,d,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var e=d.width();return d.remove(),e},J=function(a){var b=null,c=function(c,d){var e,f,g,h,i,j,k,l;c=c||window.event||{},d=d||{},c.metaKey||c.altKey||(d.force||a.data("grow")!==!1)&&(e=a.val(),c.type&&"keydown"===c.type.toLowerCase()&&(f=c.keyCode,g=f>=97&&122>=f||f>=65&&90>=f||f>=48&&57>=f||32===f,f===q||f===p?(l=G(a[0]),l.length?e=e.substring(0,l.start)+e.substring(l.start+l.length):f===p&&l.start?e=e.substring(0,l.start-1)+e.substring(l.start+1):f===q&&"undefined"!=typeof l.start&&(e=e.substring(0,l.start)+e.substring(l.start+1))):g&&(j=c.shiftKey,k=String.fromCharCode(c.keyCode),k=j?k.toUpperCase():k.toLowerCase(),e+=k)),h=a.attr("placeholder"),!e&&h&&(e=h),i=I(e,a)+4,i!==b&&(b=i,a.width(i),a.triggerHandler("resize")))};a.on("keydown keyup update blur",c),c()},K=function(a){var b=document.createElement("div");return b.appendChild(a.cloneNode(!0)),b.innerHTML},L=function(a,b){b||(b={});var c="Selectize";console.error(c+": "+a),b.explanation&&(console.group&&console.group(),console.error(b.explanation),console.group&&console.groupEnd())},M=function(c,d){var e,f,g,h,i=this;h=c[0],h.selectize=i;var j=window.getComputedStyle&&window.getComputedStyle(h,null);if(g=j?j.getPropertyValue("direction"):h.currentStyle&&h.currentStyle.direction,g=g||c.parents("[dir]:first").attr("dir")||"",a.extend(i,{order:0,settings:d,$input:c,tabIndex:c.attr("tabindex")||"",tagType:"select"===h.tagName.toLowerCase()?v:w,rtl:/rtl/i.test(g),eventNS:".selectize"+ ++M.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:c.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===d.loadThrottle?i.onSearchChange:D(i.onSearchChange,d.loadThrottle)}),i.sifter=new b(this.options,{diacritics:d.diacritics}),i.settings.options){for(e=0,f=i.settings.options.length;f>e;e++)i.registerOption(i.settings.options[e]);delete i.settings.options}if(i.settings.optgroups){for(e=0,f=i.settings.optgroups.length;f>e;e++)i.registerOptionGroup(i.settings.optgroups[e]);delete i.settings.optgroups}i.settings.mode=i.settings.mode||(1===i.settings.maxItems?"single":"multi"),"boolean"!=typeof i.settings.hideSelected&&(i.settings.hideSelected="multi"===i.settings.mode),i.initializePlugins(i.settings.plugins),i.setupCallbacks(),i.setupTemplates(),i.setup()};return e.mixin(M),"undefined"!=typeof c?c.mixin(M):L("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),a.extend(M.prototype,{setup:function(){var b,c,d,e,g,h,i,j,k,l,m=this,n=m.settings,o=m.eventNS,p=a(window),q=a(document),u=m.$input;if(i=m.settings.mode,j=u.attr("class")||"",b=a("<div>").addClass(n.wrapperClass).addClass(j).addClass(i),c=a("<div>").addClass(n.inputClass).addClass("items").appendTo(b),d=a('<input type="text" autocomplete="off" />').appendTo(c).attr("tabindex",u.is(":disabled")?"-1":m.tabIndex),h=a(n.dropdownParent||b),e=a("<div>").addClass(n.dropdownClass).addClass(i).hide().appendTo(h),g=a("<div>").addClass(n.dropdownContentClass).appendTo(e),(l=u.attr("id"))&&(d.attr("id",l+"-selectized"),a("label[for='"+l+"']").attr("for",l+"-selectized")),m.settings.copyClassesToDropdown&&e.addClass(j),b.css({width:u[0].style.width}),m.plugins.names.length&&(k="plugin-"+m.plugins.names.join(" plugin-"),b.addClass(k),e.addClass(k)),(null===n.maxItems||n.maxItems>1)&&m.tagType===v&&u.attr("multiple","multiple"),m.settings.placeholder&&d.attr("placeholder",n.placeholder),!m.settings.splitOn&&m.settings.delimiter){var w=m.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");m.settings.splitOn=new RegExp("\\s*"+w+"+\\s*")}u.attr("autocorrect")&&d.attr("autocorrect",u.attr("autocorrect")),u.attr("autocapitalize")&&d.attr("autocapitalize",u.attr("autocapitalize")),m.$wrapper=b,m.$control=c,m.$control_input=d,m.$dropdown=e,m.$dropdown_content=g,e.on("mouseenter","[data-selectable]",function(){return m.onOptionHover.apply(m,arguments)}),e.on("mousedown click","[data-selectable]",function(){return m.onOptionSelect.apply(m,arguments)}),F(c,"mousedown","*:not(input)",function(){return m.onItemSelect.apply(m,arguments)}),J(d),c.on({mousedown:function(){return m.onMouseDown.apply(m,arguments)},click:function(){return m.onClick.apply(m,arguments)}}),d.on({mousedown:function(a){a.stopPropagation()},keydown:function(){return m.onKeyDown.apply(m,arguments)},keyup:function(){return m.onKeyUp.apply(m,arguments)},keypress:function(){return m.onKeyPress.apply(m,arguments)},resize:function(){m.positionDropdown.apply(m,[])},blur:function(){return m.onBlur.apply(m,arguments)},focus:function(){return m.ignoreBlur=!1,m.onFocus.apply(m,arguments)},paste:function(){return m.onPaste.apply(m,arguments)}}),q.on("keydown"+o,function(a){m.isCmdDown=a[f?"metaKey":"ctrlKey"],m.isCtrlDown=a[f?"altKey":"ctrlKey"],m.isShiftDown=a.shiftKey}),q.on("keyup"+o,function(a){a.keyCode===t&&(m.isCtrlDown=!1),a.keyCode===r&&(m.isShiftDown=!1),a.keyCode===s&&(m.isCmdDown=!1)}),q.on("mousedown"+o,function(a){if(m.isFocused){if(a.target===m.$dropdown[0]||a.target.parentNode===m.$dropdown[0])return!1;m.$control.has(a.target).length||a.target===m.$control[0]||m.blur(a.target)}}),p.on(["scroll"+o,"resize"+o].join(" "),function(){m.isOpen&&m.positionDropdown.apply(m,arguments)}),p.on("mousemove"+o,function(){m.ignoreHover=!1}),this.revertSettings={$children:u.children().detach(),tabindex:u.attr("tabindex")},u.attr("tabindex",-1).hide().after(m.$wrapper),a.isArray(n.items)&&(m.setValue(n.items),delete n.items),x&&u.on("invalid"+o,function(a){a.preventDefault(),m.isInvalid=!0,m.refreshState()}),m.updateOriginalInput(),m.refreshItems(),m.refreshState(),m.updatePlaceholder(),m.isSetup=!0,u.is(":disabled")&&m.disable(),m.on("change",this.onChange),u.data("selectize",m),u.addClass("selectized"),m.trigger("initialize"),n.preload===!0&&m.onSearchChange("")},setupTemplates:function(){var b=this,c=b.settings.labelField,d=b.settings.optgroupLabelField,e={optgroup:function(a){return'<div class="optgroup">'+a.html+"</div>"},optgroup_header:function(a,b){return'<div class="optgroup-header">'+b(a[d])+"</div>"},option:function(a,b){return'<div class="option">'+b(a[c])+"</div>"},item:function(a,b){return'<div class="item">'+b(a[c])+"</div>"},option_create:function(a,b){return'<div class="create">Add <strong>'+b(a.input)+"</strong>&hellip;</div>"}};b.settings.render=a.extend({},e,b.settings.render)},setupCallbacks:function(){var a,b,c={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(a in c)c.hasOwnProperty(a)&&(b=this.settings[c[a]],b&&this.on(a,b))},onClick:function(a){var b=this;b.isFocused||(b.focus(),a.preventDefault())},onMouseDown:function(b){var c=this,d=b.isDefaultPrevented();a(b.target);if(c.isFocused){if(b.target!==c.$control_input[0])return"single"===c.settings.mode?c.isOpen?c.close():c.open():d||c.setActiveItem(null),!1}else d||window.setTimeout(function(){c.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(b){var c=this;return c.isFull()||c.isInputHidden||c.isLocked?void b.preventDefault():void(c.settings.splitOn&&setTimeout(function(){var b=c.$control_input.val();if(b.match(c.settings.splitOn))for(var d=a.trim(b).split(c.settings.splitOn),e=0,f=d.length;f>e;e++)c.createItem(d[e])},0))},onKeyPress:function(a){if(this.isLocked)return a&&a.preventDefault();var b=String.fromCharCode(a.keyCode||a.which);return this.settings.create&&"multi"===this.settings.mode&&b===this.settings.delimiter?(this.createItem(),a.preventDefault(),!1):void 0},onKeyDown:function(a){var b=(a.target===this.$control_input[0],this);if(b.isLocked)return void(a.keyCode!==u&&a.preventDefault());switch(a.keyCode){case g:if(b.isCmdDown)return void b.selectAll();break;case i:return void(b.isOpen&&(a.preventDefault(),a.stopPropagation(),b.close()));case o:if(!a.ctrlKey||a.altKey)break;case n:if(!b.isOpen&&b.hasOptions)b.open();else if(b.$activeOption){b.ignoreHover=!0;var c=b.getAdjacentOption(b.$activeOption,1);c.length&&b.setActiveOption(c,!0,!0)}return void a.preventDefault();case l:if(!a.ctrlKey||a.altKey)break;case k:if(b.$activeOption){b.ignoreHover=!0;var d=b.getAdjacentOption(b.$activeOption,-1);d.length&&b.setActiveOption(d,!0,!0)}return void a.preventDefault();case h:return void(b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),a.preventDefault()));case j:return void b.advanceSelection(-1,a);case m:return void b.advanceSelection(1,a);case u:return b.settings.selectOnTab&&b.isOpen&&b.$activeOption&&(b.onOptionSelect({currentTarget:b.$activeOption}),b.isFull()||a.preventDefault()),void(b.settings.create&&b.createItem()&&a.preventDefault());case p:case q:return void b.deleteSelection(a)}return!b.isFull()&&!b.isInputHidden||(f?a.metaKey:a.ctrlKey)?void 0:void a.preventDefault()},onKeyUp:function(a){var b=this;if(b.isLocked)return a&&a.preventDefault();var c=b.$control_input.val()||"";b.lastValue!==c&&(b.lastValue=c,b.onSearchChange(c),b.refreshOptions(),b.trigger("type",c))},onSearchChange:function(a){var b=this,c=b.settings.load;c&&(b.loadedSearches.hasOwnProperty(a)||(b.loadedSearches[a]=!0,b.load(function(d){c.apply(b,[a,d])})))},onFocus:function(a){var b=this,c=b.isFocused;return b.isDisabled?(b.blur(),a&&a.preventDefault(),!1):void(b.ignoreFocus||(b.isFocused=!0,"focus"===b.settings.preload&&b.onSearchChange(""),c||b.trigger("focus"),b.$activeItems.length||(b.showInput(),b.setActiveItem(null),b.refreshOptions(!!b.settings.openOnFocus)),b.refreshState()))},onBlur:function(a,b){var c=this;if(c.isFocused&&(c.isFocused=!1,!c.ignoreFocus)){if(!c.ignoreBlur&&document.activeElement===c.$dropdown_content[0])return c.ignoreBlur=!0,void c.onFocus(a);var d=function(){c.close(),c.setTextboxValue(""),c.setActiveItem(null),c.setActiveOption(null),c.setCaret(c.items.length),c.refreshState(),b&&b.focus&&b.focus(),c.ignoreFocus=!1,c.trigger("blur")};c.ignoreFocus=!0,c.settings.create&&c.settings.createOnBlur?c.createItem(null,!1,d):d()}},onOptionHover:function(a){this.ignoreHover||this.setActiveOption(a.currentTarget,!1)},onOptionSelect:function(b){var c,d,e=this;b.preventDefault&&(b.preventDefault(),b.stopPropagation()),d=a(b.currentTarget),d.hasClass("create")?e.createItem(null,function(){e.settings.closeAfterSelect&&e.close()}):(c=d.attr("data-value"),"undefined"!=typeof c&&(e.lastQuery=null,e.setTextboxValue(""),e.addItem(c),e.settings.closeAfterSelect?e.close():!e.settings.hideSelected&&b.type&&/mouse/.test(b.type)&&e.setActiveOption(e.getOption(c))))},onItemSelect:function(a){var b=this;b.isLocked||"multi"===b.settings.mode&&(a.preventDefault(),b.setActiveItem(a.currentTarget,a))},load:function(a){var b=this,c=b.$wrapper.addClass(b.settings.loadingClass);b.loading++,a.apply(b,[function(a){b.loading=Math.max(b.loading-1,0),a&&a.length&&(b.addOption(a),b.refreshOptions(b.isFocused&&!b.isInputHidden)),b.loading||c.removeClass(b.settings.loadingClass),b.trigger("load",a)}])},setTextboxValue:function(a){var b=this.$control_input,c=b.val()!==a;c&&(b.val(a).triggerHandler("update"),this.lastValue=a)},getValue:function(){return this.tagType===v&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(a,b){var c=b?[]:["change"];E(this,c,function(){this.clear(b),this.addItems(a,b)})},setActiveItem:function(b,c){var d,e,f,g,h,i,j,k,l=this;if("single"!==l.settings.mode){if(b=a(b),!b.length)return a(l.$activeItems).removeClass("active"),l.$activeItems=[],void(l.isFocused&&l.showInput());if(d=c&&c.type.toLowerCase(),"mousedown"===d&&l.isShiftDown&&l.$activeItems.length){for(k=l.$control.children(".active:last"),g=Array.prototype.indexOf.apply(l.$control[0].childNodes,[k[0]]),h=Array.prototype.indexOf.apply(l.$control[0].childNodes,[b[0]]),g>h&&(j=g,g=h,h=j),e=g;h>=e;e++)i=l.$control[0].childNodes[e],-1===l.$activeItems.indexOf(i)&&(a(i).addClass("active"),l.$activeItems.push(i));c.preventDefault()}else"mousedown"===d&&l.isCtrlDown||"keydown"===d&&this.isShiftDown?b.hasClass("active")?(f=l.$activeItems.indexOf(b[0]),l.$activeItems.splice(f,1),b.removeClass("active")):l.$activeItems.push(b.addClass("active")[0]):(a(l.$activeItems).removeClass("active"),l.$activeItems=[b.addClass("active")[0]]);l.hideInput(),this.isFocused||l.focus()}},setActiveOption:function(b,c,d){var e,f,g,h,i,j=this;j.$activeOption&&j.$activeOption.removeClass("active"),j.$activeOption=null,b=a(b),b.length&&(j.$activeOption=b.addClass("active"),(c||!y(c))&&(e=j.$dropdown_content.height(),f=j.$activeOption.outerHeight(!0),c=j.$dropdown_content.scrollTop()||0,g=j.$activeOption.offset().top-j.$dropdown_content.offset().top+c,h=g,i=g-e+f,g+f>e+c?j.$dropdown_content.stop().animate({scrollTop:i},d?j.settings.scrollDuration:0):c>g&&j.$dropdown_content.stop().animate({scrollTop:h},d?j.settings.scrollDuration:0)))},selectAll:function(){var a=this;"single"!==a.settings.mode&&(a.$activeItems=Array.prototype.slice.apply(a.$control.children(":not(input)").addClass("active")),a.$activeItems.length&&(a.hideInput(),a.close()),a.focus())},hideInput:function(){var a=this;a.setTextboxValue(""),a.$control_input.css({opacity:0,position:"absolute",left:a.rtl?1e4:-1e4}),a.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var a=this;a.isDisabled||(a.ignoreFocus=!0,a.$control_input[0].focus(),window.setTimeout(function(){a.ignoreFocus=!1,a.onFocus()},0))},blur:function(a){this.$control_input[0].blur(),this.onBlur(null,a)},getScoreFunction:function(a){return this.sifter.getScoreFunction(a,this.getSearchOptions())},getSearchOptions:function(){var a=this.settings,b=a.sortField;return"string"==typeof b&&(b=[{field:b}]),{fields:a.searchField,conjunction:a.searchConjunction,sort:b}},search:function(b){var c,d,e,f=this,g=f.settings,h=this.getSearchOptions();if(g.score&&(e=f.settings.score.apply(this,[b]),"function"!=typeof e))throw new Error('Selectize "score" setting must be a function that returns a function');if(b!==f.lastQuery?(f.lastQuery=b,d=f.sifter.search(b,a.extend(h,{score:e})),f.currentResults=d):d=a.extend(!0,{},f.currentResults),g.hideSelected)for(c=d.items.length-1;c>=0;c--)-1!==f.items.indexOf(z(d.items[c].id))&&d.items.splice(c,1);return d},refreshOptions:function(b){var c,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;"undefined"==typeof b&&(b=!0);var t=this,u=a.trim(t.$control_input.val()),v=t.search(u),w=t.$dropdown_content,x=t.$activeOption&&z(t.$activeOption.attr("data-value"));for(g=v.items.length,"number"==typeof t.settings.maxOptions&&(g=Math.min(g,t.settings.maxOptions)),h={},i=[],c=0;g>c;c++)for(j=t.options[v.items[c].id],k=t.render("option",j),l=j[t.settings.optgroupField]||"",m=a.isArray(l)?l:[l],e=0,f=m&&m.length;f>e;e++)l=m[e],t.optgroups.hasOwnProperty(l)||(l=""),h.hasOwnProperty(l)||(h[l]=document.createDocumentFragment(),i.push(l)),h[l].appendChild(k);for(this.settings.lockOptgroupOrder&&i.sort(function(a,b){var c=t.optgroups[a].$order||0,d=t.optgroups[b].$order||0;return c-d}),n=document.createDocumentFragment(),c=0,g=i.length;g>c;c++)l=i[c],t.optgroups.hasOwnProperty(l)&&h[l].childNodes.length?(o=document.createDocumentFragment(),o.appendChild(t.render("optgroup_header",t.optgroups[l])),o.appendChild(h[l]),n.appendChild(t.render("optgroup",a.extend({},t.optgroups[l],{html:K(o),dom:o})))):n.appendChild(h[l]);if(w.html(n),t.settings.highlight&&v.query.length&&v.tokens.length)for(w.removeHighlight(),c=0,g=v.tokens.length;g>c;c++)d(w,v.tokens[c].regex);if(!t.settings.hideSelected)for(c=0,g=t.items.length;g>c;c++)t.getOption(t.items[c]).addClass("selected");p=t.canCreate(u),p&&(w.prepend(t.render("option_create",{input:u})),s=a(w[0].childNodes[0])),t.hasOptions=v.items.length>0||p,t.hasOptions?(v.items.length>0?(r=x&&t.getOption(x),r&&r.length?q=r:"single"===t.settings.mode&&t.items.length&&(q=t.getOption(t.items[0])),
q&&q.length||(q=s&&!t.settings.addPrecedence?t.getAdjacentOption(s,1):w.find("[data-selectable]:first"))):q=s,t.setActiveOption(q),b&&!t.isOpen&&t.open()):(t.setActiveOption(null),b&&t.isOpen&&t.close())},addOption:function(b){var c,d,e,f=this;if(a.isArray(b))for(c=0,d=b.length;d>c;c++)f.addOption(b[c]);else(e=f.registerOption(b))&&(f.userOptions[e]=!0,f.lastQuery=null,f.trigger("option_add",e,b))},registerOption:function(a){var b=z(a[this.settings.valueField]);return"undefined"==typeof b||null===b||this.options.hasOwnProperty(b)?!1:(a.$order=a.$order||++this.order,this.options[b]=a,b)},registerOptionGroup:function(a){var b=z(a[this.settings.optgroupValueField]);return b?(a.$order=a.$order||++this.order,this.optgroups[b]=a,b):!1},addOptionGroup:function(a,b){b[this.settings.optgroupValueField]=a,(a=this.registerOptionGroup(b))&&this.trigger("optgroup_add",a,b)},removeOptionGroup:function(a){this.optgroups.hasOwnProperty(a)&&(delete this.optgroups[a],this.renderCache={},this.trigger("optgroup_remove",a))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(b,c){var d,e,f,g,h,i,j,k=this;if(b=z(b),f=z(c[k.settings.valueField]),null!==b&&k.options.hasOwnProperty(b)){if("string"!=typeof f)throw new Error("Value must be set in option data");j=k.options[b].$order,f!==b&&(delete k.options[b],g=k.items.indexOf(b),-1!==g&&k.items.splice(g,1,f)),c.$order=c.$order||j,k.options[f]=c,h=k.renderCache.item,i=k.renderCache.option,h&&(delete h[b],delete h[f]),i&&(delete i[b],delete i[f]),-1!==k.items.indexOf(f)&&(d=k.getItem(b),e=a(k.render("item",c)),d.hasClass("active")&&e.addClass("active"),d.replaceWith(e)),k.lastQuery=null,k.isOpen&&k.refreshOptions(!1)}},removeOption:function(a,b){var c=this;a=z(a);var d=c.renderCache.item,e=c.renderCache.option;d&&delete d[a],e&&delete e[a],delete c.userOptions[a],delete c.options[a],c.lastQuery=null,c.trigger("option_remove",a),c.removeItem(a,b)},clearOptions:function(){var a=this;a.loadedSearches={},a.userOptions={},a.renderCache={},a.options=a.sifter.items={},a.lastQuery=null,a.trigger("option_clear"),a.clear()},getOption:function(a){return this.getElementWithValue(a,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(b,c){var d=this.$dropdown.find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},getElementWithValue:function(b,c){if(b=z(b),"undefined"!=typeof b&&null!==b)for(var d=0,e=c.length;e>d;d++)if(c[d].getAttribute("data-value")===b)return a(c[d]);return a()},getItem:function(a){return this.getElementWithValue(a,this.$control.children())},addItems:function(b,c){for(var d=a.isArray(b)?b:[b],e=0,f=d.length;f>e;e++)this.isPending=f-1>e,this.addItem(d[e],c)},addItem:function(b,c){var d=c?[]:["change"];E(this,d,function(){var d,e,f,g,h,i=this,j=i.settings.mode;return b=z(b),-1!==i.items.indexOf(b)?void("single"===j&&i.close()):void(i.options.hasOwnProperty(b)&&("single"===j&&i.clear(c),"multi"===j&&i.isFull()||(d=a(i.render("item",i.options[b])),h=i.isFull(),i.items.splice(i.caretPos,0,b),i.insertAtCaret(d),(!i.isPending||!h&&i.isFull())&&i.refreshState(),i.isSetup&&(f=i.$dropdown_content.find("[data-selectable]"),i.isPending||(e=i.getOption(b),g=i.getAdjacentOption(e,1).attr("data-value"),i.refreshOptions(i.isFocused&&"single"!==j),g&&i.setActiveOption(i.getOption(g))),!f.length||i.isFull()?i.close():i.positionDropdown(),i.updatePlaceholder(),i.trigger("item_add",b,d),i.updateOriginalInput({silent:c})))))})},removeItem:function(b,c){var d,e,f,g=this;d=b instanceof a?b:g.getItem(b),b=z(d.attr("data-value")),e=g.items.indexOf(b),-1!==e&&(d.remove(),d.hasClass("active")&&(f=g.$activeItems.indexOf(d[0]),g.$activeItems.splice(f,1)),g.items.splice(e,1),g.lastQuery=null,!g.settings.persist&&g.userOptions.hasOwnProperty(b)&&g.removeOption(b,c),e<g.caretPos&&g.setCaret(g.caretPos-1),g.refreshState(),g.updatePlaceholder(),g.updateOriginalInput({silent:c}),g.positionDropdown(),g.trigger("item_remove",b,d))},createItem:function(b,c){var d=this,e=d.caretPos;b=b||a.trim(d.$control_input.val()||"");var f=arguments[arguments.length-1];if("function"!=typeof f&&(f=function(){}),"boolean"!=typeof c&&(c=!0),!d.canCreate(b))return f(),!1;d.lock();var g="function"==typeof d.settings.create?this.settings.create:function(a){var b={};return b[d.settings.labelField]=a,b[d.settings.valueField]=a,b},h=C(function(a){if(d.unlock(),!a||"object"!=typeof a)return f();var b=z(a[d.settings.valueField]);return"string"!=typeof b?f():(d.setTextboxValue(""),d.addOption(a),d.setCaret(e),d.addItem(b),d.refreshOptions(c&&"single"!==d.settings.mode),void f(a))}),i=g.apply(this,[b,h]);return"undefined"!=typeof i&&h(i),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var a=!this.items.length;this.isInvalid=a,this.$control_input.prop("required",a),this.$input.prop("required",!a)},refreshClasses:function(){var b=this,c=b.isFull(),d=b.isLocked;b.$wrapper.toggleClass("rtl",b.rtl),b.$control.toggleClass("focus",b.isFocused).toggleClass("disabled",b.isDisabled).toggleClass("required",b.isRequired).toggleClass("invalid",b.isInvalid).toggleClass("locked",d).toggleClass("full",c).toggleClass("not-full",!c).toggleClass("input-active",b.isFocused&&!b.isInputHidden).toggleClass("dropdown-active",b.isOpen).toggleClass("has-options",!a.isEmptyObject(b.options)).toggleClass("has-items",b.items.length>0),b.$control_input.data("grow",!c&&!d)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(a){var b,c,d,e,f=this;if(a=a||{},f.tagType===v){for(d=[],b=0,c=f.items.length;c>b;b++)e=f.options[f.items[b]][f.settings.labelField]||"",d.push('<option value="'+A(f.items[b])+'" selected="selected">'+A(e)+"</option>");d.length||this.$input.attr("multiple")||d.push('<option value="" selected="selected"></option>'),f.$input.html(d.join(""))}else f.$input.val(f.getValue()),f.$input.attr("value",f.$input.val());f.isSetup&&(a.silent||f.trigger("change",f.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var a=this.$control_input;this.items.length?a.removeAttr("placeholder"):a.attr("placeholder",this.settings.placeholder),a.triggerHandler("update",{force:!0})}},open:function(){var a=this;a.isLocked||a.isOpen||"multi"===a.settings.mode&&a.isFull()||(a.focus(),a.isOpen=!0,a.refreshState(),a.$dropdown.css({visibility:"hidden",display:"block"}),a.positionDropdown(),a.$dropdown.css({visibility:"visible"}),a.trigger("dropdown_open",a.$dropdown))},close:function(){var a=this,b=a.isOpen;"single"===a.settings.mode&&a.items.length&&(a.hideInput(),a.$control_input.blur()),a.isOpen=!1,a.$dropdown.hide(),a.setActiveOption(null),a.refreshState(),b&&a.trigger("dropdown_close",a.$dropdown)},positionDropdown:function(){var a=this.$control,b="body"===this.settings.dropdownParent?a.offset():a.position();b.top+=a.outerHeight(!0),this.$dropdown.css({width:a.outerWidth(),top:b.top,left:b.left})},clear:function(a){var b=this;b.items.length&&(b.$control.children(":not(input)").remove(),b.items=[],b.lastQuery=null,b.setCaret(0),b.setActiveItem(null),b.updatePlaceholder(),b.updateOriginalInput({silent:a}),b.refreshState(),b.showInput(),b.trigger("clear"))},insertAtCaret:function(b){var c=Math.min(this.caretPos,this.items.length);0===c?this.$control.prepend(b):a(this.$control[0].childNodes[c]).before(b),this.setCaret(c+1)},deleteSelection:function(b){var c,d,e,f,g,h,i,j,k,l=this;if(e=b&&b.keyCode===p?-1:1,f=G(l.$control_input[0]),l.$activeOption&&!l.settings.hideSelected&&(i=l.getAdjacentOption(l.$activeOption,-1).attr("data-value")),g=[],l.$activeItems.length){for(k=l.$control.children(".active:"+(e>0?"last":"first")),h=l.$control.children(":not(input)").index(k),e>0&&h++,c=0,d=l.$activeItems.length;d>c;c++)g.push(a(l.$activeItems[c]).attr("data-value"));b&&(b.preventDefault(),b.stopPropagation())}else(l.isFocused||"single"===l.settings.mode)&&l.items.length&&(0>e&&0===f.start&&0===f.length?g.push(l.items[l.caretPos-1]):e>0&&f.start===l.$control_input.val().length&&g.push(l.items[l.caretPos]));if(!g.length||"function"==typeof l.settings.onDelete&&l.settings.onDelete.apply(l,[g])===!1)return!1;for("undefined"!=typeof h&&l.setCaret(h);g.length;)l.removeItem(g.pop());return l.showInput(),l.positionDropdown(),l.refreshOptions(!0),i&&(j=l.getOption(i),j.length&&l.setActiveOption(j)),!0},advanceSelection:function(a,b){var c,d,e,f,g,h,i=this;0!==a&&(i.rtl&&(a*=-1),c=a>0?"last":"first",d=G(i.$control_input[0]),i.isFocused&&!i.isInputHidden?(f=i.$control_input.val().length,g=0>a?0===d.start&&0===d.length:d.start===f,g&&!f&&i.advanceCaret(a,b)):(h=i.$control.children(".active:"+c),h.length&&(e=i.$control.children(":not(input)").index(h),i.setActiveItem(null),i.setCaret(a>0?e+1:e))))},advanceCaret:function(a,b){var c,d,e=this;0!==a&&(c=a>0?"next":"prev",e.isShiftDown?(d=e.$control_input[c](),d.length&&(e.hideInput(),e.setActiveItem(d),b&&b.preventDefault())):e.setCaret(e.caretPos+a))},setCaret:function(b){var c=this;if(b="single"===c.settings.mode?c.items.length:Math.max(0,Math.min(c.items.length,b)),!c.isPending){var d,e,f,g;for(f=c.$control.children(":not(input)"),d=0,e=f.length;e>d;d++)g=a(f[d]).detach(),b>d?c.$control_input.before(g):c.$control.append(g)}c.caretPos=b},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var a=this;a.$input.prop("disabled",!0),a.$control_input.prop("disabled",!0).prop("tabindex",-1),a.isDisabled=!0,a.lock()},enable:function(){var a=this;a.$input.prop("disabled",!1),a.$control_input.prop("disabled",!1).prop("tabindex",a.tabIndex),a.isDisabled=!1,a.unlock()},destroy:function(){var b=this,c=b.eventNS,d=b.revertSettings;b.trigger("destroy"),b.off(),b.$wrapper.remove(),b.$dropdown.remove(),b.$input.html("").append(d.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:d.tabindex}).show(),b.$control_input.removeData("grow"),b.$input.removeData("selectize"),a(window).off(c),a(document).off(c),a(document.body).off(c),delete b.$input[0].selectize},render:function(b,c){var d,e,f="",g=!1,h=this;return("option"===b||"item"===b)&&(d=z(c[h.settings.valueField]),g=!!d),g&&(y(h.renderCache[b])||(h.renderCache[b]={}),h.renderCache[b].hasOwnProperty(d))?h.renderCache[b][d]:(f=a(h.settings.render[b].apply(this,[c,A])),"option"===b||"option_create"===b?f.attr("data-selectable",""):"optgroup"===b&&(e=c[h.settings.optgroupValueField]||"",f.attr("data-group",e)),("option"===b||"item"===b)&&f.attr("data-value",d||""),g&&(h.renderCache[b][d]=f[0]),f[0])},clearCache:function(a){var b=this;"undefined"==typeof a?b.renderCache={}:delete b.renderCache[a]},canCreate:function(a){var b=this;if(!b.settings.create)return!1;var c=b.settings.createFilter;return a.length&&("function"!=typeof c||c.apply(b,[a]))&&("string"!=typeof c||new RegExp(c).test(a))&&(!(c instanceof RegExp)||c.test(a))}}),M.count=0,M.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},a.fn.selectize=function(b){var c=a.fn.selectize.defaults,d=a.extend({},c,b),e=d.dataAttr,f=d.labelField,g=d.valueField,h=d.optgroupField,i=d.optgroupLabelField,j=d.optgroupValueField,k=function(b,c){var h,i,j,k,l=b.attr(e);if(l)for(c.options=JSON.parse(l),h=0,i=c.options.length;i>h;h++)c.items.push(c.options[h][g]);else{var m=a.trim(b.val()||"");if(!d.allowEmptyOption&&!m.length)return;for(j=m.split(d.delimiter),h=0,i=j.length;i>h;h++)k={},k[f]=j[h],k[g]=j[h],c.options.push(k);c.items=j}},l=function(b,c){var k,l,m,n,o=c.options,p={},q=function(a){var b=e&&a.attr(e);return"string"==typeof b&&b.length?JSON.parse(b):null},r=function(b,e){b=a(b);var i=z(b.val());if(i||d.allowEmptyOption)if(p.hasOwnProperty(i)){if(e){var j=p[i][h];j?a.isArray(j)?j.push(e):p[i][h]=[j,e]:p[i][h]=e}}else{var k=q(b)||{};k[f]=k[f]||b.text(),k[g]=k[g]||i,k[h]=k[h]||e,p[i]=k,o.push(k),b.is(":selected")&&c.items.push(i)}},s=function(b){var d,e,f,g,h;for(b=a(b),f=b.attr("label"),f&&(g=q(b)||{},g[i]=f,g[j]=f,c.optgroups.push(g)),h=a("option",b),d=0,e=h.length;e>d;d++)r(h[d],f)};for(c.maxItems=b.attr("multiple")?null:1,n=b.children(),k=0,l=n.length;l>k;k++)m=n[k].tagName.toLowerCase(),"optgroup"===m?s(n[k]):"option"===m&&r(n[k])};return this.each(function(){if(!this.selectize){var e,f=a(this),g=this.tagName.toLowerCase(),h=f.attr("placeholder")||f.attr("data-placeholder");h||d.allowEmptyOption||(h=f.children('option[value=""]').text());var i={placeholder:h,options:[],optgroups:[],items:[]};"select"===g?l(f,i):k(f,i),e=new M(f,a.extend(!0,{},c,i,b))}})},a.fn.selectize.defaults=M.defaults,a.fn.selectize.support={validity:x},M.define("drag_drop",function(b){if(!a.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var c=this;c.lock=function(){var a=c.lock;return function(){var b=c.$control.data("sortable");return b&&b.disable(),a.apply(c,arguments)}}(),c.unlock=function(){var a=c.unlock;return function(){var b=c.$control.data("sortable");return b&&b.enable(),a.apply(c,arguments)}}(),c.setup=function(){var b=c.setup;return function(){b.apply(this,arguments);var d=c.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:c.isLocked,start:function(a,b){b.placeholder.css("width",b.helper.css("width")),d.css({overflow:"visible"})},stop:function(){d.css({overflow:"hidden"});var b=c.$activeItems?c.$activeItems.slice():null,e=[];d.children("[data-value]").each(function(){e.push(a(this).attr("data-value"))}),c.setValue(e),c.setActiveItem(b)}})}}()}}),M.define("dropdown_header",function(b){var c=this;b=a.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(a){return'<div class="'+a.headerClass+'"><div class="'+a.titleRowClass+'"><span class="'+a.labelClass+'">'+a.title+'</span><a href="javascript:void(0)" class="'+a.closeClass+'">&times;</a></div></div>'}},b),c.setup=function(){var d=c.setup;return function(){d.apply(c,arguments),c.$dropdown_header=a(b.html(b)),c.$dropdown.prepend(c.$dropdown_header)}}()}),M.define("optgroup_columns",function(b){var c=this;b=a.extend({equalizeWidth:!0,equalizeHeight:!0},b),this.getAdjacentOption=function(b,c){var d=b.closest("[data-group]").find("[data-selectable]"),e=d.index(b)+c;return e>=0&&e<d.length?d.eq(e):a()},this.onKeyDown=function(){var a=c.onKeyDown;return function(b){var d,e,f,g;return!this.isOpen||b.keyCode!==j&&b.keyCode!==m?a.apply(this,arguments):(c.ignoreHover=!0,g=this.$activeOption.closest("[data-group]"),d=g.find("[data-selectable]").index(this.$activeOption),g=b.keyCode===j?g.prev("[data-group]"):g.next("[data-group]"),f=g.find("[data-selectable]"),e=f.eq(Math.min(f.length-1,d)),void(e.length&&this.setActiveOption(e)))}}();var d=function(){var a,b=d.width,c=document;return"undefined"==typeof b&&(a=c.createElement("div"),a.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',a=a.firstChild,c.body.appendChild(a),b=d.width=a.offsetWidth-a.clientWidth,c.body.removeChild(a)),b},e=function(){var e,f,g,h,i,j,k;if(k=a("[data-group]",c.$dropdown_content),f=k.length,f&&c.$dropdown_content.width()){if(b.equalizeHeight){for(g=0,e=0;f>e;e++)g=Math.max(g,k.eq(e).height());k.css({height:g})}b.equalizeWidth&&(j=c.$dropdown_content.innerWidth()-d(),h=Math.round(j/f),k.css({width:h}),f>1&&(i=j-h*(f-1),k.eq(f-1).css({width:i})))}};(b.equalizeHeight||b.equalizeWidth)&&(B.after(this,"positionDropdown",e),B.after(this,"refreshOptions",e))}),M.define("remove_button",function(b){b=a.extend({label:"&times;",title:"Remove",className:"remove",append:!0},b);var c=function(b,c){c.className="remove-single";var d=b,e='<a href="javascript:void(0)" class="'+c.className+'" tabindex="-1" title="'+A(c.title)+'">'+c.label+"</a>",f=function(a,b){return a+b};b.setup=function(){var g=d.setup;return function(){if(c.append){var h=a(d.$input.context).attr("id"),i=(a("#"+h),d.settings.render.item);d.settings.render.item=function(a){return f(i.apply(b,arguments),e)}}g.apply(b,arguments),b.$control.on("click","."+c.className,function(a){a.preventDefault(),d.isLocked||d.clear()})}}()},d=function(b,c){var d=b,e='<a href="javascript:void(0)" class="'+c.className+'" tabindex="-1" title="'+A(c.title)+'">'+c.label+"</a>",f=function(a,b){var c=a.search(/(<\/[^>]+>\s*)$/);return a.substring(0,c)+b+a.substring(c)};b.setup=function(){var g=d.setup;return function(){if(c.append){var h=d.settings.render.item;d.settings.render.item=function(a){return f(h.apply(b,arguments),e)}}g.apply(b,arguments),b.$control.on("click","."+c.className,function(b){if(b.preventDefault(),!d.isLocked){var c=a(b.currentTarget).parent();d.setActiveItem(c),d.deleteSelection()&&d.setCaret(d.items.length)}})}}()};return"single"===this.settings.mode?void c(this,b):void d(this,b)}),M.define("restore_on_backspace",function(a){var b=this;a.text=a.text||function(a){return a[this.settings.labelField]},this.onKeyDown=function(){var c=b.onKeyDown;return function(b){var d,e;return b.keyCode===p&&""===this.$control_input.val()&&!this.$activeItems.length&&(d=this.caretPos-1,d>=0&&d<this.items.length)?(e=this.options[this.items[d]],this.deleteSelection(b)&&(this.setTextboxValue(a.text.apply(this,[e])),this.refreshOptions(!0)),void b.preventDefault()):c.apply(this,arguments)}}()}),M}),function(a){if("undefined"!=typeof exports&&"undefined"!=typeof require)var b=a._||require("underscore"),c=a.Backbone||require("backbone");else var b=a._,c=a.Backbone;var d=c.View.extend({events:{submit:function(a){this.trigger("submit",a)}},initialize:function(a){var c=this;a=this.options=b.extend({submitButton:!1},a);var d=this.schema=function(){if(a.schema)return b.result(a,"schema");var d=a.model;return d&&d.schema?b.result(d,"schema"):c.schema?b.result(c,"schema"):{}}();b.extend(this,b.pick(a,"model","data","idPrefix","templateData"));var e=this.constructor;this.template=a.template||this.template||e.template,this.Fieldset=a.Fieldset||this.Fieldset||e.Fieldset,this.Field=a.Field||this.Field||e.Field,this.NestedField=a.NestedField||this.NestedField||e.NestedField;var f=this.selectedFields=a.fields||b.keys(d),g=this.fields={};b.each(f,function(a){var b=d[a];g[a]=this.createField(a,b)},this);var h=a.fieldsets||b.result(this,"fieldsets")||b.result(this.model,"fieldsets")||[f];this.fieldsets=[];b.each(h,function(a){this.fieldsets.push(this.createFieldset(a))},this)},createFieldset:function(a){var b={schema:a,fields:this.fields,legend:a.legend||null};return new this.Fieldset(b)},createField:function(a,b){var c={form:this,key:a,schema:b,idPrefix:this.idPrefix};this.model?c.model=this.model:this.data?c.value=this.data[a]:c.value=null;var d=new this.Field(c);return this.listenTo(d.editor,"all",this.handleEditorEvent),d},handleEditorEvent:function(a,c){var d=c.key+":"+a;switch(this.trigger.call(this,d,this,c,Array.prototype.slice.call(arguments,2)),a){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var e=this;setTimeout(function(){var a=b.find(e.fields,function(a){return a.editor.hasFocus});a||e.trigger("blur",e)},0)}}},templateData:function(){var a=this.options;return{submitButton:a.submitButton}},render:function(){var a=this,d=this.fields,e=c.$,f=e(e.trim(this.template(b.result(this,"templateData"))));return f.find("[data-editors]").add(f).each(function(c,f){var g=e(f),h=g.attr("data-editors");if(!b.isUndefined(h)){var i="*"==h?a.selectedFields||b.keys(d):h.split(",");b.each(i,function(a){var b=d[a];g.append(b.editor.render().el)})}}),f.find("[data-fields]").add(f).each(function(c,f){var g=e(f),h=g.attr("data-fields");if(!b.isUndefined(h)){var i="*"==h?a.selectedFields||b.keys(d):h.split(",");b.each(i,function(a){var b=d[a];g.append(b.render().el)})}}),f.find("[data-fieldsets]").add(f).each(function(c,d){var f=e(d),g=f.attr("data-fieldsets");b.isUndefined(g)||b.each(a.fieldsets,function(a){f.append(a.render().el)})}),this.setElement(f),f.addClass(this.className),this},validate:function(a){var c=this.fields,d=this.model,e={};if(a=a||{},b.each(c,function(a){var b=a.validate();b&&(e[a.key]=b)}),!a.skipModelValidate&&d&&d.validate){var f=d.validate(this.getValue());if(f){var g=b.isObject(f)&&!b.isArray(f);g||(e._others=e._others||[],e._others.push(f)),g&&b.each(f,function(a,b){if(c[b]&&!e[b])c[b].setError(a),e[b]=a;else{e._others=e._others||[];var d={};d[b]=a,e._others.push(d)}})}}return b.isEmpty(e)?null:e},commit:function(a){a=a||{};var c={skipModelValidate:!a.validate},d=this.validate(c);if(d)return d;var e,f=b.extend({error:function(a,b){e=b}},a);return this.model.set(this.getValue(),f),e?e:void 0},getValue:function(a){if(a)return this.fields[a].getValue();var c={};return b.each(this.fields,function(a){c[a.key]=a.getValue()}),c},setValue:function(a,b){var c={};"string"==typeof a?c[a]=b:c=a;var d;for(d in this.schema)void 0!==c[d]&&this.fields[d].setValue(c[d])},getEditor:function(a){var b=this.fields[a];if(!b)throw new Error("Field not found: "+a);return b.editor},focus:function(){if(!this.hasFocus){var a=this.fieldsets[0],b=a.getFieldAt(0);b&&b.editor.focus()}},blur:function(){if(this.hasFocus){var a=b.find(this.fields,function(a){return a.editor.hasFocus});a&&a.editor.blur()}},trigger:function(a){return"focus"===a?this.hasFocus=!0:"blur"===a&&(this.hasFocus=!1),c.View.prototype.trigger.apply(this,arguments)},remove:function(){return b.each(this.fieldsets,function(a){a.remove()}),b.each(this.fields,function(a){a.remove()}),c.View.prototype.remove.apply(this,arguments)}},{template:b.template('    <form>     <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit"><%= submitButton %></button>      <% } %>    </form>  ',null,this.templateSettings),templateSettings:{evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},editors:{}});d.validators=function(){var a={};return a.errMessages={required:"Required",regexp:"Invalid",number:"Must be a number",email:"Invalid email address",url:"Invalid URL",match:b.template('Must match field "<%= field %>"',null,d.templateSettings)},a.required=function(a){return a=b.extend({type:"required",message:this.errMessages.required},a),function(c){a.value=c;var d={type:a.type,message:b.isFunction(a.message)?a.message(a):a.message};return null===c||void 0===c||c===!1||""===c?d:void 0}},a.regexp=function(a){if(!a.regexp)throw new Error('Missing required "regexp" option for "regexp" validator');return a=b.extend({type:"regexp",match:!0,message:this.errMessages.regexp},a),function(c){a.value=c;var d={type:a.type,message:b.isFunction(a.message)?a.message(a):a.message};if(null!==c&&void 0!==c&&""!==c)return"string"==typeof a.regexp&&(a.regexp=new RegExp(a.regexp,a.flags)),(a.match?!a.regexp.test(c):a.regexp.test(c))?d:void 0}},a.number=function(c){return c=b.extend({type:"number",message:this.errMessages.number,regexp:/^[0-9]*\.?[0-9]*?$/},c),a.regexp(c)},a.email=function(c){return c=b.extend({type:"email",message:this.errMessages.email,regexp:/^[\w\-]{1,}([\w\-\+.]{1,1}[\w\-]{1,}){0,}[@][\w\-]{1,}([.]([\w\-]{1,})){1,3}$/},c),a.regexp(c)},a.url=function(c){return c=b.extend({type:"url",message:this.errMessages.url,regexp:/^(http|https):\/\/(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},c),a.regexp(c)},a.match=function(a){if(!a.field)throw new Error('Missing required "field" options for "match" validator');return a=b.extend({type:"match",message:this.errMessages.match},a),function(c,d){a.value=c;var e={type:a.type,message:b.isFunction(a.message)?a.message(a):a.message};if(null!==c&&void 0!==c&&""!==c)return c!==d[a.field]?e:void 0}},a}(),d.Fieldset=c.View.extend({initialize:function(a){a=a||{};var c=this.schema=this.createSchema(a.schema);this.fields=b.pick(a.fields,c.fields),this.template=a.template||c.template||this.template||this.constructor.template},createSchema:function(a){return b.isArray(a)&&(a={fields:a}),a.legend=a.legend||null,a},getFieldAt:function(a){var b=this.schema.fields[a];return this.fields[b]},templateData:function(){return this.schema},render:function(){var a=(this.schema,this.fields),d=c.$,e=d(d.trim(this.template(b.result(this,"templateData"))));return e.find("[data-fields]").add(e).each(function(c,e){var f=d(e),g=f.attr("data-fields");b.isUndefined(g)||b.each(a,function(a){f.append(a.render().el)})}),this.setElement(e),this},remove:function(){b.each(this.fields,function(a){a.remove()}),c.View.prototype.remove.call(this)}},{template:b.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,d.templateSettings)}),d.Field=c.View.extend({initialize:function(a){a=a||{},b.extend(this,b.pick(a,"form","key","model","value","idPrefix"));var c=this.schema=this.createSchema(a.schema);this.template=a.template||c.template||this.template||this.constructor.template,this.errorClassName=a.errorClassName||this.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(a){return b.isString(a)&&(a={type:a}),a=b.extend({type:"Text",title:this.createTitle()},a),a.type=b.isString(a.type)?d.editors[a.type]:a.type,a},createEditor:function(){var a=b.extend(b.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()}),c=this.schema.type;return new c(a)},createEditorId:function(){var a=this.idPrefix,c=this.key;return c=c.replace(/\./g,"_"),b.isString(a)||b.isNumber(a)?a+c:b.isNull(a)?c:this.model?this.model.cid+"_"+c:c},createTitle:function(){var a=this.key;return a=a.replace(/([A-Z])/g," $1"),a=a.replace(/^./,function(a){return a.toUpperCase()})},templateData:function(){var a=this.schema;return{help:a.help||"",title:a.title,titleHTML:a.titleHTML,fieldAttrs:a.fieldAttrs,editorAttrs:a.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var a=this.schema,d=this.editor,e=c.$;if(this.editor.noField===!0)return this.setElement(d.render().el);var f=e(e.trim(this.template(b.result(this,"templateData"))));return a.fieldClass&&f.addClass(a.fieldClass),a.fieldAttrs&&f.attr(a.fieldAttrs),f.find("[data-editor]").add(f).each(function(a,c){var f=e(c),g=f.attr("data-editor");b.isUndefined(g)||f.append(d.render().el)}),this.setElement(f),this},disable:function(){b.isFunction(this.editor.disable)?this.editor.disable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!0))},enable:function(){b.isFunction(this.editor.enable)?this.editor.enable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!1))},validate:function(){var a=this.editor.validate();return a?this.setError(a.message):this.clearError(),a},setError:function(a){this.editor.hasNestedForm||(this.$el.addClass(this.errorClassName),this.$("[data-error]").html(a))},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(a){this.editor.setValue(a)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),c.View.prototype.remove.call(this)}},{template:b.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,d.templateSettings),errorClassName:"error"}),d.NestedField=d.Field.extend({template:b.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div class="error-text" data-error></div>        <div class="error-help"><%= help %></div>      </div>    </div>  ',null,d.templateSettings)}),d.Editor=d.editors.Base=c.View.extend({defaultValue:null,hasFocus:!1,initialize:function(a){var a=a||{};if(a.model){if(!a.key)throw new Error("Missing option: 'key'");this.model=a.model,this.value=this.model.get(a.key)}else void 0!==a.value&&(this.value=a.value);void 0===this.value&&(this.value=this.defaultValue),b.extend(this,b.pick(a,"key","form"));var c=this.schema=a.schema||{};this.validators=a.validators||c.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),c.editorClass&&this.$el.addClass(c.editorClass),c.editorAttrs&&this.$el.attr(c.editorAttrs)},getName:function(){var a=this.key||"";return a.replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(a){this.value=a},focus:function(){throw new Error("Not implemented")},blur:function(){throw new Error("Not implemented")},commit:function(a){var b=this.validate();return b?b:(this.listenTo(this.model,"invalid",function(a,c){b=c}),this.model.set(this.key,this.getValue(),a),b?b:void 0)},validate:function(){var a=(this.$el,null),c=this.getValue(),d=this.form?this.form.getValue():{},e=this.validators,f=this.getValidator;return e&&b.every(e,function(b){return a=f(b)(c,d),a?!1:!0}),a},trigger:function(a){return"focus"===a?this.hasFocus=!0:"blur"===a&&(this.hasFocus=!1),c.View.prototype.trigger.apply(this,arguments)},getValidator:function(a){var c=d.validators;if(b.isRegExp(a))return c.regexp({regexp:a});if(b.isString(a)){if(!c[a])throw new Error('Validator "'+a+'" not found');return c[a]()}if(b.isFunction(a))return a;if(b.isObject(a)&&a.type){var e=a;return c[e.type](e)}throw new Error("Invalid validator: "+a)}}),d.editors.Text=d.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(a){var b=this;setTimeout(function(){b.determineChange()},0)},select:function(a){this.trigger("select",this)},focus:function(a){this.trigger("focus",this)},blur:function(a){this.trigger("blur",this)}},initialize:function(a){d.editors.Base.prototype.initialize.call(this,a);var b=this.schema,c="text";b&&b.editorAttrs&&b.editorAttrs.type&&(c=b.editorAttrs.type),b&&b.dataType&&(c=b.dataType),this.$el.attr("type",c)},render:function(){return this.setValue(this.value),this},determineChange:function(a){var b=this.$el.val(),c=b!==this.previousValue;c&&(this.previousValue=b,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(a){this.$el.val(a)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},select:function(){this.$el.select()}}),d.editors.TextArea=d.editors.Text.extend({tagName:"textarea",initialize:function(a){d.editors.Base.prototype.initialize.call(this,a)}}),d.editors.Password=d.editors.Text.extend({initialize:function(a){d.editors.Text.prototype.initialize.call(this,a),this.$el.attr("type","password")}}),d.editors.Number=d.editors.Text.extend({defaultValue:0,events:b.extend({},d.editors.Text.prototype.events,{
keypress:"onKeyPress",change:"onKeyPress"}),initialize:function(a){d.editors.Text.prototype.initialize.call(this,a);var b=this.schema;this.$el.attr("type","number"),b&&b.editorAttrs&&b.editorAttrs.step||this.$el.attr("step","any")},onKeyPress:function(a){var b=this,c=function(){setTimeout(function(){b.determineChange()},0)};if(0===a.charCode)return void c();var d=this.$el.val();void 0!=a.charCode&&(d+=String.fromCharCode(a.charCode));var e=/^[0-9]*\.?[0-9]*?$/.test(d);e?c():a.preventDefault()},getValue:function(){var a=this.$el.val();return""===a?null:parseFloat(a,10)},setValue:function(a){a=function(){return b.isNumber(a)?a:b.isString(a)&&""!==a?parseFloat(a,10):null}(),b.isNaN(a)&&(a=null),d.editors.Text.prototype.setValue.call(this,a)}}),d.editors.Hidden=d.editors.Text.extend({defaultValue:"",noField:!0,initialize:function(a){d.editors.Text.prototype.initialize.call(this,a),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),d.editors.Checkbox=d.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(a){this.trigger("change",this)},focus:function(a){this.trigger("focus",this)},blur:function(a){this.trigger("blur",this)}},initialize:function(a){d.editors.Base.prototype.initialize.call(this,a),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(a){a?this.$el.prop("checked",!0):this.$el.prop("checked",!1)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()}}),d.editors.Select=d.editors.Base.extend({tagName:"select",previousValue:"",events:{keyup:"determineChange",keypress:function(a){var b=this;setTimeout(function(){b.determineChange()},0)},change:function(a){this.trigger("change",this)},focus:function(a){this.trigger("focus",this)},blur:function(a){this.trigger("blur",this)}},initialize:function(a){if(d.editors.Base.prototype.initialize.call(this,a),!this.schema||!this.schema.options)throw new Error("Missing required 'schema.options'")},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(a){var d=this;if(a instanceof c.Collection){var e=a;e.length>0?this.renderOptions(a):e.fetch({success:function(b){d.renderOptions(a)}})}else b.isFunction(a)?a(function(a){d.renderOptions(a)},d):this.renderOptions(a)},renderOptions:function(a){var b,c=this.$el;b=this._getOptionsHtml(a),c.html(b),this.setValue(this.value)},_getOptionsHtml:function(a){var d;if(b.isString(a))d=a;else if(b.isArray(a))d=this._arrayToHtml(a);else if(a instanceof c.Collection)d=this._collectionToHtml(a);else if(b.isFunction(a)){var e;a(function(a){e=a},this),d=this._getOptionsHtml(e)}else d=this._objectToHtml(a);return d},determineChange:function(a){var b=this.getValue(),c=b!==this.previousValue;c&&(this.previousValue=b,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(a){this.$el.val(a)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},_collectionToHtml:function(a){var b=[];a.each(function(a){b.push({val:a.id,label:a.toString()})});var c=this._arrayToHtml(b);return c},_objectToHtml:function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push({val:c,label:a[c]});var d=this._arrayToHtml(b);return d},_arrayToHtml:function(a){var c=$();return b.each(a,function(a){if(b.isObject(a))if(a.group){var d=$("<optgroup>").attr("label",a.group).html(this._getOptionsHtml(a.options));c=c.add(d)}else{var e=a.val||0===a.val?a.val:"";c=c.add($("<option>").val(e).text(a.label))}else c=c.add($("<option>").text(a))},this),c}}),d.editors.Radio=d.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=radio]":function(){if(this.hasFocus){var a=this;setTimeout(function(){a.$("input[type=radio]:focus")[0]||a.trigger("blur",a)},0)}}},getTemplate:function(){return this.schema.template||this.constructor.template},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(a){this.$("input[type=radio]").val([a])},focus:function(){if(!this.hasFocus){var a=this.$("input[type=radio]:checked");return a[0]?void a.focus():void this.$("input[type=radio]").first().focus()}},blur:function(){this.hasFocus&&this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(a){var c=this,d=this.getTemplate(),e=c.getName(),f=c.id,g=b.map(a,function(a,c){var d={name:e,id:f+"-"+c};return b.isObject(a)?(d.value=a.val||0===a.val?a.val:"",d.label=a.label,d.labelHTML=a.labelHTML):(d.value=a,d.label=a),d});return d({items:g})}},{template:b.template('    <% _.each(items, function(item) { %>      <li>        <input type="radio" name="<%= item.name %>" value="<%- item.value %>" id="<%= item.id %>" />        <label for="<%= item.id %>"><% if (item.labelHTML){ %><%= item.labelHTML %><% }else{ %><%- item.label %><% } %></label>      </li>    <% }); %>  ',null,d.templateSettings)}),d.editors.Checkboxes=d.editors.Select.extend({tagName:"ul",groupNumber:0,events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(this.hasFocus){var a=this;setTimeout(function(){a.$("input[type=checkbox]:focus")[0]||a.trigger("blur",a)},0)}}},getValue:function(){var a=[];return this.$("input[type=checkbox]:checked").each(function(){a.push($(this).val())}),a},setValue:function(a){b.isArray(a)||(a=[a]),this.$("input[type=checkbox]").val(a)},focus:function(){this.hasFocus||this.$("input[type=checkbox]").first().focus()},blur:function(){this.hasFocus&&this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(a){var c=$(),d=this;return b.each(a,function(a,e){var f=$("<li>");if(b.isObject(a))if(a.group){var g=d.id;d.id+="-"+d.groupNumber++,f=$('<fieldset class="group">').append($("<legend>").text(a.group)),f=f.append(d._arrayToHtml(a.options)),d.id=g,close=!1}else{var h=a.val||0===a.val?a.val:"";f.append($('<input type="checkbox" name="'+d.getName()+'" id="'+d.id+"-"+e+'" />').val(h)),a.labelHTML?f.append($('<label for="'+d.id+"-"+e+'">').html(a.labelHTML)):f.append($('<label for="'+d.id+"-"+e+'">').text(a.label))}else f.append($('<input type="checkbox" name="'+d.getName()+'" id="'+d.id+"-"+e+'" />').val(a)),f.append($('<label for="'+d.id+"-"+e+'">').text(a));c=c.add(f)}),c}}),d.editors.Object=d.editors.Base.extend({hasNestedForm:!0,initialize:function(a){if(this.value={},d.editors.Base.prototype.initialize.call(this,a),!this.form)throw new Error('Missing required option "form"');if(!this.schema.subSchema)throw new Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var a=this.form.constructor;return this.nestedForm=new a({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:a.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(a){this.value=a,this.render()},focus:function(){this.hasFocus||this.nestedForm.focus()},blur:function(){this.hasFocus&&this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),c.View.prototype.remove.call(this)},validate:function(){var a=b.extend({},d.editors.Base.prototype.validate.call(this),this.nestedForm.validate());return b.isEmpty(a)?!1:a},_observeFormEvents:function(){this.nestedForm&&this.nestedForm.on("all",function(){var a=b.toArray(arguments);a[1]=this,this.trigger.apply(this,a)},this)}}),d.editors.NestedModel=d.editors.Object.extend({initialize:function(a){if(d.editors.Base.prototype.initialize.call(this,a),!this.form)throw new Error('Missing required option "form"');if(!a.schema.model)throw new Error('Missing required "schema.model" option for NestedModel editor')},render:function(){var a=this.form.constructor,b=this.value||{},c=(this.key,this.schema.model),d=b.constructor===c?b:new c(b);return this.nestedForm=new a({model:d,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var a=this.nestedForm.commit();return a?(this.$el.addClass("error"),a):d.editors.Object.prototype.commit.call(this)}}),d.editors.Date=d.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var a=this;setTimeout(function(){a.$("select:focus")[0]||a.trigger("blur",a)},0)}}},initialize:function(a){a=a||{},d.editors.Base.prototype.initialize.call(this,a);var c=d.editors.Date,e=new Date;if(this.options=b.extend({monthNames:c.monthNames,showMonthNames:c.showMonthNames},a),this.schema=b.extend({yearStart:e.getFullYear()-100,yearEnd:e.getFullYear()},a.schema||{}),this.value&&!b.isDate(this.value)&&(this.value=new Date(this.value)),!this.value){var f=new Date;f.setSeconds(0),f.setMilliseconds(0),this.value=f}this.template=a.template||this.constructor.template},render:function(){var a=this.options,d=this.schema,e=c.$,f=b.map(b.range(1,32),function(a){return'<option value="'+a+'">'+a+"</option>"}),g=b.map(b.range(0,12),function(b){var c=a.showMonthNames?a.monthNames[b]:b+1;return'<option value="'+b+'">'+c+"</option>"}),h=d.yearStart<d.yearEnd?b.range(d.yearStart,d.yearEnd+1):b.range(d.yearStart,d.yearEnd-1,-1),i=b.map(h,function(a){return'<option value="'+a+'">'+a+"</option>"}),j=e(e.trim(this.template({dates:f.join(""),months:g.join(""),years:i.join("")})));return this.$date=j.find('[data-type="date"]'),this.$month=j.find('[data-type="month"]'),this.$year=j.find('[data-type="year"]'),this.$hidden=e('<input type="hidden" name="'+this.key+'" />'),j.append(this.$hidden),this.setValue(this.value),this.setElement(j),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var a=this.$year.val(),b=this.$month.val(),c=this.$date.val();return a&&b&&c?new Date(a,b,c):null},setValue:function(a){this.$date.val(a.getDate()),this.$month.val(a.getMonth()),this.$year.val(a.getFullYear()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var a=this.getValue();b.isDate(a)&&(a=a.toISOString()),this.$hidden.val(a)}},{template:b.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,d.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),d.editors.DateTime=d.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var a=this;setTimeout(function(){a.$("select:focus")[0]||a.trigger("blur",a)},0)}}},initialize:function(a){a=a||{},d.editors.Base.prototype.initialize.call(this,a),this.options=b.extend({DateEditor:d.editors.DateTime.DateEditor},a),this.schema=b.extend({minsInterval:15},a.schema||{}),this.dateEditor=new this.options.DateEditor(a),this.value=this.dateEditor.value,this.template=a.template||this.constructor.template},render:function(){function a(a){return 10>a?"0"+a:a}var d=this.schema,e=c.$,f=b.map(b.range(0,24),function(b){return'<option value="'+b+'">'+a(b)+"</option>"}),g=b.map(b.range(0,60,d.minsInterval),function(b){return'<option value="'+b+'">'+a(b)+"</option>"}),h=e(e.trim(this.template({hours:f.join(),mins:g.join()})));return h.find("[data-date]").append(this.dateEditor.render().el),this.$hour=h.find('select[data-type="hour"]'),this.$min=h.find('select[data-type="min"]'),this.$hidden=h.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(h),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var a=this.dateEditor.getValue(),b=this.$hour.val(),c=this.$min.val();return a&&b&&c?(a.setHours(b),a.setMinutes(c),a):null},setValue:function(a){b.isDate(a)||(a=new Date(a)),this.dateEditor.setValue(a),this.$hour.val(a.getHours()),this.$min.val(a.getMinutes()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var a=this.getValue();b.isDate(a)&&(a=a.toISOString()),this.$hidden.val(a)},remove:function(){this.dateEditor.remove(),d.editors.Base.prototype.remove.call(this)}},{template:b.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,d.templateSettings),DateEditor:d.editors.Date}),d.VERSION="0.14.0",c.Form=d,"undefined"!=typeof module&&(module.exports=d)}(window||global||this),function(a){"use strict";var b=function(b,c){this.options=a.extend({},a.fn.editableform.defaults,c),this.$div=a(b),this.options.scope||(this.options.scope=this)};b.prototype={constructor:b,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=a(a.fn.editableform.template)},initButtons:function(){var b=this.$form.find(".editable-buttons");b.append(a.fn.editableform.buttons),"bottom"===this.options.showbuttons&&b.addClass("editable-buttons-bottom")},render:function(){this.$loading=a(a.fn.editableform.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(".editable-buttons").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler("rendering"),this.initInput(),this.$form.find("div.editable-input").append(this.input.$tpl),this.$div.append(this.$form),a.when(this.input.render()).then(a.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable-cancel").click(a.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(".editable-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(a){a.preventDefault()});else{this.error(!1),this.input.$input.removeAttr("disabled"),this.$form.find(".editable-submit").removeAttr("disabled");var b=null===this.value||void 0===this.value||""===this.value?this.options.defaultValue:this.value;this.input.value2input(b),this.$form.submit(a.proxy(this.submit,this))}this.$div.triggerHandler("rendered"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var a,b;this.$form?(a=this.$form.outerWidth(),b=this.$form.outerHeight(),a&&this.$loading.width(a),b&&this.$loading.height(b),this.$form.hide()):(a=this.$loading.parent().width(),a&&this.$loading.width(a)),this.$loading.show()},showForm:function(a){this.$loading.hide(),this.$form.show(),a!==!1&&this.input.activate(),this.$div.triggerHandler("show")},error:function(b){var c,d=this.$form.find(".control-group"),e=this.$form.find(".editable-error-block");if(b===!1)d.removeClass(a.fn.editableform.errorGroupClass),e.removeClass(a.fn.editableform.errorBlockClass).empty().hide();else{if(b){c=(""+b).split("\n");for(var f=0;f<c.length;f++)c[f]=a("<div>").text(c[f]).html();b=c.join("<br>")}d.addClass(a.fn.editableform.errorGroupClass),e.addClass(a.fn.editableform.errorBlockClass).html(b).show()}},submit:function(b){b.stopPropagation(),b.preventDefault();var c=this.input.input2value(),d=this.validate(c);if("object"===a.type(d)&&void 0!==d.newValue){if(c=d.newValue,this.input.value2input(c),"string"==typeof d.msg)return this.error(d.msg),void this.showForm()}else if(d)return this.error(d),void this.showForm();if(!this.options.savenochange&&this.input.value2str(c)===this.input.value2str(this.value))return void this.$div.triggerHandler("nochange");var e=this.input.value2submit(c);this.isSaving=!0,a.when(this.save(e)).done(a.proxy(function(a){this.isSaving=!1;var b="function"==typeof this.options.success?this.options.success.call(this.options.scope,a,c):null;return b===!1?(this.error(!1),void this.showForm(!1)):"string"==typeof b?(this.error(b),void this.showForm()):(b&&"object"==typeof b&&b.hasOwnProperty("newValue")&&(c=b.newValue),this.error(!1),this.value=c,void this.$div.triggerHandler("save",{newValue:c,submitValue:e,response:a}))},this)).fail(a.proxy(function(a){this.isSaving=!1;var b;b="function"==typeof this.options.error?this.options.error.call(this.options.scope,a,c):"string"==typeof a?a:a.responseText||a.statusText||"Unknown error!",this.error(b),this.showForm()},this))},save:function(b){this.options.pk=a.fn.editableutils.tryParseJson(this.options.pk,!0);var c,d="function"==typeof this.options.pk?this.options.pk.call(this.options.scope):this.options.pk,e=!!("function"==typeof this.options.url||this.options.url&&("always"===this.options.send||"auto"===this.options.send&&null!==d&&void 0!==d));return e?(this.showLoading(),c={name:this.options.name||"",value:b,pk:d},"function"==typeof this.options.params?c=this.options.params.call(this.options.scope,c):(this.options.params=a.fn.editableutils.tryParseJson(this.options.params,!0),a.extend(c,this.options.params)),"function"==typeof this.options.url?this.options.url.call(this.options.scope,c):a.ajax(a.extend({url:this.options.url,data:c,type:"POST"},this.options.ajaxOptions))):void 0},validate:function(a){return void 0===a&&(a=this.value),"function"==typeof this.options.validate?this.options.validate.call(this.options.scope,a):void 0},option:function(a,b){a in this.options&&(this.options[a]=b),"value"===a&&this.setValue(b)},setValue:function(a,b){b?this.value=this.input.str2value(a):this.value=a,this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}},a.fn.editableform=function(c){var d=arguments;return this.each(function(){var e=a(this),f=e.data("editableform"),g="object"==typeof c&&c;f||e.data("editableform",f=new b(this,g)),"string"==typeof c&&f[c].apply(f,Array.prototype.slice.call(d,1))})},a.fn.editableform.Constructor=b,a.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},a.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>',a.fn.editableform.loading='<div class="editableform-loading"></div>',a.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>',a.fn.editableform.errorGroupClass=null,a.fn.editableform.errorBlockClass="editable-error",a.fn.editableform.engine="jquery"}(window.jQuery),function(a){"use strict";a.fn.editableutils={inherit:function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype},setCursorPosition:function(a,b){if(a.setSelectionRange)a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},tryParseJson:function(a,b){if("string"==typeof a&&a.length&&a.match(/^[\{\[].*[\}\]]$/))if(b)try{a=new Function("return "+a)()}catch(c){}finally{return a}else a=new Function("return "+a)();return a},sliceObj:function(b,c,d){var e,f,g={};if(!a.isArray(c)||!c.length)return g;for(var h=0;h<c.length;h++)e=c[h],b.hasOwnProperty(e)&&(g[e]=b[e]),d!==!0&&(f=e.toLowerCase(),b.hasOwnProperty(f)&&(g[e]=b[f]));return g},getConfigData:function(b){var c={};return a.each(b.data(),function(a,b){("object"!=typeof b||b&&"object"==typeof b&&(b.constructor===Object||b.constructor===Array))&&(c[a]=b)}),c},objectKeys:function(a){if(Object.keys)return Object.keys(a);if(a!==Object(a))throw new TypeError("Object.keys called on a non-object");var b,c=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c},escape:function(b){return a("<div>").text(b).html()},itemsByValue:function(b,c,d){if(!c||null===b)return[];if("function"!=typeof d){var e=d||"value";d=function(a){return a[e]}}var f=a.isArray(b),g=[],h=this;return a.each(c,function(c,e){if(e.children)g=g.concat(h.itemsByValue(b,e.children,d));else if(f)a.grep(b,function(a){return a==(e&&"object"==typeof e?d(e):e)}).length&&g.push(e);else{var i=e&&"object"==typeof e?d(e):e;b==i&&g.push(e)}}),g},createInput:function(b){var c,d,e,f=b.type;return"date"===f&&("inline"===b.mode?a.fn.editabletypes.datefield?f="datefield":a.fn.editabletypes.dateuifield&&(f="dateuifield"):a.fn.editabletypes.date?f="date":a.fn.editabletypes.dateui&&(f="dateui"),"date"!==f||a.fn.editabletypes.date||(f="combodate")),"datetime"===f&&"inline"===b.mode&&(f="datetimefield"),"wysihtml5"!==f||a.fn.editabletypes[f]||(f="textarea"),"function"==typeof a.fn.editabletypes[f]?(c=a.fn.editabletypes[f],d=this.sliceObj(b,this.objectKeys(c.defaults)),e=new c(d)):(a.error("Unknown type: "+f),!1)},supportsTransitions:function(){var a=document.body||document.documentElement,b=a.style,c="transition",d=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof b[c])return!0;c=c.charAt(0).toUpperCase()+c.substr(1);for(var e=0;e<d.length;e++)if("string"==typeof b[d[e]+c])return!0;return!1}}}(window.jQuery),function(a){"use strict";var b=function(a,b){this.init(a,b)},c=function(a,b){this.init(a,b)};b.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(c,d){this.$element=a(c),this.options=a.extend({},a.fn.editableContainer.defaults,d),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on("destroyed",a.proxy(function(){this.destroy()},this)),a(document).data("editable-handlers-attached")||(a(document).on("keyup.editable",function(b){27===b.which&&a(".editable-open").editableContainer("hide")}),a(document).on("click.editable",function(c){var d,e=a(c.target),f=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!a(".select2-drop-mask").is(":visible")&&a.contains(document.documentElement,c.target)&&!e.is(document)){for(d=0;d<f.length;d++)if(e.is(f[d])||e.parents(f[d]).length)return;b.prototype.closeOthers(c.target)}}),a(document).data("editable-handlers-attached",!0))},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!a.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var b in this.options)b in this.defaults?this.containerOptions[b]=this.options[b]:this.formOptions[b]=this.options[b]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var a;return this.containerDataName&&(a=this.$element.data(this.containerDataName))?a:a=this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:a.proxy(this.save,this),nochange:a.proxy(function(){this.hide("nochange")},this),cancel:a.proxy(function(){this.hide("cancel")},this),show:a.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:a.proxy(this.setPosition,this),resize:a.proxy(this.setPosition,this),rendered:a.proxy(function(){this.$element.triggerHandler("shown",a(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(b){this.$element.addClass("editable-open"),b!==!1&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=a("<div>"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(a){if(this.tip()&&this.tip().is(":visible")&&this.$element.hasClass("editable-open")){if(this.$form.data("editableform").isSaving)return void(this.delayedHide={reason:a});this.delayedHide=!1,this.$element.removeClass("editable-open"),this.innerHide(),this.$element.triggerHandler("hidden",a||"manual")}},innerShow:function(){},innerHide:function(){},toggle:function(a){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(a)},setPosition:function(){},save:function(a,b){this.$element.triggerHandler("save",b),this.hide("save")},option:function(a,b){this.options[a]=b,a in this.containerOptions?(this.containerOptions[a]=b,this.setContainerOption(a,b)):(this.formOptions[a]=b,this.$form&&this.$form.editableform("option",a,b))},setContainerOption:function(a,b){this.call("option",a,b)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off("destroyed"),this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(b){a(".editable-open").each(function(c,d){if(d!==b&&!a(d).find(b).length){var e=a(d),f=e.data("editableContainer");f&&("cancel"===f.options.onblur?e.data("editableContainer").hide("onblur"):"submit"===f.options.onblur&&e.data("editableContainer").tip().find("form").submit())}})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editableform").input.activate()}},a.fn.editableContainer=function(d){var e=arguments;return this.each(function(){var f=a(this),g="editableContainer",h=f.data(g),i="object"==typeof d&&d,j="inline"===i.mode?c:b;h||f.data(g,h=new j(this,i)),"string"==typeof d&&h[d].apply(h,Array.prototype.slice.call(e,1))})},a.fn.editableContainer.Popup=b,a.fn.editableContainer.Inline=c,a.fn.editableContainer.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"},jQuery.event.special.destroyed={remove:function(a){a.handler&&a.handler()}}}(window.jQuery),function(a){"use strict";a.extend(a.fn.editableContainer.Inline.prototype,a.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=a("<span></span>"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,a.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},a.fn.editable.defaults,c,a.fn.editableutils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!a.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};b.prototype={constructor:b,init:function(){var b,c=!1;if(this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=a.fn.editableutils.createInput(this.options),this.input){switch(void 0===this.options.value||null===this.options.value?(this.value=this.input.html2value(a.trim(this.$element.html())),c=!0):(this.options.value=a.fn.editableutils.tryParseJson(this.options.value,!0),"string"==typeof this.options.value?this.value=this.input.str2value(this.options.value):this.value=this.options.value),this.$element.addClass("editable"),"textarea"===this.input.type&&this.$element.addClass("editable-pre-wrapped"),"manual"!==this.options.toggle?(this.$element.addClass("editable-click"),this.$element.on(this.options.toggle+".editable",a.proxy(function(a){if(this.options.disabled||a.preventDefault(),"mouseenter"===this.options.toggle)this.show();else{var b="click"!==this.options.toggle;this.toggle(b)}},this))):this.$element.attr("tabindex",-1),"function"==typeof this.options.display&&(this.options.autotext="always"),this.options.autotext){case"always":b=!0;break;case"auto":b=!a.trim(this.$element.text()).length&&null!==this.value&&void 0!==this.value&&!c;break;default:b=!1}a.when(b?this.render():!0).then(a.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler("init",this)},this))}},initLive:function(){var b=this.options.selector;this.options.selector=!1,this.options.autotext="never",this.$element.on(this.options.toggle+".editable",b,a.proxy(function(b){var c=a(b.target);c.data("editable")||(c.hasClass(this.options.emptyclass)&&c.empty(),c.editable(this.options).trigger(b))},this))},render:function(a){return this.options.display!==!1?this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,a):"function"==typeof this.options.display?this.options.display.call(this.$element[0],this.value,a):this.input.value2html(this.value,this.$element[0]):void 0},enable:function(){this.options.disabled=!1,this.$element.removeClass("editable-disabled"),this.handleEmpty(this.isEmpty),"manual"!==this.options.toggle&&"-1"===this.$element.attr("tabindex")&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass("editable-disabled"),this.handleEmpty(this.isEmpty),this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(b,c){return b&&"object"==typeof b?void a.each(b,a.proxy(function(b,c){this.option(a.trim(b),c)},this)):(this.options[b]=c,"disabled"===b?c?this.disable():this.enable():("value"===b&&this.setValue(c),this.container&&this.container.option(b,c),void(this.input.option&&this.input.option(b,c))))},handleEmpty:function(b){this.options.display!==!1&&(void 0!==b?this.isEmpty=b:"function"==typeof this.input.isEmpty?this.isEmpty=this.input.isEmpty(this.$element):this.isEmpty=""===a.trim(this.$element.html()),this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(b){if(!this.options.disabled){if(this.container){if(this.container.tip().is(":visible"))return}else{var c=a.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(c),this.$element.on("save.internal",a.proxy(this.save,this)),this.container=this.$element.data("editableContainer")}this.container.show(b)}},hide:function(){this.container&&this.container.hide()},toggle:function(a){this.container&&this.container.tip().is(":visible")?this.hide():this.show(a)},save:function(a,b){if(this.options.unsavedclass){var c=!1;c=c||"function"==typeof this.options.url,c=c||this.options.display===!1,c=c||void 0!==b.response,c=c||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(b.newValue),c?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var d=this.$element,e=d.css("background-color");d.css("background-color",this.options.highlight),setTimeout(function(){"transparent"===e&&(e=""),d.css("background-color",e),d.addClass("editable-bg-transition"),
setTimeout(function(){d.removeClass("editable-bg-transition")},1700)},10)}this.setValue(b.newValue,!1,b.response)},validate:function(){return"function"==typeof this.options.validate?this.options.validate.call(this,this.value):void 0},setValue:function(b,c,d){c?this.value=this.input.str2value(b):this.value=b,this.container&&this.container.option("value",this.value),a.when(this.render(d)).then(a.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),"manual"!==this.options.toggle&&(this.$element.removeClass("editable-click"),this.$element.off(this.options.toggle+".editable")),this.$element.off("save.internal"),this.$element.removeClass("editable editable-open editable-disabled"),this.$element.removeData("editable")}},a.fn.editable=function(c){var d={},e=arguments,f="editable";switch(c){case"validate":return this.each(function(){var b,c=a(this),e=c.data(f);e&&(b=e.validate())&&(d[e.options.name]=b)}),d;case"getValue":return 2===arguments.length&&arguments[1]===!0?d=this.eq(0).data(f).value:this.each(function(){var b=a(this),c=b.data(f);c&&void 0!==c.value&&null!==c.value&&(d[c.options.name]=c.input.value2submit(c.value))}),d;case"submit":var g=arguments[1]||{},h=this,i=this.editable("validate");if(a.isEmptyObject(i)){var j={};if(1===h.length){var k=h.data("editable"),l={name:k.options.name||"",value:k.input.value2submit(k.value),pk:"function"==typeof k.options.pk?k.options.pk.call(k.options.scope):k.options.pk};"function"==typeof k.options.params?l=k.options.params.call(k.options.scope,l):(k.options.params=a.fn.editableutils.tryParseJson(k.options.params,!0),a.extend(l,k.options.params)),j={url:k.options.url,data:l,type:"POST"},g.success=g.success||k.options.success,g.error=g.error||k.options.error}else{var m=this.editable("getValue");j={url:g.url,data:m,type:"POST"}}j.success="function"==typeof g.success?function(a){g.success.call(h,a,g)}:a.noop,j.error="function"==typeof g.error?function(){g.error.apply(h,arguments)}:a.noop,g.ajaxOptions&&a.extend(j,g.ajaxOptions),g.data&&a.extend(j.data,g.data),a.ajax(j)}else"function"==typeof g.error&&g.error.call(h,i);return this}return this.each(function(){var d=a(this),g=d.data(f),h="object"==typeof c&&c;return h&&h.selector?void(g=new b(this,h)):(g||d.data(f,g=new b(this,h)),void("string"==typeof c&&g[c].apply(g,Array.prototype.slice.call(e,1))))})},a.fn.editable.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(a){"use strict";a.fn.editabletypes={};var b=function(){};b.prototype={init:function(b,c,d){this.type=b,this.options=a.extend({},d,c)},prerender:function(){this.$tpl=a(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(b,c){a(c)[this.options.escape?"text":"html"](a.trim(b))},html2value:function(b){return a("<div>").html(b).text()},value2str:function(a){return a},str2value:function(a){return a},value2submit:function(a){return a},value2input:function(a){this.$input.val(a)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(b){return a("<div>").text(b).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(a){void 0!==this.options[a]&&null!==this.options[a]&&this.$input.attr(a,this.options[a])},option:function(a,b){this.options[a]=b}},b.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0},a.extend(a.fn.editabletypes,{abstractinput:b})}(window.jQuery),function(a){"use strict";var b=function(a){};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){var b=a.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),b.resolve()},function(){this.error=this.options.sourceError,b.resolve()}),b.promise()},html2value:function(a){return null},value2html:function(b,c,d,e){var f=a.Deferred(),g=function(){"function"==typeof d?d.call(c,b,this.sourceData,e):this.value2htmlFinal(b,c),f.resolve()};return null===b?g.call(this):this.onSourceReady(g,function(){f.resolve()}),f.promise()},onSourceReady:function(b,c){var d;if(a.isFunction(this.options.source)?(d=this.options.source.call(this.options.scope),this.sourceData=null):d=this.options.source,this.options.sourceCache&&a.isArray(this.sourceData))return void b.call(this);try{d=a.fn.editableutils.tryParseJson(d,!1)}catch(e){return void c.call(this)}if("string"==typeof d){if(this.options.sourceCache){var f,g=d;if(a(document).data(g)||a(document).data(g,{}),f=a(document).data(g),f.loading===!1&&f.sourceData)return this.sourceData=f.sourceData,this.doPrepend(),void b.call(this);if(f.loading===!0)return f.callbacks.push(a.proxy(function(){this.sourceData=f.sourceData,this.doPrepend(),b.call(this)},this)),void f.err_callbacks.push(a.proxy(c,this));f.loading=!0,f.callbacks=[],f.err_callbacks=[]}var h=a.extend({url:d,type:"get",cache:!1,dataType:"json",success:a.proxy(function(d){f&&(f.loading=!1),this.sourceData=this.makeArray(d),a.isArray(this.sourceData)?(f&&(f.sourceData=this.sourceData,a.each(f.callbacks,function(){this.call()})),this.doPrepend(),b.call(this)):(c.call(this),f&&a.each(f.err_callbacks,function(){this.call()}))},this),error:a.proxy(function(){c.call(this),f&&(f.loading=!1,a.each(f.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);a.ajax(h)}else this.sourceData=this.makeArray(d),a.isArray(this.sourceData)?(this.doPrepend(),b.call(this)):c.call(this)},doPrepend:function(){null!==this.options.prepend&&void 0!==this.options.prepend&&(a.isArray(this.prependData)||(a.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=a.fn.editableutils.tryParseJson(this.options.prepend,!0),"string"==typeof this.options.prepend&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),a.isArray(this.prependData)&&a.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(a,b){},makeArray:function(b){var c,d,e,f,g=[];if(!b||"string"==typeof b)return null;if(a.isArray(b)){f=function(a,b){return d={value:a,text:b},c++>=2?!1:void 0};for(var h=0;h<b.length;h++)e=b[h],"object"==typeof e?(c=0,a.each(e,f),1===c?g.push(d):c>1&&(e.children&&(e.children=this.makeArray(e.children)),g.push(e))):g.push({value:e,text:e})}else a.each(b,function(a,b){g.push({value:a,text:b})});return g},option:function(a,b){this.options[a]=b,"source"===a&&(this.sourceData=null),"prepend"===a&&(this.prependData=null)}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null}),a.fn.editabletypes.list=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("text",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),this.$input.is("input,textarea")&&!this.$input.is('[type="checkbox"],[type="range"]')&&a.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=a('<span class="editable-clear-x"></span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(a.proxy(function(b){if(!~a.inArray(b.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var c=this;this.t=setTimeout(function(){c.toggleClear(b)},100)}},this)).parent().css("position","relative"),this.$clear.click(a.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(a){if(this.$clear){var b=this.$input.val().length,c=this.$clear.is(":visible");b&&!c&&this.$clear.show(),!b&&c&&this.$clear.hide()}},clear:function(){this.$clear.hide(),this.$input.val("").focus()}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0}),a.fn.editabletypes.text=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("textarea",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass(),this.setAttr("placeholder"),this.setAttr("rows"),this.$input.keydown(function(b){b.ctrlKey&&13===b.which&&a(this).closest("form").submit()})},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7}),a.fn.editabletypes.textarea=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("select",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.list),a.extend(b.prototype,{renderList:function(){this.$input.empty();var b=this.options.escape,c=function(d,e){var f;if(a.isArray(e))for(var g=0;g<e.length;g++)if(f={},e[g].children)f.label=e[g].text,d.append(c(a("<optgroup>",f),e[g].children));else{f.value=e[g].value,e[g].disabled&&(f.disabled=!0);var h=a("<option>",f);h[b?"text":"html"](e[g].text),d.append(h)}return d};c(this.$input,this.sourceData),this.setClass(),this.$input.on("keydown.editable",function(b){13===b.which&&a(this).closest("form").submit()})},value2htmlFinal:function(b,c){var d="",e=a.fn.editableutils.itemsByValue(b,this.sourceData);e.length&&(d=e[0].text),a.fn.editabletypes.abstractinput.prototype.value2html.call(this,d,c)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){a(this).closest("form").submit()})}}),b.defaults=a.extend({},a.fn.editabletypes.list.defaults,{tpl:"<select></select>"}),a.fn.editabletypes.select=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("checklist",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.list),a.extend(b.prototype,{renderList:function(){var b;if(this.$tpl.empty(),a.isArray(this.sourceData)){for(var c=0;c<this.sourceData.length;c++){b=a("<label>").append(a("<input>",{type:"checkbox",value:this.sourceData[c].value}));var d=a("<span>");d[this.options.escape?"text":"html"](" "+this.sourceData[c].text),b.append(d),a("<div>").append(b).appendTo(this.$tpl)}this.$input=this.$tpl.find('input[type="checkbox"]'),this.setClass()}},value2str:function(b){return a.isArray(b)?b.sort().join(a.trim(this.options.separator)):""},str2value:function(b){var c,d=null;return"string"==typeof b&&b.length?(c=new RegExp("\\s*"+a.trim(this.options.separator)+"\\s*"),d=b.split(c)):d=a.isArray(b)?b:[b],d},value2input:function(b){this.$input.prop("checked",!1),a.isArray(b)&&b.length&&this.$input.each(function(c,d){var e=a(d);a.each(b,function(a,b){e.val()==b&&e.prop("checked",!0)})})},input2value:function(){var b=[];return this.$input.filter(":checked").each(function(c,d){b.push(a(d).val())}),b},value2htmlFinal:function(b,c){var d=[],e=a.fn.editableutils.itemsByValue(b,this.sourceData),f=this.options.escape;e.length?(a.each(e,function(b,c){var e=f?a.fn.editableutils.escape(c.text):c.text;d.push(e)}),a(c).html(d.join("<br>"))):a(c).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(b){13===b.which&&a(this).closest("form").submit()})}}),b.defaults=a.extend({},a.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","}),a.fn.editabletypes.checklist=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("password",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),a.extend(b.prototype,{value2html:function(b,c){b?a(c).text("[hidden]"):a(c).empty()},html2value:function(a){return null}}),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type="password">'}),a.fn.editabletypes.password=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("email",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type="email">'}),a.fn.editabletypes.email=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("url",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type="url">'}),a.fn.editabletypes.url=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("tel",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'}),a.fn.editabletypes.tel=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("number",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.text),a.extend(b.prototype,{render:function(){b.superclass.render.call(this),this.setAttr("min"),this.setAttr("max"),this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),b.defaults=a.extend({},a.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null}),a.fn.editabletypes.number=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("range",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.number),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.setAttr("min"),this.setAttr("max"),this.setAttr("step"),this.$input.on("input",function(){a(this).siblings("output").text(a(this).val())})},activate:function(){this.$input.focus()}}),b.defaults=a.extend({},a.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"}),a.fn.editabletypes.range=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("time",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass()}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'}),a.fn.editabletypes.time=b}(window.jQuery),function(a){"use strict";var b=function(c){if(this.init("select2",c,b.defaults),c.select2=c.select2||{},this.sourceData=null,c.placeholder&&(c.select2.placeholder=c.placeholder),!c.select2.tags&&c.source){var d=c.source;a.isFunction(c.source)&&(d=c.source.call(c.scope)),"string"==typeof d?(c.select2.ajax=c.select2.ajax||{},c.select2.ajax.dataType||(c.select2.ajax.dataType="json"),c.select2.ajax.data||(c.select2.ajax.data=function(a){return{query:a}}),c.select2.ajax.processResults||(c.select2.ajax.processResults=function(a){return{results:a}}),c.select2.ajax.url=d):(this.sourceData=this.convertSource(d),c.select2.data=this.sourceData)}if(this.options.select2=a.extend({},b.defaults.select2,c.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote="ajax"in this.options.select2,this.idFunc=this.options.select2.id,"function"!=typeof this.idFunc){var e=this.idFunc||"id";this.idFunc=function(a){return a[e]}}this.formatSelection=this.options.select2.formatSelection,"function"!=typeof this.formatSelection&&(this.formatSelection=function(a){return a.text})};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on("select2-loaded",a.proxy(function(a){this.sourceData=a.items.results},this)),this.isMultiple&&this.$input.on("change",function(){a(this).closest("form").parent().triggerHandler("resize")})},value2html:function(c,d){var e,f="",g=this;this.options.select2.tags?e=c:this.sourceData&&(e=a.fn.editableutils.itemsByValue(c,this.sourceData,this.idFunc)),a.isArray(e)?(f=[],a.each(e,function(a,b){f.push(b&&"object"==typeof b?g.formatSelection(b):b)})):e&&(f=g.formatSelection(e)),f=a.isArray(f)?f.join(this.options.viewseparator):f,b.superclass.value2html.call(this,f,d)},html2value:function(a){return this.options.select2.tags?this.str2value(a,this.options.viewseparator):null},value2input:function(b){if(a.isArray(b)&&(b=b.join(this.getSeparator())),this.$input.data("select2")?this.$input.val(b).trigger("change",!0):(this.$input.val(b),this.$input.select2(this.options.select2)),this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var c=this.options.select2.id,d=this.options.select2.formatSelection;if(!c&&!d){var e=a(this.options.scope);if(!e.data("editable").isEmpty){var f={id:b,text:e.text()};this.$input.select2("data",f)}}}},input2value:function(){return this.$input.select2("val")},str2value:function(b,c){if("string"!=typeof b||!this.isMultiple)return b;c=c||this.getSeparator();var d,e,f;if(null===b||b.length<1)return null;for(d=b.split(c),e=0,f=d.length;f>e;e+=1)d[e]=a.trim(d[e]);return d},autosubmit:function(){this.$input.on("change",function(b,c){c||a(this).closest("form").submit()})},getSeparator:function(){return this.options.select2.separator||a.fn.select2.defaults.separator},convertSource:function(b){if(a.isArray(b)&&b.length&&void 0!==b[0].value)for(var c=0;c<b.length;c++)void 0!==b[c].value&&(b[c].id=b[c].value,delete b[c].value);return b},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "}),a.fn.editabletypes.select2=b}(window.jQuery),function(a){var b=function(b,c){return this.$element=a(b),this.$element.is("input")?(this.options=a.extend({},a.fn.combodate.defaults,c,this.$element.data()),void this.init()):void a.error("Combodate should be applied to INPUT element")};b.prototype={constructor:b,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]},this.$widget=a('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on("change","select",a.proxy(function(b){this.$element.val(this.getValue()).change(),this.options.smartDays&&(a(b.target).is(".month")||a(b.target).is(".year"))&&this.fillCombo("day")},this)),this.$widget.find("select").css("width","auto"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var b=this.options.template;return a.each(this.map,function(a,c){c=c[0];var d=new RegExp(c+"+"),e=c.length>1?c.substring(1,2):c;b=b.replace(d,"{"+e+"}")}),b=b.replace(/ /g,"&nbsp;"),a.each(this.map,function(a,c){c=c[0];var d=c.length>1?c.substring(1,2):c;b=b.replace("{"+d+"}",'<select class="'+a+'"></select>')}),b},initCombos:function(){for(var a in this.map){var b=this.$widget.find("."+a);this["$"+a]=b.length?b:null,this.fillCombo(a)}},fillCombo:function(a){var b=this["$"+a];if(b){var c="fill"+a.charAt(0).toUpperCase()+a.slice(1),d=this[c](),e=b.val();b.empty();for(var f=0;f<d.length;f++)b.append('<option value="'+d[f][0]+'">'+d[f][1]+"</option>");b.val(e)}},fillCommon:function(a){var b,c=[];if("name"===this.options.firstItem){b=moment.relativeTime||moment.langData()._relativeTime;var d="function"==typeof b[a]?b[a](1,!0,a,!1):b[a];d=d.split(" ").reverse()[0],c.push(["",d])}else"empty"===this.options.firstItem&&c.push(["",""]);return c},fillDay:function(){var a,b,c=this.fillCommon("d"),d=-1!==this.options.template.indexOf("DD"),e=31;if(this.options.smartDays&&this.$month&&this.$year){var f=parseInt(this.$month.val(),10),g=parseInt(this.$year.val(),10);isNaN(f)||isNaN(g)||(e=moment([g,f]).daysInMonth())}for(b=1;e>=b;b++)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillMonth:function(){var a,b,c=this.fillCommon("M"),d=-1!==this.options.template.indexOf("MMMM"),e=-1!==this.options.template.indexOf("MMM"),f=-1!==this.options.template.indexOf("MM");for(b=0;11>=b;b++)a=d?moment().date(1).month(b).format("MMMM"):e?moment().date(1).month(b).format("MMM"):f?this.leadZero(b+1):b+1,c.push([b,a]);return c},fillYear:function(){var a,b,c=[],d=-1!==this.options.template.indexOf("YYYY");for(b=this.options.maxYear;b>=this.options.minYear;b--)a=d?b:(b+"").substring(2),c[this.options.yearDescending?"push":"unshift"]([b,a]);return c=this.fillCommon("y").concat(c)},fillHour:function(){var a,b,c=this.fillCommon("h"),d=-1!==this.options.template.indexOf("h"),e=(-1!==this.options.template.indexOf("H"),-1!==this.options.template.toLowerCase().indexOf("hh")),f=d?1:0,g=d?12:23;for(b=f;g>=b;b++)a=e?this.leadZero(b):b,c.push([b,a]);return c},fillMinute:function(){var a,b,c=this.fillCommon("m"),d=-1!==this.options.template.indexOf("mm");for(b=0;59>=b;b+=this.options.minuteStep)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillSecond:function(){var a,b,c=this.fillCommon("s"),d=-1!==this.options.template.indexOf("ss");for(b=0;59>=b;b+=this.options.secondStep)a=d?this.leadZero(b):b,c.push([b,a]);return c},fillAmpm:function(){var a=-1!==this.options.template.indexOf("a"),b=(-1!==this.options.template.indexOf("A"),[["am",a?"am":"AM"],["pm",a?"pm":"PM"]]);return b},getValue:function(b){var c,d={},e=this,f=!1;return a.each(this.map,function(a,b){if("ampm"!==a){var c="day"===a?1:0;return d[a]=e["$"+a]?parseInt(e["$"+a].val(),10):c,isNaN(d[a])?(f=!0,!1):void 0}}),f?"":(this.$ampm&&(12===d.hour?d.hour="am"===this.$ampm.val()?0:12:d.hour="am"===this.$ampm.val()?d.hour:d.hour+12),c=moment([d.year,d.month,d.day,d.hour,d.minute,d.second]),this.highlight(c),b=void 0===b?this.options.format:b,null===b?c.isValid()?c:null:c.isValid()?c.format(b):"")},setValue:function(b){function c(b,c){var d={};return b.children("option").each(function(b,e){var f,g=a(e).attr("value");""!==g&&(f=Math.abs(g-c),("undefined"==typeof d.distance||f<d.distance)&&(d={value:g,distance:f}))}),d.value}if(b){var d="string"==typeof b?moment(b,this.options.format):moment(b),e=this,f={};d.isValid()&&(a.each(this.map,function(a,b){"ampm"!==a&&(f[a]=d[b[1]]())}),this.$ampm&&(f.hour>=12?(f.ampm="pm",f.hour>12&&(f.hour-=12)):(f.ampm="am",0===f.hour&&(f.hour=12))),a.each(f,function(a,b){e["$"+a]&&("minute"===a&&e.options.minuteStep>1&&e.options.roundTime&&(b=c(e["$"+a],b)),"second"===a&&e.options.secondStep>1&&e.options.roundTime&&(b=c(e["$"+a],b)),e["$"+a].val(b))}),this.options.smartDays&&this.fillCombo("day"),this.$element.val(d.format(this.options.format)).change())}},highlight:function(a){a.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(a){return 9>=a?"0"+a:a},destroy:function(){this.$widget.remove(),this.$element.removeData("combodate").show()}},a.fn.combodate=function(c){var d,e=Array.apply(null,arguments);return e.shift(),"getValue"===c&&this.length&&(d=this.eq(0).data("combodate"))?d.getValue.apply(d,e):this.each(function(){var d=a(this),f=d.data("combodate"),g="object"==typeof c&&c;f||d.data("combodate",f=new b(this,g)),"string"==typeof c&&"function"==typeof f[c]&&f[c].apply(f,e)})},a.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:(new Date).getFullYear(),yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0,smartDays:!1}}(window.jQuery),function(a){"use strict";var b=function(c){this.init("combodate",c,b.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),c.combodate=a.fn.editableutils.tryParseJson(c.combodate,!0),this.options.combodate=a.extend({},b.defaults.combodate,c.combodate,{format:this.options.format,template:this.options.template})};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.$input.combodate(this.options.combodate),"bs3"===a.fn.editableform.engine&&this.$input.siblings().find("select").addClass("form-control"),this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(a,c){var d=a?a.format(this.options.viewformat):"";b.superclass.value2html.call(this,d,c)},html2value:function(a){return a?moment(a,this.options.viewformat):null},value2str:function(a){return a?a.format(this.options.format):""},str2value:function(a){return a?moment(a,this.options.format):null},value2submit:function(a){return this.value2str(a)},value2input:function(a){this.$input.combodate("setValue",a)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null}),a.fn.editabletypes.combodate=b}(window.jQuery),function(a){"use strict";var b=a.fn.editableform.Constructor.prototype.initInput;a.extend(a.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=a(a.fn.editableform.template),this.$form.find(".control-group").addClass("form-group"),this.$form.find(".editable-error-block").addClass("help-block")},initInput:function(){b.apply(this);var c=null===this.input.options.inputclass||this.input.options.inputclass===!1,d="input-sm",e="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");~a.inArray(this.input.type,e)&&(this.input.$input.addClass("form-control"),c&&(this.input.options.inputclass=d,this.input.$input.addClass(d)));for(var f=this.$form.find(".editable-buttons"),g=c?[d]:this.input.options.inputclass.split(" "),h=0;h<g.length;h++)"input-lg"===g[h].toLowerCase()&&f.find("button").removeClass("btn-sm").addClass("btn-lg")}}),a.fn.editableform.buttons='<button type="submit" class="btn btn-primary btn-sm editable-submit"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="btn btn-default btn-sm editable-cancel"><i class="glyphicon glyphicon-remove"></i></button>',a.fn.editableform.errorGroupClass="has-error",a.fn.editableform.errorBlockClass=null,a.fn.editableform.engine="bs3"}(window.jQuery),function(a){"use strict";a.extend(a.fn.editableContainer.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:a.fn.popover.Constructor.DEFAULTS,initContainer:function(){a.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template});var b;this.$element.data("template")&&(b=this.$element.data("template"),this.$element.removeData("template")),this.call(this.containerOptions),b&&this.$element.data("template",b)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(a,b){this.container().options[a]=b},setPosition:function(){(function(){var a=this.tip(),b="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,d=c.test(b);d&&(b=b.replace(c,"")||"top");var e=this.getPosition(),f=a[0].offsetWidth,g=a[0].offsetHeight;if(d){var h=this.$element.parent(),i=b,j=document.documentElement.scrollTop||document.body.scrollTop,k="body"==this.options.container?window.innerWidth:h.outerWidth(),l="body"==this.options.container?window.innerHeight:h.outerHeight(),m="body"==this.options.container?0:h.offset().left;b="bottom"==b&&e.top+e.height+g-j>l?"top":"top"==b&&e.top-j-g<0?"bottom":"right"==b&&e.right+f>k?"left":"left"==b&&e.left-f<m?"right":b,a.removeClass(i).addClass(b)}var n=this.getCalculatedOffset(b,e,f,g);this.applyPlacement(n,b)}).call(this.container())}})}(window.jQuery),function(a){function b(){return new Date(Date.UTC.apply(Date,arguments))}function c(b,c){var d,e=a(b).data(),f={},g=new RegExp("^"+c.toLowerCase()+"([A-Z])"),c=new RegExp("^"+c.toLowerCase());for(var h in e)c.test(h)&&(d=h.replace(g,function(a,b){return b.toLowerCase()}),f[d]=e[h]);return f}function d(b){var c={};if(k[b]||(b=b.split("-")[0],k[b])){var d=k[b];return a.each(j,function(a,b){b in d&&(c[b]=d[b])}),c}}var e=function(b,c){this._process_options(c),this.element=a(b),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=a(l.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(a,b){return parseInt(b)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};e.prototype={constructor:e,_process_options:function(b){this._o=a.extend({},this._o,b);var c=this.o=a.extend({},this._o),d=c.language;switch(k[d]||(d=d.split("-")[0],k[d]||(d=i.language)),c.language=d,c.startView){case 2:case"decade":c.startView=2;break;case 1:case"year":c.startView=1;break;default:c.startView=0}switch(c.minViewMode){case 1:case"months":c.minViewMode=1;break;case 2:case"years":c.minViewMode=2;break;default:c.minViewMode=0}c.startView=Math.max(c.startView,c.minViewMode),c.weekStart%=7,c.weekEnd=(c.weekStart+6)%7;var e=l.parseFormat(c.format);c.startDate!==-(1/0)&&(c.startDate=l.parseDate(c.startDate,e,c.language)),c.endDate!==1/0&&(c.endDate=l.parseDate(c.endDate,e,c.language)),c.daysOfWeekDisabled=c.daysOfWeekDisabled||[],a.isArray(c.daysOfWeekDisabled)||(c.daysOfWeekDisabled=c.daysOfWeekDisabled.split(/[,\s]*/)),c.daysOfWeekDisabled=a.map(c.daysOfWeekDisabled,function(a){return parseInt(a,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(a){for(var b,c,d=0;d<a.length;d++)b=a[d][0],c=a[d][1],b.on(c)},_unapplyEvents:function(a){for(var b,c,d=0;d<a.length;d++)b=a[d][0],c=a[d][1],b.off(c)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}],[this.component,{click:a.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:a.proxy(this.click,this)}],[a(window),{resize:a.proxy(this.place,this)}],[a(document),{mousedown:a.proxy(function(a){this.element.is(a.target)||this.element.find(a.target).size()||this.picker.is(a.target)||this.picker.find(a.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(b,c){var d=c||this.date,e=new Date(d.getTime()+6e4*d.getTimezoneOffset());
this.element.trigger({type:b,date:e,format:a.proxy(function(a){var b=a||this.o.format;return l.formatDate(d,b,this.o.language)},this)})},show:function(a){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),a&&a.preventDefault(),this._trigger("show")},hide:function(a){this.isInline||this.picker.is(":visible")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var a=this.getUTCDate();return new Date(a.getTime()+6e4*a.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(a){this.setUTCDate(new Date(a.getTime()-6e4*a.getTimezoneOffset()))},setUTCDate:function(a){this.date=a,this.setValue()},setValue:function(){var a=this.getFormattedDate();this.isInput?this.element.val(a):this.component&&this.element.find("input").val(a)},getFormattedDate:function(a){return void 0===a&&(a=this.o.format),l.formatDate(this.date,a,this.o.language)},setStartDate:function(a){this._process_options({startDate:a}),this.update(),this.updateNavArrows()},setEndDate:function(a){this._process_options({endDate:a}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(a){this._process_options({daysOfWeekDisabled:a}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var b=parseInt(this.element.parents().filter(function(){return"auto"!=a(this).css("z-index")}).first().css("z-index"))+10,c=this.component?this.component.parent().offset():this.element.offset(),d=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:c.top+d,left:c.left,zIndex:b})}},_allow_update:!0,update:function(){if(this._allow_update){var a,b=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(a=arguments[0],b=!0):(a=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=l.parseDate(a,this.o.format,this.o.language),b&&this.setValue(),this.date<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.date>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=new Date(this.date),this.fill()}},fillDow:function(){var a=this.o.weekStart,b="<tr>";if(this.o.calendarWeeks){var c='<th class="cw">&nbsp;</th>';b+=c,this.picker.find(".datepicker-days thead tr:first-child").prepend(c)}for(;a<this.o.weekStart+7;)b+='<th class="dow">'+k[this.o.language].daysMin[a++%7]+"</th>";b+="</tr>",this.picker.find(".datepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=0;12>b;)a+='<span class="month">'+k[this.o.language].monthsShort[b++]+"</span>";this.picker.find(".datepicker-months td").html(a)},setRange:function(b){b&&b.length?this.range=a.map(b,function(a){return a.valueOf()}):delete this.range,this.fill()},getClassNames:function(b){var c=[],d=this.viewDate.getUTCFullYear(),e=this.viewDate.getUTCMonth(),f=this.date.valueOf(),g=new Date;return b.getUTCFullYear()<d||b.getUTCFullYear()==d&&b.getUTCMonth()<e?c.push("old"):(b.getUTCFullYear()>d||b.getUTCFullYear()==d&&b.getUTCMonth()>e)&&c.push("new"),this.o.todayHighlight&&b.getUTCFullYear()==g.getFullYear()&&b.getUTCMonth()==g.getMonth()&&b.getUTCDate()==g.getDate()&&c.push("today"),f&&b.valueOf()==f&&c.push("active"),(b.valueOf()<this.o.startDate||b.valueOf()>this.o.endDate||-1!==a.inArray(b.getUTCDay(),this.o.daysOfWeekDisabled))&&c.push("disabled"),this.range&&(b>this.range[0]&&b<this.range[this.range.length-1]&&c.push("range"),-1!=a.inArray(b.valueOf(),this.range)&&c.push("selected")),c},fill:function(){var c,d=new Date(this.viewDate),e=d.getUTCFullYear(),f=d.getUTCMonth(),g=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),h=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),i=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,j=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf();this.picker.find(".datepicker-days thead th.datepicker-switch").text(k[this.o.language].months[f]+" "+e),this.picker.find("tfoot th.today").text(k[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.clear").text(k[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var m=b(e,f-1,28,0,0,0,0),n=l.getDaysInMonth(m.getUTCFullYear(),m.getUTCMonth());m.setUTCDate(n),m.setUTCDate(n-(m.getUTCDay()-this.o.weekStart+7)%7);var o=new Date(m);o.setUTCDate(o.getUTCDate()+42),o=o.valueOf();for(var p,q=[];m.valueOf()<o;){if(m.getUTCDay()==this.o.weekStart&&(q.push("<tr>"),this.o.calendarWeeks)){var r=new Date(+m+(this.o.weekStart-m.getUTCDay()-7)%7*864e5),s=new Date(+r+(11-r.getUTCDay())%7*864e5),t=new Date(+(t=b(s.getUTCFullYear(),0,1))+(11-t.getUTCDay())%7*864e5),u=(s-t)/864e5/7+1;q.push('<td class="cw">'+u+"</td>")}p=this.getClassNames(m),p.push("day");var v=this.o.beforeShowDay(m);void 0===v?v={}:"boolean"==typeof v?v={enabled:v}:"string"==typeof v&&(v={classes:v}),v.enabled===!1&&p.push("disabled"),v.classes&&(p=p.concat(v.classes.split(/\s+/))),v.tooltip&&(c=v.tooltip),p=a.unique(p),q.push('<td class="'+p.join(" ")+'"'+(c?' title="'+c+'"':"")+">"+m.getUTCDate()+"</td>"),m.getUTCDay()==this.o.weekEnd&&q.push("</tr>"),m.setUTCDate(m.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(q.join(""));var w=this.date&&this.date.getUTCFullYear(),x=this.picker.find(".datepicker-months").find("th:eq(1)").text(e).end().find("span").removeClass("active");w&&w==e&&x.eq(this.date.getUTCMonth()).addClass("active"),(g>e||e>i)&&x.addClass("disabled"),e==g&&x.slice(0,h).addClass("disabled"),e==i&&x.slice(j+1).addClass("disabled"),q="",e=10*parseInt(e/10,10);var y=this.picker.find(".datepicker-years").find("th:eq(1)").text(e+"-"+(e+9)).end().find("td");e-=1;for(var z=-1;11>z;z++)q+='<span class="year'+(-1==z?" old":10==z?" new":"")+(w==e?" active":"")+(g>e||e>i?" disabled":"")+'">'+e+"</span>",e+=1;y.html(q)},updateNavArrows:function(){if(this._allow_update){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()&&c<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()&&c>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-(1/0)&&b<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&b>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(c){c.preventDefault();var d=a(c.target).closest("span, td, th");if(1==d.length)switch(d[0].nodeName.toLowerCase()){case"th":switch(d[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var e=l.modes[this.viewMode].navStep*("prev"==d[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,e);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,e)}this.fill();break;case"today":var f=new Date;f=b(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0),this.showMode(-2);var g="linked"==this.o.todayBtn?null:"view";this._setDate(f,g);break;case"clear":var h;this.isInput?h=this.element:this.component&&(h=this.element.find("input")),h&&h.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!d.is(".disabled")){if(this.viewDate.setUTCDate(1),d.is(".month")){var i=1,j=d.parent().find("span").index(d),k=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(j),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(b(k,j,i,0,0,0,0))}else{var k=parseInt(d.text(),10)||0,i=1,j=0;this.viewDate.setUTCFullYear(k),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(b(k,j,i,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(d.is(".day")&&!d.is(".disabled")){var i=parseInt(d.text(),10)||1,k=this.viewDate.getUTCFullYear(),j=this.viewDate.getUTCMonth();d.is(".old")?0===j?(j=11,k-=1):j-=1:d.is(".new")&&(11==j?(j=0,k+=1):j+=1),this._setDate(b(k,j,i,0,0,0,0))}}},_setDate:function(a,b){b&&"date"!=b||(this.date=new Date(a)),b&&"view"!=b||(this.viewDate=new Date(a)),this.fill(),this.setValue(),this._trigger("changeDate");var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input")),c&&(c.change(),!this.o.autoclose||b&&"date"!=b||this.hide())},moveMonth:function(a,b){if(!b)return a;var c,d,e=new Date(a.valueOf()),f=e.getUTCDate(),g=e.getUTCMonth(),h=Math.abs(b);if(b=b>0?1:-1,1==h)d=-1==b?function(){return e.getUTCMonth()==g}:function(){return e.getUTCMonth()!=c},c=g+b,e.setUTCMonth(c),(0>c||c>11)&&(c=(c+12)%12);else{for(var i=0;h>i;i++)e=this.moveMonth(e,b);c=e.getUTCMonth(),e.setUTCDate(f),d=function(){return c!=e.getUTCMonth()}}for(;d();)e.setUTCDate(--f),e.setUTCMonth(c);return e},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.o.startDate&&a<=this.o.endDate},keydown:function(a){if(this.picker.is(":not(:visible)"))return void(27==a.keyCode&&this.show());var b,c,d,e=!1;switch(a.keyCode){case 27:this.hide(),a.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;b=37==a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):a.shiftKey?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):(c=new Date(this.date),c.setUTCDate(this.date.getUTCDate()+b),d=new Date(this.viewDate),d.setUTCDate(this.viewDate.getUTCDate()+b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;b=38==a.keyCode?-1:1,a.ctrlKey?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):a.shiftKey?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):(c=new Date(this.date),c.setUTCDate(this.date.getUTCDate()+7*b),d=new Date(this.viewDate),d.setUTCDate(this.viewDate.getUTCDate()+7*b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 13:this.hide(),a.preventDefault();break;case 9:this.hide()}if(e){this._trigger("changeDate");var f;this.isInput?f=this.element:this.component&&(f=this.element.find("input")),f&&f.change()}},showMode:function(a){a&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+a))),this.picker.find(">div").hide().filter(".datepicker-"+l.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var f=function(b,c){this.element=a(b),this.inputs=a.map(c.inputs,function(a){return a.jquery?a[0]:a}),delete c.inputs,a(this.inputs).datepicker(c).bind("changeDate",a.proxy(this.dateUpdated,this)),this.pickers=a.map(this.inputs,function(b){return a(b).data("datepicker")}),this.updateDates()};f.prototype={updateDates:function(){this.dates=a.map(this.pickers,function(a){return a.date}),this.updateRanges()},updateRanges:function(){var b=a.map(this.dates,function(a){return a.valueOf()});a.each(this.pickers,function(a,c){c.setRange(b)})},dateUpdated:function(b){var c=a(b.target).data("datepicker"),d=c.getUTCDate(),e=a.inArray(b.target,this.inputs),f=this.inputs.length;if(-1!=e){if(d<this.dates[e])for(;e>=0&&d<this.dates[e];)this.pickers[e--].setUTCDate(d);else if(d>this.dates[e])for(;f>e&&d>this.dates[e];)this.pickers[e++].setUTCDate(d);this.updateDates()}},remove:function(){a.map(this.pickers,function(a){a.remove()}),delete this.element.data().datepicker}};var g=a.fn.datepicker,h=a.fn.datepicker=function(b){var g=Array.apply(null,arguments);g.shift();var h;return this.each(function(){var j=a(this),k=j.data("datepicker"),l="object"==typeof b&&b;if(!k){var m=c(this,"date"),n=a.extend({},i,m,l),o=d(n.language),p=a.extend({},i,o,m,l);if(j.is(".input-daterange")||p.inputs){var q={inputs:p.inputs||j.find("input").toArray()};j.data("datepicker",k=new f(this,a.extend(p,q)))}else j.data("datepicker",k=new e(this,p))}return"string"==typeof b&&"function"==typeof k[b]&&(h=k[b].apply(k,g),void 0!==h)?!1:void 0}),void 0!==h?h:this},i=a.fn.datepicker.defaults={autoclose:!1,beforeShowDay:a.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},j=a.fn.datepicker.locale_opts=["format","rtl","weekStart"];a.fn.datepicker.Constructor=e;var k=a.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},l={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,l.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(a){var b=a.replace(this.validParts,"\x00").split("\x00"),c=a.match(this.validParts);if(!b||!b.length||!c||0===c.length)throw new Error("Invalid date format.");return{separators:b,parts:c}},parseDate:function(c,d,f){if(c instanceof Date)return c;if("string"==typeof d&&(d=l.parseFormat(d)),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(c)){var g,h,i=/([\-+]\d+)([dmwy])/,j=c.match(/([\-+]\d+)([dmwy])/g);c=new Date;for(var m=0;m<j.length;m++)switch(g=i.exec(j[m]),h=parseInt(g[1]),g[2]){case"d":c.setUTCDate(c.getUTCDate()+h);break;case"m":c=e.prototype.moveMonth.call(e.prototype,c,h);break;case"w":c.setUTCDate(c.getUTCDate()+7*h);break;case"y":c=e.prototype.moveYear.call(e.prototype,c,h)}return b(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate(),0,0,0)}var n,o,g,j=c&&c.match(this.nonpunctuation)||[],c=new Date,p={},q=["yyyy","yy","M","MM","m","mm","d","dd"],r={yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2e3+b)},m:function(a,b){for(b-=1;0>b;)b+=12;for(b%=12,a.setUTCMonth(b);a.getUTCMonth()!=b;)a.setUTCDate(a.getUTCDate()-1);return a},d:function(a,b){return a.setUTCDate(b)}};r.M=r.MM=r.mm=r.m,r.dd=r.d,c=b(c.getFullYear(),c.getMonth(),c.getDate(),0,0,0);var s=d.parts.slice();if(j.length!=s.length&&(s=a(s).filter(function(b,c){return-1!==a.inArray(c,q)}).toArray()),j.length==s.length){for(var m=0,t=s.length;t>m;m++){if(n=parseInt(j[m],10),g=s[m],isNaN(n))switch(g){case"MM":o=a(k[f].months).filter(function(){var a=this.slice(0,j[m].length),b=j[m].slice(0,a.length);return a==b}),n=a.inArray(o[0],k[f].months)+1;break;case"M":o=a(k[f].monthsShort).filter(function(){var a=this.slice(0,j[m].length),b=j[m].slice(0,a.length);return a==b}),n=a.inArray(o[0],k[f].monthsShort)+1}p[g]=n}for(var u,m=0;m<q.length;m++)u=q[m],u in p&&!isNaN(p[u])&&r[u](c,p[u])}return c},formatDate:function(b,c,d){"string"==typeof c&&(c=l.parseFormat(c));var e={d:b.getUTCDate(),D:k[d].daysShort[b.getUTCDay()],DD:k[d].days[b.getUTCDay()],m:b.getUTCMonth()+1,M:k[d].monthsShort[b.getUTCMonth()],MM:k[d].months[b.getUTCMonth()],yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear()};e.dd=(e.d<10?"0":"")+e.d,e.mm=(e.m<10?"0":"")+e.m;for(var b=[],f=a.extend([],c.separators),g=0,h=c.parts.length;h>=g;g++)f.length&&b.push(f.shift()),b.push(e[c.parts[g]]);return b.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};l.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+l.headTemplate+"<tbody></tbody>"+l.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+l.headTemplate+l.contTemplate+l.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+l.headTemplate+l.contTemplate+l.footTemplate+"</table></div></div>",a.fn.datepicker.DPGlobal=l,a.fn.datepicker.noConflict=function(){return a.fn.datepicker=g,this},a(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(b){var c=a(this);c.data("datepicker")||(b.preventDefault(),h.call(c,"show"))}),a(function(){h.call(a('[data-provide="datepicker-inline"]'))})}(window.jQuery),function(a){"use strict";a.fn.bdatepicker=a.fn.datepicker.noConflict(),a.fn.datepicker||(a.fn.datepicker=a.fn.bdatepicker);var b=function(a){this.init("date",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{initPicker:function(b,c){this.options.viewformat||(this.options.viewformat=this.options.format),b.datepicker=a.fn.editableutils.tryParseJson(b.datepicker,!0),this.options.datepicker=a.extend({},c.datepicker,b.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||"en",this.dpg=a.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=a('<a href="#"></a>').html(this.options.clear).click(a.proxy(function(a){a.preventDefault(),a.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(a('<div class="editable-clear">').append(this.$clear)))},value2html:function(a,c){var d=a?this.dpg.formatDate(a,this.parsedViewFormat,this.options.datepicker.language):"";b.superclass.value2html.call(this,d,c)},html2value:function(a){return this.parseDate(a,this.parsedViewFormat)},value2str:function(a){return a?this.dpg.formatDate(a,this.parsedFormat,this.options.datepicker.language):""},str2value:function(a){return this.parseDate(a,this.parsedFormat)},value2submit:function(a){return this.value2str(a)},value2input:function(a){this.$input.bdatepicker("update",a)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".day",function(b){if(!a(b.currentTarget).is(".old")&&!a(b.currentTarget).is(".new")){var c=a(this).closest("form");setTimeout(function(){c.submit()},200)}})},parseDate:function(a,b){var c,d=null;return a&&(d=this.dpg.parseDate(a,b,this.options.datepicker.language),"string"==typeof a&&(c=this.dpg.formatDate(d,b,this.options.datepicker.language),a!==c&&(d=null))),d}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:"&times; clear"}),a.fn.editabletypes.date=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("datefield",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.date),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off("focus keydown"),this.$input.keyup(a.proxy(function(){this.$tpl.removeData("date"),this.$tpl.bdatepicker("update")},this))},value2input:function(a){this.$input.val(a?this.dpg.formatDate(a,this.parsedViewFormat,this.options.datepicker.language):""),this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),a.fn.editabletypes.datefield=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("datetime",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{initPicker:function(b,c){this.options.viewformat||(this.options.viewformat=this.options.format),b.datetimepicker=a.fn.editableutils.tryParseJson(b.datetimepicker,!0),this.options.datetimepicker=a.extend({},c.datetimepicker,b.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||"en",this.dpg=a.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on("changeMode",function(b){var c=a(this).closest("form").parent();setTimeout(function(){c.triggerHandler("resize")},0)}),this.options.clear&&(this.$clear=a('<a href="#"></a>').html(this.options.clear).click(a.proxy(function(a){a.preventDefault(),a.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(a('<div class="editable-clear">').append(this.$clear)))},value2html:function(a,c){var d=a?this.dpg.formatDate(this.toUTC(a),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";return c?void b.superclass.value2html.call(this,d,c):d},html2value:function(a){var b=this.parseDate(a,this.parsedViewFormat);return b?this.fromUTC(b):null},value2str:function(a){return a?this.dpg.formatDate(this.toUTC(a),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(a){var b=this.parseDate(a,this.parsedFormat);return b?this.fromUTC(b):null},value2submit:function(a){return this.value2str(a)},value2input:function(a){a&&this.$input.data("datetimepicker").setDate(a)},input2value:function(){var a=this.$input.data("datetimepicker");return a.date?a.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(b){var c=a(this).closest("form");setTimeout(function(){c.submit()},200)})},toUTC:function(a){return a?new Date(a.valueOf()-6e4*a.getTimezoneOffset()):a},fromUTC:function(a){return a?new Date(a.valueOf()+6e4*a.getTimezoneOffset()):a},parseDate:function(a,b){var c,d=null;return a&&(d=this.dpg.parseDate(a,b,this.options.datetimepicker.language,this.options.formatType),"string"==typeof a&&(c=this.dpg.formatDate(d,b,this.options.datetimepicker.language,this.options.formatType),a!==c&&(d=null))),d}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"}),a.fn.editabletypes.datetime=b}(window.jQuery),function(a){"use strict";var b=function(a){this.init("datetimefield",a,b.defaults),this.initPicker(a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.datetime),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off("focus keydown"),this.$input.keyup(a.proxy(function(){this.$tpl.removeData("date"),this.$tpl.datetimepicker("update")},this))},value2input:function(a){this.$input.val(this.value2html(a)),this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){a.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),b.defaults=a.extend({},a.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}}),a.fn.editabletypes.datetimefield=b}(window.jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a,b){function c(){var a,b,c,d,e,f,g,h;if(b=(new Date).toString(),c=(null!=(g=b.split("(")[1])?g.slice(0,-1):0)||b.split(" "),c instanceof Array){f=[];for(var d=0,e=c.length;e>d;d++)h=c[d],((a=null!==(g=h.match(/\b[A-Z]+\b/)))?g[0]:0)&&f.push(a);c=f.pop()}return c}function d(){return new Date(Date.UTC.apply(Date,arguments))}"indexOf"in Array.prototype||(Array.prototype.indexOf=function(a,c){c===b&&(c=0),0>c&&(c+=this.length),0>c&&(c=0);for(var d=this.length;d>c;c++)if(c in this&&this[c]===a)return c;return-1});var e=function(d,e){var f=this;this.element=a(d),this.container=e.container||"body",this.language=e.language||this.element.data("date-language")||"en",this.language=this.language in g?this.language:this.language.split("-")[0],this.language=this.language in g?this.language:"en",this.isRTL=g[this.language].rtl||!1,this.formatType=e.formatType||this.element.data("format-type")||"standard",this.format=h.parseFormat(e.format||this.element.data("date-format")||g[this.language].format||h.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=e.fontAwesome||this.element.data("font-awesome")||!1,this.bootcssVer=e.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=this.element.is(".date")?3===this.bootcssVer?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-remove, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar, .add-on .fa-calendar, .add-on .fa-clock-o").parent():!1,this.componentReset=this.element.is(".date")?3===this.bootcssVer?this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent():!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.linkField=e.linkField||this.element.data("link-field")||!1,this.linkFormat=h.parseFormat(e.linkFormat||this.element.data("link-format")||h.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=e.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=e.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=e.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=e.initialDate||new Date,this.zIndex=e.zIndex||this.element.data("z-index")||b,this.title="undefined"==typeof e.title?!1:e.title,this.timezone=e.timezone||c(),this.icons={leftArrow:this.fontAwesome?"fa-arrow-left":3===this.bootcssVer?"glyphicon-arrow-left":"icon-arrow-left",rightArrow:this.fontAwesome?"fa-arrow-right":3===this.bootcssVer?"glyphicon-arrow-right":"icon-arrow-right"},this.icontype=this.fontAwesome?"fa":"glyphicon",this._attachEvents(),this.clickedOutside=function(b){0===a(b.target).closest(".datetimepicker").length&&f.hide()},this.formatViewType="datetime","formatViewType"in e?this.formatViewType=e.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in e?this.minView=e.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=h.convertViewMode(this.minView),this.maxView=h.modes.length-1,"maxView"in e?this.maxView=e.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=h.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in e?this.wheelViewModeNavigation=e.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in e?this.wheelViewModeNavigationInverseDirection=e.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in e?this.wheelViewModeNavigationDelay=e.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in e?this.startViewMode=e.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=h.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in e?this.viewSelect=e.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=h.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in e?this.forceParse=e.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));for(var i=3===this.bootcssVer?h.templateV3:h.template;-1!==i.indexOf("{iconType}");)i=i.replace("{iconType}",this.icontype);for(;-1!==i.indexOf("{leftArrow}");)i=i.replace("{leftArrow}",this.icons.leftArrow);for(;-1!==i.indexOf("{rightArrow}");)i=i.replace("{rightArrow}",this.icons.rightArrow);if(this.picker=a(i).appendTo(this.isInline?this.element:this.container).on({click:a.proxy(this.click,this),mousedown:a.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(a.fn.mousewheel?this.picker.on({mousewheel:a.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu"),this.isRTL){this.picker.addClass("datetimepicker-rtl");var j=3===this.bootcssVer?".prev span, .next span":".prev i, .next i";this.picker.find(j).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}a(document).on("mousedown touchend",this.clickedOutside),this.autoclose=!1,"autoclose"in e?this.autoclose=e.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in e?this.keyboardNavigation=e.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),
this.todayBtn=e.todayBtn||this.element.data("date-today-btn")||!1,this.clearBtn=e.clearBtn||this.element.data("date-clear-btn")||!1,this.todayHighlight=e.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=0,"undefined"!=typeof e.weekStart?this.weekStart=e.weekStart:"undefined"!=typeof this.element.data("date-weekstart")?this.weekStart=this.element.data("date-weekstart"):"undefined"!=typeof g[this.language].weekStart&&(this.weekStart=g[this.language].weekStart),this.weekStart=this.weekStart%7,this.weekEnd=(this.weekStart+6)%7,this.onRenderDay=function(a){var b=(e.onRenderDay||function(){return[]})(a);"string"==typeof b&&(b=[b]);var c=["day"];return c.concat(b?b:[])},this.onRenderHour=function(a){var b=(e.onRenderHour||function(){return[]})(a),c=["hour"];return"string"==typeof b&&(b=[b]),c.concat(b?b:[])},this.onRenderMinute=function(a){var b=(e.onRenderMinute||function(){return[]})(a),c=["minute"];return"string"==typeof b&&(b=[b]),a<this.startDate||a>this.endDate?c.push("disabled"):Math.floor(this.date.getUTCMinutes()/this.minuteStep)===Math.floor(a.getUTCMinutes()/this.minuteStep)&&c.push("active"),c.concat(b?b:[])},this.onRenderYear=function(a){var b=(e.onRenderYear||function(){return[]})(a),c=["year"];"string"==typeof b&&(b=[b]),this.date.getUTCFullYear()===a.getUTCFullYear()&&c.push("active");var d=a.getUTCFullYear(),f=this.endDate.getUTCFullYear();return(a<this.startDate||d>f)&&c.push("disabled"),c.concat(b?b:[])},this.onRenderMonth=function(a){var b=(e.onRenderMonth||function(){return[]})(a),c=["month"];return"string"==typeof b&&(b=[b]),c.concat(b?b:[])},this.startDate=new Date(-8639968443048e3),this.endDate=new Date(8639968443048e3),this.datesDisabled=[],this.daysOfWeekDisabled=[],this.setStartDate(e.startDate||this.element.data("date-startdate")),this.setEndDate(e.endDate||this.element.data("date-enddate")),this.setDatesDisabled(e.datesDisabled||this.element.data("date-dates-disabled")),this.setDaysOfWeekDisabled(e.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(e.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(e.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};e.prototype={constructor:e,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{focus:a.proxy(this.show,this),keyup:a.proxy(this.update,this),keydown:a.proxy(this.keydown,this)}],[this.component,{click:a.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:a.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:a.proxy(this.show,this)}]];for(var b,c,d=0;d<this._events.length;d++)b=this._events[d][0],c=this._events[d][1],b.on(c)},_detachEvents:function(){for(var a,b,c=0;c<this._events.length;c++)a=this._events[c][0],b=this._events[c][1],a.off(b);this._events=[]},show:function(b){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),a(window).on("resize",a.proxy(this.place,this)),b&&(b.stopPropagation(),b.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(){this.isVisible&&(this.isInline||(this.picker.hide(),a(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||a(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),a(document).off("mousedown",this.clickedOutside),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var a=this.getUTCDate();return null===a?null:new Date(a.getTime()+6e4*a.getTimezoneOffset())},getUTCDate:function(){return this.date},getInitialDate:function(){return this.initialDate},setInitialDate:function(a){this.initialDate=a},setDate:function(a){this.setUTCDate(new Date(a.getTime()-6e4*a.getTimezoneOffset()))},setUTCDate:function(a){a>=this.startDate&&a<=this.endDate?(this.date=a,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:a,startDate:this.startDate,endDate:this.endDate})},setFormat:function(a){this.format=h.parseFormat(a,this.formatType);var b;this.isInput?b=this.element:this.component&&(b=this.element.find("input")),b&&b.val()&&this.setValue()},setValue:function(){var b=this.getFormattedDate();this.isInput?this.element.val(b):(this.component&&this.element.find("input").val(b),this.element.data("date",b)),this.linkField&&a("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(a){return a=a||this.format,h.formatDate(this.date,a,this.language,this.formatType,this.timezone)},setStartDate:function(a){this.startDate=a||this.startDate,8639968443048e3!==this.startDate.valueOf()&&(this.startDate=h.parseDate(this.startDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setEndDate:function(a){this.endDate=a||this.endDate,8639968443048e3!==this.endDate.valueOf()&&(this.endDate=h.parseDate(this.endDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setDatesDisabled:function(b){this.datesDisabled=b||[],a.isArray(this.datesDisabled)||(this.datesDisabled=this.datesDisabled.split(/,\s*/));var c=this;this.datesDisabled=a.map(this.datesDisabled,function(a){return h.parseDate(a,c.format,c.language,c.formatType,c.timezone).toDateString()}),this.update(),this.updateNavArrows()},setTitle:function(a,b){return this.picker.find(a).find("th:eq(1)").text(this.title===!1?b:this.title)},setDaysOfWeekDisabled:function(b){this.daysOfWeekDisabled=b||[],a.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=a.map(this.daysOfWeekDisabled,function(a){return parseInt(a,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(b){this.minutesDisabled=b||[],a.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=a.map(this.minutesDisabled,function(a){return parseInt(a,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(b){this.hoursDisabled=b||[],a.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=a.map(this.hoursDisabled,function(a){return parseInt(a,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){if(!this.zIndex){var b=0;a("div").each(function(){var c=parseInt(a(this).css("zIndex"),10);c>b&&(b=c)}),this.zIndex=b+10}var c,d,e,f;f=this.container instanceof a?this.container.offset():a(this.container).offset(),this.component?(c=this.component.offset(),e=c.left,("bottom-left"===this.pickerPosition||"top-left"===this.pickerPosition)&&(e+=this.component.outerWidth()-this.picker.outerWidth())):(c=this.element.offset(),e=c.left,("bottom-left"===this.pickerPosition||"top-left"===this.pickerPosition)&&(e+=this.element.outerWidth()-this.picker.outerWidth()));var g=document.body.clientWidth||window.innerWidth;e+220>g&&(e=g-220),d="top-left"===this.pickerPosition||"top-right"===this.pickerPosition?c.top-this.picker.outerHeight():c.top+this.height,d-=f.top,e-=f.left,this.picker.css({top:d,left:e,zIndex:this.zIndex})}},hour_minute:"^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]",update:function(){var a,b=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(a=arguments[0],b=!0):(a=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate,"string"==typeof a&&(a=a.replace(/^\s+|\s+$/g,""))),a||(a=new Date,b=!1),"string"==typeof a&&(new RegExp(this.hour_minute).test(a)||new RegExp(this.hour_minute+":[0-5][0-9]").test(a))&&(a=this.getDate()),this.date=h.parseDate(a,this.format,this.language,this.formatType,this.timezone),b&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var a=this.weekStart,b="<tr>";a<this.weekStart+7;)b+='<th class="dow">'+g[this.language].daysMin[a++%7]+"</th>";b+="</tr>",this.picker.find(".datetimepicker-days thead").append(b)},fillMonths:function(){for(var a="",b=new Date(this.viewDate),c=0;12>c;c++){b.setUTCMonth(c);var d=this.onRenderMonth(b);a+='<span class="'+d.join(" ")+'">'+g[this.language].monthsShort[c]+"</span>"}this.picker.find(".datetimepicker-months td").html(a)},fill:function(){if(this.date&&this.viewDate){var b=new Date(this.viewDate),c=b.getUTCFullYear(),e=b.getUTCMonth(),i=b.getUTCDate(),j=b.getUTCHours(),k=this.startDate.getUTCFullYear(),l=this.startDate.getUTCMonth(),m=this.endDate.getUTCFullYear(),n=this.endDate.getUTCMonth()+1,o=new d(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),p=new Date;if(this.setTitle(".datetimepicker-days",g[this.language].months[e]+" "+c),"time"===this.formatViewType){var q=this.getFormattedDate();this.setTitle(".datetimepicker-hours",q),this.setTitle(".datetimepicker-minutes",q)}else this.setTitle(".datetimepicker-hours",i+" "+g[this.language].months[e]+" "+c),this.setTitle(".datetimepicker-minutes",i+" "+g[this.language].months[e]+" "+c);this.picker.find("tfoot th.today").text(g[this.language].today||g.en.today).toggle(this.todayBtn!==!1),this.picker.find("tfoot th.clear").text(g[this.language].clear||g.en.clear).toggle(this.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var r=d(c,e-1,28,0,0,0,0),s=h.getDaysInMonth(r.getUTCFullYear(),r.getUTCMonth());r.setUTCDate(s),r.setUTCDate(s-(r.getUTCDay()-this.weekStart+7)%7);var t=new Date(r);t.setUTCDate(t.getUTCDate()+42),t=t.valueOf();for(var u,v=[];r.valueOf()<t;)r.getUTCDay()===this.weekStart&&v.push("<tr>"),u=this.onRenderDay(r),r.getUTCFullYear()<c||r.getUTCFullYear()===c&&r.getUTCMonth()<e?u.push("old"):(r.getUTCFullYear()>c||r.getUTCFullYear()===c&&r.getUTCMonth()>e)&&u.push("new"),this.todayHighlight&&r.getUTCFullYear()===p.getFullYear()&&r.getUTCMonth()===p.getMonth()&&r.getUTCDate()===p.getDate()&&u.push("today"),r.valueOf()===o&&u.push("active"),(r.valueOf()+864e5<=this.startDate||r.valueOf()>this.endDate||-1!==a.inArray(r.getUTCDay(),this.daysOfWeekDisabled)||-1!==a.inArray(r.toDateString(),this.datesDisabled))&&u.push("disabled"),v.push('<td class="'+u.join(" ")+'">'+r.getUTCDate()+"</td>"),r.getUTCDay()===this.weekEnd&&v.push("</tr>"),r.setUTCDate(r.getUTCDate()+1);this.picker.find(".datetimepicker-days tbody").empty().append(v.join("")),v=[];var w="",x="",y="",z=this.hoursDisabled||[];b=new Date(this.viewDate);for(var A=0;24>A;A++){b.setUTCHours(A),u=this.onRenderHour(b),-1!==z.indexOf(A)&&u.push("disabled");var B=d(c,e,i,A);B.valueOf()+36e5<=this.startDate||B.valueOf()>this.endDate?u.push("disabled"):j===A&&u.push("active"),this.showMeridian&&2===g[this.language].meridiem.length?(x=12>A?g[this.language].meridiem[0]:g[this.language].meridiem[1],x!==y&&(""!==y&&v.push("</fieldset>"),v.push('<fieldset class="hour"><legend>'+x.toUpperCase()+"</legend>")),y=x,w=A%12?A%12:12,12>A?u.push("hour_am"):u.push("hour_pm"),v.push('<span class="'+u.join(" ")+'">'+w+"</span>"),23===A&&v.push("</fieldset>")):(w=A+":00",v.push('<span class="'+u.join(" ")+'">'+w+"</span>"))}this.picker.find(".datetimepicker-hours td").html(v.join("")),v=[],w="",x="",y="";var C=this.minutesDisabled||[];b=new Date(this.viewDate);for(var A=0;60>A;A+=this.minuteStep)-1===C.indexOf(A)&&(b.setUTCMinutes(A),b.setUTCSeconds(0),u=this.onRenderMinute(b),this.showMeridian&&2===g[this.language].meridiem.length?(x=12>j?g[this.language].meridiem[0]:g[this.language].meridiem[1],x!==y&&(""!==y&&v.push("</fieldset>"),v.push('<fieldset class="minute"><legend>'+x.toUpperCase()+"</legend>")),y=x,w=j%12?j%12:12,v.push('<span class="'+u.join(" ")+'">'+w+":"+(10>A?"0"+A:A)+"</span>"),59===A&&v.push("</fieldset>")):(w=A+":00",v.push('<span class="'+u.join(" ")+'">'+j+":"+(10>A?"0"+A:A)+"</span>")));this.picker.find(".datetimepicker-minutes td").html(v.join(""));var D=this.date.getUTCFullYear(),E=this.setTitle(".datetimepicker-months",c).end().find(".month").removeClass("active");D===c&&E.eq(this.date.getUTCMonth()).addClass("active"),(k>c||c>m)&&E.addClass("disabled"),c===k&&E.slice(0,l).addClass("disabled"),c===m&&E.slice(n).addClass("disabled"),v="",c=10*parseInt(c/10,10);var F=this.setTitle(".datetimepicker-years",c+"-"+(c+9)).end().find("td");c-=1,b=new Date(this.viewDate);for(var A=-1;11>A;A++)b.setUTCFullYear(c),u=this.onRenderYear(b),(-1===A||10===A)&&u.push(f),v+='<span class="'+u.join(" ")+'">'+c+"</span>",c+=1;F.html(v),this.place()}},updateNavArrows:function(){var a=new Date(this.viewDate),b=a.getUTCFullYear(),c=a.getUTCMonth(),d=a.getUTCDate(),e=a.getUTCHours();switch(this.viewMode){case 0:b<=this.startDate.getUTCFullYear()&&c<=this.startDate.getUTCMonth()&&d<=this.startDate.getUTCDate()&&e<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),b>=this.endDate.getUTCFullYear()&&c>=this.endDate.getUTCMonth()&&d>=this.endDate.getUTCDate()&&e>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:b<=this.startDate.getUTCFullYear()&&c<=this.startDate.getUTCMonth()&&d<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),b>=this.endDate.getUTCFullYear()&&c>=this.endDate.getUTCMonth()&&d>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:b<=this.startDate.getUTCFullYear()&&c<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),b>=this.endDate.getUTCFullYear()&&c>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:b<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),b>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(b){if(b.preventDefault(),b.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var c=b.originalEvent,d=c.wheelDelta,e=d>0?1:0===d?0:-1;this.wheelViewModeNavigationInverseDirection&&(e=-e),this.showMode(e),setTimeout(a.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target).closest("span, td, th, legend");if(c.is("."+this.icontype)&&(c=a(c).parent().closest("span, td, th, legend")),1===c.length){if(c.is(".disabled"))return void this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});switch(c[0].nodeName.toLowerCase()){case"th":switch(c[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var e=h.modes[this.viewMode].navStep*("prev"===c[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,e);break;case 1:this.viewDate=this.moveDate(this.viewDate,e);break;case 2:this.viewDate=this.moveMonth(this.viewDate,e);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,e)}this.fill(),this.element.trigger({type:c[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"clear":this.reset(),this.autoclose&&this.hide();break;case"today":var f=new Date;f=d(f.getFullYear(),f.getMonth(),f.getDate(),f.getHours(),f.getMinutes(),f.getSeconds(),0),f<this.startDate?f=this.startDate:f>this.endDate&&(f=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(f),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!c.is(".disabled")){var g=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),j=this.viewDate.getUTCDate(),k=this.viewDate.getUTCHours(),l=this.viewDate.getUTCMinutes(),m=this.viewDate.getUTCSeconds();if(c.is(".month")?(this.viewDate.setUTCDate(1),i=c.parent().find("span").index(c),j=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(i),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(d(g,i,j,k,l,m,0))):c.is(".year")?(this.viewDate.setUTCDate(1),g=parseInt(c.text(),10)||0,this.viewDate.setUTCFullYear(g),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(d(g,i,j,k,l,m,0))):c.is(".hour")?(k=parseInt(c.text(),10)||0,(c.hasClass("hour_am")||c.hasClass("hour_pm"))&&(12===k&&c.hasClass("hour_am")?k=0:12!==k&&c.hasClass("hour_pm")&&(k+=12)),this.viewDate.setUTCHours(k),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(d(g,i,j,k,l,m,0))):c.is(".minute")&&(l=parseInt(c.text().substr(c.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(l),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(d(g,i,j,k,l,m,0))),0!==this.viewMode){var n=this.viewMode;this.showMode(-1),this.fill(),n===this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(c.is(".day")&&!c.is(".disabled")){var j=parseInt(c.text(),10)||1,g=this.viewDate.getUTCFullYear(),i=this.viewDate.getUTCMonth(),k=this.viewDate.getUTCHours(),l=this.viewDate.getUTCMinutes(),m=this.viewDate.getUTCSeconds();c.is(".old")?0===i?(i=11,g-=1):i-=1:c.is(".new")&&(11===i?(i=0,g+=1):i+=1),this.viewDate.setUTCFullYear(g),this.viewDate.setUTCMonth(i,j),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(d(g,i,j,k,l,m,0))}var n=this.viewMode;this.showMode(-1),this.fill(),n===this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(a,b){b&&"date"!==b||(this.date=a),b&&"view"!==b||(this.viewDate=a),this.fill(),this.setValue();var c;this.isInput?c=this.element:this.component&&(c=this.element.find("input")),c&&c.change(),this.element.trigger({type:"changeDate",date:this.getDate()}),null===a&&(this.date=this.viewDate)},moveMinute:function(a,b){if(!b)return a;var c=new Date(a.valueOf());return c.setUTCMinutes(c.getUTCMinutes()+b*this.minuteStep),c},moveHour:function(a,b){if(!b)return a;var c=new Date(a.valueOf());return c.setUTCHours(c.getUTCHours()+b),c},moveDate:function(a,b){if(!b)return a;var c=new Date(a.valueOf());return c.setUTCDate(c.getUTCDate()+b),c},moveMonth:function(a,b){if(!b)return a;var c,d,e=new Date(a.valueOf()),f=e.getUTCDate(),g=e.getUTCMonth(),h=Math.abs(b);if(b=b>0?1:-1,1===h)d=-1===b?function(){return e.getUTCMonth()===g}:function(){return e.getUTCMonth()!==c},c=g+b,e.setUTCMonth(c),(0>c||c>11)&&(c=(c+12)%12);else{for(var i=0;h>i;i++)e=this.moveMonth(e,b);c=e.getUTCMonth(),e.setUTCDate(f),d=function(){return c!==e.getUTCMonth()}}for(;d();)e.setUTCDate(--f),e.setUTCMonth(c);return e},moveYear:function(a,b){return this.moveMonth(a,12*b)},dateWithinRange:function(a){return a>=this.startDate&&a<=this.endDate},keydown:function(a){if(this.picker.is(":not(:visible)"))return void(27===a.keyCode&&this.show());var b,c,d,e=!1;switch(a.keyCode){case 27:this.hide(),a.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;b=37===a.keyCode?-1:1;var f=this.viewMode;a.ctrlKey?f+=2:a.shiftKey&&(f+=1),4===f?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):3===f?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):2===f?(c=this.moveDate(this.date,b),d=this.moveDate(this.viewDate,b)):1===f?(c=this.moveHour(this.date,b),d=this.moveHour(this.viewDate,b)):0===f&&(c=this.moveMinute(this.date,b),d=this.moveMinute(this.viewDate,b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;b=38===a.keyCode?-1:1,f=this.viewMode,a.ctrlKey?f+=2:a.shiftKey&&(f+=1),4===f?(c=this.moveYear(this.date,b),d=this.moveYear(this.viewDate,b)):3===f?(c=this.moveMonth(this.date,b),d=this.moveMonth(this.viewDate,b)):2===f?(c=this.moveDate(this.date,7*b),d=this.moveDate(this.viewDate,7*b)):1===f?this.showMeridian?(c=this.moveHour(this.date,6*b),d=this.moveHour(this.viewDate,6*b)):(c=this.moveHour(this.date,4*b),d=this.moveHour(this.viewDate,4*b)):0===f&&(c=this.moveMinute(this.date,4*b),d=this.moveMinute(this.viewDate,4*b)),this.dateWithinRange(c)&&(this.date=c,this.viewDate=d,this.setValue(),this.update(),a.preventDefault(),e=!0);break;case 13:if(0!==this.viewMode){var g=this.viewMode;this.showMode(-1),this.fill(),g===this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();a.preventDefault();break;case 9:this.hide()}if(e){var h;this.isInput?h=this.element:this.component&&(h=this.element.find("input")),h&&h.change(),this.element.trigger({type:"changeDate",date:this.getDate()})}},showMode:function(a){if(a){var b=Math.max(0,Math.min(h.modes.length-1,this.viewMode+a));b>=this.minView&&b<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:b}),this.viewMode=b)}this.picker.find(">div").hide().filter(".datetimepicker-"+h.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(){this._setDate(null,"date")},convertViewModeText:function(a){switch(a){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var f=a.fn.datetimepicker;a.fn.datetimepicker=function(c){var d=Array.apply(null,arguments);d.shift();var f;return this.each(function(){var g=a(this),h=g.data("datetimepicker"),i="object"==typeof c&&c;return h||g.data("datetimepicker",h=new e(this,a.extend({},a.fn.datetimepicker.defaults,i))),"string"==typeof c&&"function"==typeof h[c]&&(f=h[c].apply(h,d),f!==b)?!1:void 0}),f!==b?f:this},a.fn.datetimepicker.defaults={},a.fn.datetimepicker.Constructor=e;var g=a.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today",clear:"Clear"}},h={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth:function(a,b){return[31,h.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},getDefaultFormat:function(a,b){if("standard"===a)return"input"===b?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"===a)return"input"===b?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(a){if("standard"===a)return/t|hh?|HH?|p|P|z|Z|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"===a)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(a,b){var c=a.replace(this.validParts(b),"\x00").split("\x00"),d=a.match(this.validParts(b));if(!c||!c.length||!d||0===d.length)throw new Error("Invalid date format.");return{separators:c,parts:d}},parseDate:function(b,c,f,h,i){if(b instanceof Date){var j=new Date(b.valueOf()-6e4*b.getTimezoneOffset());return j.setMilliseconds(0),j}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(b)&&(c=this.parseFormat("yyyy-mm-dd",h)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(b)&&(c=this.parseFormat("yyyy-mm-dd hh:ii",h)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(b)&&(c=this.parseFormat("yyyy-mm-dd hh:ii:ss",h)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(b)){var k,l,m=/([-+]\d+)([dmwy])/,n=b.match(/([-+]\d+)([dmwy])/g);b=new Date;for(var o=0;o<n.length;o++)switch(k=m.exec(n[o]),l=parseInt(k[1]),k[2]){case"d":b.setUTCDate(b.getUTCDate()+l);break;case"m":b=e.prototype.moveMonth.call(e.prototype,b,l);break;case"w":b.setUTCDate(b.getUTCDate()+7*l);break;case"y":b=e.prototype.moveYear.call(e.prototype,b,l)}return d(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),0)}var p,q,k,n=b&&b.toString().match(this.nonpunctuation)||[],b=new Date(0,0,0,0,0,0,0),r={},s=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P","z","Z"],t={hh:function(a,b){return a.setUTCHours(b)},h:function(a,b){return a.setUTCHours(b)},HH:function(a,b){return a.setUTCHours(12===b?0:b)},H:function(a,b){return a.setUTCHours(12===b?0:b)},ii:function(a,b){return a.setUTCMinutes(b)},i:function(a,b){return a.setUTCMinutes(b)},ss:function(a,b){return a.setUTCSeconds(b)},s:function(a,b){return a.setUTCSeconds(b)},yyyy:function(a,b){return a.setUTCFullYear(b)},yy:function(a,b){return a.setUTCFullYear(2e3+b)},m:function(a,b){for(b-=1;0>b;)b+=12;for(b%=12,a.setUTCMonth(b);a.getUTCMonth()!==b;){if(isNaN(a.getUTCMonth()))return a;a.setUTCDate(a.getUTCDate()-1)}return a},d:function(a,b){return a.setUTCDate(b)},p:function(a,b){return a.setUTCHours(1===b?a.getUTCHours()+12:a.getUTCHours())},z:function(){return i}};if(t.M=t.MM=t.mm=t.m,t.dd=t.d,t.P=t.p,t.Z=t.z,b=d(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds()),n.length===c.parts.length){for(var o=0,u=c.parts.length;u>o;o++){if(p=parseInt(n[o],10),k=c.parts[o],isNaN(p))switch(k){case"MM":q=a(g[f].months).filter(function(){var a=this.slice(0,n[o].length),b=n[o].slice(0,a.length);return a===b}),p=a.inArray(q[0],g[f].months)+1;break;case"M":q=a(g[f].monthsShort).filter(function(){var a=this.slice(0,n[o].length),b=n[o].slice(0,a.length);return a.toLowerCase()===b.toLowerCase()}),p=a.inArray(q[0],g[f].monthsShort)+1;break;case"p":case"P":p=a.inArray(n[o].toLowerCase(),g[f].meridiem);break;case"z":case"Z":}r[k]=p}for(var v,o=0;o<s.length;o++)v=s[o],v in r&&!isNaN(r[v])&&t[v](b,r[v])}return b},formatDate:function(b,c,d,e,f){if(null===b)return"";var i;if("standard"===e)i={t:b.getTime(),yy:b.getUTCFullYear().toString().substring(2),yyyy:b.getUTCFullYear(),m:b.getUTCMonth()+1,M:g[d].monthsShort[b.getUTCMonth()],MM:g[d].months[b.getUTCMonth()],d:b.getUTCDate(),D:g[d].daysShort[b.getUTCDay()],DD:g[d].days[b.getUTCDay()],p:2===g[d].meridiem.length?g[d].meridiem[b.getUTCHours()<12?0:1]:"",h:b.getUTCHours(),i:b.getUTCMinutes(),s:b.getUTCSeconds(),z:f},2===g[d].meridiem.length?i.H=i.h%12===0?12:i.h%12:i.H=i.h,i.HH=(i.H<10?"0":"")+i.H,i.P=i.p.toUpperCase(),i.Z=i.z,i.hh=(i.h<10?"0":"")+i.h,i.ii=(i.i<10?"0":"")+i.i,i.ss=(i.s<10?"0":"")+i.s,i.dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m;else{if("php"!==e)throw new Error("Invalid format type.");i={y:b.getUTCFullYear().toString().substring(2),Y:b.getUTCFullYear(),F:g[d].months[b.getUTCMonth()],M:g[d].monthsShort[b.getUTCMonth()],n:b.getUTCMonth()+1,t:h.getDaysInMonth(b.getUTCFullYear(),b.getUTCMonth()),j:b.getUTCDate(),l:g[d].days[b.getUTCDay()],D:g[d].daysShort[b.getUTCDay()],w:b.getUTCDay(),N:0===b.getUTCDay()?7:b.getUTCDay(),S:b.getUTCDate()%10<=g[d].suffix.length?g[d].suffix[b.getUTCDate()%10-1]:"",a:2===g[d].meridiem.length?g[d].meridiem[b.getUTCHours()<12?0:1]:"",g:b.getUTCHours()%12===0?12:b.getUTCHours()%12,G:b.getUTCHours(),i:b.getUTCMinutes(),s:b.getUTCSeconds()},i.m=(i.n<10?"0":"")+i.n,i.d=(i.j<10?"0":"")+i.j,i.A=i.a.toString().toUpperCase(),i.h=(i.g<10?"0":"")+i.g,i.H=(i.G<10?"0":"")+i.G,i.i=(i.i<10?"0":"")+i.i,i.s=(i.s<10?"0":"")+i.s}for(var b=[],j=a.extend([],c.separators),k=0,l=c.parts.length;l>k;k++)j.length&&b.push(j.shift()),b.push(i[c.parts[k]]);return j.length&&b.push(j.shift()),b.join("")},convertViewMode:function(a){switch(a){case 4:case"decade":a=4;break;case 3:case"year":a=3;break;case 2:case"month":a=2;break;case 1:case"day":a=1;break;case 0:case"hour":a=0}return a},headTemplate:'<thead><tr><th class="prev"><i class="{iconType} {leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{iconType} {rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};h.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+h.headTemplate+"<tbody></tbody>"+h.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+h.headTemplate+h.contTemplate+h.footTemplate+"</table></div></div>",h.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+h.headTemplateV3+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+h.headTemplateV3+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+h.headTemplateV3+"<tbody></tbody>"+h.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+h.headTemplateV3+h.contTemplate+h.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+h.headTemplateV3+h.contTemplate+h.footTemplate+"</table></div></div>",a.fn.datetimepicker.DPGlobal=h,a.fn.datetimepicker.noConflict=function(){return a.fn.datetimepicker=f,this},a(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(b){var c=a(this);c.data("datetimepicker")||(b.preventDefault(),c.datetimepicker("show"))}),a(function(){a('[data-provide="datetimepicker-inline"]').datetimepicker()})}),+function(a){"use strict";function b(b){return this.each(function(){var d=a(this),e=d.data("bs.toggle"),f="object"==typeof b&&b;e||d.data("bs.toggle",e=new c(this,f)),"string"==typeof b&&e[b]&&e[b]()})}var c=function(b,c){this.$element=a(b),this.options=a.extend({},this.defaults(),c),this.render()};c.VERSION="2.2.0",c.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null},c.prototype.defaults=function(){return{on:this.$element.attr("data-on")||c.DEFAULTS.on,off:this.$element.attr("data-off")||c.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||c.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||c.DEFAULTS.offstyle,size:this.$element.attr("data-size")||c.DEFAULTS.size,style:this.$element.attr("data-style")||c.DEFAULTS.style,width:this.$element.attr("data-width")||c.DEFAULTS.width,height:this.$element.attr("data-height")||c.DEFAULTS.height
}},c.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var b="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",c=a('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+b),d=a('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+b+" active"),e=a('<span class="toggle-handle btn btn-default">').addClass(b),f=a('<div class="toggle-group">').append(c,d,e),g=a('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(b).addClass(this.options.style);this.$element.wrap(g),a.extend(this,{$toggle:this.$element.parent(),$toggleOn:c,$toggleOff:d,$toggleGroup:f}),this.$toggle.append(f);var h=this.options.width||Math.max(c.outerWidth(),d.outerWidth())+e.outerWidth()/2,i=this.options.height||Math.max(c.outerHeight(),d.outerHeight());c.addClass("toggle-on"),d.addClass("toggle-off"),this.$toggle.css({width:h,height:i}),this.options.height&&(c.css("line-height",c.height()+"px"),d.css("line-height",d.height()+"px")),this.update(!0),this.trigger(!0)},c.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},c.prototype.on=function(a){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),void(a||this.trigger()))},c.prototype.off=function(a){return this.$element.prop("disabled")?!1:(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),void(a||this.trigger()))},c.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},c.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},c.prototype.update=function(a){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(a):this.off(a)},c.prototype.trigger=function(b){this.$element.off("change.bs.toggle"),b||this.$element.change(),this.$element.on("change.bs.toggle",a.proxy(function(){this.update()},this))},c.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var d=a.fn.bootstrapToggle;a.fn.bootstrapToggle=b,a.fn.bootstrapToggle.Constructor=c,a.fn.toggle.noConflict=function(){return a.fn.bootstrapToggle=d,this},a(function(){a("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()}),a(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(b){var c=a(this).find("input[type=checkbox]");c.bootstrapToggle("toggle"),b.preventDefault()})}(jQuery),function(a){a.editors.List=a.editors.Base.extend({events:{'click [data-action="add"]:last':function(a){a.preventDefault(),this.addItem(null,!0)}},initialize:function(b){b=b||{};var c=a.editors;c.Base.prototype.initialize.call(this,b);var d=this.schema;if(!d)throw new Error("Missing required option 'schema'");this.template=b.template||this.constructor.template,this.Editor=function(){var a=d.itemType;return a?c.List[a]?c.List[a]:c[a]:c.Text}(),this.items=[]},render:function(){var a=this,b=this.value||[],c=Backbone.$,d=c(c.trim(this.template()));return this.$list=d.is("[data-items]")?d:d.find("[data-items]"),b.length?_.each(b,function(b){a.addItem(b)}):this.Editor.isAsync||this.addItem(),a.schema.maxCardinality&&a.items.length>=a.schema.maxCardinality&&d.find('button[data-action="add"]:last').hide(),this.setElement(d),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),this},addItem:function(b,c){var d=this,e=a.editors,f=new e.List.Item({list:this,form:this.form,schema:this.schema,value:b,Editor:this.Editor,key:this.key}).render(),g=function(){d.items.push(f),d.$list.append(f.el),d.schema.maxCardinality&&d.items.length>=d.schema.maxCardinality&&d.$el.find('button[data-action="add"]:last').hide(),f.editor.on("all",function(a){if("change"!==a){var b=_.toArray(arguments);b[0]="item:"+a,b.splice(1,0,d),e.List.prototype.trigger.apply(this,b)}},d),f.editor.on("change",function(){f.addEventTriggered||(f.addEventTriggered=!0,this.trigger("add",this,f.editor)),this.trigger("item:change",this,f.editor),this.trigger("change",this)},d),f.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},d),f.editor.on("blur",function(){if(this.hasFocus){var a=this;setTimeout(function(){_.find(a.items,function(a){return a.editor.hasFocus})||a.trigger("blur",a)},0)}},d),(c||b)&&(f.addEventTriggered=!0),c&&(d.trigger("add",d,f.editor),d.trigger("change",d))};return this.Editor.isAsync?f.editor.on("readyToAdd",g,this):(g(),f.editor.focus()),f},removeItem:function(a){var b=this.schema.confirmDelete;if(!b||confirm(b)){var c=_.indexOf(this.items,a);this.items[c].remove(),this.items.splice(c,1),a.addEventTriggered&&(this.trigger("remove",this,a.editor),this.trigger("change",this)),this.items.length||this.Editor.isAsync||this.addItem(),this.schema.maxCardinality&&this.items.length<this.schema.maxCardinality&&this.$el.find('button[data-action="add"]:last').show()}},getValue:function(){var a=_.map(this.items,function(a){return a.getValue()});return _.without(a,void 0,"")},setValue:function(a){this.value=a,this.render()},focus:function(){this.hasFocus||this.items[0]&&this.items[0].editor.focus()},blur:function(){if(this.hasFocus){var a=_.find(this.items,function(a){return a.editor.hasFocus});a&&a.editor.blur()}},remove:function(){_.invoke(this.items,"remove"),a.editors.Base.prototype.remove.call(this)},validate:function(){if(!this.validators)return null;var a=_.map(this.items,function(a){return a.validate()}),b=_.compact(a).length?!0:!1;if(!b)return null;var c={type:"list",message:"Some of the items in the list failed validation",errors:a};return c}},{template:_.template('      <div>        <div data-items></div>        <button type="button" data-action="add">Add</button>      </div>    ',null,a.templateSettings)}),a.editors.List.Item=a.editors.Base.extend({events:{'click [data-action="remove"]:last':function(a){a.preventDefault(),this.list.removeItem(this)},"keydown input[type=text]":function(a){13===a.keyCode&&a.preventDefault()}},initialize:function(b){this.list=b.list,this.schema=b.schema||this.list.schema,this.value=b.value,this.Editor=b.Editor||a.editors.Text,this.key=b.key,this.template=b.template||this.schema.itemTemplate||this.constructor.template,this.errorClassName=b.errorClassName||this.constructor.errorClassName,this.form=b.form},render:function(){var a=Backbone.$;this.editor=new this.Editor({key:this.key,schema:this.schema,value:this.value,list:this.list,item:this,form:this.form}).render();var b=a(a.trim(this.template()));return b.find("[data-editor]").append(this.editor.el),this.setElement(b),this},getValue:function(){return this.editor.getValue()},setValue:function(a){this.editor.setValue(a)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),Backbone.View.prototype.remove.call(this)},validate:function(){var a=this.getValue(),b=this.list.form?this.list.form.getValue():{},c=this.schema.validators,d=this.getValidator;if(!c)return null;var e=null;return _.every(c,function(c){return e=d(c)(a,b),e?!1:!0}),e?this.setError(e):this.clearError(),e?e:null},setError:function(a){this.$el.addClass(this.errorClassName),this.$el.attr("title",a.message)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$el.attr("title",null)}},{template:_.template('      <div>        <span data-editor></span>        <button type="button" data-action="remove">&times;</button>      </div>    ',null,a.templateSettings),errorClassName:"error"}),a.editors.List.Modal=a.editors.Base.extend({events:{click:"openEditor"},initialize:function(b){if(b=b||{},a.editors.Base.prototype.initialize.call(this,b),!a.editors.List.Modal.ModalAdapter)throw new Error("A ModalAdapter is required");if(this.form=b.form,!b.form)throw new Error('Missing required option: "form"');this.template=b.template||this.constructor.template},render:function(){var a=this;return _.isEmpty(this.value)?this.openEditor():(this.renderSummary(),setTimeout(function(){a.trigger("readyToAdd")},0)),this.hasFocus&&this.trigger("blur",this),this},renderSummary:function(){this.$el.html($.trim(this.template({summary:this.getStringValue()})))},itemToString:function(b){var c=function(b){var c={key:b};return a.Field.prototype.createTitle.call(c)};b=b||{};var d=[];return _.each(this.nestedSchema,function(a,e){var f=a.title?a.title:c(e),g=b[e];(_.isUndefined(g)||_.isNull(g))&&(g=""),d.push(f+": "+g)}),d.join("<br />")},getStringValue:function(){var a=this.schema,b=this.getValue();return _.isEmpty(b)?"[Empty]":a.itemToString?a.itemToString(b):this.itemToString(b)},openEditor:function(){var b=this.form.constructor,c=this.modalForm=new b({schema:this.nestedSchema,data:this.value}),d=this.modal=new a.editors.List.Modal.ModalAdapter({content:c,animate:!0});d.open(),this.trigger("open",this),this.trigger("focus",this),d.on("cancel",this.onModalClosed,this),d.on("ok",_.bind(this.onModalSubmitted,this))},onModalSubmitted:function(){var a=this.modal,b=this.modalForm,c=!this.value,d=b.validate();return d?a.preventClose():(this.value=b.getValue(),this.renderSummary(),c&&this.trigger("readyToAdd"),this.trigger("change",this),void this.onModalClosed())},onModalClosed:function(){this.modal=null,this.modalForm=null,this.trigger("close",this),this.trigger("blur",this)},getValue:function(){return this.value},setValue:function(a){this.value=a},focus:function(){this.hasFocus||this.openEditor()},blur:function(){this.hasFocus&&this.modal&&this.modal.trigger("cancel")}},{template:_.template("      <div><%= summary %></div>    ",null,a.templateSettings),ModalAdapter:Backbone.BootstrapModal,isAsync:!0}),a.editors.List.Object=a.editors.List.Modal.extend({initialize:function(){a.editors.List.Modal.prototype.initialize.apply(this,arguments);var b=this.schema;if(!b.subSchema)throw new Error('Missing required option "schema.subSchema"');this.nestedSchema=b.subSchema}}),a.editors.List.NestedModel=a.editors.List.Modal.extend({initialize:function(){a.editors.List.Modal.prototype.initialize.apply(this,arguments);var b=this.schema;if(!b.model)throw new Error('Missing required option "schema.model"');var c=b.model.prototype.schema;this.nestedSchema=_.isFunction(c)?c():c},getStringValue:function(){var a=this.schema,b=this.getValue();return _.isEmpty(b)?null:a.itemToString?a.itemToString(b):new a.model(b).toString()}})}(Backbone.Form),function(a){a.template=_.template('    <form class="form-horizontal" role="form">      <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit" class="btn"><%= submitButton %></button>      <% } %>    </form>  '),a.Fieldset.template=_.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  "),a.Field.template=_.template('    <div class="form-group field-<%= key %>">      <label class="col-sm-2 control-label" for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div class="col-sm-10">        <span data-editor></span>        <p class="help-block" data-error></p>        <p class="help-block"><%= help %></p>      </div>    </div>  '),a.NestedField.template=_.template('    <div class="field-<%= key %>">      <div title="<% if (titleHTML){ %><%= titleHTML %><% } else { %><%- title %><% } %>" class="input-xlarge">        <span data-editor></span>        <div class="help-inline" data-error></div>      </div>      <div class="help-block"><%= help %></div>    </div>  '),a.editors.Base.prototype.className="form-control",a.Field.errorClassName="has-error",a.editors.List&&(a.editors.List.template=_.template('      <div class="bbf-list">        <div class="bbf-list-contents">          <ul class="list-unstyled clearfix" data-items></ul>        </div>        <div class="bbf-list-buttons">          <button type="button" class="btn btn-default bbf-add" data-action="add"><span class="glyphicon glyphicon-plus"></span> add value</button>        </div>      </div>    '),a.editors.List.Item.template=_.template('      <li class="clearfix">        <div class="input-group">          <div data-editor></div>          <span class="input-group-btn">            <button type="button" class="btn btn-default bbf-del" data-action="remove">&times;</button>          </span>        </div>      </li>    '),a.editors.List.Object.template=a.editors.List.NestedModel.template=_.template('      <div class="bbf-list-modal"><%= summary %></div>    '))}(Backbone.Form),function(a){"use strict";var b=3;try{b=parseInt(a.fn.dropdown.Constructor.VERSION,10)}catch(c){}var d={3:{buttonsClass:"default",iconsPrefix:"glyphicon",icons:{paginationSwitchDown:"glyphicon-collapse-down icon-chevron-down",paginationSwitchUp:"glyphicon-collapse-up icon-chevron-up",refresh:"glyphicon-refresh icon-refresh",toggleOff:"glyphicon-list-alt icon-list-alt",toggleOn:"glyphicon-list-alt icon-list-alt",columns:"glyphicon-th icon-th",detailOpen:"glyphicon-plus icon-plus",detailClose:"glyphicon-minus icon-minus",fullscreen:"glyphicon-fullscreen"},pullClass:"pull",toobarDropdowHtml:['<ul class="dropdown-menu" role="menu">',"</ul>"],toobarDropdowItemHtml:'<li role="menuitem"><label>%s</label></li>',pageDropdownHtml:['<ul class="dropdown-menu" role="menu">',"</ul>"],pageDropdownItemHtml:'<li role="menuitem" class="%s"><a href="#">%s</a></li>'},4:{buttonsClass:"secondary",iconsPrefix:"fa",icons:{paginationSwitchDown:"fa-toggle-down",paginationSwitchUp:"fa-toggle-up",refresh:"fa-refresh",toggleOff:"fa-toggle-off",toggleOn:"fa-toggle-on",columns:"fa-th-list",detailOpen:"fa-plus",detailClose:"fa-minus",fullscreen:"fa-arrows-alt"},pullClass:"float",toobarDropdowHtml:['<div class="dropdown-menu dropdown-menu-right">',"</div>"],toobarDropdowItemHtml:'<label class="dropdown-item">%s</label>',pageDropdownHtml:['<div class="dropdown-menu">',"</div>"],pageDropdownItemHtml:'<a class="dropdown-item %s" href="#">%s</a>'}}[b],e=null,f=function(a){var b=arguments,c=!0,d=1;return a=a.replace(/%s/g,function(){var a=b[d++];return"undefined"==typeof a?(c=!1,""):a}),c?a:""},g=function(b,c,d,e){var f="";return a.each(b,function(a,b){return b[c]===e?(f=b[d],!1):!0}),f},h=function(b){var c,d,e,f=0,g=[];for(c=0;c<b[0].length;c++)f+=b[0][c].colspan||1;for(c=0;c<b.length;c++)for(g[c]=[],d=0;f>d;d++)g[c][d]=!1;for(c=0;c<b.length;c++)for(d=0;d<b[c].length;d++){var h=b[c][d],i=h.rowspan||1,j=h.colspan||1,k=a.inArray(!1,g[c]);for(1===j&&(h.fieldIndex=k,"undefined"==typeof h.field&&(h.field=k)),e=0;i>e;e++)g[c+e][k]=!0;for(e=0;j>e;e++)g[c][k+e]=!0}},i=function(){if(null===e){var b,c,d=a("<p/>").addClass("fixed-table-scroll-inner"),f=a("<div/>").addClass("fixed-table-scroll-outer");f.append(d),a("body").append(f),b=d[0].offsetWidth,f.css("overflow","scroll"),c=d[0].offsetWidth,b===c&&(c=f[0].clientWidth),f.remove(),e=b-c}return e},j=function(b,c,d,e){var g=c;if("string"==typeof c){var h=c.split(".");h.length>1?(g=window,a.each(h,function(a,b){g=g[b]})):g=window[c]}return"object"==typeof g?g:"function"==typeof g?g.apply(b,d||[]):!g&&"string"==typeof c&&f.apply(this,[c].concat(d))?f.apply(this,[c].concat(d)):e},k=function(b,c,d){var e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},f=e(b),g=e(c),h="";if(d&&f.length!==g.length)return!1;for(var i=0;i<f.length;i++)if(h=f[i],a.inArray(h,g)>-1&&b[h]!==c[h])return!1;return!0},l=function(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`/g,"&#x60;"):a},m=function(a){for(var b in a){var c=b.split(/(?=[A-Z])/).join("-").toLowerCase();c!==b&&(a[c]=a[b],delete a[b])}return a},n=function(a,b,c){var d=a;if("string"!=typeof b||a.hasOwnProperty(b))return c?l(a[b]):a[b];var e=b.split(".");for(var f in e)e.hasOwnProperty(f)&&(d=d&&d[e[f]]);return c?l(d):d},o=function(){return!!(navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))},p=function(){Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}())},q=function(b,c){this.options=c,this.$el=a(b),this.$el_=this.$el.clone(),this.timeoutId_=0,this.timeoutFooter_=0,this.init()};q.DEFAULTS={classes:"table table-hover",sortClass:void 0,locale:void 0,height:void 0,undefinedText:"-",sortName:void 0,sortOrder:"asc",sortStable:!1,rememberOrder:!1,striped:!1,columns:[[]],data:[],totalField:"total",dataField:"rows",method:"get",url:void 0,ajax:void 0,cache:!0,contentType:"application/json",dataType:"json",ajaxOptions:{},queryParams:function(a){return a},queryParamsType:"limit",responseHandler:function(a){return a},pagination:!1,onlyInfoPagination:!1,paginationLoop:!0,sidePagination:"client",totalRows:0,pageNumber:1,pageSize:10,pageList:[10,25,50,100],paginationHAlign:"right",paginationVAlign:"bottom",paginationDetailHAlign:"left",paginationPreText:"&lsaquo;",paginationNextText:"&rsaquo;",search:!1,searchOnEnterKey:!1,strictSearch:!1,searchAlign:"right",selectItemName:"btSelectItem",showHeader:!0,showFooter:!1,showColumns:!1,showPaginationSwitch:!1,showRefresh:!1,showToggle:!1,showFullscreen:!1,smartDisplay:!0,escape:!1,minimumCountColumns:1,idField:void 0,uniqueId:void 0,cardView:!1,detailView:!1,detailFormatter:function(a,b){return""},detailFilter:function(a,b){return!0},trimOnSearch:!0,clickToSelect:!1,singleSelect:!1,toolbar:void 0,toolbarAlign:"left",buttonsToolbar:void 0,buttonsAlign:"right",checkboxHeader:!0,sortable:!0,silentSort:!0,maintainSelected:!1,searchTimeOut:500,searchText:"",iconSize:void 0,buttonsClass:d.buttonsClass,iconsPrefix:d.iconsPrefix,icons:d.icons,customSearch:a.noop,customSort:a.noop,ignoreClickToSelectOn:function(b){return a.inArray(b.tagName,["A","BUTTON"])},rowStyle:function(a,b){return{}},rowAttributes:function(a,b){return{}},footerStyle:function(a,b){return{}},onAll:function(a,b){return!1},onClickCell:function(a,b,c,d){return!1},onDblClickCell:function(a,b,c,d){return!1},onClickRow:function(a,b){return!1},onDblClickRow:function(a,b){return!1},onSort:function(a,b){return!1},onCheck:function(a){return!1},onUncheck:function(a){return!1},onCheckAll:function(a){return!1},onUncheckAll:function(a){return!1},onCheckSome:function(a){return!1},onUncheckSome:function(a){return!1},onLoadSuccess:function(a){return!1},onLoadError:function(a){return!1},onColumnSwitch:function(a,b){return!1},onPageChange:function(a,b){return!1},onSearch:function(a){return!1},onToggle:function(a){return!1},onPreBody:function(a){return!1},onPostBody:function(){return!1},onPostHeader:function(){return!1},onExpandRow:function(a,b,c){return!1},onCollapseRow:function(a,b){return!1},onRefreshOptions:function(a){return!1},onRefresh:function(a){return!1},onResetView:function(){return!1},onScrollBody:function(){return!1}},q.LOCALES={},q.LOCALES["en-US"]=q.LOCALES.en={formatLoadingMessage:function(){return"Loading, please wait..."},formatRecordsPerPage:function(a){return f("%s rows per page",a)},formatShowingRows:function(a,b,c){return f("Showing %s to %s of %s rows",a,b,c)},formatDetailPagination:function(a){return f("Showing %s rows",a)},formatSearch:function(){return"Search"},formatNoMatches:function(){return"No matching records found"},formatPaginationSwitch:function(){return"Hide/Show pagination"},formatRefresh:function(){return"Refresh"},formatToggle:function(){return"Toggle"},formatFullscreen:function(){return"Fullscreen"},formatColumns:function(){return"Columns"},formatAllRows:function(){return"All"}},a.extend(q.DEFAULTS,q.LOCALES["en-US"]),q.COLUMN_DEFAULTS={radio:!1,checkbox:!1,checkboxEnabled:!0,field:void 0,title:void 0,titleTooltip:void 0,"class":void 0,align:void 0,halign:void 0,falign:void 0,valign:void 0,width:void 0,sortable:!1,order:"asc",visible:!0,switchable:!0,clickToSelect:!0,formatter:void 0,footerFormatter:void 0,events:void 0,sorter:void 0,sortName:void 0,cellStyle:void 0,searchable:!0,searchFormatter:!0,cardVisible:!0,escape:!1,showSelectTitle:!1},q.EVENTS={"all.bs.table":"onAll","click-cell.bs.table":"onClickCell","dbl-click-cell.bs.table":"onDblClickCell","click-row.bs.table":"onClickRow","dbl-click-row.bs.table":"onDblClickRow","sort.bs.table":"onSort","check.bs.table":"onCheck","uncheck.bs.table":"onUncheck","check-all.bs.table":"onCheckAll","uncheck-all.bs.table":"onUncheckAll","check-some.bs.table":"onCheckSome","uncheck-some.bs.table":"onUncheckSome","load-success.bs.table":"onLoadSuccess","load-error.bs.table":"onLoadError","column-switch.bs.table":"onColumnSwitch","page-change.bs.table":"onPageChange","search.bs.table":"onSearch","toggle.bs.table":"onToggle","pre-body.bs.table":"onPreBody","post-body.bs.table":"onPostBody","post-header.bs.table":"onPostHeader","expand-row.bs.table":"onExpandRow","collapse-row.bs.table":"onCollapseRow","refresh-options.bs.table":"onRefreshOptions","reset-view.bs.table":"onResetView","refresh.bs.table":"onRefresh","scroll-body.bs.table":"onScrollBody"},q.prototype.init=function(){this.initLocale(),this.initContainer(),this.initTable(),this.initHeader(),this.initData(),this.initHiddenRows(),this.initFooter(),this.initToolbar(),this.initPagination(),this.initBody(),this.initSearchText(),this.initServer()},q.prototype.initLocale=function(){if(this.options.locale){var b=this.options.locale.split(/-|_/);b[0].toLowerCase(),b[1]&&b[1].toUpperCase(),a.fn.bootstrapTable.locales[this.options.locale]?a.extend(this.options,a.fn.bootstrapTable.locales[this.options.locale]):a.fn.bootstrapTable.locales[b.join("-")]?a.extend(this.options,a.fn.bootstrapTable.locales[b.join("-")]):a.fn.bootstrapTable.locales[b[0]]&&a.extend(this.options,a.fn.bootstrapTable.locales[b[0]])}},q.prototype.initContainer=function(){this.$container=a(['<div class="bootstrap-table">','<div class="fixed-table-toolbar"></div>',"top"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?'<div class="fixed-table-pagination" style="clear: both;"></div>':"",'<div class="fixed-table-container">','<div class="fixed-table-header"><table></table></div>','<div class="fixed-table-body">','<div class="fixed-table-loading">',this.options.formatLoadingMessage(),"</div>","</div>",'<div class="fixed-table-footer"><table><tr></tr></table></div>',"</div>","bottom"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?'<div class="fixed-table-pagination"></div>':"","</div>"].join("")),this.$container.insertAfter(this.$el),this.$tableContainer=this.$container.find(".fixed-table-container"),this.$tableHeader=this.$container.find(".fixed-table-header"),this.$tableBody=this.$container.find(".fixed-table-body"),this.$tableLoading=this.$container.find(".fixed-table-loading"),this.$tableFooter=this.$container.find(".fixed-table-footer"),this.options.buttonsToolbar?this.$toolbar=a("body").find(this.options.buttonsToolbar):this.$toolbar=this.$container.find(".fixed-table-toolbar"),this.$pagination=this.$container.find(".fixed-table-pagination"),this.$tableBody.append(this.$el),this.$container.after('<div class="clearfix"></div>'),this.$el.addClass(this.options.classes),this.options.striped&&this.$el.addClass("table-striped"),-1!==a.inArray("table-no-bordered",this.options.classes.split(" "))&&this.$tableContainer.addClass("table-no-bordered")},q.prototype.initTable=function(){var b=this,c=[],d=[];if(this.$header=this.$el.find(">thead"),this.$header.length||(this.$header=a("<thead></thead>").appendTo(this.$el)),this.$header.find("tr").each(function(){var b=[];a(this).find("th").each(function(){"undefined"!=typeof a(this).data("field")&&a(this).data("field",a(this).data("field")+""),b.push(a.extend({},{title:a(this).html(),"class":a(this).attr("class"),titleTooltip:a(this).attr("title"),rowspan:a(this).attr("rowspan")?+a(this).attr("rowspan"):void 0,colspan:a(this).attr("colspan")?+a(this).attr("colspan"):void 0},a(this).data()))}),c.push(b)}),a.isArray(this.options.columns[0])||(this.options.columns=[this.options.columns]),this.options.columns=a.extend(!0,[],c,this.options.columns),this.columns=[],this.fieldsColumnsIndex=[],h(this.options.columns),a.each(this.options.columns,function(c,d){a.each(d,function(d,e){e=a.extend({},q.COLUMN_DEFAULTS,e),"undefined"!=typeof e.fieldIndex&&(b.columns[e.fieldIndex]=e,b.fieldsColumnsIndex[e.field]=e.fieldIndex),b.options.columns[c][d]=e})}),!this.options.data.length){var e=[];this.$el.find(">tbody>tr").each(function(c){var f={};f._id=a(this).attr("id"),f._class=a(this).attr("class"),f._data=m(a(this).data()),a(this).find(">td").each(function(d){for(var g,h,i=a(this),j=+i.attr("colspan")||1,k=+i.attr("rowspan")||1;e[c]&&e[c][d];d++);for(g=d;d+j>g;g++)for(h=c;c+k>h;h++)e[h]||(e[h]=[]),e[h][g]=!0;var l=b.columns[d].field;f[l]=a(this).html(),f["_"+l+"_id"]=a(this).attr("id"),f["_"+l+"_class"]=a(this).attr("class"),f["_"+l+"_rowspan"]=a(this).attr("rowspan"),f["_"+l+"_colspan"]=a(this).attr("colspan"),f["_"+l+"_title"]=a(this).attr("title"),f["_"+l+"_data"]=m(a(this).data())}),d.push(f)}),this.options.data=d,d.length&&(this.fromHtml=!0)}},q.prototype.initHeader=function(){var b=this,c={},d=[];this.header={fields:[],styles:[],classes:[],formatters:[],events:[],sorters:[],sortNames:[],cellStyles:[],searchables:[]},a.each(this.options.columns,function(e,g){d.push("<tr>"),0===e&&!b.options.cardView&&b.options.detailView&&d.push(f('<th class="detail" rowspan="%s"><div class="fht-cell"></div></th>',b.options.columns.length)),a.each(g,function(a,e){var g="",h="",i="",j="",k=f(' class="%s"',e["class"]),m=(b.options.sortOrder||e.order,"px"),n=e.width;if(void 0===e.width||b.options.cardView||"string"==typeof e.width&&-1!==e.width.indexOf("%")&&(m="%"),e.width&&"string"==typeof e.width&&(n=e.width.replace("%","").replace("px","")),h=f("text-align: %s; ",e.halign?e.halign:e.align),i=f("text-align: %s; ",e.align),j=f("vertical-align: %s; ",e.valign),j+=f("width: %s; ",!e.checkbox&&!e.radio||n?n?n+m:void 0:e.showSelectTitle?void 0:"36px"),"undefined"!=typeof e.fieldIndex){if(b.header.fields[e.fieldIndex]=e.field,b.header.styles[e.fieldIndex]=i+j,b.header.classes[e.fieldIndex]=k,b.header.formatters[e.fieldIndex]=e.formatter,b.header.events[e.fieldIndex]=e.events,b.header.sorters[e.fieldIndex]=e.sorter,b.header.sortNames[e.fieldIndex]=e.sortName,b.header.cellStyles[e.fieldIndex]=e.cellStyle,b.header.searchables[e.fieldIndex]=e.searchable,!e.visible)return;if(b.options.cardView&&!e.cardVisible)return;c[e.field]=e}d.push("<th"+f(' title="%s"',e.titleTooltip),e.checkbox||e.radio?f(' class="bs-checkbox %s"',e["class"]||""):k,f(' style="%s"',h+j),f(' rowspan="%s"',e.rowspan),f(' colspan="%s"',e.colspan),f(' data-field="%s"',e.field),0===a&&e.fieldIndex?" data-not-first-th":"",">"),d.push(f('<div class="th-inner %s">',b.options.sortable&&e.sortable?"sortable both":"")),g=b.options.escape?l(e.title):e.title;var o=g;e.checkbox&&(g="",!b.options.singleSelect&&b.options.checkboxHeader&&(g='<input name="btSelectAll" type="checkbox" />'),b.header.stateField=e.field),e.radio&&(g="",b.header.stateField=e.field,b.options.singleSelect=!0),!g&&e.showSelectTitle&&(g+=o),d.push(g),d.push("</div>"),d.push('<div class="fht-cell"></div>'),d.push("</div>"),d.push("</th>")}),d.push("</tr>")}),this.$header.html(d.join("")),this.$header.find("th[data-field]").each(function(b){a(this).data(c[a(this).data("field")])}),this.$container.off("click",".th-inner").on("click",".th-inner",function(c){var d=a(this);return b.options.detailView&&!d.parent().hasClass("bs-checkbox")&&d.closest(".bootstrap-table")[0]!==b.$container[0]?!1:void(b.options.sortable&&d.parent().data().sortable&&b.onSort(c))}),this.$header.children().children().off("keypress").on("keypress",function(c){if(b.options.sortable&&a(this).data().sortable){var d=c.keyCode||c.which;13==d&&b.onSort(c)}}),a(window).off("resize.bootstrap-table"),!this.options.showHeader||this.options.cardView?(this.$header.hide(),this.$tableHeader.hide(),this.$tableLoading.css("top",0)):(this.$header.show(),this.$tableHeader.show(),this.$tableLoading.css("top",this.$header.outerHeight()+1),this.getCaret(),a(window).on("resize.bootstrap-table",a.proxy(this.resetWidth,this))),this.$selectAll=this.$header.find('[name="btSelectAll"]'),this.$selectAll.off("click").on("click",function(){var c=a(this).prop("checked");b[c?"checkAll":"uncheckAll"](),b.updateSelected()})},q.prototype.initFooter=function(){!this.options.showFooter||this.options.cardView?this.$tableFooter.hide():this.$tableFooter.show()},q.prototype.initData=function(a,b){"append"===b?this.options.data=this.options.data.concat(a):"prepend"===b?this.options.data=[].concat(a).concat(this.options.data):this.options.data=a||this.options.data,this.data=this.options.data,"server"!==this.options.sidePagination&&this.initSort()},q.prototype.initSort=function(){var b=this,c=this.options.sortName,d="desc"===this.options.sortOrder?-1:1,e=a.inArray(this.options.sortName,this.header.fields),g=0;return this.options.customSort!==a.noop?void this.options.customSort.apply(this,[this.options.sortName,this.options.sortOrder]):void(-1!==e&&(this.options.sortStable&&a.each(this.data,function(a,b){b._position=a}),this.data.sort(function(f,g){b.header.sortNames[e]&&(c=b.header.sortNames[e]);var h=n(f,c,b.options.escape),i=n(g,c,b.options.escape),k=j(b.header,b.header.sorters[e],[h,i,f,g]);return void 0!==k?b.options.sortStable&&0===k?f._position-g._position:d*k:((void 0===h||null===h)&&(h=""),(void 0===i||null===i)&&(i=""),b.options.sortStable&&h===i?(h=f._position,i=g._position,f._position-g._position):a.isNumeric(h)&&a.isNumeric(i)?(h=parseFloat(h),i=parseFloat(i),i>h?-1*d:d):h===i?0:("string"!=typeof h&&(h=h.toString()),-1===h.localeCompare(i)?-1*d:d))}),void 0!==this.options.sortClass&&(clearTimeout(g),g=setTimeout(function(){b.$el.removeClass(b.options.sortClass);var a=b.$header.find(f('[data-field="%s"]',b.options.sortName).index()+1);b.$el.find(f("tr td:nth-child(%s)",a)).addClass(b.options.sortClass)},250))))},q.prototype.onSort=function(b){var c="keypress"===b.type?a(b.currentTarget):a(b.currentTarget).parent(),d=this.$header.find("th").eq(c.index());return this.$header.add(this.$header_).find("span.order").remove(),this.options.sortName===c.data("field")?this.options.sortOrder="asc"===this.options.sortOrder?"desc":"asc":(this.options.sortName=c.data("field"),this.options.rememberOrder?this.options.sortOrder="asc"===c.data("order")?"desc":"asc":this.options.sortOrder=this.columns[this.fieldsColumnsIndex[c.data("field")]].order),this.trigger("sort",this.options.sortName,this.options.sortOrder),c.add(d).data("order",this.options.sortOrder),this.getCaret(),"server"===this.options.sidePagination?void this.initServer(this.options.silentSort):(this.initSort(),void this.initBody())},q.prototype.initToolbar=function(){var b,c,e=this,g=[],h=0,i=0;this.$toolbar.find(".bs-bars").children().length&&a("body").append(a(this.options.toolbar)),this.$toolbar.html(""),("string"==typeof this.options.toolbar||"object"==typeof this.options.toolbar)&&a(f('<div class="bs-bars %s-%s"></div>',d.pullClass,this.options.toolbarAlign)).appendTo(this.$toolbar).append(a(this.options.toolbar)),g=[f('<div class="columns columns-%s btn-group %s-%s">',this.options.buttonsAlign,d.pullClass,this.options.buttonsAlign)],"string"==typeof this.options.icons&&(this.options.icons=j(null,this.options.icons)),this.options.showPaginationSwitch&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="paginationSwitch" aria-label="pagination Switch" title="%s">',this.options.formatPaginationSwitch()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.paginationSwitchDown),"</button>"),
this.options.showFullscreen&&this.$toolbar.find('button[name="fullscreen"]').off("click").on("click",a.proxy(this.toggleFullscreen,this)),this.options.showRefresh&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="refresh" aria-label="refresh" title="%s">',this.options.formatRefresh()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.refresh),"</button>"),this.options.showToggle&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="toggle" aria-label="toggle" title="%s">',this.options.formatToggle()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.toggle),"</button>"),this.options.showFullscreen&&g.push(f('<button class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+'" type="button" name="fullscreen" aria-label="fullscreen" title="%s">',this.options.formatFullscreen()),f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.fullscreen),"</button>"),this.options.showColumns&&(g.push(f('<div class="keep-open btn-group" title="%s">',this.options.formatColumns()),'<button type="button" aria-label="columns" class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">',f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.columns),' <span class="caret"></span>',"</button>",d.toobarDropdowHtml[0]),a.each(this.columns,function(a,b){if(!b.radio&&!b.checkbox&&(!e.options.cardView||b.cardVisible)){var c=b.visible?' checked="checked"':"";b.switchable&&(g.push(f(d.toobarDropdowItemHtml,f('<input type="checkbox" data-field="%s" value="%s"%s> %s',b.field,a,c,b.title))),i++)}}),g.push(d.toobarDropdowHtml[1],"</div>")),g.push("</div>"),(this.showToolbar||g.length>2)&&this.$toolbar.append(g.join("")),this.options.showPaginationSwitch&&this.$toolbar.find('button[name="paginationSwitch"]').off("click").on("click",a.proxy(this.togglePagination,this)),this.options.showRefresh&&this.$toolbar.find('button[name="refresh"]').off("click").on("click",a.proxy(this.refresh,this)),this.options.showToggle&&this.$toolbar.find('button[name="toggle"]').off("click").on("click",function(){e.toggleView()}),this.options.showColumns&&(b=this.$toolbar.find(".keep-open"),i<=this.options.minimumCountColumns&&b.find("input").prop("disabled",!0),b.find("li").off("click").on("click",function(a){a.stopImmediatePropagation()}),b.find("input").off("click").on("click",function(){var b=a(this);e.toggleColumn(a(this).val(),b.prop("checked"),!1),e.trigger("column-switch",a(this).data("field"),b.prop("checked"))})),this.options.search&&(g=[],g.push(f('<div class="%s-%s search">',d.pullClass,this.options.searchAlign),f('<input class="form-control'+f(" input-%s",this.options.iconSize)+'" type="text" placeholder="%s">',this.options.formatSearch()),"</div>"),this.$toolbar.append(g.join("")),c=this.$toolbar.find(".search input"),c.off("keyup drop blur").on("keyup drop blur",function(b){e.options.searchOnEnterKey&&13!==b.keyCode||a.inArray(b.keyCode,[37,38,39,40])>-1||(clearTimeout(h),h=setTimeout(function(){e.onSearch(b)},e.options.searchTimeOut))}),o()&&c.off("mouseup").on("mouseup",function(a){clearTimeout(h),h=setTimeout(function(){e.onSearch(a)},e.options.searchTimeOut)}))},q.prototype.onSearch=function(b){var c=a.trim(a(b.currentTarget).val());this.options.trimOnSearch&&a(b.currentTarget).val()!==c&&a(b.currentTarget).val(c),c!==this.searchText&&(this.searchText=c,this.options.searchText=c,this.options.pageNumber=1,this.initSearch(),b.firedByInitSearchText?"client"===this.options.sidePagination&&this.updatePagination():this.updatePagination(),this.trigger("search",c))},q.prototype.initSearch=function(){var b=this;if("server"!==this.options.sidePagination){if(this.options.customSearch!==a.noop)return void window[this.options.customSearch].apply(this,[this.searchText]);var c=this.searchText&&(this.options.escape?l(this.searchText):this.searchText).toLowerCase(),d=a.isEmptyObject(this.filterColumns)?null:this.filterColumns;this.data=d?a.grep(this.options.data,function(b,c){for(var e in d)if(a.isArray(d[e])&&-1===a.inArray(b[e],d[e])||!a.isArray(d[e])&&b[e]!==d[e])return!1;return!0}):this.options.data,this.data=c?a.grep(this.data,function(d,e){for(var f=0;f<b.header.fields.length;f++)if(b.header.searchables[f]){var g,h=a.isNumeric(b.header.fields[f])?parseInt(b.header.fields[f],10):b.header.fields[f],i=b.columns[b.fieldsColumnsIndex[h]];if("string"==typeof h){g=d;for(var k=h.split("."),l=0;l<k.length;l++)null!=g[k[l]]&&(g=g[k[l]]);i&&i.searchFormatter&&(g=j(i,b.header.formatters[f],[g,d,e],g))}else g=d[h];if("string"==typeof g||"number"==typeof g)if(b.options.strictSearch){if((g+"").toLowerCase()===c)return!0}else if(-1!==(g+"").toLowerCase().indexOf(c))return!0}return!1}):this.data}},q.prototype.initPagination=function(){if(!this.options.pagination)return void this.$pagination.hide();this.$pagination.show();var b,c,e,g,h,i,j,k=this,l=[],m=!1,n=this.getData(),o=this.options.pageList;if("server"!==this.options.sidePagination&&(this.options.totalRows=n.length),this.totalPages=0,this.options.totalRows){if(this.options.pageSize===this.options.formatAllRows())this.options.pageSize=this.options.totalRows,m=!0;else if(this.options.pageSize===this.options.totalRows){var p="string"==typeof this.options.pageList?this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").toLowerCase().split(","):this.options.pageList;a.inArray(this.options.formatAllRows().toLowerCase(),p)>-1&&(m=!0)}this.totalPages=~~((this.options.totalRows-1)/this.options.pageSize)+1,this.options.totalPages=this.totalPages}if(this.totalPages>0&&this.options.pageNumber>this.totalPages&&(this.options.pageNumber=this.totalPages),this.pageFrom=(this.options.pageNumber-1)*this.options.pageSize+1,this.pageTo=this.options.pageNumber*this.options.pageSize,this.pageTo>this.options.totalRows&&(this.pageTo=this.options.totalRows),l.push(f('<div class="%s-%s pagination-detail">',d.pullClass,this.options.paginationDetailHAlign),'<span class="pagination-info">',this.options.onlyInfoPagination?this.options.formatDetailPagination(this.options.totalRows):this.options.formatShowingRows(this.pageFrom,this.pageTo,this.options.totalRows),"</span>"),!this.options.onlyInfoPagination){l.push('<span class="page-list">');var q=[f('<span class="btn-group %s">',"top"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?"dropdown":"dropup"),'<button type="button" class="btn'+f(" btn-%s",this.options.buttonsClass)+f(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">','<span class="page-size">',m?this.options.formatAllRows():this.options.pageSize,"</span>",' <span class="caret"></span>',"</button>",d.pageDropdownHtml[0]];if("string"==typeof this.options.pageList){var r=this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").split(",");o=[],a.each(r,function(a,b){o.push(b.toUpperCase()===k.options.formatAllRows().toUpperCase()||"UNLIMITED"===b.toUpperCase()?k.options.formatAllRows():+b)})}for(a.each(o,function(a,b){if(!k.options.smartDisplay||0===a||o[a-1]<k.options.totalRows){var c;c=m?b===k.options.formatAllRows()?"active":"":b===k.options.pageSize?"active":"",q.push(f(d.pageDropdownItemHtml,c,b))}}),q.push(d.pageDropdownHtml[1]+"</span>"),l.push(this.options.formatRecordsPerPage(q.join(""))),l.push("</span>"),l.push("</div>",f('<div class="%s-%s pagination">',d.pullClass,this.options.paginationHAlign),'<ul class="pagination'+f(" pagination-%s",this.options.iconSize)+'">',f('<li class="page-item page-pre"><a class="page-link" href="#">%s</a></li>',this.options.paginationPreText)),this.totalPages<5?(c=1,e=this.totalPages):(c=this.options.pageNumber-2,e=c+4,1>c&&(c=1,e=5),e>this.totalPages&&(e=this.totalPages,c=e-4)),this.totalPages>=6&&(this.options.pageNumber>=3&&(l.push(f('<li class="page-item page-first%s">',1===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',1,"</a>","</li>"),c++),this.options.pageNumber>=4&&(4==this.options.pageNumber||6==this.totalPages||7==this.totalPages?c--:l.push('<li class="page-item page-first-separator disabled">','<a class="page-link" href="#">...</a>',"</li>"),e--)),this.totalPages>=7&&this.options.pageNumber>=this.totalPages-2&&c--,6==this.totalPages?this.options.pageNumber>=this.totalPages-2&&e++:this.totalPages>=7&&(7==this.totalPages||this.options.pageNumber>=this.totalPages-3)&&e++,b=c;e>=b;b++)l.push(f('<li class="page-item%s">',b===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',b,"</a>","</li>");this.totalPages>=8&&this.options.pageNumber<=this.totalPages-4&&l.push('<li class="page-item page-last-separator disabled">','<a class="page-link" href="#">...</a>',"</li>"),this.totalPages>=6&&this.options.pageNumber<=this.totalPages-3&&l.push(f('<li class="page-item page-last%s">',this.totalPages===this.options.pageNumber?" active":""),'<a class="page-link" href="#">',this.totalPages,"</a>","</li>"),l.push(f('<li class="page-item page-next"><a class="page-link" href="#">%s</a></li>',this.options.paginationNextText),"</ul>","</div>")}this.$pagination.html(l.join("")),this.options.onlyInfoPagination||(g=this.$pagination.find(".page-list a"),h=this.$pagination.find(".page-pre"),i=this.$pagination.find(".page-next"),j=this.$pagination.find(".page-item").not(".page-next, .page-pre"),this.options.smartDisplay&&(this.totalPages<=1&&this.$pagination.find("div.pagination").hide(),(o.length<2||this.options.totalRows<=o[0])&&this.$pagination.find("span.page-list").hide(),this.$pagination[this.getData().length?"show":"hide"]()),this.options.paginationLoop||(1===this.options.pageNumber&&h.addClass("disabled"),this.options.pageNumber===this.totalPages&&i.addClass("disabled")),m&&(this.options.pageSize=this.options.formatAllRows()),g.off("click").on("click",a.proxy(this.onPageListChange,this)),h.off("click").on("click",a.proxy(this.onPagePre,this)),i.off("click").on("click",a.proxy(this.onPageNext,this)),j.off("click").on("click",a.proxy(this.onPageNumber,this)))},q.prototype.updatePagination=function(b){b&&a(b.currentTarget).hasClass("disabled")||(this.options.maintainSelected||this.resetRows(),this.initPagination(),"server"===this.options.sidePagination?this.initServer():this.initBody(),this.trigger("page-change",this.options.pageNumber,this.options.pageSize))},q.prototype.onPageListChange=function(b){b.preventDefault();var c=a(b.currentTarget);return c.parent().addClass("active").siblings().removeClass("active"),this.options.pageSize=c.text().toUpperCase()===this.options.formatAllRows().toUpperCase()?this.options.formatAllRows():+c.text(),this.$toolbar.find(".page-size").text(this.options.pageSize),this.updatePagination(b),!1},q.prototype.onPagePre=function(a){return a.preventDefault(),this.options.pageNumber-1===0?this.options.pageNumber=this.options.totalPages:this.options.pageNumber--,this.updatePagination(a),!1},q.prototype.onPageNext=function(a){return a.preventDefault(),this.options.pageNumber+1>this.options.totalPages?this.options.pageNumber=1:this.options.pageNumber++,this.updatePagination(a),!1},q.prototype.onPageNumber=function(b){return b.preventDefault(),this.options.pageNumber!==+a(b.currentTarget).text()?(this.options.pageNumber=+a(b.currentTarget).text(),this.updatePagination(b),!1):void 0},q.prototype.initRow=function(b,c,d,e){var h,i=this,k=[],m={},o=[],p="",q={},r=[];if(!(a.inArray(b,this.hiddenRows)>-1)){if(m=j(this.options,this.options.rowStyle,[b,c],m),m&&m.css)for(h in m.css)o.push(h+": "+m.css[h]);if(q=j(this.options,this.options.rowAttributes,[b,c],q))for(h in q)r.push(f('%s="%s"',h,l(q[h])));return b._data&&!a.isEmptyObject(b._data)&&a.each(b._data,function(a,b){"index"!==a&&(p+=f(' data-%s="%s"',a,b))}),k.push("<tr",f(" %s",r.join(" ")),f(' id="%s"',a.isArray(b)?void 0:b._id),f(' class="%s"',m.classes||(a.isArray(b)?void 0:b._class)),f(' data-index="%s"',c),f(' data-uniqueid="%s"',b[this.options.uniqueId]),f("%s",p),">"),this.options.cardView&&k.push(f('<td colspan="%s"><div class="card-views">',this.header.fields.length)),!this.options.cardView&&this.options.detailView&&(k.push("<td>"),j(null,this.options.detailFilter,[c,b])&&k.push('<a class="detail-icon" href="#">',f('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.detailOpen),"</a>"),k.push("</td>")),a.each(this.header.fields,function(d,e){var h="",p=n(b,e,i.options.escape),q="",r="",s={},t="",u=i.header.classes[d],v="",w="",x="",y="",z=i.columns[d];if((!i.fromHtml||"undefined"!=typeof p||z.checkbox||z.radio)&&z.visible&&(!i.options.cardView||z.cardVisible)){if(z.escape&&(p=l(p)),m=f('style="%s"',o.concat(i.header.styles[d]).join("; ")),b["_"+e+"_id"]&&(t=f(' id="%s"',b["_"+e+"_id"])),b["_"+e+"_class"]&&(u=f(' class="%s"',b["_"+e+"_class"])),b["_"+e+"_rowspan"]&&(w=f(' rowspan="%s"',b["_"+e+"_rowspan"])),b["_"+e+"_colspan"]&&(x=f(' colspan="%s"',b["_"+e+"_colspan"])),b["_"+e+"_title"]&&(y=f(' title="%s"',b["_"+e+"_title"])),s=j(i.header,i.header.cellStyles[d],[p,b,c,e],s),s.classes&&(u=f(' class="%s"',s.classes)),s.css){var A=[];for(var B in s.css)A.push(B+": "+s.css[B]);m=f('style="%s"',A.concat(i.header.styles[d]).join("; "))}q=j(z,i.header.formatters[d],[p,b,c,e],p),b["_"+e+"_data"]&&!a.isEmptyObject(b["_"+e+"_data"])&&a.each(b["_"+e+"_data"],function(a,b){"index"!==a&&(v+=f(' data-%s="%s"',a,b))}),z.checkbox||z.radio?(r=z.checkbox?"checkbox":r,r=z.radio?"radio":r,h=[f(i.options.cardView?'<div class="card-view %s">':'<td class="bs-checkbox %s">',z["class"]||""),"<input"+f(' data-index="%s"',c)+f(' name="%s"',i.options.selectItemName)+f(' type="%s"',r)+f(' value="%s"',b[i.options.idField])+f(' checked="%s"',q===!0||p||q&&q.checked?"checked":void 0)+f(' disabled="%s"',!z.checkboxEnabled||q&&q.disabled?"disabled":void 0)+" />",i.header.formatters[d]&&"string"==typeof q?q:"",i.options.cardView?"</div>":"</td>"].join(""),b[i.header.stateField]=q===!0||!!p||q&&q.checked):(q="undefined"==typeof q||null===q?i.options.undefinedText:q,h=i.options.cardView?['<div class="card-view">',i.options.showHeader?f('<span class="title" %s>%s</span>',m,g(i.columns,"field","title",e)):"",f('<span class="value">%s</span>',q),"</div>"].join(""):[f("<td%s %s %s %s %s %s %s>",t,u,m,v,w,x,y),q,"</td>"].join(""),i.options.cardView&&i.options.smartDisplay&&""===q&&(h='<div class="card-view"></div>')),k.push(h)}}),this.options.cardView&&k.push("</div></td>"),k.push("</tr>"),k.join(" ")}},q.prototype.initBody=function(b){var c=this,d=this.getData();this.trigger("pre-body",d),this.$body=this.$el.find(">tbody"),this.$body.length||(this.$body=a("<tbody></tbody>").appendTo(this.$el)),this.options.pagination&&"server"!==this.options.sidePagination||(this.pageFrom=1,this.pageTo=d.length);for(var e,g=a(document.createDocumentFragment()),h=this.pageFrom-1;h<this.pageTo;h++){var i=d[h],k=this.initRow(i,h,d,g);e=e||!!k,k&&k!==!0&&g.append(k)}e||g.append('<tr class="no-records-found">'+f('<td colspan="%s">%s</td>',this.$header.find("th").length,this.options.formatNoMatches())+"</tr>"),this.$body.html(g),b||this.scrollTo(0),this.$body.find("> tr[data-index] > td").off("click dblclick").on("click dblclick",function(b){var d=a(this),e=d.parent(),g=c.data[e.data("index")],h=d[0].cellIndex,i=c.getVisibleFields(),j=i[c.options.detailView&&!c.options.cardView?h-1:h],k=c.columns[c.fieldsColumnsIndex[j]],l=n(g,j,c.options.escape);if(!d.find(".detail-icon").length&&(c.trigger("click"===b.type?"click-cell":"dbl-click-cell",j,l,g,d),c.trigger("click"===b.type?"click-row":"dbl-click-row",g,e,j),"click"===b.type&&c.options.clickToSelect&&k.clickToSelect&&c.options.ignoreClickToSelectOn(b.target))){var m=e.find(f('[name="%s"]',c.options.selectItemName));m.length&&m[0].click()}}),this.$body.find("> tr[data-index] > td > .detail-icon").off("click").on("click",function(b){b.preventDefault();var e=a(this),g=e.parent().parent(),h=g.data("index"),i=d[h];if(g.next().is("tr.detail-view"))e.find("i").attr("class",f("%s %s",c.options.iconsPrefix,c.options.icons.detailOpen)),c.trigger("collapse-row",h,i,g.next()),g.next().remove();else{e.find("i").attr("class",f("%s %s",c.options.iconsPrefix,c.options.icons.detailClose)),g.after(f('<tr class="detail-view"><td colspan="%s"></td></tr>',g.find("td").length));var k=g.next().find("td"),l=j(c.options,c.options.detailFormatter,[h,i,k],"");1===k.length&&k.append(l),c.trigger("expand-row",h,i,k)}return c.resetView(),!1}),this.$selectItem=this.$body.find(f('[name="%s"]',this.options.selectItemName)),this.$selectItem.off("click").on("click",function(b){b.stopImmediatePropagation();var d=a(this),e=d.prop("checked"),f=c.data[d.data("index")];(a(this).is(":radio")||c.options.singleSelect)&&a.each(c.options.data,function(a,b){b[c.header.stateField]=!1}),f[c.header.stateField]=e,c.options.singleSelect&&(c.$selectItem.not(this).each(function(){c.data[a(this).data("index")][c.header.stateField]=!1}),c.$selectItem.filter(":checked").not(this).prop("checked",!1)),c.updateSelected(),c.trigger(e?"check":"uncheck",f,d)}),a.each(this.header.events,function(b,d){if(d){"string"==typeof d&&(d=j(null,d));var e=c.header.fields[b],f=a.inArray(e,c.getVisibleFields());if(-1!==f){c.options.detailView&&!c.options.cardView&&(f+=1);for(var g in d)c.$body.find(">tr:not(.no-records-found)").each(function(){var b=a(this),h=b.find(c.options.cardView?".card-view":"td").eq(f),i=g.indexOf(" "),j=g.substring(0,i),k=g.substring(i+1),l=d[g];h.find(k).off(j).on(j,function(a){var d=b.data("index"),f=c.data[d],g=f[e];l.apply(this,[a,g,f,d])})})}}}),this.updateSelected(),this.resetView(),this.trigger("post-body",d)},q.prototype.initServer=function(b,c,d){var e,f=this,g={},h=a.inArray(this.options.sortName,this.header.fields),i={searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder};this.header.sortNames[h]&&(i.sortName=this.header.sortNames[h]),this.options.pagination&&"server"===this.options.sidePagination&&(i.pageSize=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,i.pageNumber=this.options.pageNumber),(d||this.options.url||this.options.ajax)&&("limit"===this.options.queryParamsType&&(i={search:i.searchText,sort:i.sortName,order:i.sortOrder},this.options.pagination&&"server"===this.options.sidePagination&&(i.offset=this.options.pageSize===this.options.formatAllRows()?0:this.options.pageSize*(this.options.pageNumber-1),i.limit=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,0===i.limit&&delete i.limit)),a.isEmptyObject(this.filterColumnsPartial)||(i.filter=JSON.stringify(this.filterColumnsPartial,null)),g=j(this.options,this.options.queryParams,[i],g),a.extend(g,c||{}),g!==!1&&(b||this.$tableLoading.show(),e=a.extend({},j(null,this.options.ajaxOptions),{type:this.options.method,url:d||this.options.url,data:"application/json"===this.options.contentType&&"post"===this.options.method?JSON.stringify(g):g,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success:function(a){a=j(f.options,f.options.responseHandler,[a],a),f.load(a),f.trigger("load-success",a),b||f.$tableLoading.hide()},error:function(a){var c=[];"server"===f.options.sidePagination&&(c={},c[f.options.totalField]=0,c[f.options.dataField]=[]),f.load(c),f.trigger("load-error",a.status,a),b||f.$tableLoading.hide()}}),this.options.ajax?j(this,this.options.ajax,[e],null):(this._xhr&&4!==this._xhr.readyState&&this._xhr.abort(),this._xhr=a.ajax(e))))},q.prototype.initSearchText=function(){if(this.options.search&&(this.searchText="",""!==this.options.searchText)){var a=this.$toolbar.find(".search input");a.val(this.options.searchText),this.onSearch({currentTarget:a,firedByInitSearchText:!0})}},q.prototype.getCaret=function(){var b=this;a.each(this.$header.find("th"),function(c,d){a(d).find(".sortable").removeClass("desc asc").addClass(a(d).data("field")===b.options.sortName?b.options.sortOrder:"both")})},q.prototype.updateSelected=function(){var b=this.$selectItem.filter(":enabled").length&&this.$selectItem.filter(":enabled").length===this.$selectItem.filter(":enabled").filter(":checked").length;this.$selectAll.add(this.$selectAll_).prop("checked",b),this.$selectItem.each(function(){a(this).closest("tr")[a(this).prop("checked")?"addClass":"removeClass"]("selected")})},q.prototype.updateRows=function(){var b=this;this.$selectItem.each(function(){b.data[a(this).data("index")][b.header.stateField]=a(this).prop("checked")})},q.prototype.resetRows=function(){var b=this;a.each(this.data,function(a,c){b.$selectAll.prop("checked",!1),b.$selectItem.prop("checked",!1),b.header.stateField&&(c[b.header.stateField]=!1)}),this.initHiddenRows()},q.prototype.trigger=function(b){var c=Array.prototype.slice.call(arguments,1);b+=".bs.table",this.options[q.EVENTS[b]].apply(this.options,c),this.$el.trigger(a.Event(b),c),this.options.onAll(b,c),this.$el.trigger(a.Event("all.bs.table"),[b,c])},q.prototype.resetHeader=function(){clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(a.proxy(this.fitHeader,this),this.$el.is(":hidden")?100:0)},q.prototype.fitHeader=function(){var b,c,d,e,g=this;if(g.$el.is(":hidden"))return void(g.timeoutId_=setTimeout(a.proxy(g.fitHeader,g),100));if(b=this.$tableBody.get(0),c=b.scrollWidth>b.clientWidth&&b.scrollHeight>b.clientHeight+this.$header.outerHeight()?i():0,this.$el.css("margin-top",-this.$header.outerHeight()),d=a(":focus"),d.length>0){var h=d.parents("th");if(h.length>0){var j=h.attr("data-field");if(void 0!==j){var k=this.$header.find("[data-field='"+j+"']");k.length>0&&k.find(":input").addClass("focus-temp")}}}this.$header_=this.$header.clone(!0,!0),this.$selectAll_=this.$header_.find('[name="btSelectAll"]'),this.$tableHeader.css({"margin-right":c}).find("table").css("width",this.$el.outerWidth()).html("").attr("class",this.$el.attr("class")).append(this.$header_),e=a(".focus-temp:visible:eq(0)"),e.length>0&&(e.focus(),this.$header.find(".focus-temp").removeClass("focus-temp")),this.$header.find("th[data-field]").each(function(b){g.$header_.find(f('th[data-field="%s"]',a(this).data("field"))).data(a(this).data())});var l=this.getVisibleFields(),m=this.$header_.find("th");this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(b){var c=a(this),d=b;if(g.options.detailView&&!g.options.cardView&&(0===b&&g.$header_.find("th.detail").find(".fht-cell").width(c.innerWidth()),d=b-1),-1!==d){var e=g.$header_.find(f('th[data-field="%s"]',l[d]));e.length>1&&(e=a(m[c[0].cellIndex]));var h=e.width()-e.find(".fht-cell").width();e.find(".fht-cell").width(c.innerWidth()-h)}}),this.horizontalScroll(),this.trigger("post-header")},q.prototype.resetFooter=function(){var b=this,c=b.getData(),d=[];this.options.showFooter&&!this.options.cardView&&(!this.options.cardView&&this.options.detailView&&d.push('<td><div class="th-inner">&nbsp;</div><div class="fht-cell"></div></td>'),a.each(this.columns,function(a,e){var g,h="",i="",k=[],l={},m=f(' class="%s"',e["class"]);if(e.visible&&(!b.options.cardView||e.cardVisible)){if(h=f("text-align: %s; ",e.falign?e.falign:e.align),i=f("vertical-align: %s; ",e.valign),l=j(null,b.options.footerStyle),l&&l.css)for(g in l.css)k.push(g+": "+l.css[g]);d.push("<td",m,f(' style="%s"',h+i+k.concat().join("; ")),">"),d.push('<div class="th-inner">'),d.push(j(e,e.footerFormatter,[c],"&nbsp;")||"&nbsp;"),d.push("</div>"),d.push('<div class="fht-cell"></div>'),d.push("</div>"),d.push("</td>")}}),this.$tableFooter.find("tr").html(d.join("")),this.$tableFooter.show(),clearTimeout(this.timeoutFooter_),this.timeoutFooter_=setTimeout(a.proxy(this.fitFooter,this),this.$el.is(":hidden")?100:0))},q.prototype.fitFooter=function(){var b,c,d;return clearTimeout(this.timeoutFooter_),this.$el.is(":hidden")?void(this.timeoutFooter_=setTimeout(a.proxy(this.fitFooter,this),100)):(c=this.$el.css("width"),d=c>this.$tableBody.width()?i():0,this.$tableFooter.css({"margin-right":d}).find("table").css("width",c).attr("class",this.$el.attr("class")),b=this.$tableFooter.find("td"),this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(c){var d=a(this);b.eq(c).find(".fht-cell").width(d.innerWidth())}),void this.horizontalScroll())},q.prototype.horizontalScroll=function(){var b=this;b.trigger("scroll-body"),this.$tableBody.off("scroll").on("scroll",function(){b.options.showHeader&&b.options.height&&b.$tableHeader.scrollLeft(a(this).scrollLeft()),b.options.showFooter&&!b.options.cardView&&b.$tableFooter.scrollLeft(a(this).scrollLeft())})},q.prototype.toggleColumn=function(a,b,c){if(-1!==a&&(this.columns[a].visible=b,this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns)){var d=this.$toolbar.find(".keep-open input").prop("disabled",!1);c&&d.filter(f('[value="%s"]',a)).prop("checked",b),d.filter(":checked").length<=this.options.minimumCountColumns&&d.filter(":checked").prop("disabled",!0)}},q.prototype.getVisibleFields=function(){var b=this,c=[];return a.each(this.header.fields,function(a,d){var e=b.columns[b.fieldsColumnsIndex[d]];e.visible&&c.push(d)}),c},q.prototype.resetView=function(a){var b=0;if(a&&a.height&&(this.options.height=a.height),this.$selectAll.prop("checked",this.$selectItem.length>0&&this.$selectItem.length===this.$selectItem.filter(":checked").length),this.options.height){var c=this.$toolbar.outerHeight(!0),d=this.$pagination.outerHeight(!0),e=this.options.height-c-d;this.$tableContainer.css("height",e+"px")}return this.options.cardView?(this.$el.css("margin-top","0"),this.$tableContainer.css("padding-bottom","0"),void this.$tableFooter.hide()):(this.options.showHeader&&this.options.height?(this.$tableHeader.show(),this.resetHeader(),b+=this.$header.outerHeight()):(this.$tableHeader.hide(),this.trigger("post-header")),this.options.showFooter&&(this.resetFooter(),this.options.height&&(b+=this.$tableFooter.outerHeight()+1)),this.getCaret(),this.$tableContainer.css("padding-bottom",b+"px"),void this.trigger("reset-view"))},q.prototype.getData=function(b){var c=this.options.data;return(this.searchText||this.options.sortName||!a.isEmptyObject(this.filterColumns)||!a.isEmptyObject(this.filterColumnsPartial))&&(c=this.data),b?c.slice(this.pageFrom-1,this.pageTo):c},q.prototype.load=function(b){var c=!1;this.options.pagination&&"server"===this.options.sidePagination?(this.options.totalRows=b[this.options.totalField],c=b.fixedScroll,b=b[this.options.dataField]):a.isArray(b)||(c=b.fixedScroll,b=b.data),this.initData(b),this.initSearch(),this.initPagination(),this.initBody(c)},q.prototype.append=function(a){this.initData(a,"append"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.prepend=function(a){this.initData(a,"prepend"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.remove=function(b){var c,d,e=this.options.data.length;if(b.hasOwnProperty("field")&&b.hasOwnProperty("values")){for(c=e-1;c>=0;c--)d=this.options.data[c],d.hasOwnProperty(b.field)&&-1!==a.inArray(d[b.field],b.values)&&(this.options.data.splice(c,1),"server"===this.options.sidePagination&&(this.options.totalRows-=1));e!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}},q.prototype.removeAll=function(){this.options.data.length>0&&(this.options.data.splice(0,this.options.data.length),this.initSearch(),this.initPagination(),this.initBody(!0))},q.prototype.getRowByUniqueId=function(a){var b,c,d,e=this.options.uniqueId,f=this.options.data.length,g=null;for(b=f-1;b>=0;b--){if(c=this.options.data[b],c.hasOwnProperty(e))d=c[e];else{if(!c._data.hasOwnProperty(e))continue;d=c._data[e]}if("string"==typeof d?a=a.toString():"number"==typeof d&&(Number(d)===d&&d%1===0?a=parseInt(a):d===Number(d)&&0!==d&&(a=parseFloat(a))),d===a){g=c;break}}return g},q.prototype.removeByUniqueId=function(a){var b=this.options.data.length,c=this.getRowByUniqueId(a);c&&this.options.data.splice(this.options.data.indexOf(c),1),b!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initBody(!0))},q.prototype.updateByUniqueId=function(b){var c=this,d=a.isArray(b)?b:[b];a.each(d,function(b,d){var e;d.hasOwnProperty("id")&&d.hasOwnProperty("row")&&(e=a.inArray(c.getRowByUniqueId(d.id),c.options.data),-1!==e&&a.extend(c.options.data[e],d.row))}),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.refreshColumnTitle=function(b){if(b.hasOwnProperty("field")&&b.hasOwnProperty("title")&&(this.columns[this.fieldsColumnsIndex[b.field]].title=this.options.escape?l(b.title):b.title,this.columns[this.fieldsColumnsIndex[b.field]].visible)){var c=void 0!==this.options.height?this.$tableHeader:this.$header;c.find("th[data-field]").each(function(c){return a(this).data("field")===b.field?(a(a(this).find(".th-inner")[0]).text(b.title),!1):void 0})}},q.prototype.insertRow=function(a){a.hasOwnProperty("index")&&a.hasOwnProperty("row")&&(this.options.data.splice(a.index,0,a.row),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))},q.prototype.updateRow=function(b){var c=this,d=a.isArray(b)?b:[b];a.each(d,function(b,d){d.hasOwnProperty("index")&&d.hasOwnProperty("row")&&a.extend(c.options.data[d.index],d.row)}),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)},q.prototype.initHiddenRows=function(){this.hiddenRows=[]},q.prototype.showRow=function(a){this.toggleRow(a,!0)},q.prototype.hideRow=function(a){this.toggleRow(a,!1)},q.prototype.toggleRow=function(b,c){var d,e;b.hasOwnProperty("index")?d=this.getData()[b.index]:b.hasOwnProperty("uniqueId")&&(d=this.getRowByUniqueId(b.uniqueId)),d&&(e=a.inArray(d,this.hiddenRows),c||-1!==e?c&&e>-1&&this.hiddenRows.splice(e,1):this.hiddenRows.push(d),this.initBody(!0))},q.prototype.getHiddenRows=function(b){var c=this,d=this.getData(),e=[];return a.each(d,function(b,d){a.inArray(d,c.hiddenRows)>-1&&e.push(d)}),this.hiddenRows=e,e},q.prototype.mergeCells=function(b){var c,d,e,f=b.index,g=a.inArray(b.field,this.getVisibleFields()),h=b.rowspan||1,i=b.colspan||1,j=this.$body.find(">tr");if(this.options.detailView&&!this.options.cardView&&(g+=1),e=j.eq(f).find(">td").eq(g),!(0>f||0>g||f>=this.data.length)){for(c=f;f+h>c;c++)for(d=g;g+i>d;d++)j.eq(c).find(">td").eq(d).hide();e.attr("rowspan",h).attr("colspan",i).show()}},q.prototype.updateCell=function(a){a.hasOwnProperty("index")&&a.hasOwnProperty("field")&&a.hasOwnProperty("value")&&(this.data[a.index][a.field]=a.value,a.reinit!==!1&&(this.initSort(),this.initBody(!0)))},q.prototype.updateCellById=function(b){var c=this;if(b.hasOwnProperty("id")&&b.hasOwnProperty("field")&&b.hasOwnProperty("value")){var d=a.isArray(b)?b:[b];a.each(d,function(b,d){var e;e=a.inArray(c.getRowByUniqueId(d.id),c.options.data),-1!==e&&(c.data[e][d.field]=d.value)}),b.reinit!==!1&&(this.initSort(),this.initBody(!0))}},q.prototype.getOptions=function(){return a.extend(!0,{},this.options)},q.prototype.getSelections=function(){var b=this;return a.grep(this.options.data,function(a){return a[b.header.stateField]===!0})},q.prototype.getAllSelections=function(){var b=this;return a.grep(this.options.data,function(a){return a[b.header.stateField]})},q.prototype.checkAll=function(){this.checkAll_(!0)},q.prototype.uncheckAll=function(){this.checkAll_(!1)},q.prototype.checkInvert=function(){var b=this,c=b.$selectItem.filter(":enabled"),d=c.filter(":checked");c.each(function(){a(this).prop("checked",!a(this).prop("checked"))}),b.updateRows(),b.updateSelected(),b.trigger("uncheck-some",d),d=b.getSelections(),b.trigger("check-some",d)},q.prototype.checkAll_=function(a){var b;a||(b=this.getSelections()),this.$selectAll.add(this.$selectAll_).prop("checked",a),this.$selectItem.filter(":enabled").prop("checked",a),this.updateRows(),a&&(b=this.getSelections()),this.trigger(a?"check-all":"uncheck-all",b)},q.prototype.check=function(a){
this.check_(!0,a)},q.prototype.uncheck=function(a){this.check_(!1,a)},q.prototype.check_=function(a,b){var c=this.$selectItem.filter(f('[data-index="%s"]',b)).prop("checked",a);this.data[b][this.header.stateField]=a,this.updateSelected(),this.trigger(a?"check":"uncheck",this.data[b],c)},q.prototype.checkBy=function(a){this.checkBy_(!0,a)},q.prototype.uncheckBy=function(a){this.checkBy_(!1,a)},q.prototype.checkBy_=function(b,c){if(c.hasOwnProperty("field")&&c.hasOwnProperty("values")){var d=this,e=[];a.each(this.options.data,function(g,h){if(!h.hasOwnProperty(c.field))return!1;if(-1!==a.inArray(h[c.field],c.values)){var i=d.$selectItem.filter(":enabled").filter(f('[data-index="%s"]',g)).prop("checked",b);h[d.header.stateField]=b,e.push(h),d.trigger(b?"check":"uncheck",h,i)}}),this.updateSelected(),this.trigger(b?"check-some":"uncheck-some",e)}},q.prototype.destroy=function(){this.$el.insertBefore(this.$container),a(this.options.toolbar).insertBefore(this.$el),this.$container.next().remove(),this.$container.remove(),this.$el.html(this.$el_.html()).css("margin-top","0").attr("class",this.$el_.attr("class")||"")},q.prototype.showLoading=function(){this.$tableLoading.show()},q.prototype.hideLoading=function(){this.$tableLoading.hide()},q.prototype.togglePagination=function(){this.options.pagination=!this.options.pagination;var a=this.$toolbar.find('button[name="paginationSwitch"] i');this.options.pagination?a.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchDown):a.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchUp),this.updatePagination()},q.prototype.toggleFullscreen=function(){this.$el.closest(".bootstrap-table").toggleClass("fullscreen")},q.prototype.refresh=function(a){a&&a.url&&(this.options.url=a.url),a&&a.pageNumber&&(this.options.pageNumber=a.pageNumber),a&&a.pageSize&&(this.options.pageSize=a.pageSize),this.initServer(a&&a.silent,a&&a.query,a&&a.url),this.trigger("refresh",a)},q.prototype.resetWidth=function(){this.options.showHeader&&this.options.height&&this.fitHeader(),this.options.showFooter&&!this.options.cardView&&this.fitFooter()},q.prototype.showColumn=function(a){this.toggleColumn(this.fieldsColumnsIndex[a],!0,!0)},q.prototype.hideColumn=function(a){this.toggleColumn(this.fieldsColumnsIndex[a],!1,!0)},q.prototype.getHiddenColumns=function(){return a.grep(this.columns,function(a){return!a.visible})},q.prototype.getVisibleColumns=function(){return a.grep(this.columns,function(a){return a.visible})},q.prototype.toggleAllColumns=function(b){var c=this;if(a.each(this.columns,function(a,d){c.columns[a].visible=b}),this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns){var d=this.$toolbar.find(".keep-open input").prop("disabled",!1);d.filter(":checked").length<=this.options.minimumCountColumns&&d.filter(":checked").prop("disabled",!0)}},q.prototype.showAllColumns=function(){this.toggleAllColumns(!0)},q.prototype.hideAllColumns=function(){this.toggleAllColumns(!1)},q.prototype.filterBy=function(b){this.filterColumns=a.isEmptyObject(b)?{}:b,this.options.pageNumber=1,this.initSearch(),this.updatePagination()},q.prototype.scrollTo=function(a){return"string"==typeof a&&(a="bottom"===a?this.$tableBody[0].scrollHeight:0),"number"==typeof a&&this.$tableBody.scrollTop(a),"undefined"==typeof a?this.$tableBody.scrollTop():void 0},q.prototype.getScrollPosition=function(){return this.scrollTo()},q.prototype.selectPage=function(a){a>0&&a<=this.options.totalPages&&(this.options.pageNumber=a,this.updatePagination())},q.prototype.prevPage=function(){this.options.pageNumber>1&&(this.options.pageNumber--,this.updatePagination())},q.prototype.nextPage=function(){this.options.pageNumber<this.options.totalPages&&(this.options.pageNumber++,this.updatePagination())},q.prototype.toggleView=function(){this.options.cardView=!this.options.cardView,this.initHeader();var a=this.$toolbar.find('button[name="toggle"] i');this.options.cardView?(a.removeClass(this.options.icons.toggleOff),a.addClass(this.options.icons.toggleOn)):(a.removeClass(this.options.icons.toggleOn),a.addClass(this.options.icons.toggleOff)),this.initBody(),this.trigger("toggle",this.options.cardView)},q.prototype.refreshOptions=function(b){k(this.options,b,!0)||(this.options=a.extend(this.options,b),this.trigger("refresh-options",this.options),this.destroy(),this.init())},q.prototype.resetSearch=function(a){var b=this.$toolbar.find(".search input");b.val(a||""),this.onSearch({currentTarget:b})},q.prototype.expandRow_=function(a,b){var c=this.$body.find(f('> tr[data-index="%s"]',b));c.next().is("tr.detail-view")===(a?!1:!0)&&c.find("> td > .detail-icon").click()},q.prototype.expandRow=function(a){this.expandRow_(!0,a)},q.prototype.collapseRow=function(a){this.expandRow_(!1,a)},q.prototype.expandAllRows=function(b){if(b){var c=this.$body.find(f('> tr[data-index="%s"]',0)),d=this,e=null,g=!1,h=-1;if(c.next().is("tr.detail-view")?c.next().next().is("tr.detail-view")||(c.next().find(".detail-icon").click(),g=!0):(c.find("> td > .detail-icon").click(),g=!0),g)try{h=setInterval(function(){e=d.$body.find("tr.detail-view").last().find(".detail-icon"),e.length>0?e.click():clearInterval(h)},1)}catch(i){clearInterval(h)}}else for(var j=this.$body.children(),k=0;k<j.length;k++)this.expandRow_(!0,a(j[k]).data("index"))},q.prototype.collapseAllRows=function(b){if(b)this.expandRow_(!1,0);else for(var c=this.$body.children(),d=0;d<c.length;d++)this.expandRow_(!1,a(c[d]).data("index"))},q.prototype.updateFormatText=function(a,b){this.options[f("format%s",a)]&&("string"==typeof b?this.options[f("format%s",a)]=function(){return b}:"function"==typeof b&&(this.options[f("format%s",a)]=b)),this.initToolbar(),this.initPagination(),this.initBody()};var r=["getOptions","getSelections","getAllSelections","getData","load","append","prepend","remove","removeAll","insertRow","updateRow","updateCell","updateByUniqueId","removeByUniqueId","getRowByUniqueId","showRow","hideRow","getHiddenRows","mergeCells","refreshColumnTitle","checkAll","uncheckAll","checkInvert","check","uncheck","checkBy","uncheckBy","refresh","resetView","resetWidth","destroy","showLoading","hideLoading","showColumn","hideColumn","getHiddenColumns","getVisibleColumns","showAllColumns","hideAllColumns","filterBy","scrollTo","getScrollPosition","selectPage","prevPage","nextPage","togglePagination","toggleView","refreshOptions","resetSearch","expandRow","collapseRow","expandAllRows","collapseAllRows","updateFormatText","updateCellById"];a.fn.bootstrapTable=function(b){var c,d=Array.prototype.slice.call(arguments,1);return this.each(function(){var e=a(this),f=e.data("bootstrap.table"),g=a.extend({},q.DEFAULTS,e.data(),"object"==typeof b&&b);if("string"==typeof b){if(a.inArray(b,r)<0)throw new Error("Unknown method: "+b);if(!f)return;c=f[b].apply(f,d),"destroy"===b&&e.removeData("bootstrap.table")}f||e.data("bootstrap.table",f=new q(this,g))}),"undefined"==typeof c?this:c},a.fn.bootstrapTable.Constructor=q,a.fn.bootstrapTable.defaults=q.DEFAULTS,a.fn.bootstrapTable.columnDefaults=q.COLUMN_DEFAULTS,a.fn.bootstrapTable.locales=q.LOCALES,a.fn.bootstrapTable.methods=r,a.fn.bootstrapTable.utils={bootstrapVersion:b,sprintf:f,compareObjects:k,calculateObjectValue:j,getItemField:n,objectKeys:p,isIEBrowser:o},a(function(){a('[data-toggle="table"]').bootstrapTable()})}(jQuery),!function(a){"use strict";a.extend(a.fn.bootstrapTable.defaults,{editable:!0,onEditableInit:function(){return!1},onEditableSave:function(a,b,c,d){return!1},onEditableShown:function(a,b,c,d){return c.parent("td").find('button[data-name="dereference-'+a+'"]').hide(),!1},onEditableHidden:function(a,b,c,d){return c.parent("td").find('button[data-name="dereference-'+a+'"]').show(),!1},dereference:!0,onDereferenceInit:function(){return!1}}),a.extend(a.fn.bootstrapTable.Constructor.EVENTS,{"editable-init.bs.table":"onEditableInit","editable-save.bs.table":"onEditableSave","editable-shown.bs.table":"onEditableShown","editable-hidden.bs.table":"onEditableHidden","dereference-init.bs.table":"onDereferenceInit"});var b=a.fn.bootstrapTable.Constructor,c=b.prototype.initTable,d=b.prototype.initBody;b.prototype.initTable=function(){var b=this;c.apply(this,Array.prototype.slice.apply(arguments)),(this.options.editable||this.options.dereference)&&a.each(this.columns,function(c,d){if(d.editable||d.dereference){var e={},f=[],g="editable-",h=function(a,b){var c=a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()});if(c.slice(0,g.length)==g){var d=c.replace(g,"data-");e[d]=b}};a.each(b.options,h);var i={},j=[],k="dereference-",l=function(a,b){var c=a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()});if(c.slice(0,k.length)==k){var d=c.replace(k,"data-");i[d]=b}};a.each(b.options,l);var m=d.formatter;d.formatter=function(c,g,k){var n=m?m(c,g,k):c,o="";return d.editable&&(a.each(d,h),a.each(e,function(a,b){f.push(" "+a+'="'+b+'"')}),o+=['<a href="javascript:void(0)"',' data-name="'+d.field+'"',' data-pk="'+g[b.options.idField]+'"',' data-value="'+n+'"',f.join(""),"></a>"].join("")),d.dereference&&(a.each(d,l),a.each(i,function(a,b){j.push(" "+a+'="'+b+'"')}),o+=[' <a href="javascript:void(0)"',' data-name="dereference-'+d.field+'"',' data-value="'+n+'"',j.join(""),"> ",'<i class="glyphicon glyphicon-link"></i>',"</button>"].join("")),o}}})},b.prototype.initBody=function(){var b=this;d.apply(this,Array.prototype.slice.apply(arguments)),this.options.editable&&(a.each(this.columns,function(c,d){if(d.editable){var e=b.getData(),f=b.$body.find('a[data-name="'+d.field+'"]');f.each(function(){if("function"==typeof d.editable){var b=e[a(this).parents("tr[data-index]").data("index")];a(this).editable(d.editable(b,d.field))}else a(this).editable(d.editable)}).off("save").on("save",function(c,f){var g=e[a(this).parents("tr[data-index]").data("index")],h=g[d.field];a(this).data("value",f.submitValue),g[d.field]=f.submitValue,b.trigger("editable-save",d.field,g,h,a(this))}),f.each(function(){if("function"==typeof d.editable){var b=e[a(this).parents("tr[data-index]").data("index")];a(this).editable(d.editable(b,d.field))}else a(this).editable(d.editable)}).off("shown").on("shown",function(c,f){var g=e[a(this).parents("tr[data-index]").data("index")];b.trigger("editable-shown",d.field,g,a(this),f)}),f.each(function(){if("function"==typeof d.editable){var b=e[a(this).parents("tr[data-index]").data("index")];a(this).editable(d.editable(b,d.field))}else a(this).editable(d.editable)}).off("hidden").on("hidden",function(c,f){var g=e[a(this).parents("tr[data-index]").data("index")];b.trigger("editable-hidden",d.field,g,a(this),f)})}}),this.trigger("editable-init")),this.options.dereference&&(a.each(this.columns,function(c,d){if(d.dereference){var e=(b.getData(),b.$body.find('a[data-name="dereference-'+d.field+'"]'));e.off("click").on("click",function(b){return function(c,d){"function"==typeof b?b(a(this).attr("data-value")):console.log("Bad dereference definition")}}(d.dereference))}}),this.trigger("dereference-init"))}}(jQuery),function(a,b){var c={type:null,showLangSelect:!0,selectize:!1,create:!0},d=function(a,b,c,d,e,f){var g=parseInt(a,10);return isNaN(g)?!1:b||0!=g?!c&&0>g?!1:!d&&g>0?!1:void 0!=e&&g>e?!1:void 0!=f&&f>g?!1:!0:!1},e=function(b){return a.isNumeric(b)},f={"http://www.w3.org/2000/01/rdf-schema#Literal":{label:"Plain Literal"},"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource":{label:"Reference"},"http://www.w3.org/2001/XMLSchema#integer":{label:"Integer",verify:function(a){return d(a,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#decimal":{label:"Decimal",verify:e},"http://www.w3.org/2001/XMLSchema#double":{label:"Double",verify:e},"http://www.w3.org/2001/XMLSchema#float":{label:"Float",verify:e},"http://www.w3.org/2001/XMLSchema#nonPositiveInteger":{label:"Non-Positive Integer",verify:function(a){return d(a,!0,!0,!1)}},"http://www.w3.org/2001/XMLSchema#negativeInteger":{label:"Negative Integer",verify:function(a){return d(a,!1,!0,!1)}},"http://www.w3.org/2001/XMLSchema#long":{label:"Long",verify:function(a){return d(a,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#int":{label:"Int",verify:function(a){return d(a,!0,!0,!0,2147483647,-2147483648)}},"http://www.w3.org/2001/XMLSchema#short":{label:"Short",verify:function(a){return d(a,!0,!0,!0,32767,-32768)}},"http://www.w3.org/2001/XMLSchema#byte":{label:"Byte",verify:function(a){return d(a,!0,!0,!0,127,-128)}},"http://www.w3.org/2001/XMLSchema#nonNegativeInteger":{label:"Non-Negative Integer",verify:function(a){return d(a,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedLong":{label:"Unsigned Long",verify:function(a){return d(a,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedInt":{label:"Unsigned Int",verify:function(a){return d(a,!0,!1,!0,4294967295)}},"http://www.w3.org/2001/XMLSchema#unsignedShort":{label:"Unsigned Short",verify:function(a){return d(a,!0,!1,!0,65535)}},"http://www.w3.org/2001/XMLSchema#unsignedByte":{label:"Unsigned Byte",verify:function(a){return d(a,!0,!0,!0,255)}},"http://www.w3.org/2001/XMLSchema#positiveInteger":{label:"Positive Integer",verify:function(a){return d(a,!1,!1,!0)}},"http://www.w3.org/2001/XMLSchema#boolean":{label:"Boolean",setup:function(a,b){b?(a.bootstrapToggle&&a.bootstrapToggle("destroy"),a.attr("type","text")):(a.attr("type","checkbox"),a.bootstrapToggle({on:"True",off:"False"}))},getValue:function(a){return a.is(":checked")?"true":"false"},setValue:function(a,b){this.setup(a),b&&(b=b.toString().toLowerCase()),"1"===b||"true"===b?a.bootstrapToggle("on"):a.bootstrapToggle("off")}},"http://www.w3.org/2001/XMLSchema#string":{label:"String"},"http://www.w3.org/2001/XMLSchema#hexBinary":{label:"Hex Binary"},"http://www.w3.org/2001/XMLSchema#dateTime":{label:"Datetime",setup:function(a,b){b?a.datetimepicker("remove"):a.datetimepicker({format:"yyyy-mm-ddThh:ii:ssZ",weekStart:1,timezone:"Z"})}},"http://www.w3.org/2001/XMLSchema#date":{label:"Date",setup:function(a,b){b?a.datetimepicker("remove"):a.datetimepicker({format:"yyyy-mm-dd",weekStart:1})}}},g=function(b,d){var e=this;e.mainElement=b,e.options=a.extend({},c,d),e.currentType=e.options.type||"http://www.w3.org/2000/01/rdf-schema#Literal",e.mainElement.on("input",function(){e.checkHashSign(),e.verifyInput(),e.change()}),e.container=a(document.createElement("div")).addClass("rdfNodeEditor"),e.inputContainer=a(document.createElement("div")).addClass("rdfNodeInputContainer");var g=a(b).addClass("form-control");g.after(e.container),e.inputContainer.append(g),e.container.append(e.inputContainer),e.options.choices&&("object"==typeof e.options.choices?e.selectizeSetup(e.options.choices):"function"==typeof e.options.choices&&e.options.choices(function(a){e.selectizeSetup(a)}),e.updateView(!1)),e.typeContainer=a(document.createElement("div")).addClass("rdfNodeTypeContainer"),e.typeContainer.css("vertical-align","top"),e.typeElement=a(document.createElement("select")).addClass("form-control");for(var h in f)e.typeElement.append(a(document.createElement("option")).attr("value",h).text(f[h].label));e.typeContainer.append(e.typeElement),e.container.append(e.typeContainer);var i=function(){e.lastType=e.currentType,e.currentType=e.options.selectize?e.typeElement[0].selectize.getValue():e.typeElement.val(),e.verifyFct=f[e.currentType].verify,e.updateEditor(),e.verifyInput(),e.change()};if(e.options.selectize?(e.typeElement.selectize({onChange:i}),e.typeElement[0].selectize.setValue(this.currentType)):e.typeElement.change(i),e.options.type&&(e.typeElement.val(e.options.type),e.typeContainer.hide()),e.languageElement=a(document.createElement("input")).addClass("form-control").attr("placeholder","Language"),e.languageContainer=a(document.createElement("div")).addClass("rdfNodelanguageContainer"),e.languageContainer.css("vertical-align","top"),e.languageContainer.append(e.languageElement),e.container.append(e.languageContainer),"http://www.w3.org/2000/01/rdf-schema#Literal"===e.currentType&&e.options.showLangSelect||e.languageContainer.hide(),e.languageElement.on("input",function(){e.lang=e.languageElement.val(),e.verifyInput(),e.change()}),e.options.dereferenceLink){e.dereferenceLink=a(document.createElement("button")),e.dereferenceLink.attr("type","button").addClass("btn btn-default btn-sm"),e.dereferenceLink.html('<i class="glyphicon glyphicon-link"></i>');var j=a(document.createElement("div")).addClass("rdfe-reference-link");j.append(e.dereferenceLink),e.mainElement.closest(".editable-input").length?e.container.parent().after(j):e.container.after(j),e.dereferenceLink.on("click",function(){var a=e.getValue();a&&e.options.dereferenceLink(a.value)})}e.updateEditor(!0)};g.prototype.change=function(){a(this).trigger("changed",this)},g.prototype.selectizeSetup=function(c){var d=this;d.resourceContainer||(d.resourceSelect=a(document.createElement("select")),d.resourceSelect.attr("placeholder","Select/Enter resource"),d.resourceContainer=a(document.createElement("div")).addClass("rdfResourceContainer"),d.resourceContainer.append(d.resourceSelect),d.resourceContainer.css("min-width","200px"),d.inputContainer.append(d.resourceContainer)),d.resourceSelectize||(d.resourceSelect.selectize({delimiter:null,valueField:"value",searchField:["label"],sortField:["label"],lockOptgroupOrder:!0,create:function(a,c){var d=new b.RdfNode("uri",a);d.label=a,d.optgroup="local",this.options[a]=d,c(d)},createOnBlur:!0,onChange:function(a){d.mainElement.val(a),d.change()},render:{item:function(a,b){return"<div>"+b(a.label||a.value)+"</div>"},option:function(a,b){return a.label?"<div>"+b(a.label)+" <small>("+b(a.value)+")</small></div>":"<div>"+b(a.value)+"</div>"},option_create:function(a,c){var d=a.input;return d=b.Utils.trim(b.Utils.trim(d,"<"),">"),d!=a.input?'<div class="create">Add <strong>'+c(a.input)+"</strong> <small>("+c(d)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+c(d)+"</strong>&hellip;</div>"}}}),d.resourceSelectize=a(d.resourceSelect)[0].selectize),d.resourceSelectize.clearOptions(),d.resourceSelectize.clearOptionGroups(),d.resourceSelectize.addOptionGroup("local",{label:"Local Store"});for(var e=0;e<c.length;e++)c[e].optgroup="local";d.resourceSelectize.addOption(c)},g.prototype.updateSelection=function(a,b){var c=this,d=c.resourceSelectize;if(d){d.addOptionGroup(a,{label:a});for(var e=0;e<b.length;e++)b[e].optgroup=a;d.addOption(b),d.refreshOptions(!0)}};var h=function(){var b=["http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#string"];return function(c,d){return c===d||a.inArray(c,b)>=0&&a.inArray(d,b)>=0}}();g.prototype.updateEditor=function(a){var b=this;h(b.options.type,b.currentType)?b.typeContainer.hide():b.typeContainer.css("display","table-cell"),b.options.showLangSelect&&"http://www.w3.org/2000/01/rdf-schema#Literal"===b.currentType?b.languageContainer.css("display","table-cell"):b.languageContainer.hide(),(a||b.lastType!==b.currentType)&&(b.lastType&&f[b.lastType].setup&&f[b.lastType].setup(b.mainElement,!0),f[b.currentType].setup&&f[b.currentType].setup(b.mainElement),b.updateView("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==b.currentType))},g.prototype.getField=function(){var a=this;return"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===a.currentType?a.resourceSelectize:a.mainElement},g.prototype.getValue=function(){return"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===this.currentType?new b.RdfNode("uri",b.Utils.trim(b.Utils.trim(this.mainElement.val(),"<"),">")):new b.RdfNode("literal",f[this.currentType].getValue?f[this.currentType].getValue(this.mainElement):this.mainElement.val(),this.currentType,this.lang?this.lang:void 0)},g.prototype.setValue=function(a,c){if(a){var d=this;if(a=b.RdfNode.fromStoreNode(a),d.lastType=d.currentType,"uri"===a.type||d.startsWithHashSign())d.currentType="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",c?(d.selectizeSetup(c),d.updateView(!1)):d.updateView(!0);else if(d.updateView(!0),d.currentType=a.datatype||"http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#boolean"===d.options.type){var e=a.value.toString();("0"===e||"1"===e||"true"===e.toLowerCase()||"false"===e.toLowerCase())&&(d.currentType="http://www.w3.org/2001/XMLSchema#boolean")}d.lang=a.language,a.value&&a.value.indexOf&&-1!==a.value.indexOf("\n")&&d.transformToTextarea(),d.mainElement.val(a.value),d.resourceSelectize&&b.Utils.trim(a.value,"")&&(a.optgroup||(a.optgroup="local"),d.resourceSelectize.addOption(a),d.resourceSelectize.setValue(a.value)),f[d.currentType]&&f[d.currentType].setValue&&f[d.currentType].setValue(d.mainElement,d.mainElement.val()),d.languageElement.val(d.lang),d.typeElement.val(d.currentType),d.options.selectize&&d.typeElement[0].selectize.setValue(d.currentType),d.updateEditor(d.lastType!==d.currentType),d.lastType=d.currentType}},g.prototype.updateView=function(a){var b=this;b.dereferenceLink&&("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===b.currentType?b.dereferenceLink.show():b.dereferenceLink.hide()),b.inputContainer.css("width","auto"),a?(b.mainElement.show(),b.resourceContainer&&b.resourceContainer.hide()):b.resourceContainer?(b.inputContainer.css("width","50%"),b.resourceContainer.show(),b.mainElement.hide()):b.mainElement.show()},g.prototype.isValid=function(a){return this.verifyFct?this.verifyFct(this.mainElement.val()):!0},g.prototype.startsWithHashSign=function(){var c=this;if(c.options.startHashSignAsResource===!0){var d=b.Utils.trim(a(c.mainElement).val());return d.length>=1&&"#"===d.charAt(0)}return!1},g.prototype.checkHashSign=function(){var a=this;if(a.startsWithHashSign()){var b=a.options.selectize?a.typeElement[0].selectize.getValue():a.typeElement.val();"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==b&&(a.options.selectize?(a.typeElement[0].selectize.setValue("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"),a.typeElement[0].selectize.onChange()):(a.typeElement.val("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"),a.typeElement.change()))}},g.prototype.verifyInput=function(){var b=this,c=a(b.mainElement).val(),d=!0;c.length>0&&(d=b.verifyFct?b.verifyFct(c):!0),d?b.mainElement.removeClass("has-error"):b.mainElement.addClass("has-error")},g.prototype.isLiteralType=function(a){return f.hasOwnProperty(a)&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!=a},g.prototype.setEditFocus=function(){this.getField()&&this.getField().focus()},g.prototype.blur=function(){this.getField().blur()},g.prototype.getElement=function(){return this.container},g.prototype.transformToTextarea=function(){var b=this;if("INPUT"===b.mainElement.prop("tagName")&&"text"===b.mainElement.prop("type")){var c=document.createElement("textarea");c.id=b.mainElement.prop("id"),c.name=b.mainElement.prop("name"),c.value=b.mainElement.val(),a(c).addClass(b.mainElement.prop("class")),b.mainElement.replaceWith(c),b.mainElement=a(c)}},a.fn.rdfNodeEditor=function(a){var b=this.data("rdfNodeEditor");return b||(b=new g(this,a),this.data("rdfNodeEditor",b)),b}}(window.jQuery,RDFE),function(a,b){var c=function(a){this.init("rdfnode",a,c.defaults)};a.fn.editableutils.inherit(c,a.fn.editabletypes.abstractinput),a.extend(c.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.$input.rdfNodeEditor(this.options.rdfnode)},activate:function(){this.$input.rdfNodeEditor().setEditFocus()},value2html:function(b,c){return b||b===!1?void a(c).text(b.toString()):void a(c).empty()},html2value:function(a){return null},input2value:function(){return this.$input.rdfNodeEditor().getValue()},value2input:function(a){var c,d,e=this.$input.rdfNodeEditor(),f=function(){return a instanceof b.RdfNode?a.value:a};if(a instanceof b.RdfNode&&(c=a),!c||c&&"uri"===c.type){if(this.options&&this.options.rdfnode){var g=this.options.rdfnode,h=g.ontologyManager;if(h){var i=h.ontologyPropertyByURI(g.predicate);if(i){var j=i.getRange();if(j&&j.length){for(var k=0;k<j.length;k++)if(e.isLiteralType(j[k])){c=new b.RdfNode("literal",f(),j[k]);break}if(!c||c&&"uri"===c.type)if(d=g.document.itemsByRange(j))c=new b.RdfNode("uri",f());else for(k=0;k<j.length;k++)if(e.isLiteralType(j[k])){c=new b.RdfNode("literal",f(),j[k]);break}}}}}c||(c=this.options&&this.options.rdfnode&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===this.options.rdfnode.type?new b.RdfNode("uri",f(),"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"):new b.RdfNode("literal",f(),this.options.rdfnode.type))}e.setValue(c,d)}}),c.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{rdfnode:{},tpl:'<input type="text">'}),a.fn.editabletypes.rdfnode=c}(window.jQuery,RDFE),function(a){var b=function(b,c){var d=this;d.options=a.extend({},c),d.options.ontologyManager=d.options.ontologyManager||new RDFE.OntologyManager,d.mainElem=b,a(d.options.ontologyManager).on("changed",function(a,b){d.sel.addOption(b.allOntologies())}),a(d.mainElem).selectize({valueField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:d.options.ontologyManager.ontologiesAsArray(),onChange:function(b){a(d).trigger("changed",d.options.ontologyManager.ontologyByURI(b))},createOntology:function(a,b){return d.options.ontologyManager.ontologyByURI(d.options.ontologyManager.ontologyDetermine(a),b)},create:function(b,c){var e=this,f=d.options.ontologyManager.ontologyDetermine(b);f||(f=d.options.ontologyManager.prefixes[b]||b),d.options.ontologyManager.parseOntologyFile(f,{success:function(){c(e.settings.createOntology(b,!0))},error:function(d){d&&d.message&&a.notify({message:d.message},{type:"danger"}),c(e.settings.createOntology(b,!0))}})},render:{item:function(a,b){return"<div>"+b(a.title||a.label||a.prefix||a.URI)+"</div>"},option:function(a,b){return"<div>"+b(a.title||a.label||a.prefix||a.URI)+"<br/><small>("+b(a.URI)+")</small></div>"},option_create:function(a,b){var c=d.options.ontologyManager.prefixes[a.input]||a.input;return c!=a.input?'<div class="create">Load <strong>'+b(a.input)+"</strong> <small>("+b(c)+")</small>&hellip;</div>":'<div class="create">Load <strong>'+b(c)+"</strong>&hellip;</div>"}}}),d.sel=a(d.mainElem)[0].selectize};b.prototype.selectedOntologyURI=function(){return this.sel.getValue()},b.prototype.selectedOntology=function(){return this.sel.options[this.selectedOntologyURI()]},b.prototype.on=function(b,c){a(this).on(b,c)},a.fn.ontoBox=function(a){var c=this.data("ontoBox");return c||(c=new b(this,a),this.data("ontoBox",c)),c}}(window.jQuery),function(a,b){var c=function(d,e){var f=this;if(f.options=a.extend({},c.defaults,e),f.options.ontologyManager=f.options.ontologyManager||new b.OntologyManager,f.mainElement=d,a(f.options.ontologyManager).on("changed",function(a,b,c){f.updateOptions()}),a(f.mainElement).selectize({delimiter:null,valueField:"URI",searchField:["title","label","prefix","curi","URI"],sortField:["prefix","URI"],options:f.propertyList(),onChange:function(b){a(f).trigger("changed",f.sel.options[b])},createProperty:function(a,b){return f.options.ontologyManager.ontologyPropertyByURI(f.options.ontologyManager.uriDenormalize(a),b)},create:function(a,c){var d=this,e=!1;a=b.Utils.trim(b.Utils.trim(a,"<"),">"),"a"===a?(a="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",e=!0):a.startsWith("#")&&(e=!0);var g=this.settings.createProperty(a,e);if(g)c(g);else{var h=f.options.ontologyManager.ontologyDetermine(a);h||(h=f.options.ontologyManager.prefixes[a]||a),f.options.ontologyManager.parseOntologyFile(h,{success:function(){c(d.settings.createProperty(a,!0))},error:function(e){var g=e&&e.message?e.message:"Error loading ontology";console.log(g),bootbox.confirm(g+". Do you want to create new property?",function(e){if(e){var g=f.options.ontologyManager.ontologyByURI(h);g||(g=f.options.ontologyManager.ontologyByURI(h),g||(g=new b.Ontology(f.options.ontologyManager,h)),c(d.settings.createProperty(a,!0)))}else d.unlock()})}})}},render:{item:function(a,b){var c=a.title||a.label||a.curi||a.name;return c=a.curi&&a.curi!=c?b(c)+" <small>("+b(a.curi)+")</small>":b(c),"<div>"+c+"</div>"},option:function(a,b){var c=a.title||a.label||a.curi||a.name;return"<div>"+b(c)+"<br/><small>("+b(a.URI)+")</small></div>"},option_create:function(a,c){var d=a.input;return d=b.Utils.trim(b.Utils.trim(d,"<"),">"),d=f.options.ontologyManager.uriDenormalize(d),d!=a.input?'<div class="create">Add <strong>'+c(a.input)+"</strong> <small>("+c(d)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+c(d)+"</strong>&hellip;</div>"}}}),f.options.dereferenceLink){f.dereferenceLink=a(document.createElement("button")),f.dereferenceLink.attr("type","button").addClass("btn btn-default btn-sm"),f.dereferenceLink.html('<i class="glyphicon glyphicon-link"></i>');var g=a(document.createElement("div")).addClass("rdfe-reference-link");g.append(f.dereferenceLink),f.mainElement.closest(".editable-input").length?f.mainElement.parent().after(g):f.mainElement.parent().append(g),f.dereferenceLink.on("click",function(){f.options.dereferenceLink(f.selectedURI())})}f.sel=a(f.mainElement)[0].selectize};c.defaults={ontologyManager:null,ontology:null},c.prototype.setOntology=function(a){this.options.ontology=a,this.updateOptions()},c.prototype.propertyList=function(){var a;return a=this.options.ontology?this.options.ontology.allProperties():this.options.ontologyManager.allProperties()},c.prototype.updateOptions=function(){var a=this,b=a.selectedURI(),c=a.propertyList();a.sel.clearOptions(),a.sel.addOption(c),a.setPropertyURI(b)},c.prototype.setPropertyURI=function(a){if(a){var c=this.options.ontologyManager.uriDenormalize(a);c=b.Utils.trim(b.Utils.trim(c,"<"),">"),this.sel.options[c]||this.sel.addOption(this.options.ontologyManager.ontologyPropertyByURI(c,!0)),this.sel.setValue(c)}else this.sel.setValue(null)},c.prototype.selectedURI=function(){return this.sel.getValue()},c.prototype.selectedProperty=function(){return this.sel.options[this.selectedURI()]},c.prototype.on=function(b,c){return a(this).on(b,c),this},a.fn.propertyBox=function(a){var b=this.data("propertyBox");return b||(b=new c(this,a),this.data("propertyBox",b)),b}}(window.jQuery,RDFE),function(a){var b=function(a){this.init("rdfnode",a,b.defaults)};a.fn.editableutils.inherit(b,a.fn.editabletypes.abstractinput),a.extend(b.prototype,{render:function(){this.$input=this.$tpl.filter("select"),this.setClass(),this.$input.propertyBox(this.options.propertyBox),this.$input.propertyBox().sel.$control.css("min-width","250px")},activate:function(){},value2html:function(b,c){return b?void a(c).text(b.toString()):void a(c).empty()},html2value:function(a){return null},input2value:function(){return this.$input.propertyBox().selectedURI()},value2input:function(a){this.$input.propertyBox().setPropertyURI(a)}}),b.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{propertyBox:{},tpl:"<select></select>"}),a.fn.editabletypes.propertyBox=b}(window.jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.TripleView=function(){var b=function(a){this.editor=a};return b.prototype.render=function(b,c){var d,e=this;e.editor.doc.listProperties(function(f){e.editor.doc.store.graph(e.editor.doc.graph,function(f,g){if(f)a(e.editor).trigger("rdf-editor-error",{type:"triple-list-error",message:f});else{b.empty();var h=a(document.createElement("table")).addClass("table");b.append(h);for(var i=g.toArray(),j=0;j<i.length;j+=1)i[j].id=j;h.data("maxindex",j);var k=1,l=10,m="subject",n="asc",o=e.editor.config.options.pageSettings;o.pageNo&&(k=o.pageNo),o.pageSize&&(l=o.pageSize),o.sortName&&(m=o.sortName),o.sortOrder&&(n=o.sortOrder),h.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:k,pageSize:l,search:!0,sortName:m,sortOrder:n,searchAlign:"left",showHeader:!0,data:i,editable:!0,dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",e.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",e.editor.namingSchema()),sortable:!0,editable:e.editor.editableSubject(e.editor),formatter:e.editor.nodeFormatter},{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",e.editor.namingSchema()),
titleTooltip:RDFE.Utils.namingSchemaLabel("p",e.editor.namingSchema()),sortable:!0,editable:e.editor.editablePredicate(e.editor),formatter:e.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",e.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",e.editor.namingSchema()),sortable:!0,editable:e.editor.editableObject(e.editor,function(a){return a.predicate.toString()}),formatter:e.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add a new statement to the document"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(a,b,c){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(b,c,d,f){var g=d;e.editor.doc.deleteTriple(g,function(){h.bootstrapTable("remove",{field:"id",values:[d.id]}),a(e.editor).trigger("rdf-editor-success",{type:"triple-delete-success",message:"Successfully deleted triple."})},function(){a(e.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),h.on("editable-shown.bs.table",function(a,b,c){d=_.clone(c)}),h.on("editable-save.bs.table",function(a,b,c){e.editor.dataSetter(b,d,c)}),h.on("page-change.bs.table",function(b,c,d){a(e.editor).trigger("rdf-editor-page",{pageNo:c,pageSize:d})}),h.on("sort.bs.table",function(b,c,d){a(e.editor).trigger("rdf-editor-page",{sortName:c,sortOrder:d})}),a(h).find(".add").on("click",function(a){e.editor.editTriple()}),e.tripleTable=h,c&&c()}})})},b.prototype.addTriple=function(b){var c=this,d=c.tripleTable.data("maxindex");c.tripleTable.bootstrapTable("append",a.extend(b,{id:d})),c.tripleTable.data("maxindex",d+1)},b}()}(jQuery),Backbone.Form.editors.Rdfnode=Backbone.Form.editors.Base.extend({tagName:"input",events:{change:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)},keyup:function(a,b){13==a.keyCode&&a.shiftKey&&(console.log("shift+enter"),this.editor&&this.editor.transformToTextarea(),a.stopPropagation()),this.trigger("keyup",this)}},initialize:function(a){Backbone.Form.editors.Base.prototype.initialize.call(this,a)},render:function(){var a=this;return this.$el.attr("type","text"),this.$el.rdfNodeEditor(this.schema.rdfnode),a.editor=this.$el.rdfNodeEditor(),a.setElement(a.editor.getElement()),$(this.editor).on("change",function(){a.trigger("change",this)}),this.setValue(this.value),this},getValue:function(){return this.editor.getValue()},setValue:function(a){this.editor.setValue(a)},focus:function(){this.hasFocus||this.editor.setEditFocus()},blur:function(){this.hasFocus&&this.editor.blur()}}),Backbone.Form.editors.NestedRdf=Backbone.Form.editors.Object.extend({initialize:function(a){if(Backbone.Form.editors.Base.prototype.initialize.call(this,a),!this.form)throw new Error('Missing required option "form"');if(!a.schema.model)throw new Error('Missing required "schema.model" option for NestedRdf editor')},render:function(){var a=this.form.constructor,b=this.value,c=(this.key,this.schema.model),d=b?b:new c;return this.nestedForm=new a({model:d,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var a=this.nestedForm.getValue();if(this.nestedForm.model.defaults){var b=!1;for(var c in a)if(a[c])for(var d=0;d<a[c].length;d++)if(a[c][d].value){b=!0;break}b&&(a=_.extend({},this.nestedForm.model.defaults,a))}return{uri:this.nestedForm.model.uri,values:a}}}),window.RDFE||(window.RDFE={}),RDFE.EntityModel=Backbone.Model.extend({setEntity:function(a,b){this.doc=a,this.uri=b,this.individualsCache={}},addValue:function(a,b){var c=this.get(a)||[];c.push(b),this.set(a,c)},getIndividuals:function(a,b){var c=this;if(this.individualsCache[a])return void b(this.individualsCache[a]);var d=[],e=this.doc.ontologyManager.ontologyClassByURI(a);if(a&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==a?"http://www.w3.org/2000/01/rdf-schema#Class"===a?d=this.doc.ontologyManager.ontologyClasses:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"===a?d=this.doc.ontologyManager.ontologyProperties:e&&(d=e.getIndividuals(!0)):d=this.doc.ontologyManager.individuals,d=_.map(_.values(d),function(a){var b=new RDFE.RdfNode("uri",a.URI);return b.label=a.label||a.name,b}),c.doc.listEntities(a,function(a){$.merge(d,a)}),e)for(var f=e.getSubClasses(!0),g=0,h=f.length;h>g;g++)c.doc.listEntities(f[g].URI,function(a){$.merge(d,a)});this.individualsCache[a]=d,b(d)},maxCardinalityForProperty:function(a){for(var b=0;b<this.types.length;b++){var c=this.types[b].maxCardinalityForProperty(a);if(c)return c}return null},restrictionsForProperty:function(a){for(var b=0;b<this.types.length;b++){var c=this.types[b].restrictions[a];if(c)return c}return null},isAggregateProperty:function(a){for(var b=0;b<this.types.length;b++)if(this.types[b].isAggregateProperty(a))return!0;return!1},addSchemaEntryForProperty:function(a){var b,c,d=this,e=a.URI?a:d.doc.ontologyManager.ontologyProperties[a]||{URI:a},f=this.restrictionsForProperty(a);f&&(b=f.hasCustomLabel,c=f.hasCustomComment);var g=RDFE.Utils.createTitle(b||e.label||e.title||RDFE.Utils.uri2name(e.URI)),h={titleHTML:'<span title="{0}">{1}</span>'.format(RDFE.Utils.escapeXml(e.URI),g),title:g,maxCardinality:d.maxCardinalityForProperty(e.URI),editorAttrs:{title:RDFE.coalesce(c,e.comment,e.description)}};if(d.isAggregateProperty(e.URI)){var i=e.getRange?d.doc.ontologyManager.ontologyClassByURI(e.getRange()):null;i?(h.type="List",h.itemType="NestedRdf",h.model=RDFE.EntityModel.extend({defaults:{"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":[new RDFE.RdfNode("uri",e.getRange())]},initialize:function(a){RDFE.EntityModel.prototype.initialize.call(this,a),this.doc=d.doc,this.buildSchemaFromTypes([i])},individualsCache:d.individualsCache}),h.editorAttrs.style="height:auto;"):(console.log("Caution: invalid range on aggregate: ",e),h.type="List",h.itemType="Rdfnode",h.rdfnode={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",create:!0})}else{h.type="List",h.itemType="Rdfnode",h.rdfnode={};var j=_.result(e,"getRange");e["class"]==d.doc.ontologyManager.uriDenormalize("owl:DatatypeProperty")?h.rdfnode.type=j:e["class"]==d.doc.ontologyManager.uriDenormalize("owl:ObjectProperty")?(h.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",h.rdfnode.choices=function(a){d.getIndividuals(j,a)},h.rdfnode.create=!0):j&&("http://www.w3.org/2000/01/rdf-schema#Literal"==j||j.startsWith("http://www.w3.org/2001/XMLSchema#")?h.rdfnode.type=j:(h.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",h.rdfnode.choices=function(a){d.getIndividuals(j,a)},h.rdfnode.create=!0))}d.schema[e.URI]=h},buildSchemaFromTypes:function(a){var b=this;b.schema={},b.fields=[],b.lens=null,b.types=a;for(var c=0,d=a.length;d>c;c++){var e=a[c].getFresnelLens();if(e&&e.showProperties.length){b.lens=e;break}}e?b.fields=_.without(e.showProperties,b.doc.ontologyManager.uriDenormalize("fresnel:allProperties")):b.fields=[b.doc.ontologyManager.uriDenormalize("rdf:type")];for(var c=0;c<b.fields.length;c++)b.addSchemaEntryForProperty(b.fields[c])},docToModel:function(a,b){var c=this;c.schema={},c.fields=[],this.doc.getEntity(c.uri,function(b){c.types=_.compact(_.map(b.types,c.doc.ontologyManager.ontologyClassByURI,c.doc.ontologyManager)),c.fields=[],c.lens=null;if(0===c.types.length)for(var d in b.properties){var e=c.doc.ontologyManager.ontologyPropertyByURI(d);e&&e.domain&&(c.types=_.union(c.types,e.domain))}for(var f=0,g=c.types.length;g>f;f++){var h=c.types[f].getFresnelLens();if(h&&h.showProperties.length>0){c.lens=h;break}}if(h&&(c.fields=_.clone(h.showProperties)),h){var i=c.fields.indexOf(c.doc.ontologyManager.uriDenormalize("fresnel:allProperties"));if(i>=0){c.allowAddProperty=!0;var j=[];for(d in b.properties)_.contains(c.fields,d)||_.contains(h.hideProperties,d)||j.push(d);c.fields.splice.apply(c.fields,[i,1].concat(j))}}else{c.allowAddProperty=!0;for(var d in b.properties)_.contains(c.fields,d)||("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===d?c.fields.unshift(d):c.fields.push(d))}for(var f=0;f<c.fields.length;f++)c.addSchemaEntryForProperty(c.fields[f]);for(var d in b.properties)for(var k=c.isAggregateProperty(d),l=b.properties[d],f=0;f<l.length;f++)if(k){var m=new RDFE.EntityModel;m.setEntity(c.doc,l[f].value),m.individualsCache=c.individualsCache,m.docToModel(function(){c.addValue(d,m)})}else c.addValue(d,l[f]);a&&a()})},modelToDoc:function(){function a(c,d,e){var f=[];if(!c||0===c.length){for(var g="",h=0,i=e.config.options.labelProps.length;i>h;h++)if(d[e.config.options.labelProps[h]]){g=d[e.config.options.labelProps[h]];break}g=(g||"subres")+"_"+b,c=e.buildEntityUri(g),b++}var j=e.store.rdf.createNamedNode(c);for(prop in d){var k=e.store.rdf.createNamedNode(prop),l=d[prop];l.constructor!==Array&&(l=[l]);for(var m=0;m<l.length;m++){var n=l[m];if(n.values){var o=a(n.uri,n.values,e);o.length>0&&(f.push(e.store.rdf.createTriple(j,k,o[0].subject)),Array.prototype.push.apply(f,o))}else{var p=l[m].toStoreNode(e.store);p&&p.nominalValue.length>0&&f.push(e.store.rdf.createTriple(j,k,p))}}}return f}var b=1;return function(c,d){var e=this;b=1;for(var f=a(this.uri,e.attributes,e.doc),g=[],h=0;h<f.length;h++)_.indexOf(g,f[h].subject.nominalValue)<0&&g.push(f[h].subject.nominalValue);var i=function(a){a>=g.length?e.doc.addTriples(f,c,d):e.doc.deleteBySubject(g[a],function(){i(a+1)},d)};i(0)}}()}),function(a){window.RDFE||(window.RDFE={}),RDFE.EntityEditor=function(){var b=function(a,b){this.doc=a,this.namingSchema=a.config.options[a.config.options.namingSchema],this.ontologyManager=b},c=Backbone.Form.extend({template:_.template('<form class="form-horizontal clearfix" role="form">  <a href="#" class="btn btn-default btn-xs pull-right addProp">Add <%= RDFE.Utils.namingSchemaLabel("p", this.namingSchema) %></a>  <div data-fieldsets></div>  <% if (submitButton) { %>    <button type="submit" class="btn"><%= submitButton %></button>  <% } %></form>'),render:function(){var b=this;return b.namingSchema=b.model.doc.config.options[b.model.doc.config.options.namingSchema],Backbone.Form.prototype.render.call(this),b.model.allowAddProperty||this.$el.find(".addProp").hide(),this.$el.find("> a.addProp").click(function(c){c.preventDefault();var d=a(document.createElement("select")),e=a(document.createElement("button")).addClass("btn").addClass("btn-default").text("Add"),f=a(document.createElement("button")).addClass("btn").addClass("btn-default").text("Cancel"),g=a(document.createElement("div")).append(a(document.createElement("span")).text("New "+RDFE.Utils.namingSchemaLabel("p",b.namingSchema)+":")).append(d).append(e).append(f);d=d.propertyBox({ontologyManager:b.model.doc.ontologyManager}),f.click(function(a){a.preventDefault(),g.remove()}),e.click(function(a){if(a.preventDefault(),d.selectedURI()){console.log("Adding new property",d.selectedURI(),"to form",b),b.commit(),b.model.addSchemaEntryForProperty(d.selectedProperty()),b.model.fields.push(d.selectedURI()),b.fieldsets=void 0,b.initialize(b.options),g.remove();var c=b.$el.parent();b.$el.remove(),b.render(),console.log(c,b.$el),c.append(b.$el)}else console.log("No prop selected")}),b.$el.prepend(g)}),this}});return b.prototype.template=_.template('<div class="panel panel-default">        <div class="panel-heading clearfix">          <h3 class="panel-title pull-left">Editing <a href="<%= entityUri %>"><span class="rdfe-entity-label"><%= entityLabel %><span></a> <span class="rdfe-entity-types"></span></h3>          <div class="btn-group pull-right" role="group">            <button type="button" class="btn btn-primary btn-sm" id="okBtn">Apply</button>            <button type="button" class="btn btn-default btn-sm" id="cnclBtn">Cancel</button>          </div>        </div>        <div class="panel-body" id="entityFormContainer">        </div>      </div>'),b.prototype.render=function(b,d,e){var f=this,g=new RDFE.EntityModel;g.setEntity(this.doc,d),g.docToModel(function(){var h=new c({model:g});h.render(),b.empty(),b.append(f.template({entityUri:d,entityLabel:RDFE.Utils.uri2name(d)})),f.doc.getEntity(d,function(a){b.find(".rdfe-entity-types").html(f.ontologyManager.typesToLabel(a.types,!0)),b.find(".rdfe-entity-label").html(a.label)}),b.find("#entityFormContainer").append(h.el),b.find(".toggle.btn").css("width","100%");var i=b.find("button#cnclBtn"),j=b.find("button#saveBtn"),k=b.find("button#okBtn");i.click(function(){e()});var l=function(b){h.commit(),g.modelToDoc(function(){a(f).trigger("rdf-editor-success",{type:"editor-form-save-done",message:"Locally saved details of "+d}),b&&b()},function(b){a(f).trigger("rdf-editor-error",{type:"editor-form-save-failed",message:b})})};j.click(function(){l()}),k.click(function(){l(e)})},function(b){a(f).trigger("rdf-editor-error",{type:"editor-form-creation-failed",message:b})})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.EntityView=function(){var b=function(a,b,c,d){this.doc=a,this.namingSchema=a.config.options[a.config.options.namingSchema],this.ontologyManager=b,this.editor=c,this.editFct=d.editFct},c=function(a,b,c){return'<span title="'+b.uri+'">'+b.label+"</span>"},d=function(a,b,c){return b.types&&b.types.length?b.types:"<em>none</em>"},e=function(a,b){return{label:a.label,types:b.typesToLabel(a.types),uri:a.uri||a.value}};return b.prototype.render=function(b,f){var g=this,h=function(a,b,c){return['<a class="edit ml10" href="javascript:void(0)" title="Edit this '+RDFE.Utils.namingSchemaLabel("spo",g.namingSchema,!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove this '+RDFE.Utils.namingSchemaLabel("spo",g.namingSchema,!1,!0)+' from the document">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")};g.doc.listEntities(g.editor.config.options.entityTypesFiler,function(i){g.entityTable=null,b.empty();var j=a(document.createElement("table")).addClass("table");b.append(j);for(var k=[],l=0;l<i.length;l++)k.push(e(i[l],g.ontologyManager));var m=function(b){g.doc.deleteEntity(b,function(){j.bootstrapTable("remove",{field:"uri",values:[b]}),a(g).trigger("rdf-editor-success",{type:"entity-delete-done",uri:b,message:"Successfully deleted entity "+b+"."})},function(b){a(g).trigger("rdf-editor-error",{type:"entity-delete-failed",message:b})})};j.bootstrapTable({striped:!0,sortName:"label",pagination:!0,search:!0,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:k,idField:"uri",columns:[{field:"label",title:RDFE.Utils.namingSchemaLabel("s",g.namingSchema)+" Name",titleTooltip:RDFE.Utils.namingSchemaLabel("s",g.namingSchema)+" Name",aligh:"left",sortable:!0,formatter:c},{field:"types",title:"Entity Types",titleTooltip:"Entity Types",aligh:"left","class":"rdfe-small-column",sortable:!0,formatter:d},{field:"actions",title:'<button class="add btn btn-default" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("spo",g.namingSchema,!1,!0)+' to the document"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,formatter:h,events:{"click .edit":function(a,b,c,d){g.editFct(c.uri)},"click .remove":function(a,b,c,d){m(c.uri)}}}]}),a(j).find(".add").on("click",function(a){g.editor.createNewEntityEditor()}),g.entityTable=j,f&&f()},function(b){a(g).trigger("rdf-editor-error",{type:"entity-list-failed",message:b})})},b.prototype.addEntity=function(a){this.entityTable.bootstrapTable("append",a)},b.prototype.updateEntity=function(a){var b=this;b.doc.getEntity(a,function(a){b.entityTable.bootstrapTable("update",{field:"uri",data:e(a,b.ontologyManager)})})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.SubjectEditor=function(){var b=function(a,b){this.editor=a,this.subject=b};return b.prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <form class="form-inline">             <div class="form-group" style="width: 80%;">               <label>Selected <%= RDFE.Utils.namingSchemaLabel("s", this.editor.namingSchema()) %> </label>               <input name="subject" class="form-control" style="width: 85%;" disabled="disabled" />             </div>             <div class="btn-group pull-right" role="group">               <button type="button" class="btn btn-default btn-sm rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </form>         </div>         <div class="panel-body" id="subjectTable">         </div>         <div class="panel-body" id="subjectForm" style="display: none;">       </div>'),b.prototype.render=function(b,c,d,e){var f,g=this,h=function(c,e){var f,h,i,j=function(a){var b=g.editor.ontologyManager.ontologyByURI(a.currentTarget.selectedOntologyURI());i.clearOptions(),i.addOption(b?b.classesAsArray():g.editor.ontologyManager.allClasses())};c.html('<div class="panel panel-default">  <div class="panel-heading">    <h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema())+'</h3>  </div>  <div class="panel-body">    <div class="form-horizontal">       <div class="form-group">         <label for="ontology" class="col-sm-2 control-label">Vocabulary</label>         <div class="col-sm-10">           <select name="ontology" id="ontology" class="form-control" />         </div>       </div>       <div class="form-group">         <label for="class" class="col-sm-2 control-label">Type</label>         <div class="col-sm-10">           <select name="class" id="class" class="form-control" />         </div>       </div>       <div class="form-group">          <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema())+(g.editor.doc.config.options.entityUriTmpl?" Name":" URI")+'</label>          <div class="col-sm-10">            <input name="subject" id="subject" class="form-control" />          </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <a href="#" class="btn btn-default triple-action triple-action-new-cancel">Cancel</a>           <a href="#" class="btn btn-primary triple-action triple-action-new-save">OK</a>         </div>       </div>     </div>  </div></div>\n'),f=a("#ontology").ontoBox({ontologyManager:g.editor.ontologyManager}),f.on("changed",j),f.sel.focus(),h=a("#class").selectize({valueField:"URI",labelField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:g.editor.ontologyManager.allClasses(),create:function(a,b){b(g.editor.ontologyManager.ontologyClassByURI(g.editor.ontologyManager.uriDenormalize(a),!0))},render:{item:function(a,b){var c=a.title||a.label||name.curi||a.name;return c=a.curi&&a.curi!=c?b(c)+" <small>("+b(a.curi)+")</small>":b(c),"<div>"+c+"</div>"},option:function(a,b){return"<div>"+b(a.title||a.label||name.curi||a.name)+"<br/><small>("+b(a.URI)+")</small></div>"},option_create:function(a,b){var c=g.editor.ontologyManager.uriDenormalize(a.input);return c!==a.input?'<div class="create">Add <strong>'+b(a.input)+"</strong> <small>("+b(c)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+b(c)+"</strong>&hellip;</div>"}}}),i=h[0].selectize,c.find("a.triple-action-new-cancel").click(function(a){a.preventDefault(),e()});var k=function(){var f=c.find('input[name="subject"]').val(),h=null,i=c.find("#class")[0].selectize.getValue();g.editor.doc.config.options.entityUriTmpl&&(h=f,f=null),g.editor.doc.addEntity(f,h,i,function(f){a(g.editor).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully created new triple."}),g.editor.doc.getSubject(f.uri,function(a){b.subjectView.addSubject(a),g.subject=a,g.render(b,c,d,e)})},function(){a(g.editor).trigger("rdf-editor-error",{type:"triple-insert-error",message:"Failed to add new triple."})})};c.find("a.triple-action-new-save").click(function(a){a.preventDefault(),k()}),c.find("input#subject").keypress(function(a){13===a.which&&k()})},i=function(b,c){j.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",g.editor.namingSchema()),sortable:!0,editable:g.editor.editablePredicate(g.editor),formatter:g.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",g.editor.namingSchema()),sortable:!0,editable:g.editor.editableObject(g.editor,function(a){return a.predicate.toString()}),formatter:g.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(a,b,c){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(b,c,d,e){g.editor.doc.deleteTriple(d,function(){j.bootstrapTable("remove",{field:"id",values:[d.id]}),a(g.editor).trigger("rdf-editor-success",{type:"triple-delete-success",message:"Successfully deleted triple."})},function(b){a(g.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),j.on("editable-shown.bs.table",function(a,b,c){f=_.clone(c)}),j.on("editable-save.bs.table",function(a,b,c){g.editor.dataSetter(b,f,c)}),g.subjectTable=j,g.subjectTableContainer=b.find("#subjectTable"),g.subjectFormContainer=b.find("#subjectForm"),g.addButton=a(j).find(".add"),g.addButton.click(function(){g.createNewRelationEditor()}),g.renderData(),d&&g.createNewRelationEditor()};if(c.empty(),g.subject){c.append(g.template(g.subject));var j=a(document.createElement("table")).addClass("table");c.find("#subjectTable").append(j);var k=c.find("button#backButton");k.click(function(){e()});var l=c.find('input[name="subject"]'),m=g.subject.uri;""!==m?l.val(g.subject.uri):(l.css("color","red"),l.css("font-style","italic"),l.val("Empty")),i(c,e)}else h(c,e)},b.prototype.renderData=function(){for(var a=this,b=a.subject?a.subject.items:[],c=0;c<b.length;c++)b[c].id=c;a.subjectTable.data("maxindex",c),a.subjectTable.bootstrapTable("load",b),a.subject?a.addButton.show():a.addButton.hide()},b.prototype.addTriple=function(b){var c=this.subjectTable.data("maxindex");this.subjectTable.bootstrapTable("append",a.extend(b,{id:c})),this.subjectTable.data("maxindex",++c)},b.prototype.createNewRelationEditor=function(){var b=this;b.subjectTableContainer.hide(),b.subjectFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",b.editor.namingSchema())+'</label>         <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>       </div>       <div class="form-group object-list">         <div class="col-sm-12 object-item_0" style="padding: 0;">           <label for="object_0" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",b.editor.namingSchema())+'</label>           <div class="col-sm-9"><input name="object_0" class="form-control" /></div>           <div class="col-sm-1 btn_0"><button type="button" class="btn btn-default object-add" title="Add Object"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button></div>         </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default subject-action subject-action-new-cancel">Cancel</button>           <button type="submt" class="btn btn-primary subject-action subject-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var c=1,d=' <div class="col-sm-12 object-item_<N>" style="padding: 0;">    <label for="object_<N>" class="col-sm-2 control-label"></label>    <div class="col-sm-9"><input name="object_<N>" class="form-control" /></div>    <div class="col-sm-1 btn_<N>"></div>  </div> ',e=' <button type="button" class="btn btn-default object-remove_<N>" title="Remove Object"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>',f=[],g=b.subjectFormContainer.find('input[name="object_0"]').rdfNodeEditor(b.editor.doc.config.options);g.setValue(new RDFE.RdfNode("literal","",null,"")),f.push(g);var h=b.subjectFormContainer.find('select[name="predicate"]').propertyBox({ontologyManager:b.editor.ontologyManager}).on("changed",function(a,c){for(var d=0;d<f.length;d++){var e=f[d];e&&b.editor.changeObjectType(c,e)}});h.sel.focus(),b.subjectFormContainer.find("button.object-add").click(function(a){for(var g=0,i=f.length-1;i>=0;i--)if(f[i]){g=i;break}var j=b.editor.ontologyManager.ontologyPropertyByURI(h.selectedURI()),k=b.subjectFormContainer.find("div.object-list");k.append(d.replace(/<N>/g,c)),k.find("button.object-add").detach().appendTo(k.find("div.btn_<N>".replace(/<N>/g,c))),k.find("div.btn_<N>".replace(/<N>/g,g)).append(e.replace(/<N>/g,g));var l=b.subjectFormContainer.find('input[name="object_<N>"]'.replace(/<N>/g,c)).rdfNodeEditor(b.editor.doc.config.options);l.setValue(new RDFE.RdfNode("literal","",null,"")),j&&b.editor.changeObjectType(j,l);var m=function(a){return function(c){b.subjectFormContainer.find("div.object-item_<N>".replace(/<N>/g,a)).remove(),f[a]=null}}(g);b.subjectFormContainer.find("button.object-remove_<N>".replace(/<N>/g,g)).click(m),f.push(l),c++}),b.subjectFormContainer.find("button.subject-action-new-cancel").click(function(a){b.subjectFormContainer.hide(),b.subjectTableContainer.show()}),b.subjectFormContainer.find("button.subject-action-new-save").click(function(c){c.preventDefault();var d=!0,e=b.subject.uri,g=h.selectedURI();if(RDFE.Validate.check(h.sel,g)){for(var i=0;i<f.length;i++){var j=f[i];if(j){var k=j.getValue();if(RDFE.Validate.check(j.getField(),k.value)){var l=b.editor.doc.store.rdf.createTriple(b.editor.doc.store.rdf.createNamedNode(e),b.editor.doc.store.rdf.createNamedNode(g),k.toStoreNode(b.editor.doc.store));b.editor.doc.addTriples([l],function(){b.subjectView||b.addTriple(l),a(b.editor).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully added new triple."}),b.subjectFormContainer.find("div.object-item_<N>".replace(/<N>/g,i)).remove(),f[i]=null},function(c){a(b.editor).trigger("rdf-editor-error",{type:"triple-insert-error",message:"Failed to add new triple."}),d=!1})}else d=!1}}d&&(b.subjectFormContainer.hide(),b.subjectTableContainer.show())}})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.SubjectView=function(){var b=function(a,b){this.editor=a,this.editFct=b.editFct};return b.prototype.render=function(b,c){var d=this;d.editor.doc.listSubjects(function(e){var f=function(a,b,c){var e=d.editor.ontologyManager,f=e.ontologyClassByURI(b.label)?"":'class="rdfe-green-link"',g=RDFE.Utils.uri2name(b.uri);return""!==g?'<a href="{1}" target="_blank" {2}>{0}</a>'.format(RDFE.Utils.uri2name(b.uri),b.uri,f):'<em style="color: red;">Empty<em>'},g=function(a,b){function c(a){return'<a href="{1}">{0}</a>'.format(RDFE.Utils.uri2name(a),a)}return a=c(a),b=c(b),a>b?1:b>a?-1:0},h=function(a,b,c){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("p",d.editor.namingSchema(),!1,!0)+" name and "+RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this '+RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema(),!0,!0)+'">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",d.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")};d.subjects=e,d.subjectTable=null,b.empty();var i=a(document.createElement("table")).addClass("table");b.append(i);var j=1,k=10,l="uri",m="asc",n=d.editor.config.options.pageSettings;n.pageNo&&(j=n.pageNo),n.pageSize&&(k=n.pageSize),n.sortName&&(l=n.sortName),n.sortOrder&&(m=n.sortOrder),i.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:j,pageSize:k,search:!0,sortName:l,sortOrder:m,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:e,idField:"uri",columns:[{field:"uri",title:RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema()),sortable:!0,sorter:g,formatter:f},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,sorter:d.editor.countSorter,align:"right","class":"rdfe-small-column",formatter:d.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,formatter:h,events:{"click .edit":function(a,b,c,e){d.editFct(c)},"click .dereference":function(a,b,c,e){var f=d.editor.dereference();f(c.uri)},"click .remove":function(b,c,e,f){d.editor.doc.deleteBySubject(e.uri,function(){i.bootstrapTable("remove",{field:"uri",values:[e.uri]}),a(d.editor).trigger("rdf-editor-success",{type:"subject-delete-success",message:"Successfully deleted triples with subject "+e.uri+"."})},function(b){a(d.editor).trigger("rdf-editor-error",{type:"subject-delete-error",message:b})})}}}]}),i.on("page-change.bs.table",function(b,c,e){a(d.editor).trigger("rdf-editor-page",{pageNo:c,pageSize:e})}),i.on("sort.bs.table",function(b,c,e){a(d.editor).trigger("rdf-editor-page",{sortName:c,sortOrder:e})}),a(i).find(".add").on("click",function(a){d.editor.editSubject()}),d.subjectTable=i,c&&c()},function(b){a(d.editor).trigger("rdf-editor-error",{type:"subject-list-error",message:b})})},b.prototype.addSubject=function(a){var b=this;_.find(b.subjects,function(b){return b.uri===a.uri})||this.subjectTable.bootstrapTable("append",a)},b.prototype.updateSubject=function(a){var b=this;b.editor.doc.getSubject(a,function(c){var d=b.subjects.findIndex(function(b,c,d){return b.uri===a});b.subjectTable.bootstrapTable("updateRow",{index:d,row:c})})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.PredicateEditor=function(){var b=function(a,b){this.editor=a,this.predicate=b};return b.prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <form class="form-inline">             <div class="form-group" style="width: 80%;">               <label><%= RDFE.Utils.namingSchemaLabel("p", this.editor.namingSchema()) %> </label>               <select name="predicate" class="form-control" style="width: 85%;"></select>             </div>             <div class="btn-group pull-right" role="group">               <button type="button" class="btn btn-default btn-sm rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </form>         </div>         <div class="panel-body" id="predicateTable">         </div>         <div class="panel-body" id="predicateForm" style="display: none;">       </div>'),
b.prototype.render=function(b,c,d,e){var f,g=this,h=function(c,e){i.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema()),sortable:!0,editable:g.editor.editableSubject(g.editor),formatter:g.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",g.editor.namingSchema()),sortable:!0,editable:g.editor.editableObject(g.editor,function(a){return a.predicate.toString()}),formatter:g.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(a,b,c){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(b,c,d,e){g.editor.doc.deleteTriple(d,function(){i.bootstrapTable("remove",{field:"id",values:[d.id]}),a(g.editor).trigger("rdf-editor-success",{type:"predicate-delete-success",message:"Successfully deleted triple."})},function(b){a(g.editor).trigger("rdf-editor-error",{type:"predicate-delete-error",message:"Failed to delete triple."})})}}}]}),i.on("editable-shown.bs.table",function(a,b,c){f=_.clone(c)}),i.on("editable-save.bs.table",function(a,b,c){g.editor.dataSetter(b,f,c)}),g.predicateView=b.predicateView,g.predicateTable=i,g.predicateTableContainer=c.find("#predicateTable"),g.predicateFormContainer=c.find("#predicateForm"),g.addButton=a(i).find(".add"),g.addButton.click(function(){g.createNewRelationEditor()}),g.renderData(),d&&g.createNewRelationEditor()};c.empty(),c.append(g.template(g.predicate));var i=a(document.createElement("table")).addClass("table");c.find("#predicateTable").append(i);var j=c.find("button#backButton");j.click(function(){e()});var k=c.find('select[name="predicate"]').propertyBox({ontologyManager:g.editor.ontologyManager});g.predicate&&k.setPropertyURI(g.predicate.uri),g.predicate||k.sel.focus(),k.sel.on("change",function(a){a&&g.editor.doc.getPredicate(a,function(a){g.predicateView.addPredicate(a),g.predicate=a,g.renderData()})}),h(c,e)},b.prototype.renderData=function(){for(var a=this,b=a.predicate?a.predicate.items:[],c=0;c<b.length;c++)b[c].id=c;a.predicateTable.data("maxindex",c),a.predicateTable.bootstrapTable("load",b),a.predicate?a.addButton.show():a.addButton.hide()},b.prototype.addTriple=function(b){var c=this,d=c.predicateTable.data("maxindex");c.predicateTable.bootstrapTable("append",a.extend(b,{id:d})),c.predicateTable.data("maxindex",++d),c.predicateView.updatePredicate(c.predicate.uri)},b.prototype.createNewRelationEditor=function(){var b=this;b.predicateTableContainer.hide(),b.predicateFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",b.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="subject" class="form-control" /></div>       </div>       <div class="form-group">         <label for="object" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",b.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="object" class="form-control" /></div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default predicate-action predicate-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary predicate-action predicate-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var c=b.predicateFormContainer.find('input[name="subject"]');c.focus();var d=b.editor.ontologyManager.ontologyProperties[b.predicate.uri],e=b.predicateFormContainer.find('input[name="object"]').rdfNodeEditor(b.editor.doc.config.options);b.editor.changeObjectType(d,e),b.predicateFormContainer.find("button.predicate-action-new-cancel").click(function(a){b.predicateFormContainer.hide(),b.predicateTableContainer.show()}),b.predicateFormContainer.find("button.predicate-action-new-save").click(function(d){d.preventDefault();var f=c.val();if(f=RDFE.Utils.trim(RDFE.Utils.trim(f,"<"),">"),RDFE.Validate.check(c,f)){var g=b.predicate.uri,h=e.getValue();if(RDFE.Validate.check(e.getField(),h.value)){var i=b.editor.doc.store.rdf.createTriple(b.editor.doc.store.rdf.createNamedNode(f),b.editor.doc.store.rdf.createNamedNode(g),h.toStoreNode(b.editor.doc.store));b.editor.doc.addTriples([i],function(){b.addTriple(i),a(b.editor).trigger("rdf-editor-success",{type:"predicate-insert-success",message:"Successfully added new triple."}),b.predicateFormContainer.hide(),b.predicateTableContainer.show()},function(){a(b.editor).trigger("rdf-editor-error",{type:"predicate-insert-error",message:"Failed to add new triple."})})}}})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.PredicateView=function(){var b=function(a,b){this.editor=a,this.editFct=b.editFct},c=function(a,b,c){return'<a href="{0}" target="_blank">{0}</a>'.format(b.uri)},d=function(a,b){function c(a){return'<a href="{0}">{0}</a>'.format(a)}return a=c(a),b=c(b),a>b?1:b>a?-1:0};return b.prototype.render=function(b,e){var f=this;f.editor.doc.listPredicates(function(g){var h=function(a,b,c){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("s",f.editor.namingSchema(),!1,!0)+" and "+RDFE.Utils.namingSchemaLabel("o",f.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this '+RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema(),!0,!0)+'">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",f.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")};f.predicates=g,f.predicateTable=null,b.empty();var i=a(document.createElement("table")).addClass("table");b.append(i);var j=1,k=10,l="uri",m="asc",n=f.editor.config.options.pageSettings;n.pageNo&&(j=n.pageNo),n.pageSize&&(k=n.pageSize),n.sortName&&(l=n.sortName),n.sortOrder&&(m=n.sortOrder),i.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:j,pageSize:k,search:!0,sortName:l,sortOrder:m,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:g,idField:"uri",columns:[{field:"uri",title:RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema()),sortable:!0,sorter:d,formatter:c},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,align:"right",sorter:f.editor.countSorter,"class":"rdfe-small-column",formatter:f.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("p",f.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,formatter:h,events:{"click .edit":function(a,b,c,d){f.editFct(c)},"click .dereference":function(a,b,c,d){var e=f.editor.dereference();e(c.uri)},"click .remove":function(b,c,d,e){f.editor.doc.deletePredicate(d.uri,function(){i.bootstrapTable("remove",{field:"uri",values:[d.uri]}),a(f.editor).trigger("rdf-editor-success",{type:"predicate-delete-success",message:"Successfully deleted predicate "+d.uri+"."})},function(b){a(f.editor).trigger("rdf-editor-error",{type:"predicate-delete-error",message:b})})}}}]}),i.on("page-change.bs.table",function(b,c,d){a(f.editor).trigger("rdf-editor-page",{pageNo:c,pageSize:d})}),i.on("sort.bs.table",function(b,c,d){a(f.editor).trigger("rdf-editor-page",{sortName:c,sortOrder:d})}),a(i).find(".add").on("click",function(a){f.editor.editPredicate()}),f.predicateTable=i,e&&e()},function(b){a(f.editor).trigger("rdf-editor-error",{type:"predicate-list-error",message:b})})},b.prototype.addPredicate=function(a){var b=this;_.find(b.predicates,function(b){return b.uri===a.uri})||(b.predicateTable.bootstrapTable("append",a),b.predicates.push(a))},b.prototype.updatePredicate=function(a){var b=this;b.editor.doc.getPredicate(a,function(c){var d=b.predicates.findIndex(function(b,c,d){return b.uri===a});b.predicateTable.bootstrapTable("updateRow",{index:d,row:c})})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.ObjectEditor=function(){var b=function(a,b){this.editor=a,this.object=b};return b.prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <div class="form-group">             <div class="col-sm-1">               <label for="object" class="control-label pull-right" style="padding-top: 5px"><%= RDFE.Utils.namingSchemaLabel("o", this.editor.namingSchema()) %> </label>             </div>             <div class="col-sm-10">               <input name="object" class="form-control" />             </div>             <div class="col-sm-1">               <button type="button" class="btn btn-default btn-sm pull-right rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </div>         </div>         <div class="panel-body" id="objectTable">         </div>         <div class="panel-body" id="objectForm" style="display: none;">       </div>'),b.prototype.render=function(b,c,d,e){var f,g=this,h=function(c,e){i.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",g.editor.namingSchema()),sortable:!0,editable:g.editor.editableSubject(g.editor),formatter:g.editor.nodeFormatter},{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",g.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",g.editor.namingSchema()),sortable:!0,editable:g.editor.editablePredicate(g.editor),formatter:g.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(a,b,c){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(b,c,d,e){g.editor.doc.deleteTriple(d,function(){i.bootstrapTable("remove",{field:"id",values:[d.id]}),a(g.editor).trigger("rdf-editor-success",{type:"object-delete-success",message:"Successfully deleted triple."})},function(b){a(g.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),i.on("editable-shown.bs.table",function(a,b,c){f=_.clone(c)}),i.on("editable-save.bs.table",function(a,b,c){g.editor.dataSetter(b,f,c)}),g.objectView=b.objectView,g.objectTable=i,g.objectTableContainer=c.find("#objectTable"),g.objectFormContainer=c.find("#objectForm"),g.addButton=a(i).find(".add"),g.addButton.click(function(){g.createNewRelationEditor()}),g.renderData(),d&&g.createNewRelationEditor()};c.empty(),c.append(g.template(g.object));var i=a(document.createElement("table")).addClass("table");c.find("#objectTable").append(i);var j=c.find("button#backButton");j.click(function(){g.objectView.removeObject(g.object),e()});var k=c.find('input[name="object"]').rdfNodeEditor(g.editor.doc.config.options);g.object&&k.setValue(g.object.object),a(k).on("changed",function(a,b){var c=b.getValue();if(c.value){"uri"==c.type&&(c.value=g.editor.ontologyManager.uriDenormalize(c.value));var d=c.toStoreNode(g.editor.doc.store);g.editor.doc.getObject(d,function(a){g.objectView.removeObject(g.object),g.objectView.addObject(a),g.object=a,g.renderData()})}}),k.mainElement.focus(),h(c,e)},b.prototype.renderData=function(){for(var a=this,b=a.object?a.object.items:[],c=0;c<b.length;c++)b[c].id=c;a.objectTable.data("maxindex",c),a.objectTable.bootstrapTable("load",b),a.object?a.addButton.show():a.addButton.hide()},b.prototype.addTriple=function(b){var c=this,d=c.objectTable.data("maxindex");c.objectTable.bootstrapTable("append",a.extend(b,{id:d})),c.objectTable.data("maxindex",++d),c.objectView.updateObject(c.object.object)},b.prototype.createNewRelationEditor=function(){var b=this;b.objectTableContainer.hide(),b.objectFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",b.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="subject" class="form-control" /></div>       </div>       <div class="form-group">         <label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",b.editor.namingSchema())+'</label>         <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default object-action object-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary object-action object-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var c=b.objectFormContainer.find('select[name="predicate"]').propertyBox({ontologyManager:b.editor.ontologyManager}),d=b.objectFormContainer.find('input[name="subject"]');d.focus(),b.objectFormContainer.find("button.object-action-new-cancel").click(function(a){b.objectFormContainer.hide(),b.objectTableContainer.show()}),b.objectFormContainer.find("button.object-action-new-save").click(function(e){e.preventDefault();var f=d.val();if(f=RDFE.Utils.trim(RDFE.Utils.trim(f,"<"),">"),RDFE.Validate.check(d,f)){var g=c.selectedURI();if(g=RDFE.Utils.trim(RDFE.Utils.trim(g,"<"),">"),RDFE.Validate.check(c.sel,g)){var h=b.editor.doc.store.rdf.createTriple(b.editor.doc.store.rdf.createNamedNode(f),b.editor.doc.store.rdf.createNamedNode(g),b.object.object);b.editor.doc.addTriples([h],function(){b.addTriple(h),a(b.editor).trigger("rdf-editor-success",{type:"object-insert-success",message:"Successfully added new triple."}),b.objectFormContainer.hide(),b.objectTableContainer.show()},function(){a(b.editor).trigger("rdf-editor-error",{type:"object-insert-error",message:"Failed to add new triple."})})}}})},b}()}(jQuery),function(a){window.RDFE||(window.RDFE={}),RDFE.ObjectView=function(){var b=function(a,b){this.editor=a,this.editFct=b.editFct};return b.prototype.render=function(b,c){var d=this;d.editor.doc.listObjects(function(e){var f=function(a,b,c){if("IRI"===b.type){var e=d.editor.ontologyManager,f='class="rdfe-green-link"';return e.ontologyClassByURI(b.label)&&(f=""),'<a href="{1}" target="_blank" {2}>{0}</a>'.format(RDFE.Utils.uri2name(b.label),b.label,f)}return b.label},g=function(a,b){return a>b?1:b>a?-1:0},h=function(a,b,c){return"IRI"===b.type?b.type:'<a href="{1}" target="_blank">{0}</a>'.format(d.editor.ontologyManager.uriNormalize(b.type),b.type)},i=function(a,b,c){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("s",d.editor.namingSchema(),!1,!0)+" and "+RDFE.Utils.namingSchemaLabel("p",d.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",d.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")};d.objects=e,d.objectsTable=null,b.empty();var j=a(document.createElement("table")).addClass("table");b.append(j);var k=1,l=10,m="label",n="asc",o=d.editor.config.options.pageSettings;o.pageNo&&(k=o.pageNo),o.pageSize&&(l=o.pageSize),o.sortName&&(m=o.sortName),o.sortOrder&&(n=o.sortOrder),j.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:k,pageSize:l,search:!0,sortName:m,sortOrder:n,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:e,idField:"id",columns:[{field:"label",title:RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema()),sortable:!0,sorter:g,formatter:f},{field:"type",title:"Type",titleTooltip:"Type",sortable:!0,"class":"rdfe-small-column",formatter:h},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,sorter:d.editor.countSorter,align:"right","class":"rdfe-small-column",formatter:d.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("o",d.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle","class":"rdfe-small-column",clickToSelect:!1,formatter:i,events:{"click .edit":function(a,b,c,e){d.editFct(c)},"click .remove":function(b,c,e,f){d.editor.doc.deleteObject(e.object,function(){j.bootstrapTable("remove",{field:"id",values:[e.id]}),a(d.editor).trigger("rdf-editor-success",{type:"object-delete-success",message:"Successfully deleted object."})},function(b){-a(d.editor).trigger("rdf-editor-error",{type:"object-delete-error",message:b})})}}}]}),j.on("page-change.bs.table",function(b,c,e){a(d.editor).trigger("rdf-editor-page",{pageNo:c,pageSize:e})}),j.on("sort.bs.table",function(b,c,e){a(d.editor).trigger("rdf-editor-page",{sortName:c,sortOrder:e})}),a(j).find(".add").on("click",function(a){d.editor.editObject()}),d.objectsTable=j,c&&c()},function(b){a(d.editor).trigger("rdf-editor-error",{type:"object-list-error",message:b})})},b.prototype.addObject=function(a){var b=this;_.find(b.objects,function(b){return b.id===a.id})||(b.objectsTable.bootstrapTable("append",a),b.objects.push(a))},b.prototype.updateObject=function(a){var b=this;b.editor.doc.getObject(a,function(a){var c=b.objects.findIndex(function(b,c,d){return b.id===a.id});b.objectsTable.bootstrapTable("updateRow",{index:c,row:a})})},b.prototype.removeObject=function(a){var b=this;a&&0===a.items.length&&b.objectsTable.bootstrapTable("remove",{field:"id",values:[a.id]})},b}()}(jQuery),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0==this.indexOf(a)}),window.RDFE||(window.RDFE={}),RDFE.Editor=function(a,b){var c=this,d=$.extend({initOntologyManager:!0},a.options);c.config=a.config,c.maxLength=c.config.options.maxLabelLength,c.spinner=0,c.ontologyManager=new RDFE.OntologyManager(a.config.options);var e=function(){var d={config:a.config,documentTree:a.documentTree,ontologyManager:c.ontologyManager};new RDFE.Document(d,function(a){c.doc=a,$(c.doc).on("docChanged",function(a,b){c.docChanged()}),b&&b(c)})};d.initOntologyManager===!0?c.ontologyManager.init({success:e}):e()},RDFE.Editor.prototype.namingSchema=function(){return this.config.options[this.config.options.namingSchema]},RDFE.Editor.prototype.nodeFormatter=function(a){var b=this;return"Literal"==a.interfaceName?"http://www.w3.org/2001/XMLSchema#dateTime"==a.datatype?new Date(a.nominalValue).toString():RDFE.Utils.escapeXml(RDFE.Utils.strAbbreviate(a.nominalValue,b.maxLength)):RDFE.Utils.uriAbbreviate(a.toString(),b.maxLength)},RDFE.Editor.prototype.countFormatter=function(a,b,c){return b.items.length},RDFE.Editor.prototype.countSorter=function(a,b){return a=a.length,b=b.length,a>b?1:b>a?-1:0},RDFE.Editor.prototype.editableSubject=function(a){return function(b){return{mode:"inline",type:"rdfnode",rdfnode:{mode:"subject",config:$.extend({},a.config.options,{dereferenceLink:a.dereference()}),type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",dereferenceLink:a.dereference()},value:b.subject}}},RDFE.Editor.prototype.editablePredicate=function(a){return function(b){return{mode:"inline",type:"propertyBox",propertyBox:{ontologyManager:a.ontologyManager,dereferenceLink:a.dereference()},value:b.predicate.nominalValue}}},RDFE.Editor.prototype.editableObject=function(a,b){return function(c){return{mode:"inline",type:"rdfnode",rdfnode:{mode:"object",type:c.object.datatype,config:$.extend({},a.config.options,{dereferenceLink:a.dereference()}),predicate:b?b(c):null,document:a.doc,ontologyManager:a.ontologyManager,dereferenceLink:a.dereference()},value:c.object}}},RDFE.Editor.prototype.render=function(a){this.container=a,this.container.empty(),this.listContainer=$(document.createElement("div")).appendTo(this.container),this.formContainer=$(document.createElement("div")).appendTo(this.container)},RDFE.Editor.prototype.docChanged=function(){var a=this;a.doc.store.graph(a.doc.graph,function(a,b){var c="<![CDATA["+b.toNT()+"]]>";$("body").find('script[type="text/turtle"][id="document"]').text(c)})},RDFE.Editor.prototype.toggleSpinner=function(a){var b=this;a?$(b).trigger("rdf-editor-spinner-start","editor-spinner"):$(b).trigger("rdf-editor-spinner-done","editor-spinner")},RDFE.Editor.prototype.toggleView=function(a,b){var c=this;a!==c.view&&("subjects"===a||"entities"===a?(c.config.options.useEntityEditor===!0?c.createEntityList():c.createSubjectList(),c.view=a):"predicates"===a||"attributes"===a?(c.createPredicateList(),c.view=a):"objects"===a||"values"===a?(c.createObjectList(),c.view=a):(c.createTripleList(),"triples"===a||"statements"===a?c.view=a:c.view="EAV"===b?"statements":"triples"),$(c).trigger("rdf-editor-page",{view:c.view}))},RDFE.Editor.prototype.updateView=function(){var a=this;"subjects"===a.view||"entities"===a.view?a.config.options.useEntityEditor===!0?a.createEntityList():a.createSubjectList():"predicates"===a.view||"attributes"===a.view?a.createPredicateList():"objects"===a.view||"values"===a.view?a.createObjectList():a.createTripleList()},RDFE.Editor.prototype.settingsForm=function(){var a=this,b=$("#settingsModal"),c=$.jStorage.get("rdfe:settings",{});b.find("#userID").val(c.userID),b.find('input[name="namingSchema"][value="'+c.namingSchema+'"]').attr("checked","checked"),b.modal({keyboard:!0}),b.keypress(function(a){13==a.which&&b.find('button[type="submit"]').click()}),b.find(".ok").off(),b.find(".ok").on("click",function(c){c.preventDefault();var d=$.jStorage.get("rdfe:settings",{}),e=b.find("#userID").val(),f=d.namingSchema,g="",h=b.find('input[name="namingSchema"]:checked');h.length>0&&(g=h.val()),d={userID:e,namingSchema:g},$.jStorage.set("rdfe:settings",d),b.modal("hide");var i=-1!==["entities","attributes","values","statements"].indexOf(a.view)?"EAV":"SPO";(f!==g||i!==g)&&(a.tripleView=null,a.subjectView=null,a.predicateView=null,a.objectView=null,a.config.options.namingSchema=g,$(a).trigger("rdf-editor-namingSchema",{uiMode:g,viewMode:a.view}))})},RDFE.Editor.prototype.localForm=function(){var a=this,b=$("#localModal");b.find("#content").val(""),b.find("#contentType").val("text/turtle"),b.modal({keyboard:!0}),b.find(".ok").off(),b.find(".ok").on("click",function(c){if(c.preventDefault(),window.File&&window.FileReader&&window.FileList&&window.Blob){var d=b.find("#localFile"),e=d.prop("files");if(e)if(e.length&&e[0]){var f,g,h=function(){var c=g.result,d=function(c){b.modal("hide"),a.updateView(),a.docChanged(),$(a).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})},e=function(b){$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+b.message})};a.doc["import"](c,d,e)};f=e[0],g=new FileReader,g.onload=h,g.readAsText(f)}else $(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Please select a file!"});else $(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:'This browser doesn\'t seem to support the "files" property of file inputs.'})}else $(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"The File APIs are not fully supported by your browser."})})},RDFE.Editor.prototype.remoteForm=function(){var a=this,b=$("#remoteModal");b.find("#remoteURL").val(""),b.modal({keyboard:!0}),b.find(".ok").off(),b.find(".ok").on("click",function(c){c.preventDefault();var d=b.find("#remoteURL").val(),e=function(c){var d=function(c){b.modal("hide"),a.updateView(),a.docChanged(),$(a).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})},e=function(c){b.modal("hide"),$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+c.message})};a.doc["import"](c,d,e)},f=function(c){b.modal("hide");var e=RDFE.IO.ajaxFailMessage(c,'Failed to load remote document "{0}"',d);$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:e})};$.ajax(d).done(e).fail(f)})},RDFE.Editor.prototype.importForm=function(){var a=this,b=$("#importModal");b.find("#content").val(""),b.find("#contentType").val("text/turtle"),b.modal({keyboard:!0}),b.find(".ok").off(),b.find(".ok").on("click",function(c){c.preventDefault();var d=b.find("#content").val(),e=(b.find("#contentType").val(),function(c){b.modal("hide"),a.updateView(),a.docChanged(),$(a).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})}),f=function(b){$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+b.message})};a.doc["import"](d,e,f)})},RDFE.Editor.prototype.exportForm=function(){var a=this,b=$("#exportModal");b.find("#content").val(""),b.keypress(function(a){13==a.which&&b.find('button[type="submit"]').click()}),b.modal({keyboard:!0}),$(a).trigger("rdf-editor-spinner-start","export-spinner"),a.doc.store.graph(a.doc.graph,function(c,d){var e=d.toNT();b.find("#content").val(e),$(a).trigger("rdf-editor-spinner-done","export-spinner")})},RDFE.Editor.prototype.signDocumentForm=function(){var a=this,b=$("#signModal"),c=b.find(".modal-body");c.empty(),a.doc.checkForSignature();var d=angular.element("[ng-controller=AuthHeaderCtrl]").scope();d.profile?(c.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <input type="text" class="form-control" name="signatureDocURI" id="signatureDocURI" value="{0}">        </div>       </div>    '.format(a.doc.signature?a.doc.signature:a.doc.url+",signature")),b.find(".ok").show(),b.find(".ok").off(),b.find(".ok").on("click",function(b){return function(c){c.preventDefault();var d,e=a.doc.store.rdf,f=b.find("#signatureDocURI").val(),g=e.createTriple(e.createNamedNode(a.doc.url),e.createNamedNode("http://www.openlinksw.com/schemas/cert#hasSignature"),e.createNamedNode(f));a.doc.checkTriple(g,function(a){d=a},function(a){d=a});var h=function(c,d){a.doc.store.graph(a.doc.graph,function(c,d){var e=d.toNT(),g=function(c,d,e){if("error"===d)i();else{var g={contentType:"text/plain",success:function(){b.modal("hide"),a.updateView(),$(a).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully signed document."})},error:i},h=RDFE.IO.createIO("webdav");h.type="webdav",h.insert(f,c,g)}};$.get("/ods/api/signature?content="+e).done(function(a,b,c){g(a,b,c)}).fail(function(a,b,c){g(a,b,c)})})},i=function(b,c){d||a.doc.deleteTriples(g),$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to sign document."})};d?h():a.doc.addTriples(g,h,i)}}(b))):(c.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">The user is not logged. Please, login and try again.</p>         </div>       </div>    '),b.find(".ok").hide()),b.modal()},RDFE.Editor.prototype.unsignDocumentForm=function(){var a=this,b=$("#unsignModal"),c=b.find(".modal-body");c.empty(),a.doc.checkForSignature(),a.doc.signature?(c.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">{0}</p>         </div>       </div>      <div class="form-group">         <label class="col-sm-2"></label>         <div class="col-sm-10 checkbox">           <label><input type="checkbox" name="deleteSignature" id="deleteSignature" value="on"><strong>Delete Signature File</strong></label>        </div>       </div>    '.format(a.doc.signature)),b.find(".ok").show(),b.find(".ok").off(),b.find(".ok").on("click",function(b){return function(c){c.preventDefault();var d=function(){b.modal("hide"),a.updateView(),$(a).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully unsigned document."})},e=function(){$(a).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to unsign document."})},f=function(){var b=a.doc.store.rdf,c=b.createTriple(b.createNamedNode(a.doc.url),b.createNamedNode("http://www.openlinksw.com/schemas/cert#hasSignature"),b.createNamedNode(a.doc.signature));a.doc.deleteTriples(c,d,e)};if(b.find("#deleteSignature").checked){var g=RDFE.IO.createIO("webdav");g.type="webdav",g["delete"](a.doc.signature)}else f()}}(b))):(c.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">Document has not signature</p>         </div>       </div>    '),b.find(".ok").hide()),b.modal()},RDFE.Editor.prototype.dereference=function(){var a=this;return function(a){return function(b){if(b){if(b.startsWith("#")){if(!a.doc.url)return;b=a.doc.url+b}if(b.startsWith("http")){var c=window.open(b,"_blank");c.focus()}}}}(a)},RDFE.Editor.prototype.createTripleList=function(){var a=this;a.toggleSpinner(!0),a.tripleView||(a.tripleView=new RDFE.TripleView(a)),a.formContainer.hide(),a.listContainer.empty().show(),setTimeout(function(){a.tripleView.render(a.listContainer,function(){a.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editTriple=function(a,b,c){var d=this;if(!d.doc)return!1;d.listContainer.hide(),d.formContainer.html('<div class="panel panel-default">  <div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("spo",d.namingSchema())+'</h3></div>  <div class="panel-body">    <form class="form-horizontal">      <div class="form-group"><label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",d.namingSchema())+'</label>        <div class="col-sm-10"><input name="subject" class="form-control" /></div>      </div>      <div class="form-group"><label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",d.namingSchema())+'</label>        <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>      </div>      <div class="form-group"><label for="object" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",d.namingSchema())+'</label>        <div class="col-sm-10"><input name="object" class="form-control" /></div>      </div>      <div class="form-group">        <div class="col-sm-10 col-sm-offset-2">          <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>         </div>      </div>    </form>  </div></div>').show();
var e=d.formContainer.find('input[name="subject"]');e.focus(),(a||d.saveSubject)&&d.formContainer.find('input[name="subject"]').val(a||d.saveSubject);var f=d.formContainer.find('input[name="object"]').rdfNodeEditor(d.config.options);c&&f.setValue(new RDFE.RdfNode("literal",c,null,""));var g=d.formContainer.find('select[name="predicate"]').propertyBox({ontologyManager:d.ontologyManager}).on("changed",function(a,b){d.changeObjectType(b,f)});b&&g.setPropertyURI(b),d.formContainer.find("button.triple-action-new-cancel").click(function(a){a.preventDefault(),d.createTripleList()}),d.formContainer.find("button.triple-action-new-save").click(function(a){a.preventDefault();var b=e.val();if(b=RDFE.Utils.trim(RDFE.Utils.trim(b,"<"),">"),RDFE.Validate.check(e,b)){var c=g.selectedURI();if(c=RDFE.Utils.trim(RDFE.Utils.trim(c,"<"),">"),RDFE.Validate.check(g.sel,c)){var h=f.getValue();if("uri"==h.type&&(h.value=d.ontologyManager.uriDenormalize(h.value)),RDFE.Validate.check(f.getField(),h.value)){var i=d.doc.store.rdf.createTriple(d.doc.store.rdf.createNamedNode(b),d.doc.store.rdf.createNamedNode(c),h.toStoreNode(d.doc.store));d.doc.addTriples([i],function(){d.tripleView&&d.tripleView.addTriple(i),$(d).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully added new triple."}),d.saveSubject=b,d.createTripleList()},function(){$(d).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})}}}})},RDFE.Editor.prototype.createNewEntityEditor=function(a){var b,c,d,e=this,f=function(a){var b=e.ontologyManager.ontologyByURI(a.currentTarget.selectedOntologyURI());d.clearOptions(),d.addOption(b?b.classesAsArray():e.ontologyManager.allClasses())};if(!e.doc)return!1;if(e.listContainer.hide(),e.formContainer.show(),a){var g=e.ontologyManager.ontologyClassByURI(a),h=g?g.label:RDFE.Utils.uri2name(a);e.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",e.namingSchema())+'</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <p class="form-control-static" title="'+a+'">'+h+'</p>    </div>   </div>   <div class="form-group">      <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",e.namingSchema())+' URI</label>      <div class="col-sm-10">        <input name="subject" id="subject" class="form-control" />      </div>   </div>   <div class="form-group">     <div class="col-sm-10 col-sm-offset-2">       <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>       <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>     </div>   </div> </div></div></div>\n'),e.formContainer.find("input#subject").focus()}else e.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",e.namingSchema())+'</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="ontology" class="col-sm-2 control-label">Vocabulary</label>     <div class="col-sm-10">       <select name="ontology" id="ontology" class="form-control" />     </div>   </div>   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <select name="class" id="class" class="form-control" />     </div>   </div>   <div class="form-group">      <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",e.namingSchema())+' URI</label>      <div class="col-sm-10">        <input name="subject" id="subject" class="form-control" />      </div>   </div>   <div class="form-group">     <div class="col-sm-10 col-sm-offset-2">       <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>       <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>     </div>   </div> </div></div></div>\n'),b=$("#ontology").ontoBox({ontologyManager:e.ontologyManager}),b.on("changed",f),b.sel.focus(),c=$("#class").selectize({valueField:"URI",labelField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:e.ontologyManager.allClasses(),create:function(a,b){b(e.ontologyManager.ontologyClassByURI(e.ontologyManager.uriDenormalize(a),!0))},render:{item:function(a,b){var c=a.title||a.label||name.curi||a.name;return c=a.curi&&a.curi!=c?b(c)+" <small>("+b(a.curi)+")</small>":b(c),"<div>"+c+"</div>"},option:function(a,b){return"<div>"+b(a.title||a.label||name.curi||a.name)+"<br/><small>("+b(a.URI)+")</small></div>"},option_create:function(a,b){var c=e.ontologyManager.uriDenormalize(a.input);return c!=a.input?'<div class="create">Add <strong>'+b(a.input)+"</strong> <small>("+b(c)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+b(c)+"</strong>&hellip;</div>"}}}),d=c[0].selectize;e.config.options.entityUriTmpl&&e.formContainer.find('label[for="subject"]').text(RDFE.Utils.namingSchemaLabel("s",e.namingSchema())+" Name"),e.formContainer.find("button.triple-action-new-cancel").click(function(a){a.preventDefault(),e.listContainer.show(),e.formContainer.hide()});var i=function(){var b=e.formContainer.find('input[name="subject"]').val(),c=null,d=a||e.formContainer.find("#class")[0].selectize.getValue();b=RDFE.Utils.trim(RDFE.Utils.trim(b,"<"),">"),e.config.options.entityUriTmpl&&(c=b,b=null),e.doc.addEntity(b,c,d,function(a){e.entityView&&e.entityView.addEntity(a),$(e).trigger("rdf-editor-success",{type:"entity-insert-success",message:"Successfully created new entity."}),e.editEntity(a.uri)},function(){$(e).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})};e.formContainer.find("button.triple-action-new-save").click(function(a){a.preventDefault(),i()}),e.formContainer.find("input#subject").keypress(function(a){13===a.which&&i()})},RDFE.Editor.prototype.createEntityList=function(){var a=this;a.toggleSpinner(!0),a.entityView||(a.entityView=new RDFE.EntityView(a.doc,a.ontologyManager,a,{editFct:function(b){a.editEntity.call(a,b)}}),$(a.entityView).on("rdf-editor-error",function(b,c){$(a).trigger("rdf-editor-error",c)}).on("rdf-editor-success",function(b,c){$(a).trigger("rdf-editor-success",c)})),a.formContainer.hide(),a.listContainer.empty().show(),setTimeout(function(){a.entityView.render(a.listContainer,function(){a.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editEntity=function(a){var b=this;b.entityEditor||(b.entityEditor=new RDFE.EntityEditor(b.doc,b.ontologyManager),$(b.entityEditor).on("rdf-editor-error",function(a,c){$(b).trigger("rdf-editor-error",c)}).on("rdf-editor-success",function(a,c){$(b).trigger("rdf-editor-success",c)})),b.listContainer.hide(),b.formContainer.show(),b.entityEditor.render(b.formContainer,a,function(){b.formContainer.hide(),b.listContainer.show(),b.entityView.updateEntity(a)})},RDFE.Editor.prototype.createSubjectList=function(){var a=this;a.toggleSpinner(!0),a.subjectView||(a.subjectView=new RDFE.SubjectView(a,{editFct:function(b){a.editSubject.call(a,b)}})),a.formContainer.hide(),a.listContainer.empty().show(),setTimeout(function(){a.subjectView.render(a.listContainer,function(){a.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editSubject=function(a,b){var c=this;c.subjectEditor||(c.subjectEditor=new RDFE.SubjectEditor(c)),"string"==typeof a&&(a=c.doc.newSubject(a)),c.listContainer.hide(),c.formContainer.show(),c.subjectEditor.subject=a,c.subjectEditor.render(c,c.formContainer,b,function(){c.formContainer.hide(),c.listContainer.show(),a&&a.uri&&c.subjectView.updateSubject(a.uri)})},RDFE.Editor.prototype.createPredicateList=function(){var a=this;a.toggleSpinner(!0),a.predicateView||(a.predicateView=new RDFE.PredicateView(a,{editFct:function(b){a.editPredicate.call(a,b)}})),a.formContainer.hide(),a.listContainer.empty().show(),setTimeout(function(){a.predicateView.render(a.listContainer,function(){a.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editPredicate=function(a,b){var c=this;c.predicateEditor||(c.predicateEditor=new RDFE.PredicateEditor(c)),c.listContainer.hide(),c.formContainer.show(),"string"==typeof a&&(a=c.doc.newPredicate(a)),a&&c.ontologyManager.ontologyPropertyByURI(a.uri,!0),c.predicateEditor.predicate=a,c.predicateEditor.render(c,c.formContainer,b,function(){c.formContainer.hide(),c.listContainer.show(),a&&a.uri&&c.predicateView.updatePredicate(a.uri)})},RDFE.Editor.prototype.createObjectList=function(){var a=this;a.toggleSpinner(!0),a.objectView||(a.objectView=new RDFE.ObjectView(a,{editFct:function(b){a.editObject.call(a,b)}})),a.formContainer.hide(),a.listContainer.empty().show(),setTimeout(function(){a.objectView.render(a.listContainer,function(){a.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editObject=function(a,b){var c=this;c.objectEditor||(c.objectEditor=new RDFE.ObjectEditor(c)),"string"==typeof a&&(a=c.doc.newObject(a)),c.listContainer.hide(),c.formContainer.show(),c.objectEditor.object=a,c.objectEditor.render(c,c.formContainer,b,function(){c.formContainer.hide(),c.listContainer.show(),a&&c.objectView.updateObject(a)})},RDFE.Editor.prototype.changeObjectType=function(a,b){var c,d,e=this,f=b.getValue();if(a){var g=a.getRange();if(g&&g.length){for(var h=0;h<g.length;h++)if(b.isLiteralType(g[h])){c=new RDFE.RdfNode("literal",f.value,g[h],f.language);break}if(!c)if(d=e.doc.itemsByRange(g))c=new RDFE.RdfNode("uri",f.value),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!==a.URI&&e.objectsLookup(b,g);else for(var h=0;h<g.length;h++)b.isLiteralType(g[h])&&(c=new RDFE.RdfNode("literal",f.value,g[h],f.language))}}c||(c=new RDFE.RdfNode("literal",f.value,null,"")),b.setValue(c,d)},RDFE.Editor.prototype.objectsLookup=function(a,b){var c=this,d=c.config.options.objectLookups;if(d&&d.enabled){var e=d.sources;if(e)for(var f=RDFE.IO.createIO("http"),g=c.doc.store,h=0;h<e.length;h++)for(var i=0;i<b.length;i++){var j=b[i],k="urn:__GRAPH__"+h+"_"+i,l=e[h].url.format(encodeURIComponent(j)),m=function(b,c,d){return function(e,f,h){g.loadTurtle(e,b,b,null,function(e,f){if(!e){var h="select ?s from <{0}> where {?s a <{1}>}".format(b,c);g.execute(h,function(b,c){for(var e=[],f=0;f<c.length;f++)e.push(new RDFE.RdfNode("uri",c[f].s.value));a.updateSelection(d,e)})}}),g.clear(b,function(){})}}(k,j,e[h].label),n={success:m};f.retrieveToStore(l,g,k,n)}}},RDFE.Editor.prototype.dataSetter=function(a,b,c){var d=this,e=c[a];if("subject"===a)e=d.doc.store.rdf.createNamedNode(e.value);else if("predicate"===a)e=d.doc.store.rdf.createNamedNode(e);else if("object"===a)if("uri"===e.type)e=d.doc.store.rdf.createNamedNode(e.value);else if("http://www.w3.org/2001/XMLSchema#dateTime"===e.datatype){var f=new Date(e.value);e=d.doc.store.rdf.createLiteral(f.toISOString(),e.language,e.datatype)}else e=d.doc.store.rdf.createLiteral(e.value,e.language,e.datatype);c[a]=e,d.doc.updateTriple(b,c,function(a){$(d).trigger("rdf-editor-success",{type:"triple-update-success",message:"Successfully updated triple."})},function(a){$(d).trigger("rdf-editor-error",{type:"triple-update-error",message:"Failed to update triple."})})},function(a){window.RDFE||(window.RDFE={}),RDFE.OntologyView=function(){var b=function(b,c){c=a.extend({},c),this.editor=b,this.ontologyManager=b.ontologyManager,this.ontologies=this.ontologyManager.allOntologies()};return b.prototype.render=function(b){var c=this;a(c.ontologyManager).on("changed",function(a,b){c.addOntologies(b.allOntologies())}),c.table=null,c.tableContainer=null,c.formContainer=null,b.empty();var d=a(document.createElement("div"));b.append(d);var e=a(document.createElement("table")).addClass("table");d.append(e);var f=a(document.createElement("div"));b.append(f);var g=function(b,d,e){e=a.trim(e),b.prefix!==e&&(delete c.ontologyManager.prefixes[b.prefix],delete RDFE.prefixes[b.prefix],b.prefix=e,c.ontologyManager.prefixes[b.prefix]=b.URI,RDFE.prefixes[b.prefix]=b.URI)},h=c.ontologyManager.allOntologies();e.bootstrapTable({striped:!0,sortName:"prefix",showHeader:!1,classes:"table-hover table-condensed",height:157,data:h,idField:"URI",dataSetter:g,columns:[{field:"prefix",title:"Prefix",titleTooltip:"Prefix",editable:function(b){return{mode:"inline",type:"text",value:b.prefix,emptytext:"empty",validate:function(b){var d=a.trim(b);return""==d?"This field is required":c.ontologyManager.ontologyByPrefix(d)?"This prefix is used":void 0}}},formatter:function(a,b,c){return b.prefix?b.prefix:""}},{field:"URI",title:"URI",titleTooltip:"URI",formatter:function(a,b,c){return['<span title="Vocabulary {0} - {1} classes, {2} properties">'.format(b.URI,b.classesLength(),b.propertiesLength()),"{0} - {1}/{2}".format(b.URI,b.classesLength(),b.propertiesLength()),"</span>"].join("")}},{field:"actions",title:"",align:"center",valign:"middle",clickToSelect:!1,formatter:function(a,b,c){return['<a class="refresh ml10" href="javascript:void(0)" title="Refresh vocabulary">','  <i class="glyphicon glyphicon-refresh"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this vocabulary">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove vocabulary">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .refresh":function(b,d,e,f){var g=a("#ontology-loading");if(!g.is(":visible")){g.show();var h={success:function(){a(c.ontologyManager).trigger("loadingFinished",[c.ontologyManager]),g.hide()},error:function(b){a(c.ontologyManager).trigger("loadingFailed",[c.ontologyManager]),a.notify({message:b.message},{type:"danger"}),g.hide()},ioType:"http"};c.ontologyManager.parseOntologyFile(e.URI,h)}},"click .dereference":function(a,b,d,e){var f=c.editor.dereference();f(d.URI)},"click .remove":function(a,b,d,e){c.ontologyManager.ontologyRemove(d.URI),c.table.bootstrapTable("remove",{field:"URI",values:[d.URI]})}}}]}),c.table=e,c.tableContainer=d,c.formContainer=f,f.html('<div class="panel panel-default" style="border: 0; padding: 0; margin-bottom: 0;">   <div class="panel-body" style="padding-top: 10px; padding-bottom: 0;"><div class="form-horizontal">     <form class="form-horizontal">       <div class="form-group">         <label for="ontology" class="col-sm-2 control-label">Prefix</label>         <div class="col-sm-10">           <input name="prefix" id="prefix" class="form-control" />         </div>       </div>       <div class="form-group">         <label for="class" class="col-sm-2 control-label">URI</label>         <div class="col-sm-10">           <input name="uri" id="uri" class="form-control" />         </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default cancel">Cancel</button>           <button type="submit" class="btn btn-primary save">OK</button>         </div>       </div>     </form>   </div> </div>\n'),f.find(".cancel").click(function(b){b.preventDefault();var d=a("#ontology-loading");d.is(":visible")||(c.formContainer.hide(),c.tableContainer.show())}),f.find(".save").click(function(b){b.preventDefault();var d=a("#ontology-loading");if(!d.is(":visible")){var e=c.formContainer.find("#uri"),f=function(){c.formContainer.hide(),c.tableContainer.show(),d.hide()},g={success:function(){a(c.ontologyManager).trigger("loadingFinished",[c.ontologyManager]),f()},error:function(b){a(c.ontologyManager).trigger("loadingFailed",[c.ontologyManager]);var d=b&&b.message?b.message:"Error loading ontology";bootbox.confirm(d+". Do you want an empty ontology to be added?",function(a){if(a){var b=e.val(),d=c.ontologyManager.ontologyByURI(b);if(!d){d=new RDFE.Ontology(c.ontologyManager,b);var f=c.formContainer.find("#prefix").val();f&&(d.prefix=f),c.addOntologies(c.ontologyManager.allOntologies())}}}),f()}},h=e.val();if(RDFE.Validate.check(e,h)){var i=RDFE.Utils.splitUrl(h);if("http:"!==i.protocol&&"https:"!==i.protocol)return void bootbox.alert("Only HTTP and HTTPS protocols are supported");var j=c.ontologyManager.ontologyByURI(h);if(j)return void bootbox.alert("This ontology is loaded. Please, use 'Refresh' action!");if(d.show(),!c.ontologyManager.prefixByOntology(h)){var k=c.formContainer.find("#prefix").val();c.ontologyManager.prefixes[k]=h}c.ontologyManager.parseOntologyFile(h,g)}}}),f.find("#prefix").blur(function(a){var b=c.formContainer.find("#prefix").val();if(b){var d=RDFE.ontologyByPrefix(b);d&&c.formContainer.find("#uri").val(d)}}),f.hide()},b.prototype.addOntologies=function(a){for(var b=this,c=0;c<a.length;c++)_.find(b.ontologies,function(b){return b.URI===a[c].URI})||b.table.bootstrapTable("append",a[c]);b.ontologies=a},b.prototype.add=function(a){var b=this;b.formContainer.find("#prefix").val(""),b.formContainer.find("#uri").val(""),b.tableContainer.hide(),b.formContainer.show(),b.formContainer.find("#prefix").focus()},b}()}(jQuery),function(){"use strict";function a(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(v=window.localStorage,y="localStorage",B=v.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(v="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],y="globalStorage",B=v.jStorage_update)}catch(f){}else{if(w=document.createElement("link"),!w.addBehavior)return void(w=null);w.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(w);try{w.load("jStorage")}catch(g){w.setAttribute("jStorage","{}"),w.save("jStorage"),w.load("jStorage")}var i="{}";try{i=w.getAttribute("jStorage")}catch(j){}try{B=w.getAttribute("jStorage_update")}catch(m){}v.jStorage=i,y="userDataBehavior"}h(),k(),c(),l(),"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&d()},!1)}function b(){var a="{}";if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage")}catch(b){}try{B=w.getAttribute("jStorage_update")}catch(c){}v.jStorage=a}h(),k(),l()}function c(){"localStorage"==y||"globalStorage"==y?"addEventListener"in window?window.addEventListener("storage",d,!1):document.attachEvent("onstorage",d):"userDataBehavior"==y&&setInterval(d,1e3)}function d(){var a;clearTimeout(A),A=setTimeout(function(){if("localStorage"==y||"globalStorage"==y)a=v.jStorage_update;else if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage_update")}catch(b){}}a&&a!=B&&(B=a,e())},25)}function e(){var a,c=s.parse(s.stringify(u.__jstorage_meta.CRC32));b(),a=s.parse(s.stringify(u.__jstorage_meta.CRC32));var d,e=[],g=[];for(d in c)if(c.hasOwnProperty(d)){if(!a[d]){g.push(d);continue}c[d]!=a[d]&&"2."==String(c[d]).substr(0,2)&&e.push(d)}for(d in a)a.hasOwnProperty(d)&&(c[d]||e.push(d));f(e,"updated"),f(g,"deleted")}function f(a,b){a=[].concat(a||[]);var c,d,e,f;if("flushed"==b){a=[];for(var g in z)z.hasOwnProperty(g)&&a.push(g);b="deleted"}for(c=0,e=a.length;e>c;c++){if(z[a[c]])for(d=0,f=z[a[c]].length;f>d;d++)z[a[c]][d](a[c],b);if(z["*"])for(d=0,f=z["*"].length;f>d;d++)z["*"][d](a[c],b)}}function g(){var a=(+new Date).toString();if("localStorage"==y||"globalStorage"==y)try{v.jStorage_update=a}catch(b){y=!1}else"userDataBehavior"==y&&(w.setAttribute("jStorage_update",a),w.save("jStorage"));d()}function h(){if(v.jStorage)try{u=s.parse(String(v.jStorage))}catch(a){v.jStorage="{}"}else v.jStorage="{}";x=v.jStorage?String(v.jStorage).length:0,u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.CRC32||(u.__jstorage_meta.CRC32={})}function i(){n();try{v.jStorage=s.stringify(u),w&&(w.setAttribute("jStorage",v.jStorage),w.save("jStorage")),x=v.jStorage?String(v.jStorage).length:0}catch(a){}}function j(a){if("string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==a)throw new TypeError("Reserved key name");return!0}function k(){var a,b,c,d,e=1/0,h=!1,j=[];if(clearTimeout(t),u.__jstorage_meta&&"object"==typeof u.__jstorage_meta.TTL){a=+new Date,c=u.__jstorage_meta.TTL,d=u.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=a?(delete c[b],delete d[b],delete u[b],h=!0,j.push(b)):c[b]<e&&(e=c[b]));e!=1/0&&(t=setTimeout(k,Math.min(e-a,2147483647))),h&&(i(),g(),f(j,"deleted"))}}function l(){var a,b;if(u.__jstorage_meta.PubSub){var c,d=D,e=[];for(a=b=u.__jstorage_meta.PubSub.length-1;a>=0;a--)c=u.__jstorage_meta.PubSub[a],c[0]>D&&(d=c[0],e.unshift(c));for(a=e.length-1;a>=0;a--)m(e[a][1],e[a][2]);D=d}}function m(a,b){if(C[a])for(var c=0,d=C[a].length;d>c;c++)try{C[a][c](a,s.parse(s.stringify(b)))}catch(e){}}function n(){if(u.__jstorage_meta.PubSub){for(var a=+new Date-2e3,b=0,c=u.__jstorage_meta.PubSub.length;c>b;b++)if(u.__jstorage_meta.PubSub[b][0]<=a){u.__jstorage_meta.PubSub.splice(b,u.__jstorage_meta.PubSub.length-b);break}u.__jstorage_meta.PubSub.length||delete u.__jstorage_meta.PubSub}}function o(a,b){u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.PubSub||(u.__jstorage_meta.PubSub=[]),u.__jstorage_meta.PubSub.unshift([+new Date,a,b]),i(),g()}function p(a,b){for(var c,d=a.length,e=b^d,f=0;d>=4;)c=255&a.charCodeAt(f)|(255&a.charCodeAt(++f))<<8|(255&a.charCodeAt(++f))<<16|(255&a.charCodeAt(++f))<<24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),c^=c>>>24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^c,d-=4,++f;switch(d){case 3:e^=(255&a.charCodeAt(f+2))<<16;case 2:e^=(255&a.charCodeAt(f+1))<<8;case 1:e^=255&a.charCodeAt(f),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)}return e^=e>>>13,e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16),e^=e>>>15,e>>>0}var q="0.4.12",r=window.jQuery||window.$||(window.$={}),s={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||r.parseJSON||r.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||r.toJSON};if("function"!=typeof s.parse||"function"!=typeof s.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var t,u={__jstorage_meta:{CRC32:{}}},v={jStorage:"{}"},w=null,x=0,y=!1,z={},A=!1,B=0,C={},D=+new Date,E={isXML:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?"HTML"!==b.nodeName:!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b,c="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b};return c?(b=c.call("DOMParser"in window&&new DOMParser||window,a,"text/xml"),this.isXML(b)?b:!1):!1}};r.jStorage={version:q,set:function(a,b,c){if(j(a),c=c||{},"undefined"==typeof b)return this.deleteKey(a),b;if(E.isXML(b))b={_is_xml:!0,xml:E.encode(b)};else{if("function"==typeof b)return void 0;b&&"object"==typeof b&&(b=s.parse(s.stringify(b)))}return u[a]=b,u.__jstorage_meta.CRC32[a]="2."+p(s.stringify(b),2538058380),this.setTTL(a,c.TTL||0),f(a,"updated"),b},get:function(a,b){return j(a),a in u?u[a]&&"object"==typeof u[a]&&u[a]._is_xml?E.decode(u[a].xml):u[a]:"undefined"==typeof b?null:b},deleteKey:function(a){return j(a),a in u?(delete u[a],"object"==typeof u.__jstorage_meta.TTL&&a in u.__jstorage_meta.TTL&&delete u.__jstorage_meta.TTL[a],delete u.__jstorage_meta.CRC32[a],i(),g(),f(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+new Date;return j(a),b=Number(b)||0,a in u?(u.__jstorage_meta.TTL||(u.__jstorage_meta.TTL={}),b>0?u.__jstorage_meta.TTL[a]=c+b:delete u.__jstorage_meta.TTL[a],i(),k(),g(),!0):!1},getTTL:function(a){var b,c=+new Date;return j(a),a in u&&u.__jstorage_meta.TTL&&u.__jstorage_meta.TTL[a]?(b=u.__jstorage_meta.TTL[a]-c,b||0):0},flush:function(){return u={__jstorage_meta:{CRC32:{}}},i(),g(),f(null,"flushed"),!0},storageObj:function(){function a(){}return a.prototype=u,new a},index:function(){var a,b=[];for(a in u)u.hasOwnProperty(a)&&"__jstorage_meta"!=a&&b.push(a);return b},storageSize:function(){return x},currentBackend:function(){return y},storageAvailable:function(){return!!y},listenKeyChange:function(a,b){j(a),z[a]||(z[a]=[]),z[a].push(b)},stopListening:function(a,b){if(j(a),z[a]){if(!b)return void delete z[a];for(var c=z[a].length-1;c>=0;c--)z[a][c]==b&&z[a].splice(c,1)}},subscribe:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");C[a]||(C[a]=[]),C[a].push(b)},publish:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");o(a,b)},reInit:function(){b()},noConflict:function(a){return delete window.$.jStorage,a&&(window.jStorage=this),this}},a()}(),!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports?module.exports=b(require("jquery")):a.bootbox=b(a.jQuery)}(this,function a(b,c){"use strict";function d(a){var b=q[o.locale];return b?b[a]:q.en[a]}function e(a,c,d){a.stopPropagation(),a.preventDefault();var e=b.isFunction(d)&&d(a)===!1;e||c.modal("hide")}function f(a){var b,c=0;for(b in a)c++;return c}function g(a,c){var d=0;b.each(a,function(a,b){c(a,b,d++)})}function h(a){var c,d;if("object"!=typeof a)throw new Error("Please supply an object of options");if(!a.message)throw new Error("Please specify a message");return a=b.extend({},o,a),a.buttons||(a.buttons={}),a.backdrop=a.backdrop?"static":!1,c=a.buttons,d=f(c),g(c,function(a,e,f){if(b.isFunction(e)&&(e=c[a]={callback:e}),"object"!==b.type(e))throw new Error("button with key "+a+" must be an object");e.label||(e.label=a),e.className||(e.className=2>=d&&f===d-1?"btn-primary":"btn-default")}),a}function i(a,b){var c=a.length,d={};if(1>c||c>2)throw new Error("Invalid argument length");return 2===c||"string"==typeof a[0]?(d[b[0]]=a[0],d[b[1]]=a[1]):d=a[0],d}function j(a,c,d){return b.extend(!0,{},a,i(c,d))}function k(a,b,c,d){var e={className:"bootbox-"+a,buttons:l.apply(null,b)};return m(j(e,d,c),b)}function l(){for(var a={},b=0,c=arguments.length;c>b;b++){var e=arguments[b],f=e.toLowerCase(),g=e.toUpperCase();a[f]={label:d(g)}}return a}function m(a,b){var d={};return g(b,function(a,b){d[b]=!0}),g(a.buttons,function(a){if(d[a]===c)throw new Error("button key "+a+" is not allowed (options are "+b.join("\n")+")")}),a}var n={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},o={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0,container:"body"},p={};p.alert=function(){var a;if(a=k("alert",["ok"],["message","callback"],arguments),a.callback&&!b.isFunction(a.callback))throw new Error("alert requires callback property to be a function when provided");return a.buttons.ok.callback=a.onEscape=function(){return b.isFunction(a.callback)?a.callback():!0},p.dialog(a)},p.confirm=function(){var a;if(a=k("confirm",["cancel","confirm"],["message","callback"],arguments),a.buttons.cancel.callback=a.onEscape=function(){return a.callback(!1)},a.buttons.confirm.callback=function(){return a.callback(!0)},!b.isFunction(a.callback))throw new Error("confirm requires a callback");return p.dialog(a)},p.prompt=function(){var a,d,e,f,h,i,k;if(f=b(n.form),d={className:"bootbox-prompt",buttons:l("cancel","confirm"),value:"",inputType:"text"},a=m(j(d,arguments,["title","callback"]),["cancel","confirm"]),i=a.show===c?!0:a.show,a.message=f,a.buttons.cancel.callback=a.onEscape=function(){return a.callback(null)},a.buttons.confirm.callback=function(){var c;switch(a.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":c=h.val();break;case"checkbox":var d=h.find("input:checked");c=[],g(d,function(a,d){c.push(b(d).val())})}return a.callback(c)},a.show=!1,!a.title)throw new Error("prompt requires a title");if(!b.isFunction(a.callback))throw new Error("prompt requires a callback");if(!n.inputs[a.inputType])throw new Error("invalid prompt type");switch(h=b(n.inputs[a.inputType]),a.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":h.val(a.value);break;case"select":var o={};if(k=a.inputOptions||[],!k.length)throw new Error("prompt with select requires options");g(k,function(a,d){var e=h;if(d.value===c||d.text===c)throw new Error("given options in wrong format");d.group&&(o[d.group]||(o[d.group]=b("<optgroup/>").attr("label",d.group)),e=o[d.group]),e.append("<option value='"+d.value+"'>"+d.text+"</option>")}),g(o,function(a,b){h.append(b)}),h.val(a.value);break;case"checkbox":var q=b.isArray(a.value)?a.value:[a.value];if(k=a.inputOptions||[],!k.length)throw new Error("prompt with checkbox requires options");if(!k[0].value||!k[0].text)throw new Error("given options in wrong format");h=b("<div/>"),g(k,function(c,d){var e=b(n.inputs[a.inputType]);e.find("input").attr("value",d.value),e.find("label").append(d.text),g(q,function(a,b){b===d.value&&e.find("input").prop("checked",!0)}),h.append(e)})}return a.placeholder&&h.attr("placeholder",a.placeholder),a.pattern&&h.attr("pattern",a.pattern),f.append(h),f.on("submit",function(a){a.preventDefault(),a.stopPropagation(),e.find(".btn-primary").click()}),e=p.dialog(a),e.off("shown.bs.modal"),e.on("shown.bs.modal",function(){h.focus()}),i===!0&&e.modal("show"),e},p.dialog=function(a){a=h(a);var c=b(n.dialog),d=c.find(".modal-dialog"),f=c.find(".modal-body"),i=a.buttons,j="",k={onEscape:a.onEscape};if(g(i,function(a,b){j+="<button data-bb-handler='"+a+"' type='button' class='btn "+b.className+"'>"+b.label+"</button>",k[a]=b.callback}),f.find(".bootbox-body").html(a.message),a.animate===!0&&c.addClass("fade"),a.className&&c.addClass(a.className),"large"===a.size&&d.addClass("modal-lg"),"small"===a.size&&d.addClass("modal-sm"),a.title&&f.before(n.header),a.closeButton){var l=b(n.closeButton);a.title?c.find(".modal-header").prepend(l):l.css("margin-top","-10px").prependTo(f)}return a.title&&c.find(".modal-title").html(a.title),j.length&&(f.after(n.footer),c.find(".modal-footer").html(j)),c.on("hidden.bs.modal",function(a){a.target===this&&c.remove()}),c.on("shown.bs.modal",function(){c.find(".btn-primary:first").focus()}),c.on("escape.close.bb",function(a){k.onEscape&&e(a,c,k.onEscape)}),c.on("click",".modal-footer button",function(a){var d=b(this).data("bb-handler");e(a,c,k[d])}),c.on("click",".bootbox-close-button",function(a){
e(a,c,k.onEscape)}),c.on("keyup",function(a){27===a.which&&c.trigger("escape.close.bb")}),b(a.container).append(c),c.modal({backdrop:a.backdrop,keyboard:!1,show:!1}),a.show&&c.modal("show"),c},p.setDefaults=function(){var a={};2===arguments.length?a[arguments[0]]=arguments[1]:a=arguments[0],b.extend(o,a)},p.hideAll=function(){return b(".bootbox").modal("hide"),p};var q={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return p.init=function(c){return a(c||b)},p}),function(a){a.deparam=function(b,c){var d={},e={"true":!0,"false":!1,"null":null};return a.each(b.replace(/\+/g," ").split("&"),function(b,f){var g,h=f.split("="),i=decodeURIComponent(h[0]),j=d,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(h=decodeURIComponent(h[1]),c&&(h=h&&!isNaN(h)?+h:"undefined"===h?void 0:void 0!==e[h]?e[h]:h),m)for(;m>=k;k++)i=""===l[k]?j.length:l[k],g=j[i]=m>k?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):h,j=g;else a.isArray(d[i])?d[i].push(h):d[i]=void 0!==d[i]?[d[i],h]:h;else i&&(d[i]=c?void 0:"")}),d}}(jQuery),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),function(a){if("object"==typeof exports)a(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],a);else{if(!window.Spinner)throw new Error("Spin.js not present");a(window.jQuery,window.Spinner)}}(function(a,b){a.fn.spin=function(c,d){return this.each(function(){var e=a(this),f=e.data();f.spinner&&(f.spinner.stop(),delete f.spinner),c!==!1&&(c=a.extend({color:d||e.css("color")},a.fn.spin.presets[c]||c),f.spinner=new b(c).spin(this))})},a.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(b){var c=!1;return a('[data-notify="container"]').each(function(d,e){var f=a(e),g=f.find('[data-notify="title"]').text().trim(),h=f.find('[data-notify="message"]').html().trim(),i=g===a("<div>"+b.settings.content.title+"</div>").html().trim(),j=h===a("<div>"+b.settings.content.message+"</div>").html().trim(),k=f.hasClass("alert-"+b.settings.type);return i&&j&&k&&(c=!0),!c}),c}function c(c,e,f){var g={content:{message:"object"==typeof e?e.message:e,title:e.title?e.title:"",icon:e.icon?e.icon:"",url:e.url?e.url:"#",target:e.target?e.target:"-"}};f=a.extend(!0,{},g,f),this.settings=a.extend(!0,{},d,f),this._defaults=d,"-"===this.settings.content.target&&(this.settings.content.target=this.settings.url_target),this.animations={start:"webkitAnimationStart oanimationstart MSAnimationStart animationstart",end:"webkitAnimationEnd oanimationend MSAnimationEnd animationend"},"number"==typeof this.settings.offset&&(this.settings.offset={x:this.settings.offset,y:this.settings.offset}),(this.settings.allow_duplicates||!this.settings.allow_duplicates&&!b(this))&&this.init()}var d={element:"body",position:null,type:"info",allow_dismiss:!0,allow_duplicates:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5e3,timer:1e3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},onShow:null,onShown:null,onClose:null,onClosed:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">&times;</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'};String.format=function(){for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a},a.extend(c.prototype,{init:function(){var a=this;this.buildNotify(),this.settings.content.icon&&this.setIcon(),"#"!=this.settings.content.url&&this.styleURL(),this.styleDismiss(),this.placement(),this.bind(),this.notify={$ele:this.$ele,update:function(b,c){var d={};"string"==typeof b?d[b]=c:d=b;for(var e in d)switch(e){case"type":this.$ele.removeClass("alert-"+a.settings.type),this.$ele.find('[data-notify="progressbar"] > .progress-bar').removeClass("progress-bar-"+a.settings.type),a.settings.type=d[e],this.$ele.addClass("alert-"+d[e]).find('[data-notify="progressbar"] > .progress-bar').addClass("progress-bar-"+d[e]);break;case"icon":var f=this.$ele.find('[data-notify="icon"]');"class"===a.settings.icon_type.toLowerCase()?f.removeClass(a.settings.content.icon).addClass(d[e]):(f.is("img")||f.find("img"),f.attr("src",d[e]));break;case"progress":var g=a.settings.delay-a.settings.delay*(d[e]/100);this.$ele.data("notify-delay",g),this.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",d[e]).css("width",d[e]+"%");break;case"url":this.$ele.find('[data-notify="url"]').attr("href",d[e]);break;case"target":this.$ele.find('[data-notify="url"]').attr("target",d[e]);break;default:this.$ele.find('[data-notify="'+e+'"]').html(d[e])}var h=this.$ele.outerHeight()+parseInt(a.settings.spacing)+parseInt(a.settings.offset.y);a.reposition(h)},close:function(){a.close()}}},buildNotify:function(){var b=this.settings.content;this.$ele=a(String.format(this.settings.template,this.settings.type,b.title,b.message,b.url,b.target)),this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align),this.settings.allow_dismiss||this.$ele.find('[data-notify="dismiss"]').css("display","none"),(this.settings.delay<=0&&!this.settings.showProgressbar||!this.settings.showProgressbar)&&this.$ele.find('[data-notify="progressbar"]').remove()},setIcon:function(){"class"===this.settings.icon_type.toLowerCase()?this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon):this.$ele.find('[data-notify="icon"]').is("img")?this.$ele.find('[data-notify="icon"]').attr("src",this.settings.content.icon):this.$ele.find('[data-notify="icon"]').append('<img src="'+this.settings.content.icon+'" alt="Notify Icon" />')},styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"10px",top:"5px",zIndex:this.settings.z_index+2})},styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},placement:function(){var b=this,c=this.settings.offset.y,d={display:"inline-block",margin:"0px auto",position:this.settings.position?this.settings.position:"body"===this.settings.element?"fixed":"absolute",transition:"all .5s ease-in-out",zIndex:this.settings.z_index},e=!1,f=this.settings;switch(a('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){c=Math.max(c,parseInt(a(this).css(f.placement.from))+parseInt(a(this).outerHeight())+parseInt(f.spacing))}),this.settings.newest_on_top===!0&&(c=this.settings.offset.y),d[this.settings.placement.from]=c+"px",this.settings.placement.align){case"left":case"right":d[this.settings.placement.align]=this.settings.offset.x+"px";break;case"center":d.left=0,d.right=0}this.$ele.css(d).addClass(this.settings.animate.enter),a.each(Array("webkit-","moz-","o-","ms-",""),function(a,c){b.$ele[0].style[c+"AnimationIterationCount"]=1}),a(this.settings.element).append(this.$ele),this.settings.newest_on_top===!0&&(c=parseInt(c)+parseInt(this.settings.spacing)+this.$ele.outerHeight(),this.reposition(c)),a.isFunction(b.settings.onShow)&&b.settings.onShow.call(this.$ele),this.$ele.one(this.animations.start,function(){e=!0}).one(this.animations.end,function(){b.$ele.removeClass(b.settings.animate.enter),a.isFunction(b.settings.onShown)&&b.settings.onShown.call(this)}),setTimeout(function(){e||a.isFunction(b.settings.onShown)&&b.settings.onShown.call(this)},600)},bind:function(){var b=this;if(this.$ele.find('[data-notify="dismiss"]').on("click",function(){b.close()}),this.$ele.mouseover(function(){a(this).data("data-hover","true")}).mouseout(function(){a(this).data("data-hover","false")}),this.$ele.data("data-hover","false"),this.settings.delay>0){b.$ele.data("notify-delay",b.settings.delay);var c=setInterval(function(){var a=parseInt(b.$ele.data("notify-delay"))-b.settings.timer;if("false"===b.$ele.data("data-hover")&&"pause"===b.settings.mouse_over||"pause"!=b.settings.mouse_over){var d=(b.settings.delay-a)/b.settings.delay*100;b.$ele.data("notify-delay",a),b.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",d).css("width",d+"%")}a<=-b.settings.timer&&(clearInterval(c),b.close())},b.settings.timer)}},close:function(){var b=this,c=parseInt(this.$ele.css(this.settings.placement.from)),d=!1;this.$ele.attr("data-closing","true").addClass(this.settings.animate.exit),b.reposition(c),a.isFunction(b.settings.onClose)&&b.settings.onClose.call(this.$ele),this.$ele.one(this.animations.start,function(){d=!0}).one(this.animations.end,function(){a(this).remove(),a.isFunction(b.settings.onClosed)&&b.settings.onClosed.call(this)}),setTimeout(function(){d||(b.$ele.remove(),b.settings.onClosed&&b.settings.onClosed(b.$ele))},600)},reposition:function(b){var c=this,d='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',e=this.$ele.nextAll(d);this.settings.newest_on_top===!0&&(e=this.$ele.prevAll(d)),e.each(function(){a(this).css(c.settings.placement.from,b),b=parseInt(b)+parseInt(c.settings.spacing)+a(this).outerHeight()})}}),a.notify=function(a,b){var d=new c(this,a,b);return d.notify},a.notifyDefaults=function(b){return d=a.extend(!0,{},d,b)},a.notifyClose=function(b){"warning"===b&&(b="danger"),"undefined"==typeof b||"all"===b?a("[data-notify]").find('[data-notify="dismiss"]').trigger("click"):"success"===b||"info"===b||"warning"===b||"danger"===b?a(".alert-"+b+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):b?a(b+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):a('[data-notify-position="'+b+'"]').find('[data-notify="dismiss"]').trigger("click")},a.notifyCloseExcept=function(b){"warning"===b&&(b="danger"),"success"===b||"info"===b||"warning"===b||"danger"===b?a("[data-notify]").not(".alert-"+b).find('[data-notify="dismiss"]').trigger("click"):a("[data-notify]").not(b).find('[data-notify="dismiss"]').trigger("click")}});