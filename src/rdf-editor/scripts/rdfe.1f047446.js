!function(e){"use strict";function d(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function a(e,t,i,n,r,o){return d((s=d(d(t,e),d(n,o)))<<(a=r)|s>>>32-a,i);var s,a}function h(e,t,i,n,r,o,s){return a(t&i|~t&n,e,t,r,o,s)}function p(e,t,i,n,r,o,s){return a(t&n|i&~n,e,t,r,o,s)}function f(e,t,i,n,r,o,s){return a(t^i^n,e,t,r,o,s)}function g(e,t,i,n,r,o,s){return a(i^(t|~n),e,t,r,o,s)}function l(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var i,n,r,o,s,a=1732584193,l=-271733879,u=-1732584194,c=271733878;for(i=0;i<e.length;i+=16)l=g(l=g(l=g(l=g(l=f(l=f(l=f(l=f(l=p(l=p(l=p(l=p(l=h(l=h(l=h(l=h(r=l,u=h(o=u,c=h(s=c,a=h(n=a,l,u,c,e[i],7,-680876936),l,u,e[i+1],12,-389564586),a,l,e[i+2],17,606105819),c,a,e[i+3],22,-1044525330),u=h(u,c=h(c,a=h(a,l,u,c,e[i+4],7,-176418897),l,u,e[i+5],12,1200080426),a,l,e[i+6],17,-1473231341),c,a,e[i+7],22,-45705983),u=h(u,c=h(c,a=h(a,l,u,c,e[i+8],7,1770035416),l,u,e[i+9],12,-1958414417),a,l,e[i+10],17,-42063),c,a,e[i+11],22,-1990404162),u=h(u,c=h(c,a=h(a,l,u,c,e[i+12],7,1804603682),l,u,e[i+13],12,-40341101),a,l,e[i+14],17,-1502002290),c,a,e[i+15],22,1236535329),u=p(u,c=p(c,a=p(a,l,u,c,e[i+1],5,-165796510),l,u,e[i+6],9,-1069501632),a,l,e[i+11],14,643717713),c,a,e[i],20,-373897302),u=p(u,c=p(c,a=p(a,l,u,c,e[i+5],5,-701558691),l,u,e[i+10],9,38016083),a,l,e[i+15],14,-660478335),c,a,e[i+4],20,-405537848),u=p(u,c=p(c,a=p(a,l,u,c,e[i+9],5,568446438),l,u,e[i+14],9,-1019803690),a,l,e[i+3],14,-187363961),c,a,e[i+8],20,1163531501),u=p(u,c=p(c,a=p(a,l,u,c,e[i+13],5,-1444681467),l,u,e[i+2],9,-51403784),a,l,e[i+7],14,1735328473),c,a,e[i+12],20,-1926607734),u=f(u,c=f(c,a=f(a,l,u,c,e[i+5],4,-378558),l,u,e[i+8],11,-2022574463),a,l,e[i+11],16,1839030562),c,a,e[i+14],23,-35309556),u=f(u,c=f(c,a=f(a,l,u,c,e[i+1],4,-1530992060),l,u,e[i+4],11,1272893353),a,l,e[i+7],16,-155497632),c,a,e[i+10],23,-1094730640),u=f(u,c=f(c,a=f(a,l,u,c,e[i+13],4,681279174),l,u,e[i],11,-358537222),a,l,e[i+3],16,-722521979),c,a,e[i+6],23,76029189),u=f(u,c=f(c,a=f(a,l,u,c,e[i+9],4,-640364487),l,u,e[i+12],11,-421815835),a,l,e[i+15],16,530742520),c,a,e[i+2],23,-995338651),u=g(u,c=g(c,a=g(a,l,u,c,e[i],6,-198630844),l,u,e[i+7],10,1126891415),a,l,e[i+14],15,-1416354905),c,a,e[i+5],21,-57434055),u=g(u,c=g(c,a=g(a,l,u,c,e[i+12],6,1700485571),l,u,e[i+3],10,-1894986606),a,l,e[i+10],15,-1051523),c,a,e[i+1],21,-2054922799),u=g(u,c=g(c,a=g(a,l,u,c,e[i+8],6,1873313359),l,u,e[i+15],10,-30611744),a,l,e[i+6],15,-1560198380),c,a,e[i+13],21,1309151649),u=g(u,c=g(c,a=g(a,l,u,c,e[i+4],6,-145523070),l,u,e[i+11],10,-1120210379),a,l,e[i+2],15,718787259),c,a,e[i+9],21,-343485551),a=d(a,n),l=d(l,r),u=d(u,o),c=d(c,s);return[a,l,u,c]}function u(e){var t,i="";for(t=0;t<32*e.length;t+=8)i+=String.fromCharCode(e[t>>5]>>>t%32&255);return i}function c(e){var t,i=[];for(i[(e.length>>2)-1]=void 0,t=0;t<i.length;t+=1)i[t]=0;for(t=0;t<8*e.length;t+=8)i[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return i}function n(e){var t,i,n="0123456789abcdef",r="";for(i=0;i<e.length;i+=1)t=e.charCodeAt(i),r+=n.charAt(t>>>4&15)+n.charAt(15&t);return r}function i(e){return unescape(encodeURIComponent(e))}function r(e){return u(l(c(t=i(e)),8*t.length));var t}function o(e,t){return function(e,t){var i,n,r=c(e),o=[],s=[];for(o[15]=s[15]=void 0,16<r.length&&(r=l(r,8*e.length)),i=0;i<16;i+=1)o[i]=909522486^r[i],s[i]=1549556828^r[i];return n=l(o.concat(c(t)),512+8*t.length),u(l(s.concat(n),640))}(i(e),i(t))}e.md5=function(e,t,i){return t?i?o(t,e):n(o(t,e)):i?r(e):n(r(e))}}("function"==typeof jQuery?jQuery:this),function(){var e=this,t=e._,n=Array.prototype,i=Object.prototype,r=Function.prototype,a=n.push,u=n.slice,c=n.concat,h=i.toString,o=i.hasOwnProperty,s=Array.isArray,l=Object.keys,d=r.bind,p=function(e){return e instanceof p?e:this instanceof p?void(this._wrapped=e):new p(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=p),exports._=p):e._=p,p.VERSION="1.7.0";var f=function(r,o,e){if(void 0===o)return r;switch(null==e?3:e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,i){return r.call(o,e,t,i)};case 4:return function(e,t,i,n){return r.call(o,e,t,i,n)}}return function(){return r.apply(o,arguments)}};p.iteratee=function(e,t,i){return null==e?p.identity:p.isFunction(e)?f(e,t,i):p.isObject(e)?p.matches(e):p.property(e)},p.each=p.forEach=function(e,t,i){if(null==e)return e;t=f(t,i);var n,r=e.length;if(r===+r)for(n=0;n<r;n++)t(e[n],n,e);else{var o=p.keys(e);for(n=0,r=o.length;n<r;n++)t(e[o[n]],o[n],e)}return e},p.map=p.collect=function(e,t,i){if(null==e)return[];t=p.iteratee(t,i);for(var n,r=e.length!==+e.length&&p.keys(e),o=(r||e).length,s=Array(o),a=0;a<o;a++)n=r?r[a]:a,s[a]=t(e[n],n,e);return s};var g="Reduce of empty array with no initial value";p.reduce=p.foldl=p.inject=function(e,t,i,n){null==e&&(e=[]),t=f(t,n,4);var r,o=e.length!==+e.length&&p.keys(e),s=(o||e).length,a=0;if(arguments.length<3){if(!s)throw new TypeError(g);i=e[o?o[a++]:a++]}for(;a<s;a++)i=t(i,e[r=o?o[a]:a],r,e);return i},p.reduceRight=p.foldr=function(e,t,i,n){null==e&&(e=[]),t=f(t,n,4);var r,o=e.length!==+e.length&&p.keys(e),s=(o||e).length;if(arguments.length<3){if(!s)throw new TypeError(g);i=e[o?o[--s]:--s]}for(;s--;)i=t(i,e[r=o?o[s]:s],r,e);return i},p.find=p.detect=function(e,n,t){var r;return n=p.iteratee(n,t),p.some(e,function(e,t,i){return n(e,t,i)?(r=e,!0):void 0}),r},p.filter=p.select=function(e,n,t){var r=[];return null==e||(n=p.iteratee(n,t),p.each(e,function(e,t,i){n(e,t,i)&&r.push(e)})),r},p.reject=function(e,t,i){return p.filter(e,p.negate(p.iteratee(t)),i)},p.every=p.all=function(e,t,i){if(null==e)return!0;t=p.iteratee(t,i);var n,r,o=e.length!==+e.length&&p.keys(e),s=(o||e).length;for(n=0;n<s;n++)if(!t(e[r=o?o[n]:n],r,e))return!1;return!0},p.some=p.any=function(e,t,i){if(null==e)return!1;t=p.iteratee(t,i);var n,r,o=e.length!==+e.length&&p.keys(e),s=(o||e).length;for(n=0;n<s;n++)if(t(e[r=o?o[n]:n],r,e))return!0;return!1},p.contains=p.include=function(e,t){return null!=e&&(e.length!==+e.length&&(e=p.values(e)),0<=p.indexOf(e,t))},p.invoke=function(e,t){var i=u.call(arguments,2),n=p.isFunction(t);return p.map(e,function(e){return(n?t:e[t]).apply(e,i)})},p.pluck=function(e,t){return p.map(e,p.property(t))},p.where=function(e,t){return p.filter(e,p.matches(t))},p.findWhere=function(e,t){return p.find(e,p.matches(t))},p.max=function(e,n,t){var i,r,o=-1/0,s=-1/0;if(null==n&&null!=e)for(var a=0,l=(e=e.length===+e.length?e:p.values(e)).length;a<l;a++)i=e[a],o<i&&(o=i);else n=p.iteratee(n,t),p.each(e,function(e,t,i){r=n(e,t,i),(s<r||r===-1/0&&o===-1/0)&&(o=e,s=r)});return o},p.min=function(e,n,t){var i,r,o=1/0,s=1/0;if(null==n&&null!=e)for(var a=0,l=(e=e.length===+e.length?e:p.values(e)).length;a<l;a++)(i=e[a])<o&&(o=i);else n=p.iteratee(n,t),p.each(e,function(e,t,i){((r=n(e,t,i))<s||1/0===r&&1/0===o)&&(o=e,s=r)});return o},p.shuffle=function(e){for(var t,i=e&&e.length===+e.length?e:p.values(e),n=i.length,r=Array(n),o=0;o<n;o++)(t=p.random(0,o))!==o&&(r[o]=r[t]),r[t]=i[o];return r},p.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=p.values(e)),e[p.random(e.length-1)]):p.shuffle(e).slice(0,Math.max(0,t))},p.sortBy=function(e,n,t){return n=p.iteratee(n,t),p.pluck(p.map(e,function(e,t,i){return{value:e,index:t,criteria:n(e,t,i)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(n<i||void 0===i)return 1;if(i<n||void 0===n)return-1}return e.index-t.index}),"value")};var v=function(s){return function(n,r,e){var o={};return r=p.iteratee(r,e),p.each(n,function(e,t){var i=r(e,t,n);s(o,e,i)}),o}};p.groupBy=v(function(e,t,i){p.has(e,i)?e[i].push(t):e[i]=[t]}),p.indexBy=v(function(e,t,i){e[i]=t}),p.countBy=v(function(e,t,i){p.has(e,i)?e[i]++:e[i]=1}),p.sortedIndex=function(e,t,i,n){for(var r=(i=p.iteratee(i,n,1))(t),o=0,s=e.length;o<s;){var a=o+s>>>1;i(e[a])<r?o=a+1:s=a}return o},p.toArray=function(e){return e?p.isArray(e)?u.call(e):e.length===+e.length?p.map(e,p.identity):p.values(e):[]},p.size=function(e){return null==e?0:e.length===+e.length?e.length:p.keys(e).length},p.partition=function(e,n,t){n=p.iteratee(n,t);var r=[],o=[];return p.each(e,function(e,t,i){(n(e,t,i)?r:o).push(e)}),[r,o]},p.first=p.head=p.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:t<0?[]:u.call(e,0,t)},p.initial=function(e,t,i){return u.call(e,0,Math.max(0,e.length-(null==t||i?1:t)))},p.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},p.rest=p.tail=p.drop=function(e,t,i){return u.call(e,null==t||i?1:t)},p.compact=function(e){return p.filter(e,p.identity)};var m=function(e,t,i,n){if(t&&p.every(e,p.isArray))return c.apply(n,e);for(var r=0,o=e.length;r<o;r++){var s=e[r];p.isArray(s)||p.isArguments(s)?t?a.apply(n,s):m(s,t,i,n):i||n.push(s)}return n};p.flatten=function(e,t){return m(e,t,!1,[])},p.without=function(e){return p.difference(e,u.call(arguments,1))},p.uniq=p.unique=function(e,t,i,n){if(null==e)return[];p.isBoolean(t)||(n=i,i=t,t=!1),null!=i&&(i=p.iteratee(i,n));for(var r=[],o=[],s=0,a=e.length;s<a;s++){var l=e[s];if(t)s&&o===l||r.push(l),o=l;else if(i){var u=i(l,s,e);p.indexOf(o,u)<0&&(o.push(u),r.push(l))}else p.indexOf(r,l)<0&&r.push(l)}return r},p.union=function(){return p.uniq(m(arguments,!0,!0,[]))},p.intersection=function(e){if(null==e)return[];for(var t=[],i=arguments.length,n=0,r=e.length;n<r;n++){var o=e[n];if(!p.contains(t,o)){for(var s=1;s<i&&p.contains(arguments[s],o);s++);s===i&&t.push(o)}}return t},p.difference=function(e){var t=m(u.call(arguments,1),!0,!0,[]);return p.filter(e,function(e){return!p.contains(t,e)})},p.zip=function(e){if(null==e)return[];for(var t=p.max(arguments,"length").length,i=Array(t),n=0;n<t;n++)i[n]=p.pluck(arguments,n);return i},p.object=function(e,t){if(null==e)return{};for(var i={},n=0,r=e.length;n<r;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},p.indexOf=function(e,t,i){if(null==e)return-1;var n=0,r=e.length;if(i){if("number"!=typeof i)return e[n=p.sortedIndex(e,t)]===t?n:-1;n=i<0?Math.max(0,r+i):i}for(;n<r;n++)if(e[n]===t)return n;return-1},p.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=e.length;for("number"==typeof i&&(n=i<0?n+i+1:Math.min(n,i+1));0<=--n;)if(e[n]===t)return n;return-1},p.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=i||1;for(var n=Math.max(Math.ceil((t-e)/i),0),r=Array(n),o=0;o<n;o++,e+=i)r[o]=e;return r};var y=function(){};p.bind=function(i,n){var r,o;if(d&&i.bind===d)return d.apply(i,u.call(arguments,1));if(!p.isFunction(i))throw new TypeError("Bind must be called on a function");return r=u.call(arguments,2),o=function(){if(!(this instanceof o))return i.apply(n,r.concat(u.call(arguments)));y.prototype=i.prototype;var e=new y;y.prototype=null;var t=i.apply(e,r.concat(u.call(arguments)));return p.isObject(t)?t:e}},p.partial=function(r){var o=u.call(arguments,1);return function(){for(var e=0,t=o.slice(),i=0,n=t.length;i<n;i++)t[i]===p&&(t[i]=arguments[e++]);for(;e<arguments.length;)t.push(arguments[e++]);return r.apply(this,t)}},p.bindAll=function(e){var t,i,n=arguments.length;if(n<=1)throw new Error("bindAll must be passed function names");for(t=1;t<n;t++)e[i=arguments[t]]=p.bind(e[i],e);return e},p.memoize=function(n,r){var o=function(e){var t=o.cache,i=r?r.apply(this,arguments):e;return p.has(t,i)||(t[i]=n.apply(this,arguments)),t[i]};return o.cache={},o},p.delay=function(e,t){var i=u.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},p.defer=function(e){return p.delay.apply(p,[e,1].concat(u.call(arguments,1)))},p.throttle=function(i,n,r){var o,s,a,l=null,u=0;r||(r={});var c=function(){u=!1===r.leading?0:p.now(),l=null,a=i.apply(o,s),l||(o=s=null)};return function(){var e=p.now();u||!1!==r.leading||(u=e);var t=n-(e-u);return o=this,s=arguments,t<=0||n<t?(clearTimeout(l),l=null,u=e,a=i.apply(o,s),l||(o=s=null)):l||!1===r.trailing||(l=setTimeout(c,t)),a}},p.debounce=function(t,i,n){var r,o,s,a,l,u=function(){var e=p.now()-a;e<i&&0<e?r=setTimeout(u,i-e):(r=null,n||(l=t.apply(s,o),r||(s=o=null)))};return function(){s=this,o=arguments,a=p.now();var e=n&&!r;return r||(r=setTimeout(u,i)),e&&(l=t.apply(s,o),s=o=null),l}},p.wrap=function(e,t){return p.partial(t,e)},p.negate=function(e){return function(){return!e.apply(this,arguments)}},p.compose=function(){var i=arguments,n=i.length-1;return function(){for(var e=n,t=i[n].apply(this,arguments);e--;)t=i[e].call(this,t);return t}},p.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},p.before=function(e,t){var i;return function(){return 0<--e?i=t.apply(this,arguments):t=null,i}},p.once=p.partial(p.before,2),p.keys=function(e){if(!p.isObject(e))return[];if(l)return l(e);var t=[];for(var i in e)p.has(e,i)&&t.push(i);return t},p.values=function(e){for(var t=p.keys(e),i=t.length,n=Array(i),r=0;r<i;r++)n[r]=e[t[r]];return n},p.pairs=function(e){for(var t=p.keys(e),i=t.length,n=Array(i),r=0;r<i;r++)n[r]=[t[r],e[t[r]]];return n},p.invert=function(e){for(var t={},i=p.keys(e),n=0,r=i.length;n<r;n++)t[e[i[n]]]=i[n];return t},p.functions=p.methods=function(e){var t=[];for(var i in e)p.isFunction(e[i])&&t.push(i);return t.sort()},p.extend=function(e){if(!p.isObject(e))return e;for(var t,i,n=1,r=arguments.length;n<r;n++)for(i in t=arguments[n])o.call(t,i)&&(e[i]=t[i]);return e},p.pick=function(e,t,i){var n,r={};if(null==e)return r;if(p.isFunction(t))for(n in t=f(t,i),e){var o=e[n];t(o,n,e)&&(r[n]=o)}else{var s=c.apply([],u.call(arguments,1));e=new Object(e);for(var a=0,l=s.length;a<l;a++)(n=s[a])in e&&(r[n]=e[n])}return r},p.omit=function(e,t,i){if(p.isFunction(t))t=p.negate(t);else{var n=p.map(c.apply([],u.call(arguments,1)),String);t=function(e,t){return!p.contains(n,t)}}return p.pick(e,t,i)},p.defaults=function(e){if(!p.isObject(e))return e;for(var t=1,i=arguments.length;t<i;t++){var n=arguments[t];for(var r in n)void 0===e[r]&&(e[r]=n[r])}return e},p.clone=function(e){return p.isObject(e)?p.isArray(e)?e.slice():p.extend({},e):e},p.tap=function(e,t){return t(e),e};var b=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof p&&(e=e._wrapped),t instanceof p&&(t=t._wrapped);var r=h.call(e);if(r!==h.call(t))return!1;switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]===e)return n[o]===t;var s,a,l=e.constructor,u=t.constructor;if(l!==u&&"constructor"in e&&"constructor"in t&&!(p.isFunction(l)&&l instanceof l&&p.isFunction(u)&&u instanceof u))return!1;if(i.push(e),n.push(t),"[object Array]"===r){if(a=(s=e.length)===t.length)for(;s--&&(a=b(e[s],t[s],i,n)););}else{var c,d=p.keys(e);if(s=d.length,a=p.keys(t).length===s)for(;s--&&(c=d[s],a=p.has(t,c)&&b(e[c],t[c],i,n)););}return i.pop(),n.pop(),a};p.isEqual=function(e,t){return b(e,t,[],[])},p.isEmpty=function(e){if(null==e)return!0;if(p.isArray(e)||p.isString(e)||p.isArguments(e))return 0===e.length;for(var t in e)if(p.has(e,t))return!1;return!0},p.isElement=function(e){return!(!e||1!==e.nodeType)},p.isArray=s||function(e){return"[object Array]"===h.call(e)},p.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},p.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){p["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),p.isArguments(arguments)||(p.isArguments=function(e){return p.has(e,"callee")}),"function"!=typeof/./&&(p.isFunction=function(e){return"function"==typeof e||!1}),p.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},p.isNaN=function(e){return p.isNumber(e)&&e!==+e},p.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"===h.call(e)},p.isNull=function(e){return null===e},p.isUndefined=function(e){return void 0===e},p.has=function(e,t){return null!=e&&o.call(e,t)},p.noConflict=function(){return e._=t,this},p.identity=function(e){return e},p.constant=function(e){return function(){return e}},p.noop=function(){},p.property=function(t){return function(e){return e[t]}},p.matches=function(e){var r=p.pairs(e),o=r.length;return function(e){if(null==e)return!o;e=new Object(e);for(var t=0;t<o;t++){var i=r[t],n=i[0];if(i[1]!==e[n]||!(n in e))return!1}return!0}},p.times=function(e,t,i){var n=Array(Math.max(0,e));t=f(t,i,1);for(var r=0;r<e;r++)n[r]=t(r);return n},p.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},p.now=Date.now||function(){return(new Date).getTime()};var w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},x=p.invert(w),k=function(t){var i=function(e){return t[e]},e="(?:"+p.keys(t).join("|")+")",n=RegExp(e),r=RegExp(e,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(r,i):e}};p.escape=k(w),p.unescape=k(x),p.result=function(e,t){if(null!=e){var i=e[t];return p.isFunction(i)?e[t]():i}};var _=0;p.uniqueId=function(e){var t=++_+"";return e?e+t:t},p.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,C={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},E=/\\|'|\r|\n|\u2028|\u2029/g,T=function(e){return"\\"+C[e]};p.template=function(o,e,t){!e&&t&&(e=t),e=p.defaults({},e,p.templateSettings);var i=RegExp([(e.escape||F).source,(e.interpolate||F).source,(e.evaluate||F).source].join("|")+"|$","g"),s=0,a="__p+='";o.replace(i,function(e,t,i,n,r){return a+=o.slice(s,r).replace(E,T),s=r+e.length,t?a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":i?a+="'+\n((__t=("+i+"))==null?'':__t)+\n'":n&&(a+="';\n"+n+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var n=new Function(e.variable||"obj","_",a)}catch(e){throw e.source=a,e}var r=function(e){return n.call(this,e,p)},l=e.variable||"obj";return r.source="function("+l+"){\n"+a+"}",r},p.chain=function(e){var t=p(e);return t._chain=!0,t};var D=function(e){return this._chain?p(e).chain():e};p.mixin=function(i){p.each(p.functions(i),function(e){var t=p[e]=i[e];p.prototype[e]=function(){var e=[this._wrapped];return a.apply(e,arguments),D.call(this,t.apply(p,e))}})},p.mixin(p),p.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var i=n[t];p.prototype[t]=function(){var e=this._wrapped;return i.apply(e,arguments),"shift"!==t&&"splice"!==t||0!==e.length||delete e[0],D.call(this,e)}}),p.each(["concat","join","slice"],function(e){var t=n[e];p.prototype[e]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),p.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return p})}.call(this),function(n,r){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(e,t,i){n.Backbone=r(n,i,e,t)});else if("undefined"!=typeof exports){var e=require("underscore");r(n,exports,e)}else n.Backbone=r(n,{},n._,n.jQuery||n.Zepto||n.ender||n.$)}(this,function(e,a,k,t){var i=e.Backbone,n=[],r=n.slice;a.VERSION="1.1.2",a.$=t,a.noConflict=function(){return e.Backbone=i,this},a.emulateHTTP=!1,a.emulateJSON=!1;var o=a.Events={on:function(e,t,i){return d(this,"on",e,[t,i])&&t&&(this._events||(this._events={}),(this._events[e]||(this._events[e]=[])).push({callback:t,context:i,ctx:i||this})),this},once:function(e,t,i){if(!d(this,"once",e,[t,i])||!t)return this;var n=this,r=k.once(function(){n.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,i)},off:function(e,t,i){var n,r,o,s,a,l,u,c;if(!this._events||!d(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(a=0,l=(s=e?[e]:k.keys(this._events)).length;a<l;a++)if(e=s[a],o=this._events[e]){if(this._events[e]=n=[],t||i)for(u=0,c=o.length;u<c;u++)r=o[u],(t&&t!==r.callback&&t!==r.callback._callback||i&&i!==r.context)&&n.push(r);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!d(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&s(i,t),n&&s(n,arguments),this},stopListening:function(e,t,i){var n=this._listeningTo;if(!n)return this;var r=!t&&!i;for(var o in i||"object"!=typeof t||(i=this),e&&((n={})[e._listenId]=e),n)(e=n[o]).off(t,i,this),(r||k.isEmpty(e._events))&&delete this._listeningTo[o];return this}},l=/\s+/,d=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var r in i)e[t].apply(e,[r,i[r]].concat(n));return!1}if(l.test(i)){for(var o=i.split(l),s=0,a=o.length;s<a;s++)e[t].apply(e,[o[s]].concat(n));return!1}return!0},s=function(e,t){var i,n=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,o,s,a);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t);return}};k.each({listenTo:"on",listenToOnce:"once"},function(r,e){o[e]=function(e,t,i){var n=this._listeningTo||(this._listeningTo={});return i||"object"!=typeof t||(i=this),(n[e._listenId||(e._listenId=k.uniqueId("l"))]=e)[r](t,i,this),this}}),o.bind=o.on,o.unbind=o.off,k.extend(a,o);var _=a.Model=function(e,t){var i=e||{};t||(t={}),this.cid=k.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=k.defaults({},i,k.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};k.extend(_.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return k.clone(this.attributes)},sync:function(){return a.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return k.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var n,r,o,s,a,l,u,c;if(null==e)return this;if("object"==typeof e?(r=e,i=t):(r={})[e]=t,i||(i={}),!this._validate(r,i))return!1;for(n in o=i.unset,a=i.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=k.clone(this.attributes),this.changed={}),c=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]),r)t=r[n],k.isEqual(c[n],t)||s.push(n),k.isEqual(u[n],t)?delete this.changed[n]:this.changed[n]=t,o?delete c[n]:c[n]=t;if(!a){s.length&&(this._pending=i);for(var d=0,h=s.length;d<h;d++)this.trigger("change:"+s[d],this,c[s[d]],i)}if(l)return this;if(!a)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,k.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,k.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!k.isEmpty(this.changed):k.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&k.clone(this.changed);var t,i=!1,n=this._changing?this._previousAttributes:this.attributes;for(var r in e)k.isEqual(n[r],t=e[r])||((i||(i={}))[r]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return k.clone(this._previousAttributes)},fetch:function(t){void 0===(t=t?k.clone(t):{}).parse&&(t.parse=!0);var i=this,n=t.success;return t.success=function(e){if(!i.set(i.parse(e,t),t))return!1;n&&n(i,e,t),i.trigger("sync",i,e,t)},I(this,t),this.sync("read",this,t)},save:function(e,t,i){var n,r,o,s=this.attributes;if(null==e||"object"==typeof e?(n=e,i=t):(n={})[e]=t,i=k.extend({validate:!0},i),n&&!i.wait){if(!this.set(n,i))return!1}else if(!this._validate(n,i))return!1;n&&i.wait&&(this.attributes=k.extend({},s,n)),void 0===i.parse&&(i.parse=!0);var a=this,l=i.success;return i.success=function(e){a.attributes=s;var t=a.parse(e,i);if(i.wait&&(t=k.extend(n||{},t)),k.isObject(t)&&!a.set(t,i))return!1;l&&l(a,e,i),a.trigger("sync",a,e,i)},I(this,i),"patch"===(r=this.isNew()?"create":i.patch?"patch":"update")&&(i.attrs=n),o=this.sync(r,this,i),n&&i.wait&&(this.attributes=s),o},destroy:function(t){t=t?k.clone(t):{};var i=this,n=t.success,r=function(){i.trigger("destroy",i,i.collection,t)};if(t.success=function(e){(t.wait||i.isNew())&&r(),n&&n(i,e,t),i.isNew()||i.trigger("sync",i,e,t)},this.isNew())return t.success(),!1;I(this,t);var e=this.sync("delete",this,t);return t.wait||r(),e},url:function(){var e=k.result(this,"urlRoot")||k.result(this.collection,"url")||j();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},k.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=k.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return!i||(this.trigger("invalid",this,i,k.extend(t,{validationError:i})),!1)}});k.each(["keys","values","pairs","invert","pick","omit"],function(t){_.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.attributes),k[t].apply(k,e)}});var u=a.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,k.extend({silent:!0},t))},F={add:!0,remove:!0,merge:!0},c={add:!0,remove:!1};k.extend(u.prototype,o,{model:_,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return a.sync.apply(this,arguments)},add:function(e,t){return this.set(e,k.extend({merge:!1},t,c))},remove:function(e,t){var i,n,r,o,s=!k.isArray(e);for(t||(t={}),i=0,n=(e=s?[e]:k.clone(e)).length;i<n;i++)(o=e[i]=this.get(e[i]))&&(delete this._byId[o.id],delete this._byId[o.cid],r=this.indexOf(o),this.models.splice(r,1),this.length--,t.silent||(t.index=r,o.trigger("remove",o,this,t)),this._removeReference(o,t));return s?e[0]:e},set:function(e,t){(t=k.defaults({},t,F)).parse&&(e=this.parse(e,t));var i,n,r,o,s,a,l,u=!k.isArray(e);e=u?e?[e]:[]:k.clone(e);var c=t.at,d=this.model,h=this.comparator&&null==c&&!1!==t.sort,p=k.isString(this.comparator)?this.comparator:null,f=[],g=[],v={},m=t.add,y=t.merge,b=t.remove,w=!(h||!m||!b)&&[];for(i=0,n=e.length;i<n;i++){if(r=(s=e[i]||{})instanceof _?o=s:s[d.prototype.idAttribute||"id"],a=this.get(r))b&&(v[a.cid]=!0),y&&(s=s===o?o.attributes:s,t.parse&&(s=a.parse(s,t)),a.set(s,t),h&&!l&&a.hasChanged(p)&&(l=!0)),e[i]=a;else if(m){if(!(o=e[i]=this._prepareModel(s,t)))continue;f.push(o),this._addReference(o,t)}o=a||o,!w||!o.isNew()&&v[o.id]||w.push(o),v[o.id]=!0}if(b){for(i=0,n=this.length;i<n;++i)v[(o=this.models[i]).cid]||g.push(o);g.length&&this.remove(g,t)}if(f.length||w&&w.length)if(h&&(l=!0),this.length+=f.length,null!=c)for(i=0,n=f.length;i<n;i++)this.models.splice(c+i,0,f[i]);else{w&&(this.models.length=0);var x=w||f;for(i=0,n=x.length;i<n;i++)this.models.push(x[i])}if(l&&this.sort({silent:!0}),!t.silent){for(i=0,n=f.length;i<n;i++)(o=f[i]).trigger("add",o,this,t);(l||w&&w.length)&&this.trigger("sort",this,t)}return u?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,n=this.models.length;i<n;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,k.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,k.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,k.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(i,e){return k.isEmpty(i)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var t in i)if(i[t]!==e.get(t))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),k.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(k.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return k.invoke(this.models,"get",e)},fetch:function(i){void 0===(i=i?k.clone(i):{}).parse&&(i.parse=!0);var n=i.success,r=this;return i.success=function(e){var t=i.reset?"reset":"set";r[t](e,i),n&&n(r,e,i),r.trigger("sync",r,e,i)},I(this,i),this.sync("read",this,i)},create:function(e,i){if(i=i?k.clone(i):{},!(e=this._prepareModel(e,i)))return!1;i.wait||this.add(e,i);var n=this,r=i.success;return i.success=function(e,t){i.wait&&n.add(e,i),r&&r(e,t,i)},e.save(null,i),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof _)return e;var i=new(((t=t?k.clone(t):{}).collection=this).model)(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e,t){null!=(this._byId[e.cid]=e).id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});k.each(["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"],function(t){u.prototype[t]=function(){var e=r.call(arguments);return e.unshift(this.models),k[t].apply(k,e)}});k.each(["groupBy","countBy","sortBy","indexBy"],function(n){u.prototype[n]=function(t,e){var i=k.isFunction(t)?t:function(e){return e.get(t)};return k[n](this.models,i,e)}});var h=a.View=function(e){this.cid=k.uniqueId("view"),e||(e={}),k.extend(this,k.pick(e,f)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},p=/^(\S+)\s*(.*)$/,f=["model","collection","el","id","attributes","className","tagName","events"];k.extend(h.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof a.$?e:a.$(e),this.el=this.$el[0],!1!==t&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=k.result(this,"events")))return this;for(var t in this.undelegateEvents(),e){var i=e[t];if(k.isFunction(i)||(i=this[e[t]]),i){var n=t.match(p),r=n[1],o=n[2];i=k.bind(i,this),r+=".delegateEvents"+this.cid,""===o?this.$el.on(r,i):this.$el.on(r,o,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(k.result(this,"el"),!1);else{var e=k.extend({},k.result(this,"attributes"));this.id&&(e.id=k.result(this,"id")),this.className&&(e.class=k.result(this,"className"));var t=a.$("<"+k.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}}}),a.sync=function(e,t,i){var n=v[e];k.defaults(i||(i={}),{emulateHTTP:a.emulateHTTP,emulateJSON:a.emulateJSON});var r={type:n,dataType:"json"};if(i.url||(r.url=k.result(t,"url")||j()),null!=i.data||!t||"create"!==e&&"update"!==e&&"patch"!==e||(r.contentType="application/json",r.data=JSON.stringify(i.attrs||t.toJSON(i))),i.emulateJSON&&(r.contentType="application/x-www-form-urlencoded",r.data=r.data?{model:r.data}:{}),i.emulateHTTP&&("PUT"===n||"DELETE"===n||"PATCH"===n)){r.type="POST",i.emulateJSON&&(r.data._method=n);var o=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",n),o)return o.apply(this,arguments)}}"GET"===r.type||i.emulateJSON||(r.processData=!1),"PATCH"===r.type&&g&&(r.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var s=i.xhr=a.ajax(k.extend(r,i));return t.trigger("request",t,s,i),s};var g=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),v={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};a.ajax=function(){return a.$.ajax.apply(a.$,arguments)};var m=a.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,b=/(\(\?)?:\w+/g,w=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;k.extend(m.prototype,o,{initialize:function(){},route:function(i,n,r){k.isRegExp(i)||(i=this._routeToRegExp(i)),k.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var o=this;return a.history.route(i,function(e){var t=o._extractParameters(i,e);o.execute(r,t),o.trigger.apply(o,["route:"+n].concat(t)),o.trigger("route",n,t),a.history.trigger("route",o,n,t)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,t){return a.history.navigate(e,t),this},_bindRoutes:function(){if(this.routes){this.routes=k.result(this,"routes");for(var e,t=k.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(x,"\\$&").replace(y,"(?:$1)?").replace(b,function(e,t){return t?e:"([^/?]+)"}).replace(w,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return k.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var C=a.History=function(){this.handlers=[],k.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,T=/^\/+|\/+$/g,D=/msie [\w.]+/,S=/\/$/,R=/#.*$/;C.started=!1,k.extend(C.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(S,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(E,"")},start:function(e){if(C.started)throw new Error("Backbone.history has already been started");C.started=!0,this.options=k.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),i=document.documentMode,n=D.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);if(this.root=("/"+this.root+"/").replace(T,"/"),n&&this._wantsHashChange){var r=a.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=r.hide().appendTo("body")[0].contentWindow,this.navigate(t)}this._hasPushState?a.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!n?a.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}if(!this.options.silent)return this.loadUrl()},stop:function(){a.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),C.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(t){return t=this.fragment=this.getFragment(t),k.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0})},navigate:function(e,t){if(!C.started)return!1;t&&!0!==t||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(R,""),this.fragment!==e){if(""===(this.fragment=e)&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),a.history=new C;_.extend=u.extend=m.extend=h.extend=C.extend=function(e,t){var i,n=this;i=e&&k.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},k.extend(i,n,t);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,e&&k.extend(i.prototype,e),i.__super__=n.prototype,i};var j=function(){throw new Error('A "url" property or function must be specified')},I=function(t,i){var n=i.error;i.error=function(e){n&&n(t,e,i),t.trigger("error",t,e,i)}};return a}),function(g){var i,t;i="http://www.w3.org/2001/XMLSchema#double",t={isIRI:function(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return"string"==typeof e&&'"'===e[0]},isBlank:function(e){return"string"==typeof e&&"_:"===e.substr(0,2)},isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return"string"==typeof e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var i,n,r,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[i=o[1]],r=o.index),void 0===n?e:0===r?n+e.substr(i.length+1):e.substr(0,r+3)+n+e.substr(r+i.length+4)},createIRI:function(e){return e&&'"'===e[0]?t.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":isFinite(e)?t=e%1==0?"http://www.w3.org/2001/XMLSchema#integer":i:(t=i,isNaN(e)||(e=0<e?"INF":"-INF"));break;default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return t.prefixes({"":e})("")},prefixes:function(e){var n=Object.create(null);for(var t in e)i(t,e[t]);function i(e,t){if(t||!(e in n)){var i=Object.create(null);t=t||"",n[e]=function(e){return i[e]||(i[e]=t+e)}}return n[e]}return i}},g.Util=t,function(){var s=String.fromCharCode,o="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},t=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,a={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},m=/[\x00-\x20<>\\"\{\}\|\^\`]/;function i(e){if(!(this instanceof i))return new i(e);if((e=e||{}).lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var n=this;this._tokenize=this.tokenize,this.tokenize=function(e,i){this._tokenize(e,function(e,t){!e&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(t.type)?i&&i(e,t):i&&i(e||n._syntaxError(t.type,i=null))})}}this._n3Mode=!1!==e.n3,this._comments=!!e.comments}i.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(t,e){for(var i=this._input,n=this._comments;;){for(var r,o;r=this._newline.exec(i);)n&&(o=this._comment.exec(r[0]))&&t(null,{line:this._line,type:"comment",value:o[1],prefix:""}),i=i.substr(r[0].length,i.length),this._line++;if((r=this._whitespace.exec(i))&&(i=i.substr(r[0].length,i.length)),this._endOfFile.test(i))return e&&(n&&(o=this._comment.exec(i))&&t(null,{line:this._line,type:"comment",value:o[1],prefix:""}),t(i=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=i;var s,a=this._line,l="",u="",c="",d=i[0],h=null,p=0,f=!1;switch(d){case"^":if(i.length<3)break;if("^"!==i[1]){this._n3Mode&&(p=1,l="^");break}if(this._previousMarker="^^","<"!==(i=i.substr(2))[0]){f=!0;break}case"<":if(h=this._unescapedIri.exec(i))l="IRI",u=h[1];else if(h=this._iri.exec(i)){if(null===(s=this._unescape(h[1]))||m.test(s))return v(this);l="IRI",u=s}else this._n3Mode&&1<i.length&&"="===i[1]&&(l="inverse",p=2,u="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((h=this._blank.exec(i))||e&&(h=this._blank.exec(i+" ")))&&(l="blank",c="_",u=h[1]);break;case'"':case"'":if(h=this._unescapedString.exec(i))l="literal",u=h[0];else if(h=this._singleQuotedString.exec(i)){if(null===(s=this._unescape(h[0])))return v(this);l="literal",u=s.replace(/^'|'$/g,'"')}else if(h=this._tripleQuotedString.exec(i)){if(s=h[1]||h[2],this._line+=s.split(/\r\n|\r|\n/).length-1,null===(s=this._unescape(s)))return v(this);l="literal",u=s.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(h=this._variable.exec(i))&&(l="var",u=h[0]);break;case"@":"literal"===this._previousMarker&&(h=this._langcode.exec(i))?(l="langcode",u=h[1]):(h=this._keyword.exec(i))&&(l=h[0]);break;case".":if(1===i.length?e:i[1]<"0"||"9"<i[1]){l=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(h=this._number.exec(i)||e&&(h=this._number.exec(i+" ")))&&(l="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(h[1]?"double":/^[+\-]?\d+$/.test(h[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(h=this._sparqlKeyword.exec(i))?l=h[0].toUpperCase():f=!0;break;case"f":case"t":(h=this._boolean.exec(i))?(l="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):f=!0;break;case"a":(h=this._shortPredicates.exec(i))?(l="abbreviation",u="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):f=!0;break;case"=":this._n3Mode&&1<i.length&&(l="abbreviation",u=">"!==i[1]?(p=1,"http://www.w3.org/2002/07/owl#sameAs"):(p=2,"http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":p=1,l=d;break;default:f=!0}if(f&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(h=this._prefix.exec(i))?((h=this._prefixed.exec(i))||e&&(h=this._prefixed.exec(i+" ")))&&(l="prefixed",c=h[1]||"",u=this._unescape(h[2])):(l="prefix",u=h[1]||"")),"^^"===this._previousMarker)switch(l){case"prefixed":l="type";break;case"IRI":l="typeIRI";break;default:l=""}if(!l)return e||!/^'''|^"""/.test(i)&&/\n|\r/.test(i)?v(this):this._input=i;var g={line:a,type:l,value:u,prefix:c};t(null,g),this.previousToken=g,this._previousMarker=l,i=i.substr(p||h[0].length,i.length)}function v(e){t(e._syntaxError(/^\S*/.exec(i)[0]))}},_unescape:function(e){try{return e.replace(t,function(e,t,i,n){var r;if(t){if(r=parseInt(t,16),isNaN(r))throw new Error;return s(r)}if(i){if(r=parseInt(i,16),isNaN(r))throw new Error;return r<=65535?s(r):s(55296+(r-=65536)/1024,56320+(1023&r))}var o=a[n];if(!o)throw new Error;return o})}catch(e){return null}},_syntaxError:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t},tokenize:function(e,t){var i=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var n,r=[];if(this._tokenizeToEnd(function(e,t){e?n=e:r.push(t)},!0),n)throw n;return r}o(function(){i._tokenizeToEnd(t,!0)})}else this._input="","function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",function(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}),e.on("end",function(){null!==i._input&&i._tokenizeToEnd(t,!0)}),e.on("error",t)}},g.Lexer=i}(),function(){var l=g.Lexer,e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",u=e+"nil",c=e+"first",d=e+"rest",i="urn:n3:quantifiers",r=/^[a-z][a-z0-9+.-]*:/i,n=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,a=/(?:^|\/)\.\.?(?:$|[\/#?])/,s=0,h=0;function p(e){if(!(this instanceof p))return new p(e);this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",i="turtle"===t,n="trig"===t,r=/triple/.test(t),o=/quad/.test(t),s=this._n3Mode=/n3/.test(t),a=r||o;(this._supportsNamedGraphs=!(i||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(i||n||r||s),a&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=f,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new l({lineMode:a,n3:s}),this._explicitQuantifiers=!!e.explicitQuantifiers}function f(){}p._resetBlankNodeIds=function(){s=h=0},p.prototype={_setBase:function(e){if(e){var t=e.indexOf("#");0<=t&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(n),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base=null},_saveContext:function(e,t,i,n,r){var o=this._n3Mode;this._contextStack.push({subject:i,predicate:n,object:r,graph:t,type:e,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph+".",this._quantified=Object.create(this._quantified))},_restoreContext:function(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readEntity:function(e,t){var i;switch(e.type){case"IRI":case"typeIRI":i=null===this._base||r.test(e.value)?e.value:this._resolveIRI(e);break;case"type":case"blank":case"prefixed":var n=this._prefixes[e.prefix];if(void 0===n)return this._error('Undefined prefix "'+e.prefix+':"',e);i=n+e.value;break;case"var":return e.value;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&i in this._quantified&&(i=this._quantified[i]),i},_readSubject:function(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject="_:b"+h++,null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,u,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph="_:b"+h++,null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forSome",this._quantifiedPrefix="_:b",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate="http://www.w3.org/2000/10/swap/reify#forAll",this._quantifiedPrefix="?b-",this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject},_readObject:function(e){switch(e.type){case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject="_:b"+h++),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,u),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph="_:b"+h++),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()},_readPredicateAfterBlank:function(e){return"."!==e.type||this._contextStack.length?this._readPredicate(e):(this._subject=null,this._readPunctuation(e))},_readListItem:function(e){var t=null,i=null,n=this._subject,r=this._contextStack,o=r[r.length-1],s=this._readListItem,a=!0;switch(e.type){case"[":this._saveContext("blank",this._graph,i="_:b"+h++,c,this._subject=t="_:b"+h++),s=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,i="_:b"+h++,c,u),this._subject=null;break;case")":if(this._restoreContext(),0!==r.length&&"list"===r[r.length-1].type&&this._triple(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(s=this._readPredicate,this._subject===u)return s}else if(s=this._getContextEndReader(),this._object===u)return s;i=u;break;case"literal":t=e.value,a=!1,s=this._readListItemDataTypeOrLang;break;default:if(void 0===(t=this._readEntity(e)))return}if(null===i&&(this._subject=i="_:b"+h++),null===n?null===o.predicate?o.subject=i:o.object=i:this._triple(n,d,i,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,i,c,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);a?this._triple(i,c,t,this._graph):this._object=t}return s},_readDataTypeOrLang:function(e){return this._completeLiteral(e,!1)},_readListItemDataTypeOrLang:function(e){return this._completeLiteral(e,!0)},_completeLiteral:function(e,t){var i=!1;switch(e.type){case"type":case"typeIRI":var n=this._readEntity(e);if(void 0===n)return;i=!0,this._object+="^^"+n;break;case"langcode":i=!0,this._object+="@"+e.value.toLowerCase()}return t&&this._triple(this._subject,c,this._object,this._graph),i?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))},_readFormulaTail:function(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._triple(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())},_readPunctuation:function(e){var t,i=this._subject,n=this._graph,r=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,r&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object+'"',e)}if(null!==i){var o=this._predicate,s=this._object;r?this._triple(s,o,i,n):this._triple(i,o,s,n)}return t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._triple(this._subject,this._predicate,this._object,this._graph),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation},_readBaseIRI:function(e){return"IRI"!==e.type?this._error("Expected IRI to follow base declaration",e):(this._setBase(null===this._base||r.test(e.value)?e.value:this._resolveIRI(e)),this._readDeclarationPunctuation)},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+h++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_readQuantifierList:function(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._triple(this._graph||"",this._predicate,this._subject="_:b"+h++,i):this._triple(this._subject,d,this._subject="_:b"+h++,i),this._triple(this._subject,c,t,i)):this._quantified[t]=this._quantifiedPrefix+h++,this._readQuantifierPunctuation},_readQuantifierPunctuation:function(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._triple(this._subject,d,u,i),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))},_getPathReader:function(e){return this._afterPath=e,this._readPath},_readPath:function(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,i=t.length&&t[t.length-1];if(i&&"item"===i.type){var n=this._subject;this._restoreContext(),this._triple(this._subject,c,n,this._graph)}return this._afterPath(e)}},_readForwardPath:function(e){var t,i,n="_:b"+h++;if(void 0!==(i=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._triple(t,i,n,this._graph),this._readPath},_readBackwardPath:function(e){var t,i,n="_:b"+h++;if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(i=this._subject,this._subject=n):(i=this._object,this._object=n),this._triple(n,t,i,this._graph),this._readPath},_getContextEndReader:function(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}},_triple:function(e,t,i,n){this._callback(null,{subject:e,predicate:t,object:i,graph:n||""})},_error:function(e,t){var i=new Error(e+" on line "+t.line+".");i.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(i),this._callback=f},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!a.test(e))return e;for(var t="",i=e.length,n=-1,r=-1,o=0,s="/";n<i;){switch(s){case":":if(r<0&&"/"===e[++n]&&"/"===e[++n])for(;(r=n+1)<i&&"/"!==e[r];)n=r;break;case"?":case"#":n=i;break;case"/":if("."===e[n+1])switch(s=e[++n+1]){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(s=e[++n+1])||"/"===s||"?"===s||"#"===s){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=r&&(t=t.substr(0,o)),"/"!==s)return t+"/"+e.substr(n+1);o=n+1}}}s=e[++n]}return t+e.substring(o)},parse:function(e,t,i){var n=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+s+++"_",this._prefixCallback=i||f,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var r,o=[];if(this._callback=function(e,t){e?r=e:t&&o.push(t)},this._lexer.tokenize(e).every(function(e){return n._readCallback=n._readCallback(e)}),r)throw r;return o}this._callback=t,this._lexer.tokenize(e,function(e,t){null!==e?(n._callback(e),n._callback=f):n._readCallback&&(n._readCallback=n._readCallback(t))})}},g.Parser=p}(),function(){var i=/^"([^]*)"(?:\^\^(.+)|@([a-z]+(?:-[a-z0-9]+)*))?$/i,n=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,r=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,o={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function s(e,t){if(!(this instanceof s))return new s(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var n="";this._outputStream={write:function(e,t,i){n+=e,i&&i()},end:function(e){e&&e(null,n)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function a(e){var t=o[e];return void 0===t&&(t=1===e.length?(t=e.charCodeAt(0).toString(16),"\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),"\\U00000000".substr(0,10-t.length)+t)),t}s.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,i,n,r){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(i),r):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),r):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),r)}catch(e){r&&r(e)}},_writeTripleLine:function(e,t,i,n,r){delete this._prefixMatch;try{this._write(this.tripleToString(e,t,i,n),r)}catch(e){r&&r(e)}},tripleToString:function(e,t,i,n){return this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(i)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n")},triplesToString:function(e){return e.map(function(e){return this.tripleToString(e.subject,e.predicate,e.object,e.graph)},this).join("")},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;n.test(e)&&(e=e.replace(r,a));var i=this._prefixRegex.exec(e);return i?i[1]?this._prefixIRIs[i[1]]+i[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,i){return n.test(e)&&(e=e.replace(r,a)),i?'"'+e+'"@'+i:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=i.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,i,n,r){void 0===i?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,i,"",n):this._writeTriple(e,t,i,n,r)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,i){var n={};n[e]=t,this.addPrefixes(n,i)},addPrefixes:function(e,t){var i=this._prefixIRIs,n=!1;for(var r in e){var o=e[r];/[#\/]$/.test(o)&&i[o]!==(r+=":")&&(n=!0,i[o]=r,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+r+" <"+o+">.\n"))}if(n){var s="",a="";for(var l in i)s+=s?"|"+l:l,a+=(a?"|":"")+i[l];s=s.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+a+")[^/]*$|^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)},blank:function(e,t){var i,n,r=e;switch(void 0===e?r=[]:"string"==typeof e?r=[{predicate:e,object:t}]:"length"in e||(r=[e]),n=r.length){case 0:return"[]";case 1:if("["!==(i=r[0]).object[0])return"[ "+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object)+" ]";default:for(var o="[",s=0;s<n;s++)(i=r[s]).predicate===e?o+=", "+this._encodeObject(i.object):(o+=(s?";\n  ":"\n  ")+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object),e=i.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,i=new Array(t),n=0;n<t;n++)i[n]=this._encodeObject(e[n]);return"("+i.join(" ")+")"},_prefixRegex:/$0^/,end:function(i){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var n=i&&function(e,t){n=null,i(e,t)};if(this._endStream)try{return this._outputStream.end(n)}catch(e){}n&&n()}},g.Writer=s}(),function(){var s=g.Util.expandPrefixedName;function i(e,t){if(!(this instanceof i))return new i(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),e&&this.addTriples(e)}function h(e){return"string"==typeof e||e instanceof String}i.prototype={get size(){var e=this._size;if(null!==e)return e;e=0;var t,i,n=this._graphs;for(var r in n)for(var o in t=n[r].subjects)for(var s in i=t[o])e+=Object.keys(i[s]).length;return this._size=e},_addToIndex:function(e,t,i,n){var r=e[t]||(e[t]={}),o=r[i]||(r[i]={}),s=n in o;return s||(o[n]=null),!s},_removeFromIndex:function(e,t,i,n){var r,o=e[t],s=o[i];for(r in delete s[n],s)return;for(r in delete o[i],o)return;delete e[t]},_findInIndex:function(e,t,i,n,r,o,s,a,l,u){var c,d,h,p=1<!t+!i+!n?Object.keys(this._ids):this._entities;for(var f in t&&((c=e,e={})[t]=c[t]),e){var g=p[f];if(d=e[f])for(var v in i&&((c=d,d={})[i]=c[i]),d){var m=p[v];if(h=d[v])for(var y=(n?n in h?[n]:[]:Object.keys(h)),b=y.length-1;0<=b;b--){var w={subject:"",predicate:"",object:"",graph:a};if(w[r]=g,w[o]=m,w[s]=p[y[b]],u)u.push(w);else if(l(w))return!0}}}return u},_loop:function(e,t){for(var i in e)t(i)},_loopByKey0:function(e,t,i){var n,r;if(n=e[t])for(r in n)i(r)},_loopByKey1:function(e,t,i){var n;for(n in e)e[n][t]&&i(n)},_loopBy2Keys:function(e,t,i,n){var r,o,s;if((r=e[t])&&(o=r[i]))for(s in o)n(s)},_countInIndex:function(e,t,i,n){var r,o,s,a=0;for(var l in t&&((r=e,e={})[t]=r[t]),e)if(o=e[l])for(var u in i&&((r=o,o={})[i]=r[i]),o)(s=o[u])&&(n?n in s&&a++:a+=Object.keys(s).length);return a},_getGraphs:function(e){if(!h(e))return this._graphs;var t={};return t[e]=this._graphs[e],t},_uniqueEntities:function(t){var i=Object.create(null),n=this._entities;return function(e){e in i||(i[e]=!0,t(n[e]))}},addTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||"";var r=this._graphs[n];r||(r=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(r));var o=this._ids,s=this._entities;e=o[e]||(o[s[++this._id]=e]=this._id),t=o[t]||(o[s[++this._id]=t]=this._id),i=o[i]||(o[s[++this._id]=i]=this._id);var a=this._addToIndex(r.subjects,e,t,i);return this._addToIndex(r.predicates,t,i,e),this._addToIndex(r.objects,i,e,t),this._size=null,a},addTriples:function(e){for(var t=e.length-1;0<=t;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||"";var r,o,s,a=this._ids,l=this._graphs;if(!((e=a[e])&&(t=a[t])&&(i=a[i])&&(r=l[n])&&(o=r.subjects[e])&&(s=o[t])&&i in s))return!1;for(e in this._removeFromIndex(r.subjects,e,t,i),this._removeFromIndex(r.predicates,t,i,e),this._removeFromIndex(r.objects,i,e,t),null!==this._size&&this._size--,r.subjects)return!0;return delete l[n],!0},removeTriples:function(e){for(var t=e.length-1;0<=t;t--)this.removeTriple(e[t])},getTriples:function(e,t,i,n){var r=this._prefixes;return this.getTriplesByIRI(s(e,r),s(t,r),s(i,r),s(n,r))},getTriplesByIRI:function(e,t,i,n){var r,o,s,a,l=[],u=this._getGraphs(n),c=this._ids;if(h(e)&&!(o=c[e])||h(t)&&!(s=c[t])||h(i)&&!(a=c[i]))return l;for(var d in u)(r=u[d])&&(o?a?this._findInIndex(r.objects,a,o,s,"object","subject","predicate",d,null,l):this._findInIndex(r.subjects,o,s,null,"subject","predicate","object",d,null,l):s?this._findInIndex(r.predicates,s,a,null,"predicate","object","subject",d,null,l):a?this._findInIndex(r.objects,a,null,null,"object","subject","predicate",d,null,l):this._findInIndex(r.subjects,null,null,null,"subject","predicate","object",d,null,l));return l},countTriples:function(e,t,i,n){var r=this._prefixes;return this.countTriplesByIRI(s(e,r),s(t,r),s(i,r),s(n,r))},countTriplesByIRI:function(e,t,i,n){var r,o,s,a,l=0,u=this._getGraphs(n),c=this._ids;if(h(e)&&!(o=c[e])||h(t)&&!(s=c[t])||h(i)&&!(a=c[i]))return 0;for(var d in u)(r=u[d])&&(l+=e?i?this._countInIndex(r.objects,a,o,s):this._countInIndex(r.subjects,o,s,a):t?this._countInIndex(r.predicates,s,a,o):this._countInIndex(r.objects,a,o,s));return l},forEach:function(e,t,i,n,r){var o=this._prefixes;this.forEachByIRI(e,s(t,o),s(i,o),s(n,o),s(r,o))},forEachByIRI:function(t,e,i,n,r){this.someByIRI(function(e){return t(e),!1},e,i,n,r)},every:function(e,t,i,n,r){var o=this._prefixes;return this.everyByIRI(e,s(t,o),s(i,o),s(n,o),s(r,o))},everyByIRI:function(t,e,i,n,r){var o=!1,s=!this.someByIRI(function(e){return o=!0,!t(e)},e,i,n,r);return o&&s},some:function(e,t,i,n,r){var o=this._prefixes;return this.someByIRI(e,s(t,o),s(i,o),s(n,o),s(r,o))},someByIRI:function(e,t,i,n,r){var o,s,a,l,u=this._getGraphs(r),c=this._ids;if(h(t)&&!(s=c[t])||h(i)&&!(a=c[i])||h(n)&&!(l=c[n]))return!1;for(var d in u)if(o=u[d])if(s){if(l){if(this._findInIndex(o.objects,l,s,a,"object","subject","predicate",d,e,null))return!0}else if(this._findInIndex(o.subjects,s,a,null,"subject","predicate","object",d,e,null))return!0}else if(a){if(this._findInIndex(o.predicates,a,l,null,"predicate","object","subject",d,e,null))return!0}else if(l){if(this._findInIndex(o.objects,l,null,null,"object","subject","predicate",d,e,null))return!0}else if(this._findInIndex(o.subjects,null,null,null,"subject","predicate","object",d,e,null))return!0;return!1},getSubjects:function(e,t,i){var n=this._prefixes;return this.getSubjectsByIRI(s(e,n),s(t,n),s(i,n))},getSubjectsByIRI:function(e,t,i){var n=[];return this.forSubjectsByIRI(function(e){n.push(e)},e,t,i),n},forSubjects:function(e,t,i,n){var r=this._prefixes;this.forSubjectsByIRI(e,s(t,r),s(i,r),s(n,r))},forSubjectsByIRI:function(e,t,i,n){var r,o,s,a=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(h(t)&&!(o=a[t])||h(i)&&!(s=a[i])))for(n in l)(r=l[n])&&(o?s?this._loopBy2Keys(r.predicates,o,s,e):this._loopByKey1(r.subjects,o,e):s?this._loopByKey0(r.objects,s,e):this._loop(r.subjects,e))},getPredicates:function(e,t,i){var n=this._prefixes;return this.getPredicatesByIRI(s(e,n),s(t,n),s(i,n))},getPredicatesByIRI:function(e,t,i){var n=[];return this.forPredicatesByIRI(function(e){n.push(e)},e,t,i),n},forPredicates:function(e,t,i,n){var r=this._prefixes;this.forPredicatesByIRI(e,s(t,r),s(i,r),s(n,r))},forPredicatesByIRI:function(e,t,i,n){var r,o,s,a=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(h(t)&&!(o=a[t])||h(i)&&!(s=a[i])))for(n in l)(r=l[n])&&(o?s?this._loopBy2Keys(r.objects,s,o,e):this._loopByKey0(r.subjects,o,e):s?this._loopByKey1(r.predicates,s,e):this._loop(r.predicates,e))},getObjects:function(e,t,i){var n=this._prefixes;return this.getObjectsByIRI(s(e,n),s(t,n),s(i,n))},getObjectsByIRI:function(e,t,i){var n=[];return this.forObjectsByIRI(function(e){n.push(e)},e,t,i),n},forObjects:function(e,t,i,n){var r=this._prefixes;this.forObjectsByIRI(e,s(t,r),s(i,r),s(n,r))},forObjectsByIRI:function(e,t,i,n){var r,o,s,a=this._ids,l=this._getGraphs(n);if(e=this._uniqueEntities(e),!(h(t)&&!(o=a[t])||h(i)&&!(s=a[i])))for(n in l)(r=l[n])&&(o?s?this._loopBy2Keys(r.subjects,o,s,e):this._loopByKey1(r.objects,o,e):s?this._loopByKey0(r.predicates,s,e):this._loop(r.objects,e))},getGraphs:function(e,t,i){var n=this._prefixes;return this.getGraphsByIRI(s(e,n),s(t,n),s(i,n))},getGraphsByIRI:function(e,t,i){var n=[];return this.forGraphsByIRI(function(e){n.push(e)},e,t,i),n},forGraphs:function(e,t,i,n){var r=this._prefixes;this.forGraphsByIRI(e,s(t,r),s(i,r),s(n,r))},forGraphsByIRI:function(t,e,i,n){for(var r in this._graphs)this.someByIRI(function(e){return t(e.graph),!0},e,i,n,r)},createBlankNode:function(e){var t,i;if(e)for(t=e="_:"+e,i=1;this._ids[t];)t=e+i++;else for(;t="_:b"+this._blankNodeIndex++,this._ids[t];);return this._ids[t]=++this._id,this._entities[this._id]=t}},g.Store=i}()}("undefined"!=typeof exports?exports:this.N3={}),function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.rdfstore=e()}}(function(){var define,module,exports;return function r(o,s,a){function l(i,e){if(!s[i]){if(!o[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(u)return u(i,!0);throw new Error("Cannot find module '"+i+"'")}var n=s[i]={exports:{}};o[i][0].call(n.exports,function(e){var t=o[i][1][e];return l(t||e)},n,n.exports,r,o,s,a)}return s[i].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e]);return l}({1:[function(e,t,i){!function(){var e=void 0!==i?i:this,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function a(e){this.message=e}(a.prototype=new Error).name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var t,i,n=0,r=s,o="";e.charAt(0|n)||(r="=",n%1);o+=r.charAt(63&t>>8-n%1*8)){if(255<(i=e.charCodeAt(n+=.75)))throw new a("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|i}return o}),e.atob||(e.atob=function(e){if((e=e.replace(/=+$/,"")).length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,i,n=0,r=0,o="";i=e.charAt(r++);~i&&(t=n%4?64*t+i:i,n++%4)?o+=String.fromCharCode(255&t>>(-2*n&6)):0)i=s.indexOf(i);return o})}()},{}],2:[function(e,t,i){!function(e){"use strict";var c="undefined"!=typeof Uint8Array?Uint8Array:Array,i="+".charCodeAt(0),n="/".charCodeAt(0),r="0".charCodeAt(0),o="a".charCodeAt(0),s="A".charCodeAt(0);function d(e){var t=e.charCodeAt(0);return t===i?62:t===n?63:t<r?-1:t<r+10?t-r+26+26:t<s+26?t-s:t<o+26?t-o+26:void 0}e.toByteArray=function(e){var t,i,n,r,o,s;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.length;o="="===e.charAt(a-2)?2:"="===e.charAt(a-1)?1:0,s=new c(3*e.length/4-o),n=0<o?e.length-4:e.length;var l=0;function u(e){s[l++]=e}for(i=t=0;t<n;t+=4,i+=3)u((16711680&(r=d(e.charAt(t))<<18|d(e.charAt(t+1))<<12|d(e.charAt(t+2))<<6|d(e.charAt(t+3))))>>16),u((65280&r)>>8),u(255&r);return 2===o?u(255&(r=d(e.charAt(t))<<2|d(e.charAt(t+1))>>4)):1===o&&(u((r=d(e.charAt(t))<<10|d(e.charAt(t+1))<<4|d(e.charAt(t+2))>>2)>>8&255),u(255&r)),s},e.fromByteArray=function(e){var t,i,n,r,o=e.length%3,s="";function a(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(t=0,n=e.length-o;t<n;t+=3)i=(e[t]<<16)+(e[t+1]<<8)+e[t+2],s+=a((r=i)>>18&63)+a(r>>12&63)+a(r>>6&63)+a(63&r);switch(o){case 1:s+=a((i=e[e.length-1])>>2),s+=a(i<<4&63),s+="==";break;case 2:s+=a((i=(e[e.length-2]<<8)+e[e.length-1])>>10),s+=a(i>>4&63),s+=a(i<<2&63),s+="="}return s}}(void 0===i?this.base64js={}:i)},{}],3:[function(X,W,e){(function(H,G){(function(){"use strict";function u(e){return"function"==typeof e}var t,i,s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},n=0,a=function(e,t){b[n]=e,b[n+1]=t,2===(n+=2)&&(i?i(w):h())};var e="undefined"!=typeof window?window:void 0,r=e||{},o=r.MutationObserver||r.WebKitMutationObserver,l=void 0!==H&&"[object process]"==={}.toString.call(H),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){return function(){setTimeout(w,1)}}var h,p,f,g,v,m,y,b=new Array(1e3);function w(){for(var e=0;e<n;e+=2){(0,b[e])(b[e+1]),b[e]=void 0,b[e+1]=void 0}n=0}function x(){}h=l?(m=H.nextTick,y=H.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(y)&&"0"===y[1]&&"10"===y[2]&&(m=setImmediate),function(){m(w)}):o?(f=0,g=new o(w),v=document.createTextNode(""),g.observe(v,{characterData:!0}),function(){v.data=f=++f%2}):c?((p=new MessageChannel).port1.onmessage=w,function(){p.port2.postMessage(0)}):void 0===e&&"function"==typeof X?function(){try{var e=X("vertx");return t=e.runOnLoop||e.runOnContext,function(){t(w)}}catch(e){return d()}}():d();var k=void 0,_=1,F=2,C=new A;function E(e,t){if(t.constructor===e.constructor)o=e,(s=t)._state===_?S(o,s._result):s._state===F?R(o,s._result):j(s,void 0,function(e){T(o,e)},function(e){R(o,e)});else{var i=function(e){try{return e.then}catch(e){return C.error=e,C}}(t);i===C?R(e,C.error):void 0===i?S(e,t):u(i)?(n=t,r=i,a(function(t){var i=!1,e=function(e,t,i,n){try{e.call(t,i,n)}catch(e){return e}}(r,n,function(e){i||(i=!0,n!==e?T(t,e):S(t,e))},function(e){i||(i=!0,R(t,e))},t._label);!i&&e&&(i=!0,R(t,e))},e)):S(e,t)}var n,r,o,s}function T(e,t){var i;e===t?R(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(i=t)||"object"==typeof i&&null!==i?E(e,t):S(e,t)}function D(e){e._onerror&&e._onerror(e._result),I(e)}function S(e,t){e._state===k&&(e._result=t,e._state=_,0!==e._subscribers.length&&a(I,e))}function R(e,t){e._state===k&&(e._state=F,e._result=t,a(D,e))}function j(e,t,i,n){var r=e._subscribers,o=r.length;e._onerror=null,r[o]=t,r[o+_]=i,r[o+F]=n,0===o&&e._state&&a(I,e)}function I(e){var t=e._subscribers,i=e._state;if(0!==t.length){for(var n,r,o=e._result,s=0;s<t.length;s+=3)n=t[s],r=t[s+i],n?N(i,n,r,o):r(o);e._subscribers.length=0}}function A(){this.error=null}var O=new A;function N(e,t,i,n){var r,o,s,a,l=u(i);if(l){if((r=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(i,n))===O?(a=!0,o=r.error,r=null):s=!0,t===r)return void R(t,new TypeError("A promises callback cannot return that same promise."))}else r=n,s=!0;t._state!==k||(l&&s?T(t,r):a?R(t,o):e===_?S(t,r):e===F&&R(t,r))}function L(e,t){var i=this;i._instanceConstructor=e,i.promise=new e(x),i._validateInput(t)?(i._input=t,i.length=t.length,i._remaining=t.length,i._init(),0===i.length?S(i.promise,i._result):(i.length=i.length||0,i._enumerate(),0===i._remaining&&S(i.promise,i._result))):R(i.promise,i._validationError())}L.prototype._validateInput=function(e){return s(e)},L.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},L.prototype._init=function(){this._result=new Array(this.length)};var M=L;L.prototype._enumerate=function(){for(var e=this.length,t=this.promise,i=this._input,n=0;t._state===k&&n<e;n++)this._eachEntry(i[n],n)},L.prototype._eachEntry=function(e,t){var i,n=this,r=n._instanceConstructor;"object"==typeof(i=e)&&null!==i?e.constructor===r&&e._state!==k?(e._onerror=null,n._settledAt(e._state,t,e._result)):n._willSettleAt(r.resolve(e),t):(n._remaining--,n._result[t]=e)},L.prototype._settledAt=function(e,t,i){var n=this,r=n.promise;r._state===k&&(n._remaining--,e===F?R(r,i):n._result[t]=i),0===n._remaining&&S(r,n._result)},L.prototype._willSettleAt=function(e,t){var i=this;j(e,void 0,function(e){i._settledAt(_,t,e)},function(e){i._settledAt(F,t,e)})};var P=function(e){var t=new this(x);if(!s(e))return R(t,new TypeError("You must pass an array to race.")),t;var i=e.length;function n(e){T(t,e)}function r(e){R(t,e)}for(var o=0;t._state===k&&o<i;o++)j(this.resolve(e[o]),void 0,n,r);return t};var U=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(x);return T(t,e),t};var $=function(e){var t=new this(x);return R(t,e),t},B=0;var Q=V;function V(e){this._id=B++,this._state=void 0,this._result=void 0,this._subscribers=[],x!==e&&(u(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof V||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e(function(e){T(t,e)},function(e){R(t,e)})}catch(e){R(t,e)}}(this,e))}V.all=function(e){return new M(this,e).promise},V.race=P,V.resolve=U,V.reject=$,V._setScheduler=function(e){i=e},V._setAsap=function(e){a=e},V._asap=a,V.prototype={constructor:V,then:function(e,t){var i=this._state;if(i===_&&!e||i===F&&!t)return this;var n=new this.constructor(x),r=this._result;if(i){var o=arguments[i-1];a(function(){N(i,n,o,r)})}else j(this,n,e,t);return n},catch:function(e){return this.then(null,e)}};var z=function(){var e;if(void 0!==G)e=G;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=Q)},q={Promise:Q,polyfill:z};"function"==typeof define&&define.amd?define(function(){return q}):void 0!==W&&W.exports?W.exports=q:void 0!==this&&(this.ES6Promise=q),z()}).call(this)}).call(this,X("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"7YKIPe":10}],4:[function(e,t,i){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function a(e){return"function"==typeof e}function l(e){return"object"==typeof e&&null!==e}function u(e){return void 0===e}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,i,n,r,o,s;if(this._events||(this._events={}),"error"===e&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(u(i=this._events[e]))return!1;if(a(i))switch(arguments.length){case 1:i.call(this);break;case 2:i.call(this,arguments[1]);break;case 3:i.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];i.apply(this,r)}else if(l(i)){for(n=arguments.length,r=new Array(n-1),o=1;o<n;o++)r[o-1]=arguments[o];for(n=(s=i.slice()).length,o=0;o<n;o++)s[o].apply(this,r)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){var i;if(!a(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,a(t.listener)?t.listener:t),this._events[e]?l(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,l(this._events[e])&&!this._events[e].warned)&&((i=u(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&0<i&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()));return this},n.prototype.once=function(e,t){if(!a(t))throw TypeError("listener must be a function");var i=!1;function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var i,n,r,o;if(!a(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=(i=this._events[e]).length,n=-1,i===t||a(i.listener)&&i.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(l(i)){for(o=r;0<o--;)if(i[o]===t||i[o].listener&&i[o].listener===t){n=o;break}if(n<0)return this;1===i.length?(i.length=0,delete this._events[e]):i.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,i;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(a(i=this._events[e]))this.removeListener(e,i);else for(;i.length;)this.removeListener(e,i[i.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?a(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){return e._events&&e._events[t]?a(e._events[t])?1:e._events[t].length:0}},{}],5:[function(e,t,i){},{}],6:[function(e,t,n){var l=e("base64-js"),o=e("ieee754");function v(e,t,i){if(!(this instanceof v))return new v(e,t,i);var n,r,o,s,a,l=typeof e;if("base64"===t&&"string"===l)for(e=(n=e).trim?n.trim():n.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"===l)r=k(e);else if("string"===l)r=v.byteLength(e,t);else{if("object"!==l)throw new Error("First argument needs to be a number, array or string.");r=k(e.length)}if(v._useTypedArrays?o=v._augment(new Uint8Array(r)):((o=this).length=r,o._isBuffer=!0),v._useTypedArrays&&"number"==typeof e.byteLength)o._set(e);else if(_(a=e)||v.isBuffer(a)||a&&"object"==typeof a&&"number"==typeof a.length)for(s=0;s<r;s++)v.isBuffer(e)?o[s]=e.readUInt8(s):o[s]=e[s];else if("string"===l)o.write(e,0,t);else if("number"===l&&!v._useTypedArrays&&!i)for(s=0;s<r;s++)o[s]=0;return o}function m(e,t,i,n){return v._charsWritten=T(function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function u(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;r++)n+=String.fromCharCode(e[r]);return n}function s(e,t,i,n){n||(I("boolean"==typeof i,"missing or invalid endian"),I(null!=t,"missing offset"),I(t+1<e.length,"Trying to read beyond buffer length"));var r,o=e.length;if(!(o<=t))return i?(r=e[t],t+1<o&&(r|=e[t+1]<<8)):(r=e[t]<<8,t+1<o&&(r|=e[t+1])),r}function a(e,t,i,n){n||(I("boolean"==typeof i,"missing or invalid endian"),I(null!=t,"missing offset"),I(t+3<e.length,"Trying to read beyond buffer length"));var r,o=e.length;if(!(o<=t))return i?(t+2<o&&(r=e[t+2]<<16),t+1<o&&(r|=e[t+1]<<8),r|=e[t],t+3<o&&(r+=e[t+3]<<24>>>0)):(t+1<o&&(r=e[t+1]<<16),t+2<o&&(r|=e[t+2]<<8),t+3<o&&(r|=e[t+3]),r+=e[t]<<24>>>0),r}function i(e,t,i,n){if(n||(I("boolean"==typeof i,"missing or invalid endian"),I(null!=t,"missing offset"),I(t+1<e.length,"Trying to read beyond buffer length")),!(e.length<=t)){var r=s(e,t,i,!0);return 32768&r?-1*(65535-r+1):r}}function r(e,t,i,n){if(n||(I("boolean"==typeof i,"missing or invalid endian"),I(null!=t,"missing offset"),I(t+3<e.length,"Trying to read beyond buffer length")),!(e.length<=t)){var r=a(e,t,i,!0);return 2147483648&r?-1*(4294967295-r+1):r}}function c(e,t,i,n){return n||(I("boolean"==typeof i,"missing or invalid endian"),I(t+3<e.length,"Trying to read beyond buffer length")),o.read(e,t,i,23,4)}function d(e,t,i,n){return n||(I("boolean"==typeof i,"missing or invalid endian"),I(t+7<e.length,"Trying to read beyond buffer length")),o.read(e,t,i,52,8)}function h(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+1<e.length,"trying to write beyond buffer length"),S(t,65535));var o=e.length;if(!(o<=i))for(var s=0,a=Math.min(o-i,2);s<a;s++)e[i+s]=(t&255<<8*(n?s:1-s))>>>8*(n?s:1-s)}function p(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+3<e.length,"trying to write beyond buffer length"),S(t,4294967295));var o=e.length;if(!(o<=i))for(var s=0,a=Math.min(o-i,4);s<a;s++)e[i+s]=t>>>8*(n?s:3-s)&255}function f(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+1<e.length,"Trying to write beyond buffer length"),R(t,32767,-32768)),e.length<=i||h(e,0<=t?t:65535+t+1,i,n,r)}function g(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+3<e.length,"Trying to write beyond buffer length"),R(t,2147483647,-2147483648)),e.length<=i||p(e,0<=t?t:4294967295+t+1,i,n,r)}function y(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+3<e.length,"Trying to write beyond buffer length"),j(t,34028234663852886e22,-34028234663852886e22)),e.length<=i||o.write(e,t,i,n,23,4)}function b(e,t,i,n,r){r||(I(null!=t,"missing value"),I("boolean"==typeof n,"missing or invalid endian"),I(null!=i,"missing offset"),I(i+7<e.length,"Trying to write beyond buffer length"),j(t,17976931348623157e292,-17976931348623157e292)),e.length<=i||o.write(e,t,i,n,52,8)}n.Buffer=v,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50,v.poolSize=8192,v._useTypedArrays=function(){try{var e=new ArrayBuffer(0),t=new Uint8Array(e);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray}catch(e){return!1}}(),v.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.isBuffer=function(e){return!(null==e||!e._isBuffer)},v.byteLength=function(e,t){var i;switch(e+="",t||"utf8"){case"hex":i=e.length/2;break;case"utf8":case"utf-8":i=C(e).length;break;case"ascii":case"binary":case"raw":i=e.length;break;case"base64":i=E(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=2*e.length;break;default:throw new Error("Unknown encoding")}return i},v.concat=function(e,t){if(I(_(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new v(0);if(1===e.length)return e[0];var i;if("number"!=typeof t)for(i=t=0;i<e.length;i++)t+=e[i].length;var n=new v(t),r=0;for(i=0;i<e.length;i++){var o=e[i];o.copy(n,r),r+=o.length}return n},v.prototype.write=function(e,t,i,n){if(isFinite(t))isFinite(i)||(n=i,i=void 0);else{var r=n;n=t,t=i,i=r}t=Number(t)||0;var o,s,a,l,u,c,d,h,p,f,g=this.length-t;switch(i?g<(i=Number(i))&&(i=g):i=g,n=String(n||"utf8").toLowerCase()){case"hex":o=function(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?r<(n=Number(n))&&(n=r):n=r;var o=t.length;I(o%2==0,"Invalid hex string"),o/2<n&&(n=o/2);for(var s=0;s<n;s++){var a=parseInt(t.substr(2*s,2),16);I(!isNaN(a),"Invalid hex string"),e[i+s]=a}return v._charsWritten=2*s,s}(this,e,t,i);break;case"utf8":case"utf-8":h=this,p=t,f=i,o=v._charsWritten=T(C(e),h,p,f);break;case"ascii":o=m(this,e,t,i);break;case"binary":o=m(this,e,t,i);break;case"base64":u=this,c=t,d=i,o=v._charsWritten=T(E(e),u,c,d);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":s=this,a=t,l=i,o=v._charsWritten=T(function(e){for(var t,i,n,r=[],o=0;o<e.length;o++)t=e.charCodeAt(o),i=t>>8,n=t%256,r.push(n),r.push(i);return r}(e),s,a,l);break;default:throw new Error("Unknown encoding")}return o},v.prototype.toString=function(e,t,i){var n,r,o,s,a=this;if(e=String(e||"utf8").toLowerCase(),t=Number(t)||0,(i=void 0!==i?Number(i):i=a.length)===t)return"";switch(e){case"hex":n=function(e,t,i){var n=e.length;(!t||t<0)&&(t=0);(!i||i<0||n<i)&&(i=n);for(var r="",o=t;o<i;o++)r+=F(e[o]);return r}(a,t,i);break;case"utf8":case"utf-8":n=function(e,t,i){var n="",r="";i=Math.min(e.length,i);for(var o=t;o<i;o++)e[o]<=127?(n+=D(r)+String.fromCharCode(e[o]),r=""):r+="%"+e[o].toString(16);return n+D(r)}(a,t,i);break;case"ascii":n=u(a,t,i);break;case"binary":n=u(a,t,i);break;case"base64":r=a,s=i,n=0===(o=t)&&s===r.length?l.fromByteArray(r):l.fromByteArray(r.slice(o,s));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=function(e,t,i){for(var n=e.slice(t,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}(a,t,i);break;default:throw new Error("Unknown encoding")}return n},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},v.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t||(t=0),n!==i&&0!==e.length&&0!==this.length){I(i<=n,"sourceEnd < sourceStart"),I(0<=t&&t<e.length,"targetStart out of bounds"),I(0<=i&&i<this.length,"sourceStart out of bounds"),I(0<=n&&n<=this.length,"sourceEnd out of bounds"),n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r=n-i;if(r<100||!v._useTypedArrays)for(var o=0;o<r;o++)e[o+t]=this[o+i];else e._set(this.subarray(i,i+r),t)}},v.prototype.slice=function(e,t){var i=this.length;if(e=x(e,i,0),t=x(t,i,i),v._useTypedArrays)return v._augment(this.subarray(e,t));for(var n=t-e,r=new v(n,void 0,!0),o=0;o<n;o++)r[o]=this[o+e];return r},v.prototype.get=function(e){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(e)},v.prototype.set=function(e,t){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(e,t)},v.prototype.readUInt8=function(e,t){if(t||(I(null!=e,"missing offset"),I(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},v.prototype.readUInt16LE=function(e,t){return s(this,e,!0,t)},v.prototype.readUInt16BE=function(e,t){return s(this,e,!1,t)},v.prototype.readUInt32LE=function(e,t){return a(this,e,!0,t)},v.prototype.readUInt32BE=function(e,t){return a(this,e,!1,t)},v.prototype.readInt8=function(e,t){if(t||(I(null!=e,"missing offset"),I(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},v.prototype.readInt16LE=function(e,t){return i(this,e,!0,t)},v.prototype.readInt16BE=function(e,t){return i(this,e,!1,t)},v.prototype.readInt32LE=function(e,t){return r(this,e,!0,t)},v.prototype.readInt32BE=function(e,t){return r(this,e,!1,t)},v.prototype.readFloatLE=function(e,t){return c(this,e,!0,t)},v.prototype.readFloatBE=function(e,t){return c(this,e,!1,t)},v.prototype.readDoubleLE=function(e,t){return d(this,e,!0,t)},v.prototype.readDoubleBE=function(e,t){return d(this,e,!1,t)},v.prototype.writeUInt8=function(e,t,i){i||(I(null!=e,"missing value"),I(null!=t,"missing offset"),I(t<this.length,"trying to write beyond buffer length"),S(e,255)),t>=this.length||(this[t]=e)},v.prototype.writeUInt16LE=function(e,t,i){h(this,e,t,!0,i)},v.prototype.writeUInt16BE=function(e,t,i){h(this,e,t,!1,i)},v.prototype.writeUInt32LE=function(e,t,i){p(this,e,t,!0,i)},v.prototype.writeUInt32BE=function(e,t,i){p(this,e,t,!1,i)},v.prototype.writeInt8=function(e,t,i){i||(I(null!=e,"missing value"),I(null!=t,"missing offset"),I(t<this.length,"Trying to write beyond buffer length"),R(e,127,-128)),t>=this.length||(0<=e?this.writeUInt8(e,t,i):this.writeUInt8(255+e+1,t,i))},v.prototype.writeInt16LE=function(e,t,i){f(this,e,t,!0,i)},v.prototype.writeInt16BE=function(e,t,i){f(this,e,t,!1,i)},v.prototype.writeInt32LE=function(e,t,i){g(this,e,t,!0,i)},v.prototype.writeInt32BE=function(e,t,i){g(this,e,t,!1,i)},v.prototype.writeFloatLE=function(e,t,i){y(this,e,t,!0,i)},v.prototype.writeFloatBE=function(e,t,i){y(this,e,t,!1,i)},v.prototype.writeDoubleLE=function(e,t,i){b(this,e,t,!0,i)},v.prototype.writeDoubleBE=function(e,t,i){b(this,e,t,!1,i)},v.prototype.fill=function(e,t,i){if(e||(e=0),t||(t=0),i||(i=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),I("number"==typeof e&&!isNaN(e),"value is not a number"),I(t<=i,"end < start"),i!==t&&0!==this.length){I(0<=t&&t<this.length,"start out of bounds"),I(0<=i&&i<=this.length,"end out of bounds");for(var n=t;n<i;n++)this[n]=e}},v.prototype.inspect=function(){for(var e=[],t=this.length,i=0;i<t;i++)if(e[i]=F(this[i]),i===n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<Buffer "+e.join(" ")+">"},v.prototype.toArrayBuffer=function(){if("undefined"==typeof Uint8Array)throw new Error("Buffer.toArrayBuffer not supported in this browser");if(v._useTypedArrays)return new v(this).buffer;for(var e=new Uint8Array(this.length),t=0,i=e.length;t<i;t+=1)e[t]=this[t];return e.buffer};var w=v.prototype;function x(e,t,i){return"number"!=typeof e?i:t<=(e=~~e)?t:0<=e?e:0<=(e+=t)?e:0}function k(e){return(e=~~Math.ceil(+e))<0?0:e}function _(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function C(e){for(var t=[],i=0;i<e.length;i++){var n=e.charCodeAt(i);if(n<=127)t.push(e.charCodeAt(i));else{var r=i;55296<=n&&n<=57343&&i++;for(var o=encodeURIComponent(e.slice(r,i+1)).substr(1).split("%"),s=0;s<o.length;s++)t.push(parseInt(o[s],16))}}return t}function E(e){return l.toByteArray(e)}function T(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);r++)t[r+i]=e[r];return r}function D(e){try{return decodeURIComponent(e)}catch(e){return String.fromCharCode(65533)}}function S(e,t){I("number"==typeof e,"cannot write a non-number as a number"),I(0<=e,"specified a negative value for writing an unsigned value"),I(e<=t,"value is larger than maximum value for type"),I(Math.floor(e)===e,"value has a fractional component")}function R(e,t,i){I("number"==typeof e,"cannot write a non-number as a number"),I(e<=t,"value larger than maximum allowed value"),I(i<=e,"value smaller than minimum allowed value"),I(Math.floor(e)===e,"value has a fractional component")}function j(e,t,i){I("number"==typeof e,"cannot write a non-number as a number"),I(e<=t,"value larger than maximum allowed value"),I(i<=e,"value smaller than minimum allowed value")}function I(e,t){if(!e)throw new Error(t||"Failed assertion")}v._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=w.get,e.set=w.set,e.write=w.write,e.toString=w.toString,e.toLocaleString=w.toString,e.toJSON=w.toJSON,e.copy=w.copy,e.slice=w.slice,e.readUInt8=w.readUInt8,e.readUInt16LE=w.readUInt16LE,e.readUInt16BE=w.readUInt16BE,e.readUInt32LE=w.readUInt32LE,e.readUInt32BE=w.readUInt32BE,e.readInt8=w.readInt8,e.readInt16LE=w.readInt16LE,e.readInt16BE=w.readInt16BE,e.readInt32LE=w.readInt32LE,e.readInt32BE=w.readInt32BE,e.readFloatLE=w.readFloatLE,e.readFloatBE=w.readFloatBE,e.readDoubleLE=w.readDoubleLE,e.readDoubleBE=w.readDoubleBE,e.writeUInt8=w.writeUInt8,e.writeUInt16LE=w.writeUInt16LE,e.writeUInt16BE=w.writeUInt16BE,e.writeUInt32LE=w.writeUInt32LE,e.writeUInt32BE=w.writeUInt32BE,e.writeInt8=w.writeInt8,e.writeInt16LE=w.writeInt16LE,e.writeInt16BE=w.writeInt16BE,e.writeInt32LE=w.writeInt32LE,e.writeInt32BE=w.writeInt32BE,e.writeFloatLE=w.writeFloatLE,e.writeFloatBE=w.writeFloatBE,e.writeDoubleLE=w.writeDoubleLE,e.writeDoubleBE=w.writeDoubleBE,e.fill=w.fill,e.inspect=w.inspect,e.toArrayBuffer=w.toArrayBuffer,e}},{"base64-js":2,ieee754:23}],7:[function(e,t,i){var n=t.exports,r=(e("events").EventEmitter,e("./lib/request")),o=e("url");n.request=function(e,t){"string"==typeof e&&(e=o.parse(e)),e||(e={}),e.host||e.port||(e.port=parseInt(window.location.port,10)),!e.host&&e.hostname&&(e.host=e.hostname),e.scheme||(e.scheme=window.location.protocol.split(":")[0]),e.host||(e.host=window.location.hostname||window.location.host),/:/.test(e.host)&&(e.port||(e.port=e.host.split(":")[1]),e.host=e.host.split(":")[0]),e.port||(e.port="https"==e.scheme?443:80);var i=new r(new s,e);return t&&i.on("response",t),i},n.get=function(e,t){e.method="GET";var i=n.request(e,t);return i.end(),i},n.Agent=function(){},n.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],i=0;i<t.length;i++)try{var n=new window.ActiveXObject(t[i]);return function(){if(n){var e=n;return n=null,e}return new window.ActiveXObject(t[i])}}catch(e){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();n.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":8,events:4,url:36}],8:[function(e,t,i){var n=e("stream"),l=e("./response"),u=e("Base64"),r=e("inherits"),o=t.exports=function(e,t){var i=this;i.writable=!0,i.xhr=e,i.body=[],i.uri=(t.scheme||"http")+"://"+t.host+(t.port?":"+t.port:"")+(t.path||"/"),void 0===t.withCredentials&&(t.withCredentials=!0);try{e.withCredentials=t.withCredentials}catch(e){}if(e.open(t.method||"GET",i.uri,!0),i._headers={},t.headers)for(var n=c(t.headers),r=0;r<n.length;r++){var o=n[r];if(i.isSafeRequestHeader(o)){var s=t.headers[o];i.setHeader(o,s)}}t.auth&&this.setHeader("Authorization","Basic "+u.btoa(t.auth));var a=new l;a.on("close",function(){i.emit("close")}),a.on("ready",function(){i.emit("response",a)}),e.onreadystatechange=function(){e.__aborted||a.handle(e)}};r(o,n),o.prototype.setHeader=function(e,t){this._headers[e.toLowerCase()]=t},o.prototype.getHeader=function(e){return this._headers[e.toLowerCase()]},o.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},o.prototype.write=function(e){this.body.push(e)},o.prototype.destroy=function(e){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},o.prototype.end=function(e){void 0!==e&&this.body.push(e);for(var t=c(this._headers),i=0;i<t.length;i++){var n=t[i],r=this._headers[n];if(d(r))for(var o=0;o<r.length;o++)this.xhr.setRequestHeader(n,r[o]);else this.xhr.setRequestHeader(n,r)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(d(this.body[0])){var s=[];for(i=0;i<this.body.length;i++)s.push.apply(s,this.body[i]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){var a=0;for(i=0;i<this.body.length;i++)a+=this.body[i].length;s=new this.body[0].constructor(a);var l=0;for(i=0;i<this.body.length;i++){var u=this.body[i];for(o=0;o<u.length;o++)s[l++]=u[o]}this.xhr.send(s)}else{for(s="",i=0;i<this.body.length;i++)s+=this.body[i].toString();this.xhr.send(s)}},o.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],o.prototype.isSafeRequestHeader=function(e){return!!e&&-1===s(o.unsafeHeaders,e.toLowerCase())};var c=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=function(e,t){if(e.indexOf)return e.indexOf(t);for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}},{"./response":9,Base64:1,inherits:24,stream:15}],9:[function(e,t,i){var n=e("stream"),r=e("util"),o=t.exports=function(e){this.offset=0,this.readable=!0};r.inherits(o,n);var s={streaming:!0,status2:!0};function a(e){for(var t=e.getAllResponseHeaders().split(/\r?\n/),i={},n=0;n<t.length;n++){var r=t[n];if(""!==r){var o=r.match(/^([^:]+):\s*(.*)/);if(o){var s=o[1].toLowerCase(),a=o[2];void 0!==i[s]?l(i[s])?i[s].push(a):i[s]=[i[s],a]:i[s]=a}else i[r]=!0}}return i}o.prototype.getResponse=function(e){var t=String(e.responseType).toLowerCase();return"blob"===t?e.responseBlob||e.response:"arraybuffer"===t?e.response:e.responseText},o.prototype.getHeader=function(e){return this.headers[e.toLowerCase()]},o.prototype.handle=function(e){if(2===e.readyState&&s.status2){try{this.statusCode=e.status,this.headers=a(e)}catch(e){s.status2=!1}s.status2&&this.emit("ready")}else if(s.streaming&&3===e.readyState){try{this.statusCode||(this.statusCode=e.status,this.headers=a(e),this.emit("ready"))}catch(e){}try{this._emitData(e)}catch(e){s.streaming=!1}}else 4===e.readyState&&(this.statusCode||(this.statusCode=e.status,this.emit("ready")),this._emitData(e),e.error?this.emit("error",this.getResponse(e)):this.emit("end"),this.emit("close"))},o.prototype._emitData=function(e){var t=this.getResponse(e);if(t.toString().match(/ArrayBuffer/))return this.emit("data",new Uint8Array(t,this.offset)),void(this.offset=t.byteLength);t.length>this.offset&&(this.emit("data",t.slice(this.offset)),this.offset=t.length)};var l=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{stream:15,util:38}],10:[function(e,t,i){var n=t.exports={};function r(){}n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<i.length&&i.shift()())},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],11:[function(e,t,i){"use strict";t.exports=function(e,t,i,n){t=t||"&",i=i||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a,l,u=e.length;0<s&&s<u&&(u=s);for(var c=0;c<u;++c){var d,h,p,f,g=e[c].replace(o,"%20"),v=g.indexOf(i);h=0<=v?(d=g.substr(0,v),g.substr(v+1)):(d=g,""),p=decodeURIComponent(d),f=decodeURIComponent(h),a=r,l=p,Object.prototype.hasOwnProperty.call(a,l)?m(r[p])?r[p].push(f):r[p]=[r[p],f]:r[p]=f}return r};var m=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],12:[function(e,t,i){"use strict";var o=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(i,n,r,e){return n=n||"&",r=r||"=",null===i&&(i=void 0),"object"==typeof i?function(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}(a(i),function(e){var t=encodeURIComponent(o(e))+r;return s(i[e])?i[e].map(function(e){return t+encodeURIComponent(o(e))}).join(n):t+encodeURIComponent(o(i[e]))}).join(n):e?encodeURIComponent(o(e))+r+encodeURIComponent(o(i)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};var a=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},{}],13:[function(e,t,i){"use strict";i.decode=i.parse=e("./decode"),i.encode=i.stringify=e("./encode")},{"./decode":11,"./encode":12}],14:[function(e,t,i){t.exports=a;var n=e("inherits"),r=e("process/browser.js").nextTick,o=e("./readable.js"),s=e("./writable.js");function a(e){if(!(this instanceof a))return new a(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",l)}function l(){if(!this.allowHalfOpen&&!this._writableState.ended){var e=this;r(function(){e.end()})}}n(a,o),a.prototype.write=s.prototype.write,a.prototype.end=s.prototype.end,a.prototype._write=s.prototype._write},{"./readable.js":18,"./writable.js":20,inherits:24,"process/browser.js":16}],15:[function(e,t,i){t.exports=n;var c=e("events").EventEmitter;function n(){c.call(this)}e("inherits")(n,c),n.Readable=e("./readable.js"),n.Writable=e("./writable.js"),n.Duplex=e("./duplex.js"),n.Transform=e("./transform.js"),n.PassThrough=e("./passthrough.js"),(n.Stream=n).prototype.pipe=function(t,e){var i=this;function n(e){t.writable&&!1===t.write(e)&&i.pause&&i.pause()}function r(){i.readable&&i.resume&&i.resume()}i.on("data",n),t.on("drain",r),t._isStdio||e&&!1===e.end||(i.on("end",s),i.on("close",a));var o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,"function"==typeof t.destroy&&t.destroy())}function l(e){if(u(),0===c.listenerCount(this,"error"))throw e}function u(){i.removeListener("data",n),t.removeListener("drain",r),i.removeListener("end",s),i.removeListener("close",a),i.removeListener("error",l),t.removeListener("error",l),i.removeListener("end",u),i.removeListener("close",u),t.removeListener("close",u)}return i.on("error",l),t.on("error",l),i.on("end",u),i.on("close",u),t.on("close",u),t.emit("pipe",i),t}},{"./duplex.js":14,"./passthrough.js":17,"./readable.js":18,"./transform.js":19,"./writable.js":20,events:4,inherits:24}],16:[function(e,t,i){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),0<i.length&&i.shift()())},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],17:[function(e,t,i){t.exports=r;var n=e("./transform.js");function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}e("inherits")(r,n),r.prototype._transform=function(e,t,i){i(null,e)}},{"./transform.js":19,inherits:24}],18:[function(w,e,t){(function(g){(e.exports=i).ReadableState=t;var n,v=w("events").EventEmitter,r=w("./index.js"),h=w("buffer").Buffer,m=w("process/browser.js").nextTick;function t(e,t){var i=(e=e||{}).highWaterMark;this.highWaterMark=i||0===i?i:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(n||(n=w("string_decoder").StringDecoder),this.decoder=new n(e.encoding),this.encoding=e.encoding)}function i(e){if(!(this instanceof i))return new i(e);this._readableState=new t(e,this),this.readable=!0,r.call(this)}function o(e,t,i,n,r){var o,s,a,l=function(e,t){var i=null;h.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||i||(i=new TypeError("Invalid non-string/buffer chunk"));return i}(t,i);if(l)e.emit("error",l);else if(null==i)t.reading=!1,t.ended||function(e,t){if(t.decoder&&!t.ended){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,0<t.length?c(e):p(e)}(e,t);else if(t.objectMode||i&&0<i.length)if(t.ended&&!r){var u=new Error("stream.push() after EOF");e.emit("error",u)}else if(t.endEmitted&&r){u=new Error("stream.unshift() after end event");e.emit("error",u)}else!t.decoder||r||n||(i=t.decoder.write(i)),t.length+=t.objectMode?1:i.length,r?t.buffer.unshift(i):(t.reading=!1,t.buffer.push(i)),t.needReadable&&c(e),o=e,(s=t).readingMore||(s.readingMore=!0,m(function(){!function(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}(o,s)}));else r||(t.reading=!1);return!(a=t).ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}w("inherits")(i,r),i.prototype.push=function(e,t){var i=this._readableState;return"string"!=typeof e||i.objectMode||(t=t||i.defaultEncoding)!==i.encoding&&(e=new h(e,t),t=""),o(this,i,e,t,!1)},i.prototype.unshift=function(e){return o(this,this._readableState,e,"",!0)},i.prototype.setEncoding=function(e){n||(n=w("string_decoder").StringDecoder),this._readableState.decoder=new n(e),this._readableState.encoding=e};var s=8388608;function a(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||null===e?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=function(e){if(s<=e)e=s;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function c(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?m(function(){l(e)}):l(e))}function l(e){e.emit("readable")}function y(e){var n,r=e._readableState;function t(e,t,i){!1===e.write(n)&&r.awaitDrain++}for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes):f(r.pipes,t),e.emit("data",n),0<r.awaitDrain)return;if(0===r.pipesCount)return r.flowing=!1,void(0<v.listenerCount(e,"data")&&u(e));r.ranOut=!0}function b(){this._readableState.ranOut&&(this._readableState.ranOut=!1,y(this))}function u(t,e){if(t._readableState.flowing)throw new Error("Cannot switch to old mode now.");var i=e||!1,n=!1;t.readable=!0,t.pipe=r.prototype.pipe,t.on=t.addListener=r.prototype.on,t.on("readable",function(){var e;for(n=!0;!i&&null!==(e=t.read());)t.emit("data",e);null===e&&(n=!1,t._readableState.needReadable=!0)}),t.pause=function(){i=!0,this.emit("pause")},t.resume=function(){i=!1,n?m(function(){t.emit("readable")}):this.read(0),this.emit("resume")},t.emit("readable")}function d(e,t){var i,n=t.buffer,r=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===n.length)return null;if(0===r)i=null;else if(s)i=n.shift();else if(!e||r<=e)i=o?n.join(""):h.concat(n,r),n.length=0;else{if(e<n[0].length)i=(c=n[0]).slice(0,e),n[0]=c.slice(e);else if(e===n[0].length)i=n.shift();else{i=o?"":new h(e);for(var a=0,l=0,u=n.length;l<u&&a<e;l++){var c=n[0],d=Math.min(e-a,c.length);o?i+=c.slice(0,d):c.copy(i,a,0,d),d<c.length?n[0]=c.slice(d):n.shift(),a+=d}}}return i}function p(e){var t=e._readableState;if(0<t.length)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,m(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function f(e,t){for(var i=0,n=e.length;i<n;i++)t(e[i],i)}i.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var i=e;if(("number"!=typeof e||0<e)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return c(this),null;if(0===(e=a(e,t))&&t.ended)return 0===t.length&&p(this),null;var n,r=t.needReadable;return t.length-e<=t.highWaterMark&&(r=!0),(t.ended||t.reading)&&(r=!1),r&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=a(i,t)),null===(n=0<e?d(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&p(this),n},i.prototype._read=function(e){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){var i=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t)}n.pipesCount+=1;var r=(!e||!1!==e.end)&&t!==g.stdout&&t!==g.stderr?s:u;function o(e){e===i&&u()}function s(){t.end()}n.endEmitted?m(r):i.once("end",r),t.on("unpipe",o);var a,l=(a=i,function(){var e=a._readableState;e.awaitDrain--,0===e.awaitDrain&&y(a)});function u(){t.removeListener("close",h),t.removeListener("finish",p),t.removeListener("drain",l),t.removeListener("error",d),t.removeListener("unpipe",o),i.removeListener("end",s),i.removeListener("end",u),t._writableState&&!t._writableState.needDrain||l()}t.on("drain",l);var c=v.listenerCount(t,"error");function d(e){f(),0===c&&0===v.listenerCount(t,"error")&&t.emit("error",e)}function h(){t.removeListener("finish",p),f()}function p(){t.removeListener("close",h),f()}function f(){i.unpipe(t)}return t.once("error",d),t.once("close",h),t.once("finish",p),t.emit("pipe",i),n.flowing||(this.on("readable",b),n.flowing=!0,m(function(){y(i)})),t},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",b),t.flowing=!1,e&&e.emit("unpipe",this)),this;if(e)return-1===(r=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}(t.pipes,e))||(t.pipes.splice(r,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this;var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",b),t.flowing=!1;for(var r=0;r<n;r++)i[r].emit("unpipe",this);return this},i.prototype.addListener=i.prototype.on=function(e,t){var i=r.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||u(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&c(this):this.read(0))}return i},i.prototype.resume=function(){u(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){u(this,!0),this.emit("pause")},i.prototype.wrap=function(i){var t=this._readableState,n=!1,r=this;for(var e in i.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),i.on("data",function(e){(t.decoder&&(e=t.decoder.write(e)),e&&(t.objectMode||e.length))&&(r.push(e)||(n=!0,i.pause()))}),i)"function"==typeof i[e]&&void 0===this[e]&&(this[e]=function(e){return function(){return i[e].apply(i,arguments)}}(e));return f(["error","close","destroy","pause","resume"],function(t){i.on(t,function(e){return r.emit.apply(r,t,e)})}),r._read=function(e){n&&(n=!1,i.resume())},r},i._fromList=d}).call(this,w("7YKIPe"))},{"./index.js":15,"7YKIPe":10,buffer:6,events:4,inherits:24,"process/browser.js":16,string_decoder:21}],19:[function(e,t,i){t.exports=o;var n=e("./duplex.js");function r(e,i){this.afterTransform=function(e,t){return function(e,t,i){var n=e._transformState;n.transforming=!1;var r=n.writecb;if(!r)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,(n.writecb=null)!=i&&e.push(i);r&&r(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(i,e,t)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e);this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var i=e._writableState,n=(e._readableState,e._transformState);if(i.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}e("inherits")(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,i){throw new Error("not implemented")},o.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./duplex.js":14,inherits:24}],20:[function(e,t,i){(t.exports=s).WritableState=o;var l="undefined"!=typeof Uint8Array?function(e){return e instanceof Uint8Array}:function(e){return e&&e.constructor&&"Uint8Array"===e.constructor.name},u="undefined"!=typeof ArrayBuffer?function(e){return e instanceof ArrayBuffer}:function(e){return e&&e.constructor&&"ArrayBuffer"===e.constructor.name},n=e("inherits"),r=e("./index.js"),c=e("process/browser.js").nextTick,d=e("buffer").Buffer;function h(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function o(e,t){var i=(e=e||{}).highWaterMark;this.highWaterMark=i||0===i?i:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1;var n=(this.finished=!1)===e.decodeStrings;this.decodeStrings=!n,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,r=i.writecb;if(s=i,s.writing=!1,s.writecb=null,s.length-=s.writelen,s.writelen=0,t)!function(e,t,i,n,r){i?c(function(){r(n)}):r(n);e.emit("error",n)}(e,0,n,t,r);else{var o=f(e,i);o||i.bufferProcessing||!i.buffer.length||function(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var n=t.buffer[i],r=n.chunk,o=n.encoding,s=n.callback,a=t.objectMode?1:r.length;if(p(e,t,a,r,o,s),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}(e,i),n?c(function(){a(e,i,o,r)}):a(e,i,o,r)}var s}(t,e)},this.writecb=null,this.writelen=0,this.buffer=[]}function s(e){if(!(this instanceof s||this instanceof r.Duplex))return new s(e);this._writableState=new o(e,this),this.writable=!0,r.call(this)}function p(e,t,i,n,r,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1}function a(e,t,i,n){var r,o;i||(r=e,0===(o=t).length&&o.needDrain&&(o.needDrain=!1,r.emit("drain"))),n(),i&&g(e,t)}function f(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function g(e,t){var i=f(0,t);return i&&(t.finished=!0,e.emit("finish")),i}n(s,r),s.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},s.prototype.write=function(e,t,i){var n,r,o,s=this._writableState,a=!1;return"function"==typeof t&&(i=t,t=null),!d.isBuffer(e)&&l(e)&&(e=new d(e)),u(e)&&"undefined"!=typeof Uint8Array&&(e=new d(new Uint8Array(e))),d.isBuffer(e)?t="buffer":t||(t=s.defaultEncoding),"function"!=typeof i&&(i=function(){}),s.ended?(n=this,r=i,o=new Error("write after end"),n.emit("error",o),c(function(){r(o)})):function(e,t,i,n){var r=!0;if(!d.isBuffer(i)&&"string"!=typeof i&&null!=i&&!t.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),c(function(){n(o)}),r=!1}return r}(this,s,e,i)&&(a=function(e,t,i,n,r){i=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new d(t,i));return t}(t,i,n);var o=t.objectMode?1:i.length;t.length+=o;var s=t.length<t.highWaterMark;t.needDrain=!s,t.writing?t.buffer.push(new h(i,n,r)):p(e,t,o,i,n,r);return s}(this,s,e,t,i)),a},s.prototype._write=function(e,t,i){i(new Error("not implemented"))},s.prototype.end=function(e,t,i){var n=this._writableState;"function"==typeof e?(i=e,t=e=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),n.ending||n.finished||function(e,t,i){t.ending=!0,g(e,t),i&&(t.finished?c(i):e.once("finish",i));t.ended=!0}(this,n,i)}},{"./index.js":15,buffer:6,inherits:24,"process/browser.js":16}],21:[function(e,t,i){var n=e("buffer").Buffer;var r=i.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!n.isEncoding(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=s;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=o)}this.charBuffer=new n(6),this.charReceived=0,this.charLength=0};function o(e){return e.toString(this.encoding)}function s(e){var t=this.charReceived=e.length%2;return this.charLength=t?2:0,t}function a(e){var t=this.charReceived=e.length%3;return this.charLength=t?3:0,t}r.prototype.write=function(e){for(var t="",i=0;this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,i,n),this.charReceived+=n-i,i=n,this.charReceived<this.charLength)return"";if(!(55296<=(s=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))&&s<=56319)){if(this.charReceived=this.charLength=0,n==e.length)return t;e=e.slice(n,e.length);break}this.charLength+=this.surrogateSize,t=""}var r=this.detectIncompleteChar(e),o=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-r,o),o-=this.charReceived=r);var s;o=(t+=e.toString(this.encoding,0,o)).length-1;if(55296<=(s=t.charCodeAt(o))&&s<=56319){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),this.charBuffer.write(t.charAt(t.length-1),this.encoding),t.substring(0,o)}return t},r.prototype.detectIncompleteChar=function(e){for(var t=3<=e.length?3:e.length;0<t;t--){var i=e[e.length-t];if(1==t&&i>>5==6){this.charLength=2;break}if(t<=2&&i>>4==14){this.charLength=3;break}if(t<=3&&i>>3==30){this.charLength=4;break}}return t},r.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var i=this.charReceived,n=this.charBuffer,r=this.encoding;t+=n.slice(0,i).toString(r)}return t}},{buffer:6}],22:[function(e,t,i){var n=e("http"),r=t.exports;for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o]);r.request=function(e,t){return e||(e={}),e.scheme="https",e.protocol="https:",n.request.call(this,e,t)}},{http:7}],23:[function(e,t,i){i.read=function(e,t,i,n,r){var o,s,a=8*r-n-1,l=(1<<a)-1,u=l>>1,c=-7,d=i?r-1:0,h=i?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-c)-1,p>>=-c,c+=a;0<c;o=256*o+e[t+d],d+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;0<c;s=256*s+e[t+d],d+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=u}return(p?-1:1)*s*Math.pow(2,o-n)},i.write=function(e,t,i,n,r,o){var s,a,l,u=8*o-r-1,c=(1<<u)-1,d=c>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),2<=(t+=1<=s+d?h/l:h*Math.pow(2,1-d))*l&&(s++,l/=2),c<=s+d?(a=0,s=c):1<=s+d?(a=(t*l-1)*Math.pow(2,r),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,r),s=0));8<=r;e[i+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,u+=r;0<u;e[i+p]=255&s,p+=f,s/=256,u-=8);e[i+p-f]|=128*g}},{}],24:[function(e,t,i){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},{}],25:[function(e,t,i){},{}],26:[function(Fe,i,e){(function(xe,ke,_e){!function(){var be=void 0!==xe&&xe.versions&&xe.versions.node,we=!be&&("undefined"!=typeof window||"undefined"!=typeof self);we&&void 0===ke&&("undefined"!=typeof window?ke=window:"undefined"!=typeof self?ke=self:"undefined"!=typeof $&&(ke=$));var e=function(O){function e(){}O.compact=function(e,c,r,d){if(arguments.length<2)return O.nextTick(function(){d(new TypeError("Could not compact, too few arguments."))});if("function"==typeof r&&(d=r,r={}),r=r||{},null===c)return O.nextTick(function(){d(new D("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"}))});if(null===e)return O.nextTick(function(){d(null,null)});"base"in r||(r.base="string"==typeof e?e:""),"compactArrays"in r||(r.compactArrays=!0),"graph"in r||(r.graph=!1),"skipExpansion"in r||(r.skipExpansion=!1),"documentLoader"in r||(r.documentLoader=O.loadDocument),"link"in r||(r.link=!1),r.link&&(r.skipExpansion=!0);!function(e,t,i){if(t.skipExpansion)return O.nextTick(function(){i(null,e)});O.expand(e,t,i)}(e,r,function(e,n){if(e)return d(new D("Could not expand input before compaction.","jsonld.CompactError",{cause:e}));var t=G(r);O.processContext(t,c,r,function(e,t){if(e)return d(new D("Could not process context before compaction.","jsonld.CompactError",{cause:e}));var i;try{i=(new h).compact(t,null,n,r)}catch(e){return d(e)}!function(e,t,i,n){if(e)return d(e);n.compactArrays&&!n.graph&&K(t)?1===t.length?t=t[0]:0===t.length&&(t={}):n.graph&&W(t)&&(t=[t]);W(c)&&"@context"in c&&(c=c["@context"]);K(c=le(c))||(c=[c]);var r=c;c=[];for(var o=0;o<r.length;++o)(!W(r[o])||0<Object.keys(r[o]).length)&&c.push(r[o]);var s=0<c.length;1===c.length&&(c=c[0]);if(K(t)){var a=z(i,"@graph"),l=t;t={},s&&(t["@context"]=c),t[a]=l}else if(W(t)&&s){var l=t;for(var u in t={"@context":c},l)t[u]=l[u]}d(null,t,i)}(null,i,t,r)})})},O.expand=function(i,a,l){if(arguments.length<1)return O.nextTick(function(){l(new TypeError("Could not expand, too few arguments."))});function n(e){"base"in a||(a.base=e.documentUrl||"");var t={document:le(e.document),remoteContext:{"@context":e.contextUrl}};if("expandContext"in a){var i=le(a.expandContext);t.expandContext="object"==typeof i&&"@context"in i?i:{"@context":i}}ce(t,a,function(e,t){if(e)return l(e);var i;try{var n=new h,r=G(a),o=t.document,s=t.remoteContext["@context"];t.expandContext&&(r=n.processContext(r,t.expandContext["@context"],a)),s&&(r=n.processContext(r,s,a)),W(i=n.expand(r,null,o,a,!1))&&"@graph"in i&&1===Object.keys(i).length?i=i["@graph"]:null===i&&(i=[]),K(i)||(i=[i])}catch(e){return l(e)}l(null,i)})}"function"==typeof a&&(l=a,a={}),"documentLoader"in(a=a||{})||(a.documentLoader=O.loadDocument),"keepFreeFloatingNodes"in a||(a.keepFreeFloatingNodes=!1),O.nextTick(function(){if("string"!=typeof i)n({contextUrl:null,documentUrl:null,document:i});else{var e=function(e,t){if(e)return l(e);try{if(!t.document)throw new D("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return l(new D("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}n(t)},t=a.documentLoader(i,e);t&&"then"in t&&t.then(e.bind(null,null),e)}})},O.flatten=function(e,n,r,o){if(arguments.length<1)return O.nextTick(function(){o(new TypeError("Could not flatten, too few arguments."))});"function"==typeof r?(o=r,r={}):"function"==typeof n&&(o=n,n=null,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=O.loadDocument),O.expand(e,r,function(e,t){if(e)return o(new D("Could not expand input before flattening.","jsonld.FlattenError",{cause:e}));var i;try{i=(new h).flatten(t)}catch(e){return o(e)}if(null===n)return o(null,i);r.graph=!0,r.skipExpansion=!0,O.compact(i,n,r,function(e,t){if(e)return o(new D("Could not compact flattened output.","jsonld.FlattenError",{cause:e}));o(null,t)})})},O.frame=function(i,n,s,a){if(arguments.length<2)return O.nextTick(function(){a(new TypeError("Could not frame, too few arguments."))});function r(e){var o,t=e.document;t?(o=t["@context"],e.contextUrl?(o?K(o)?o.push(e.contextUrl):o=[o,e.contextUrl]:o=e.contextUrl,t["@context"]=o):o=o||{}):o={},O.expand(i,s,function(e,n){if(e)return a(new D("Could not expand input before framing.","jsonld.FrameError",{cause:e}));var r=le(s);r.isFrame=!0,r.keepFreeFloatingNodes=!0,O.expand(t,r,function(e,t){if(e)return a(new D("Could not expand frame before framing.","jsonld.FrameError",{cause:e}));var i;try{i=(new h).frame(n,t,r)}catch(e){return a(e)}r.graph=!0,r.skipExpansion=!0,r.link={},O.compact(i,o,r,function(e,t,i){if(e)return a(new D("Could not compact framed output.","jsonld.FrameError",{cause:e}));var n=z(i,"@graph");r.link={},t[n]=function e(t,i,n){if(K(i)){for(var r=[],o=0;o<i.length;++o){var s=e(t,i[o],n);null!==s&&r.push(s)}i=r}else if(W(i)){if("@preserve"in i)return"@null"===i["@preserve"]?null:i["@preserve"];if(re(i))return i;if(oe(i))return i["@list"]=e(t,i["@list"],n),i;var a=z(t,"@id");if(a in i){var l=i[a];if(l in n.link){var u=n.link[l].indexOf(i);if(-1!==u)return n.link[l][u];n.link[l].push(i)}else n.link[l]=[i]}for(var c in i){var s=e(t,i[c],n),d=O.getContextValue(t,c,"@container");n.compactArrays&&K(s)&&1===s.length&&null===d&&(s=s[0]),i[c]=s}}return i}(i,t[n],r),a(null,t)})})})}"function"==typeof s&&(a=s,s={}),"base"in(s=s||{})||(s.base="string"==typeof i?i:""),"documentLoader"in s||(s.documentLoader=O.loadDocument),"embed"in s||(s.embed="@last"),s.explicit=s.explicit||!1,"requireAll"in s||(s.requireAll=!0),s.omitDefault=s.omitDefault||!1,O.nextTick(function(){if("string"!=typeof n)r({contextUrl:null,documentUrl:null,document:n});else{var e=function(e,t){if(e)return a(e);try{if(!t.document)throw new D("No remote document found at the given URL.","jsonld.NullRemoteDocument");"string"==typeof t.document&&(t.document=JSON.parse(t.document))}catch(e){return a(new D("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:t}))}r(t)},t=s.documentLoader(n,e);t&&"then"in t&&t.then(e.bind(null,null),e)}})},O.link=function(e,t,i,n){var r={};t&&(r["@context"]=t),r["@embed"]="@link",O.frame(e,r,i,n)},O.objectify=function(e,n,r,o){"function"==typeof r&&(o=r,r={}),"base"in(r=r||{})||(r.base="string"==typeof e?e:""),"documentLoader"in r||(r.documentLoader=O.loadDocument),O.expand(e,r,function(e,t){if(e)return o(new D("Could not expand input before linking.","jsonld.LinkError",{cause:e}));var i;try{i=(new h).flatten(t)}catch(e){return o(e)}r.graph=!0,r.skipExpansion=!0,O.compact(i,n,r,function(e,t,s){if(e)return o(new D("Could not compact flattened output before linking.","jsonld.LinkError",{cause:e}));var a=t[z(s,"@graph")][0],l=function(e){if(W(e)||K(e)){if(W(e)){if(l.visited[e["@id"]])return;l.visited[e["@id"]]=!0}for(var t in e){var i=e[t],n="@id"===O.getContextValue(s,t,"@type");if(K(i)||W(i)||n)if(Y(i)&&n)e[t]=i=a[i],l(i);else if(K(i))for(var r=0;r<i.length;++r)Y(i[r])&&n?i[r]=a[i[r]]:W(i[r])&&"@id"in i[r]&&(i[r]=a[i[r]["@id"]]),l(i[r]);else if(W(i)){var o=i["@id"];e[t]=i=a[o],l(i)}}}};for(var i in l.visited={},l(a),t.of_type={},a)if("@type"in a[i]){var n=a[i]["@type"];K(n)||(n=[n]);for(var r=0;r<n.length;++r)n[r]in t.of_type||(t.of_type[n[r]]=[]),t.of_type[n[r]].push(a[i])}o(null,t)})})},O.normalize=function(e,i,n){if(arguments.length<1)return O.nextTick(function(){n(new TypeError("Could not normalize, too few arguments."))});if("function"==typeof i&&(n=i,i={}),"algorithm"in(i=i||{})||(i.algorithm="URGNA2012"),"base"in i||(i.base="string"==typeof e?e:""),"documentLoader"in i||(i.documentLoader=O.loadDocument),"inputFormat"in i){if("application/nquads"!==i.inputFormat)return n(new D("Unknown normalization input format.","jsonld.NormalizeError"));var t=de(e);(new h).normalize(t,i,n)}else{var r=le(i);delete r.format,r.produceGeneralizedRdf=!1,O.toRDF(e,r,function(e,t){if(e)return n(new D("Could not convert input to RDF dataset before normalization.","jsonld.NormalizeError",{cause:e}));(new h).normalize(t,i,n)})}},O.fromRDF=function(t,r,o){if(arguments.length<1)return O.nextTick(function(){o(new TypeError("Could not convert from RDF, too few arguments."))});"function"==typeof r&&(o=r,r={}),"useRdfType"in(r=r||{})||(r.useRdfType=!1),"useNativeTypes"in r||(r.useNativeTypes=!1),"format"in r||!Y(t)||"format"in r||(r.format="application/nquads"),O.nextTick(function(){var e;if(r.format){if(!(e=r.rdfParser||s[r.format]))return o(new D("Unknown input format.","jsonld.UnknownFormat",{format:r.format}))}else e=function(){return t};var i=!1;try{t=e(t,function(e,t){if(i=!0,e)return o(e);n(t,r,o)})}catch(e){if(!i)return o(e);throw e}if(t){if("then"in t)return t.then(function(e){n(e,r,o)},o);n(t,r,o)}function n(e,t,i){(new h).fromRDF(e,t,i)}})},O.toRDF=function(e,n,r){if(arguments.length<1)return O.nextTick(function(){r(new TypeError("Could not convert to RDF, too few arguments."))});"function"==typeof n&&(r=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=O.loadDocument),O.expand(e,n,function(e,t){if(e)return r(new D("Could not expand input before serialization to RDF.","jsonld.RdfError",{cause:e}));var i;try{if(i=h.prototype.toRDF(t,n),n.format){if("application/nquads"===n.format)return r(null,function(e){var t=[];for(var i in e)for(var n=e[i],r=0;r<n.length;++r){var o=n[r];"@default"===i&&(i=null),t.push(he(o,i))}return t.sort().join("")}(i));throw new D("Unknown output format.","jsonld.UnknownFormat",{format:n.format})}}catch(e){return r(e)}r(null,i)})},O.createNodeMap=function(e,n,r){if(arguments.length<1)return O.nextTick(function(){r(new TypeError("Could not create node map, too few arguments."))});"function"==typeof n&&(r=n,n={}),"base"in(n=n||{})||(n.base="string"==typeof e?e:""),"documentLoader"in n||(n.documentLoader=O.loadDocument),O.expand(e,n,function(e,t){if(e)return r(new D("Could not expand input before creating node map.","jsonld.CreateNodeMapError",{cause:e}));var i;try{i=(new h).createNodeMap(t,n)}catch(e){return r(e)}r(null,i)})},O.merge=function(e,v,m,y){if(arguments.length<1)return O.nextTick(function(){y(new TypeError("Could not merge, too few arguments."))});if(!K(e))return O.nextTick(function(){y(new TypeError('Could not merge, "docs" must be an array.'))});"function"==typeof m?(y=m,m={}):"function"==typeof v&&(y=v,v=null,m={}),m=m||{};for(var i=[],n=null,r=e.length,t=0;t<e.length;++t){var o={};for(var s in m)o[s]=m[s];O.expand(e[t],o,a)}function a(e,t){if(!n){if(e)return y(new D("Could not expand input before flattening.","jsonld.FlattenError",{cause:n=e}));i.push(t),0==--r&&function(e){var t=!0;"mergeNodes"in m&&(t=m.mergeNodes);var i,n=m.namer||m.issuer||new pe("_:b"),r={"@default":{}};try{for(var o=0;o<e.length;++o){var s=e[o];s=O.relabelBlankNodes(s,{issuer:new pe("_:b"+o+"-")});var a=t||0===o?r:{"@default":{}};if(S(s,a,"@default",n),a!==r)for(var l in a){var u=a[l];if(l in r){var c=r[l];for(var d in u)d in c||(c[d]=u[d])}else r[l]=u}}i=C(r)}catch(e){return y(e)}for(var h=[],p=Object.keys(i).sort(),f=0;f<p.length;++f){var g=i[p[f]];ne(g)||h.push(g)}if(null===v)return y(null,h);m.graph=!0,m.skipExpansion=!0,O.compact(h,v,m,function(e,t){if(e)return y(new D("Could not compact merged output.","jsonld.MergeError",{cause:e}));y(null,t)})}(i)}}},O.relabelBlankNodes=function(e,t){return function e(t,i){if(K(i))for(var n=0;n<i.length;++n)i[n]=e(t,i[n]);else if(oe(i))i["@list"]=e(t,i["@list"]);else if(W(i)){se(i)&&(i["@id"]=t.getId(i["@id"]));for(var r=Object.keys(i).sort(),o=0;o<r.length;++o){var s=r[o];"@id"!==s&&(i[s]=e(t,i[s]))}}return i}((t=t||{}).namer||t.issuer||new pe("_:b"),e)},O.prependBase=function(e,t){return function(e,t){if(null===e)return t;if(-1!==t.indexOf(":"))return t;Y(e)&&(e=O.url.parse(e||""));var i=O.url.parse(t),n={protocol:e.protocol||""};if(null!==i.authority)n.authority=i.authority,n.path=i.path,n.query=i.query;else if(n.authority=e.authority,""===i.path)n.path=e.path,null!==i.query?n.query=i.query:n.query=e.query;else{if(0===i.path.indexOf("/"))n.path=i.path;else{var r=e.path;""!==i.path&&(0<(r=r.substr(0,r.lastIndexOf("/")+1)).length&&"/"!==r.substr(-1)&&(r+="/"),r+=i.path),n.path=r}n.query=i.query}n.path=me(n.path,!!n.authority);var o=n.protocol;null!==n.authority&&(o+="//"+n.authority);o+=n.path,null!==n.query&&(o+="?"+n.query);null!==i.fragment&&(o+="#"+i.fragment);""===o&&(o="./");return o}(e,t)},O.documentLoader=function(e,t){var i=new D("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed"});return be?t(i,{contextUrl:null,documentUrl:e,document:null}):O.promisify(function(e){e(i)})},O.loadDocument=function(e,t){var i=O.documentLoader(e,t);i&&"then"in i&&i.then(t.bind(null,null),t)},O.promises=function(e){e=e||{};var i=Array.prototype.slice,n=O.promisify,t=e.api||{},r=e.version||"jsonld.js";"string"==typeof e.api&&(e.version||(r=e.api),t={}),t.expand=function(e){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");return n.apply(null,[O.expand].concat(i.call(arguments)))},t.compact=function(e,t){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");return n.apply(null,[function(e,t,i,n){O.compact(e,t,i,function(e,t){n(e,t)})}].concat(i.call(arguments)))},t.flatten=function(e){if(arguments.length<1)throw new TypeError("Could not flatten, too few arguments.");return n.apply(null,[O.flatten].concat(i.call(arguments)))},t.frame=function(e,t){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");return n.apply(null,[O.frame].concat(i.call(arguments)))},t.fromRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");return n.apply(null,[O.fromRDF].concat(i.call(arguments)))},t.toRDF=function(e){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");return n.apply(null,[O.toRDF].concat(i.call(arguments)))},t.normalize=function(e){if(arguments.length<1)throw new TypeError("Could not normalize, too few arguments.");return n.apply(null,[O.normalize].concat(i.call(arguments)))},"jsonld.js"===r&&(t.link=function(e,t){if(arguments.length<2)throw new TypeError("Could not link, too few arguments.");return n.apply(null,[O.link].concat(i.call(arguments)))},t.objectify=function(e){return n.apply(null,[O.objectify].concat(i.call(arguments)))},t.createNodeMap=function(e){return n.apply(null,[O.createNodeMap].concat(i.call(arguments)))},t.merge=function(e){return n.apply(null,[O.merge].concat(i.call(arguments)))});try{O.Promise=ke.Promise||Fe("es6-promise").Promise}catch(e){var o=function(){throw new Error("Unable to find a Promise implementation.")};for(var s in t)t[s]=o}return t},O.promisify=function(e){if(!O.Promise)try{O.Promise=ke.Promise||Fe("es6-promise").Promise}catch(e){throw new Error("Unable to find a Promise implementation.")}var t=Array.prototype.slice.call(arguments,1);return new O.Promise(function(i,n){e.apply(null,t.concat(function(e,t){e?n(e):i(t)}))})},O.promises({api:O.promises}),(e.prototype=O.promises({version:"json-ld-1.0"})).toString=function(){return this instanceof e?"[object JsonLdProcessor]":"[object JsonLdProcessorPrototype]"},O.JsonLdProcessor=e;var t=!!Object.defineProperty;if(t)try{Object.defineProperty({},"x",{})}catch(e){t=!1}t&&(Object.defineProperty(e,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(e.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:e})),we&&void 0===ke.JsonLdProcessor&&(t?Object.defineProperty(ke,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e}):ke.JsonLdProcessor=e);var i="function"==typeof setImmediate&&setImmediate,n=i?function(e){i(e)}:function(e){setTimeout(e,0)};"object"==typeof xe&&"function"==typeof xe.nextTick?O.nextTick=xe.nextTick:O.nextTick=n,O.setImmediate=i?n:O.nextTick,O.parseLinkHeader=function(e){for(var t={},i=e.match(/(?:<[^>]*?>|"[^"]*?"|[^,])+/g),n=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,r=0;r<i.length;++r){var o=i[r].match(n);if(o){for(var s={target:o[1]},a=o[2],l=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g;o=l.exec(a);)s[o[1]]=void 0===o[2]?o[3]:o[2];var u=s.rel||"";K(t[u])?t[u].push(s):t[u]=u in t?[t[u],s]:s}}return t},O.RequestQueue=function(){this._requests={}},O.RequestQueue.prototype.wrapLoader=function(e){return this._loader=e,this._usePromise=1===e.length,this.add.bind(this)},O.RequestQueue.prototype.add=function(r,e){var o=this;if(!e&&!o._usePromise)throw new Error("callback must be specified.");if(o._usePromise)return new O.Promise(function(t,i){var e=o._requests[r];e||(e=o._requests[r]=o._loader(r).then(function(e){return delete o._requests[r],e}).catch(function(e){throw delete o._requests[r],e})),e.then(function(e){t(e)}).catch(function(e){i(e)})});r in o._requests?o._requests[r].push(e):(o._requests[r]=[e],o._loader(r,function(e,t){var i=o._requests[r];delete o._requests[r];for(var n=0;n<i.length;++n)i[n](e,t)}))},O.DocumentCache=function(e){this.order=[],this.cache={},this.size=e||50,this.expires=3e4},O.DocumentCache.prototype.get=function(e){if(e in this.cache){var t=this.cache[e];if(t.expires>=+new Date)return t.ctx;delete this.cache[e],this.order.splice(this.order.indexOf(e),1)}return null},O.DocumentCache.prototype.set=function(e,t){this.order.length===this.size&&delete this.cache[this.order.shift()],this.order.push(e),this.cache[e]={ctx:t,expires:+new Date+this.expires}},O.ActiveContextCache=function(e){this.order=[],this.cache={},this.size=e||100},O.ActiveContextCache.prototype.get=function(e,t){var i=JSON.stringify(e),n=JSON.stringify(t),r=this.cache[i];return r&&n in r?r[n]:null},O.ActiveContextCache.prototype.set=function(e,t,i){if(this.order.length===this.size){var n=this.order.shift();delete this.cache[n.activeCtx][n.localCtx]}var r=JSON.stringify(e),o=JSON.stringify(t);this.order.push({activeCtx:r,localCtx:o}),r in this.cache||(this.cache[r]={}),this.cache[r][o]=le(i)},O.cache={activeCtx:new O.ActiveContextCache},O.documentLoaders={},O.documentLoaders.jquery=function(e,t){t=t||{};var i=new O.RequestQueue;return("usePromise"in t?t.usePromise:"undefined"!=typeof Promise)?i.wrapLoader(function(e){return O.promisify(n,e)}):i.wrapLoader(n);function n(s,a){return 0!==s.indexOf("http:")&&0!==s.indexOf("https:")?a(new D('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:s}),{contextUrl:null,documentUrl:s,document:null}):t.secure&&0!==s.indexOf("https")?a(new D('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:s}),{contextUrl:null,documentUrl:s,document:null}):void e.ajax({url:s,accepts:{json:"application/ld+json, application/json"},headers:{Accept:"application/ld+json, application/json"},dataType:"json",crossDomain:!0,success:function(e,t,i){var n={contextUrl:null,documentUrl:s,document:e},r=i.getResponseHeader("Content-Type"),o=i.getResponseHeader("Link");if(o&&"application/ld+json"!==r){if(K(o=O.parseLinkHeader(o)[p]))return a(new D("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:s}),n);o&&(n.contextUrl=o.target)}a(null,n)},error:function(e,t,i){a(new D("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:s,cause:i}),{contextUrl:null,documentUrl:s,document:null})}})}},O.documentLoaders.node=function(i){var n=!("strictSSL"in(i=i||{}))||i.strictSSL,u="maxRedirects"in i?i.maxRedirects:-1,r="request"in i?i.request:Fe("request"),c="application/ld+json, application/json",d=Fe("http"),e=new O.RequestQueue;if(i.usePromise)return e.wrapLoader(function(e){return O.promisify(h,e,[])});var t=i.headers||{};if("Accept"in t||"accept"in t)throw new RangeError('Accept header may not be specified as an option; only "'+c+'" is supported.');return e.wrapLoader(function(e,t){h(e,[],t)});function h(o,s,a){if(0!==o.indexOf("http:")&&0!==o.indexOf("https:"))return a(new D('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:o}),{contextUrl:null,documentUrl:o,document:null});if(i.secure&&0!==o.indexOf("https"))return a(new D('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:o}),{contextUrl:null,documentUrl:o,document:null});var l=null;if(null!==l)return a(null,l);var e={Accept:c};for(var t in i.headers)e[t]=i.headers[t];r({url:o,headers:e,strictSSL:n,followRedirect:!1},function(e,t,i){if(l={contextUrl:null,documentUrl:o,document:i||null},e)return a(new D("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:o,cause:e}),l);var n=d.STATUS_CODES[t.statusCode];if(400<=t.statusCode)return a(new D("URL could not be dereferenced: "+n,"jsonld.InvalidUrl",{code:"loading document failed",url:o,httpStatusCode:t.statusCode}),l);if(t.headers.link&&"application/ld+json"!==t.headers["content-type"]){var r=O.parseLinkHeader(t.headers.link)[p];if(K(r))return a(new D("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:o}),l);r&&(l.contextUrl=r.target)}if(300<=t.statusCode&&t.statusCode<400&&t.headers.location)return s.length===u?a(new D("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:o,httpStatusCode:t.statusCode,redirects:s}),l):-1!==s.indexOf(o)?a(new D("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:o,httpStatusCode:t.statusCode,redirects:s}),l):(s.push(o),h(t.headers.location,s,a));s.push(o),a(e,l)})}},O.documentLoaders.xhr=function(e){e=e||{};var s=/(^|(\r\n))link:/i,t=new O.RequestQueue;return("usePromise"in e?e.usePromise:"undefined"!=typeof Promise)?t.wrapLoader(function(e){return O.promisify(i,e)}):t.wrapLoader(i);function i(n,r){if(0!==n.indexOf("http:")&&0!==n.indexOf("https:"))return r(new D('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null});if(e.secure&&0!==n.indexOf("https"))return r(new D('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null});var o=new(e.xhr||XMLHttpRequest);o.onload=function(){if(400<=o.status)return r(new D("URL could not be dereferenced: "+o.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:n,httpStatusCode:o.status}),{contextUrl:null,documentUrl:n,document:null});var e,t={contextUrl:null,documentUrl:n,document:o.response},i=o.getResponseHeader("Content-Type");if(s.test(o.getAllResponseHeaders())&&(e=o.getResponseHeader("Link")),e&&"application/ld+json"!==i){if(K(e=O.parseLinkHeader(e)[p]))return r(new D("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:n}),t);e&&(t.contextUrl=e.target)}r(null,t)},o.onerror=function(){r(new D("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:n}),{contextUrl:null,documentUrl:n,document:null})},o.open("GET",n,!0),o.setRequestHeader("Accept","application/ld+json, application/json"),o.send()}},O.useDocumentLoader=function(e){if(!(e in O.documentLoaders))throw new D('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});O.documentLoader=O.documentLoaders[e].apply(O,Array.prototype.slice.call(arguments,1))},O.processContext=function(i,e){var n={},t=2;3<arguments.length&&(n=arguments[2]||{},t+=1);var r=arguments[t];if("base"in n||(n.base=""),"documentLoader"in n||(n.documentLoader=O.loadDocument),null===e)return r(null,G(n));W(e=le(e))&&"@context"in e||(e={"@context":e}),ce(e,n,function(e,t){if(e)return r(e);try{t=(new h).processContext(i,t,n)}catch(e){return r(e)}r(null,t)})},O.hasProperty=function(e,t){var i=!1;if(t in e){var n=e[t];i=!K(n)||0<n.length}return i},O.hasValue=function(e,t,i){var n=!1;if(O.hasProperty(e,t)){var r=e[t],o=oe(r);if(K(r)||o){o&&(r=r["@list"]);for(var s=0;s<r.length;++s)if(O.compareValues(i,r[s])){n=!0;break}}else K(i)||(n=O.compareValues(i,r))}return n},O.addValue=function(e,t,i,n){if("propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1),"allowDuplicate"in n||(n.allowDuplicate=!0),K(i)){0!==i.length||!n.propertyIsArray||t in e||(e[t]=[]);for(var r=0;r<i.length;++r)O.addValue(e,t,i[r],n)}else if(t in e){var o=!n.allowDuplicate&&O.hasValue(e,t,i);K(e[t])||o&&!n.propertyIsArray||(e[t]=[e[t]]),o||e[t].push(i)}else e[t]=n.propertyIsArray?[i]:i},O.getValues=function(e,t){var i=e[t]||[];return K(i)||(i=[i]),i},O.removeProperty=function(e,t){delete e[t]},O.removeValue=function(e,t,i,n){"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);var r=O.getValues(e,t).filter(function(e){return!O.compareValues(e,i)});0===r.length?O.removeProperty(e,t):1!==r.length||n.propertyIsArray?e[t]=r:e[t]=r[0]},O.compareValues=function(e,t){return e===t||(!(!re(e)||!re(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(W(e)&&"@id"in e&&W(t)&&"@id"in t)&&e["@id"]===t["@id"])},O.getContextValue=function(e,t,i){var n=null;if(null===t)return n;if("@language"===i&&i in e&&(n=e[i]),e.mappings[t]){var r=e.mappings[t];te(i)?n=r:i in r&&(n=r[i])}return n};var s={};if(O.registerRDFParser=function(e,t){s[e]=t},O.unregisterRDFParser=function(e){delete s[e]},be){if(void 0===g)var g=null;if(void 0===v)var v={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}var a="http://www.w3.org/2001/XMLSchema#boolean",l="http://www.w3.org/2001/XMLSchema#double",u="http://www.w3.org/2001/XMLSchema#integer",m="http://www.w3.org/2001/XMLSchema#string",r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",N=r+"first",L=r+"rest",M=r+"nil",P=r+"type",y=r+"langString",p="http://www.w3.org/ns/json-ld#context",f=10,D=function(e,t,i){be?(Error.call(this),Error.captureStackTrace(this,this.constructor)):"undefined"!=typeof Error&&(this.stack=(new Error).stack),this.name=t||"jsonld.Error",this.message=e||"An unspecified JSON-LD error occurred.",this.details=i||{}};be?Fe("util").inherits(D,Error):"undefined"!=typeof Error&&(D.prototype=new Error);var h=function(){};function T(e){for(var t=[],i=Object.keys(e).sort(),n=0;n<i.length;++n){var r=i[n],o=e[r];K(o)||(o=[o]);for(var s=0;s<o.length;++s){var a=o[s];if(null!==a){if(!Y(a))throw new D("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:e});t.push({"@value":a,"@language":r.toLowerCase()})}}}return t}function c(e,t,i){for(var n=[],r=Object.keys(e).sort(),o=0;o<r.length;++o)for(var s=r[o],a=e[s],l=Object.keys(a).sort(),u=0;u<l.length;++u){var c=l[u],d=a[c];if("@type"===c)c=P;else if(X(c))continue;for(var h=0;h<d.length;++h){var p=d[h],f={};if(f.type=0===s.indexOf("_:")?"blank node":"IRI",ae(f.value=s)){var g={};if(g.type=0===c.indexOf("_:")?"blank node":"IRI",ae(g.value=c)&&("blank node"!==g.type||i.produceGeneralizedRdf))if(oe(p))b(p["@list"],t,f,g,n);else{var v=w(p);v&&n.push({subject:f,predicate:g,object:v})}}}}return n}function b(e,t,i,n,r){for(var o={type:"IRI",value:N},s={type:"IRI",value:L},a={type:"IRI",value:M},l=0;l<e.length;++l){var u=e[l],c={type:"blank node",value:t.getId()};r.push({subject:i,predicate:n,object:c}),i=c,n=o;var d=w(u);d&&r.push({subject:i,predicate:n,object:d}),n=s}r.push({subject:i,predicate:n,object:a})}function w(e){var t,i={};if(re(e)){i.type="literal";var n=e["@value"],r=e["@type"]||null;"boolean"==typeof(t=n)||"[object Boolean]"===Object.prototype.toString.call(t)?(i.value=n.toString(),i.datatype=r||a):ee(n)||r===l?(ee(n)||(n=parseFloat(n)),i.value=n.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),i.datatype=r||l):Z(n)?(i.value=n.toFixed(0),i.datatype=r||u):"@language"in e?(i.value=n,i.datatype=r||y,i.language=e["@language"]):(i.value=n,i.datatype=r||m)}else{var o=W(e)?e["@id"]:e;i.type=0===o.indexOf("_:")?"blank node":"IRI",i.value=o}return"IRI"!==i.type||ae(i.value)?i:null}function U(e,t){if("IRI"===e.type||"blank node"===e.type)return{"@id":e.value};var i,n={"@value":e.value};if(e.language)n["@language"]=e.language;else{var r=e.datatype;if(r||(r=m),t){if(r===a)"true"===n["@value"]?n["@value"]=!0:"false"===n["@value"]&&(n["@value"]=!1);else if(i=n["@value"],!isNaN(parseFloat(i))&&isFinite(i))if(r===u){var o=parseInt(n["@value"],10);o.toFixed(0)===n["@value"]&&(n["@value"]=o)}else r===l&&(n["@value"]=parseFloat(n["@value"]));-1===[a,u,l,m].indexOf(r)&&(n["@type"]=r)}else r!==m&&(n["@type"]=r)}return n}function x(e,t){for(var i=["subject","predicate","object"],n=0;n<i.length;++n){var r=i[n];if(e[r].type!==t[r].type||e[r].value!==t[r].value)return!1}return e.object.language===t.object.language&&e.object.datatype===t.object.datatype}h.prototype.compact=function(e,t,i,n){if(K(i)){for(var r=[],o=0;o<i.length;++o){var s=this.compact(e,t,i[o],n);null!==s&&r.push(s)}if(n.compactArrays&&1===r.length)null===(x=O.getContextValue(e,t,"@container"))&&(r=r[0]);return r}if(W(i)){if(n.link&&"@id"in i&&i["@id"]in n.link){var a=n.link[i["@id"]];for(o=0;o<a.length;++o)if(a[o].expanded===i)return a[o].compacted}if(re(i)||ne(i)){r=function(e,t,i){if(re(i)){var n=O.getContextValue(e,t,"@type"),r=O.getContextValue(e,t,"@language"),o=O.getContextValue(e,t,"@container"),s="@index"in i&&"@index"!==o;if(!s&&(i["@type"]===n||i["@language"]===r))return i["@value"];var a=Object.keys(i).length,l=1===a||2===a&&"@index"in i&&!s,u="@language"in e,c=Y(i["@value"]),d=e.mappings[t]&&null===e.mappings[t]["@language"];if(l&&(!u||!c||d))return i["@value"];var h={};return s&&(h[z(e,"@index")]=i["@index"]),"@type"in i?h[z(e,"@type")]=z(e,i["@type"],null,{vocab:!0}):"@language"in i&&(h[z(e,"@language")]=i["@language"]),h[z(e,"@value")]=i["@value"],h}var p=H(e,t,{vocab:!0}),n=O.getContextValue(e,t,"@type"),f=z(e,i["@id"],null,{vocab:"@vocab"===n});return"@id"!==n&&"@vocab"!==n&&"@graph"!==p?((h={})[z(e,"@id")]=f,h):f}(e,t,i);return n.link&&ne(i)&&(i["@id"]in n.link||(n.link[i["@id"]]=[]),n.link[i["@id"]].push({expanded:i,compacted:r})),r}var l="@reverse"===t;r={};n.link&&"@id"in i&&(i["@id"]in n.link||(n.link[i["@id"]]=[]),n.link[i["@id"]].push({expanded:i,compacted:r}));for(var u=Object.keys(i).sort(),c=0;c<u.length;++c){var d=u[c],h=i[d];if("@id"!==d&&"@type"!==d)if("@reverse"!==d)if("@index"!==d)if("@graph"!==d&&"@list"!==d&&X(d)){F=z(e,d);O.addValue(r,F,h)}else{if(0===h.length){var p=z(e,d,h,{vocab:!0},l);O.addValue(r,p,h,{propertyIsArray:!0})}for(E=0;E<h.length;++E){var f=h[E],g=(p=z(e,d,f,{vocab:!0},l),x=O.getContextValue(e,p,"@container"),oe(f)),v=null;g&&(v=f["@list"]);var m=this.compact(e,p,g?v:f,n);if(g)if(K(m)||(m=[m]),"@list"!==x){var y={};y[z(e,"@list")]=m,m=y,"@index"in f&&(m[z(e,"@index")]=f["@index"])}else if(p in r)throw new D('JSON-LD compact error; property has a "@list" @container rule but there is more than a single @list that matches the compacted term in the document. Compaction might mix unwanted items into the list.',"jsonld.SyntaxError",{code:"compaction to list of lists"});if("@language"===x||"@index"===x){var b;p in r?b=r[p]:r[p]=b={},"@language"===x&&re(m)&&(m=m["@value"]),O.addValue(b,f[x],m)}else{T=!n.compactArrays||"@set"===x||"@list"===x||K(m)&&0===m.length||"@list"===d||"@graph"===d;O.addValue(r,p,m,{propertyIsArray:T})}}}else{if("@index"===(x=O.getContextValue(e,t,"@container")))continue;F=z(e,d);O.addValue(r,F,h)}else{C=this.compact(e,"@reverse",h,n);for(var w in C)if(e.mappings[w]&&e.mappings[w].reverse){var x,k=C[w],_="@set"===(x=O.getContextValue(e,w,"@container"))||!n.compactArrays;O.addValue(r,w,k,{propertyIsArray:_}),delete C[w]}if(0<Object.keys(C).length){var F=z(e,d);O.addValue(r,F,C)}}else{var C;if(Y(h))C=z(e,h,null,{vocab:"@type"===d});else{C=[];for(var E=0;E<h.length;++E)C.push(z(e,h[E],null,{vocab:!0}))}var F=z(e,d),T=K(C)&&0===h.length;O.addValue(r,F,C,{propertyIsArray:T})}}return r}return i},h.prototype.expand=function(l,e,t,u,i){var c=this;if(null==t)return null;if(!K(t)&&!W(t))return i||null!==e&&"@graph"!==H(l,e,{vocab:!0})?function(e,t,i){if(null==i)return null;var n=H(e,t,{vocab:!0});{if("@id"===n)return H(e,i,{base:!0});if("@type"===n)return H(e,i,{vocab:!0,base:!0})}var r=O.getContextValue(e,t,"@type");if("@id"===r||"@graph"===n&&Y(i))return{"@id":H(e,i,{base:!0})};if("@vocab"===r)return{"@id":H(e,i,{vocab:!0,base:!0})};if(X(n))return i;var o={};if(null!==r)o["@type"]=r;else if(Y(i)){var s=O.getContextValue(e,t,"@language");null!==s&&(o["@language"]=s)}-1===["boolean","number","string"].indexOf(typeof i)&&(i=i.toString());return o["@value"]=i,o}(l,e,t):null;if(K(t)){var n=[],r=O.getContextValue(l,e,"@container");i=i||"@list"===r;for(var o=0;o<t.length;++o){var s=c.expand(l,e,t[o],u);if(i&&(K(s)||oe(s)))throw new D("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"});null!==s&&(K(s)?n=n.concat(s):n.push(s))}return n}"@context"in t&&(l=c.processContext(l,t["@context"],u));for(var a=H(l,e,{vocab:!0}),d=(n={},Object.keys(t).sort()),h=0;h<d.length;++h){var p,f=d[h],g=t[f];if("@context"!==f){var v=H(l,f,{vocab:!0});if(null!==v&&(ae(v)||X(v))){if(X(v)){if("@reverse"===a)throw new D("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:g});if(v in n)throw new D("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:v})}if("@id"===v&&!Y(g)){if(!u.isFrame)throw new D('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:g});if(!W(g))throw new D('Invalid JSON-LD syntax; "@id" value must be a string or an object.',"jsonld.SyntaxError",{code:"invalid @id value",value:g})}if("@type"===v&&J(g),"@graph"===v&&!W(g)&&!K(g))throw new D('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:g});if("@value"===v&&(W(g)||K(g)))throw new D('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:g});if("@language"===v){if(null===g)continue;if(!Y(g))throw new D('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:g});g=g.toLowerCase()}if("@index"===v&&!Y(g))throw new D('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:g});if("@reverse"!==v){if("@language"===(r=O.getContextValue(l,f,"@container"))&&W(g))p=T(g);else if("@index"===r&&W(g))p=function(e){for(var t=[],i=Object.keys(g).sort(),n=0;n<i.length;++n){var r=i[n],o=g[r];K(o)||(o=[o]),o=c.expand(l,e,o,u,!1);for(var s=0;s<o.length;++s){var a=o[s];"@index"in a||(a["@index"]=r),t.push(a)}}return t}(f);else{var m="@list"===v;if(m||"@set"===v){var y=e;if(m&&"@graph"===a&&(y=null),p=c.expand(l,y,g,u,m),m&&oe(p))throw new D("Invalid JSON-LD syntax; lists of lists are not permitted.","jsonld.SyntaxError",{code:"list of lists"})}else p=c.expand(l,f,g,u,!1)}if(null!==p||"@value"===v)if("@list"===v||oe(p)||"@list"!==r||(p={"@list":p=K(p)?p:[p]}),l.mappings[f]&&l.mappings[f].reverse){x=n["@reverse"]=n["@reverse"]||{};K(p)||(p=[p]);for(_=0;_<p.length;++_){if(re(F=p[_])||oe(F))throw new D('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:p});O.addValue(x,v,F,{propertyIsArray:!0})}}else{var b=-1===["@index","@id","@type","@value","@language"].indexOf(v);O.addValue(n,v,p,{propertyIsArray:b})}}else{if(!W(g))throw new D('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:g});if("@reverse"in(p=c.expand(l,"@reverse",g,u)))for(var w in p["@reverse"])O.addValue(n,w,p["@reverse"][w],{propertyIsArray:!0});var x=n["@reverse"]||null;for(var w in p)if("@reverse"!==w){null===x&&(x=n["@reverse"]={}),O.addValue(x,w,[],{propertyIsArray:!0});for(var k=p[w],_=0;_<k.length;++_){var F;if(re(F=k[_])||oe(F))throw new D('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:p});O.addValue(x,w,F,{propertyIsArray:!0})}}}}}}var C=(d=Object.keys(n)).length;if("@value"in n){if("@type"in n&&"@language"in n)throw new D('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:n});var E=C-1;if("@type"in n&&(E-=1),"@index"in n&&(E-=1),"@language"in n&&(E-=1),0!==E)throw new D('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:n});if(null===n["@value"])n=null;else{if("@language"in n&&!Y(n["@value"]))throw new D("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:n});if("@type"in n&&(!ae(n["@type"])||0===n["@type"].indexOf("_:")))throw new D('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:n})}}else if("@type"in n&&!K(n["@type"]))n["@type"]=[n["@type"]];else if("@set"in n||"@list"in n){if(1<C&&!(2===C&&"@index"in n))throw new D('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:n});"@set"in n&&(n=n["@set"],C=(d=Object.keys(n)).length)}else 1===C&&"@language"in n&&(n=null);return!W(n)||u.keepFreeFloatingNodes||i||null!==e&&"@graph"!==a||(0===C||"@value"in n||"@list"in n||1===C&&"@id"in n)&&(n=null),n},h.prototype.createNodeMap=function(e,t){var i={"@default":{}};return S(e,i,"@default",(t=t||{}).namer||t.issuer||new pe("_:b")),C(i)},h.prototype.flatten=function(e){for(var t=this.createNodeMap(e),i=[],n=Object.keys(t).sort(),r=0;r<n.length;++r){var o=t[n[r]];ne(o)||i.push(o)}return i},h.prototype.frame=function(e,t,i){var n={options:i,graphs:{"@default":{},"@merged":{}},subjectStack:[],link:{}},r=new pe("_:b");S(e,n.graphs,"@merged",r),n.subjects=n.graphs["@merged"];var o=[];return function e(t,i,n,r,o){A(n);n=n[0];var s=t.options;var a={embed:I(n,s,"embed"),explicit:I(n,s,"explicit"),requireAll:I(n,s,"requireAll")};var l=$(t,i,n,a);var u=Object.keys(l).sort();for(var c=0;c<u.length;++c){var d=u[c],h=l[d];if("@link"===a.embed&&d in t.link)Q(r,o,t.link[d]);else{null===o&&(t.uniqueEmbeds={});var p={};if(p["@id"]=d,t.link[d]=p,"@never"===a.embed||j(h,t.subjectStack))Q(r,o,p);else{"@last"===a.embed&&(d in t.uniqueEmbeds&&B(t,d),t.uniqueEmbeds[d]={parent:r,property:o}),t.subjectStack.push(h);for(var f=Object.keys(h).sort(),g=0;g<f.length;g++){var v=f[g];if(X(v))p[v]=le(h[v]);else if(!a.explicit||v in n)for(var m=h[v],y=0;y<m.length;++y){var b=m[y];if(oe(b)){var w={"@list":[]};Q(p,v,w);var x=b["@list"];for(var k in x)if(ne(b=x[k])){var _=v in n?n[v][0]["@list"]:R(a);e(t,[b["@id"]],_,w,"@list")}else Q(w,"@list",le(b))}else if(ne(b)){var _=v in n?n[v]:R(a);e(t,[b["@id"]],_,p,v)}else Q(p,v,le(b))}}for(var f=Object.keys(n).sort(),g=0;g<f.length;++g){var v=f[g];if(!X(v)){var F=n[v][0],C=I(F,s,"omitDefault");if(!(C||v in p)){var E="@null";"@default"in F&&(E=le(F["@default"])),K(E)||(E=[E]),p[v]=[{"@preserve":E}]}}}Q(r,o,p),t.subjectStack.pop()}}}}(n,Object.keys(n.subjects).sort(),t,o,null),o},h.prototype.normalize=function(e,t,i){return"URDNA2015"===t.algorithm?new _(t).main(e,i):"URGNA2012"===t.algorithm?new F(t).main(e,i):void i(new Error("Invalid RDF Dataset Normalization algorithm: "+t.algorithm))},h.prototype.fromRDF=function(e,t,i){var n={},r={"@default":n},o={};for(var s in e){var a=e[s];s in r||(r[s]={}),"@default"===s||s in n||(n[s]={"@id":s});for(var l=r[s],u=0;u<a.length;++u){var c=a[u],d=c.subject.value,h=c.predicate.value,p=c.object;d in l||(l[d]={"@id":d});var f=l[d],g="IRI"===p.type||"blank node"===p.type;if(!g||p.value in l||(l[p.value]={"@id":p.value}),h!==P||t.useRdfType||!g){var v=U(p,t.useNativeTypes);if(O.addValue(f,h,v,{propertyIsArray:!0}),g)if(p.value===M){var m=l[p.value];"usages"in m||(m.usages=[]),m.usages.push({node:f,property:h,value:v})}else p.value in o?o[p.value]=!1:o[p.value]={node:f,property:h,value:v}}else O.addValue(f,"@type",p.value,{propertyIsArray:!0})}}for(var s in r){var y=r[s];if(M in y){for(var b=y[M],w=0;w<b.usages.length;++w){for(var x=b.usages[w],k=(f=x.node,x.property),_=x.value,F=[],C=[],E=Object.keys(f).length;k===L&&W(o[f["@id"]])&&K(f[N])&&1===f[N].length&&K(f[L])&&1===f[L].length&&(3===E||4===E&&K(f["@type"])&&1===f["@type"].length&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#List"===f["@type"][0])&&(F.push(f[N][0]),C.push(f["@id"]),f=(x=o[f["@id"]]).node,k=x.property,_=x.value,E=Object.keys(f).length,0===f["@id"].indexOf("_:")););if(k===N){if(f["@id"]===M)continue;_=y[_["@id"]][L][0],F.pop(),C.pop()}delete _["@id"],_["@list"]=F.reverse();for(var T=0;T<C.length;++T)delete y[C[T]]}delete b.usages}}var D=[],S=Object.keys(n).sort();for(w=0;w<S.length;++w){var R=S[w];f=n[R];if(R in r){a=f["@graph"]=[],y=r[R];for(var j=Object.keys(y).sort(),I=0;I<j.length;++I){var A=y[j[I]];ne(A)||a.push(A)}}ne(f)||D.push(f)}i(null,D)},h.prototype.toRDF=function(e,t){var i=new pe("_:b"),n={"@default":{}};S(e,n,"@default",i);for(var r={},o=Object.keys(n).sort(),s=0;s<o.length;++s){var a=o[s];("@default"===a||ae(a))&&(r[a]=c(n[a],i,t))}return r},h.prototype.processContext=function(e,t,i){W(t)&&"@context"in t&&K(t["@context"])&&(t=t["@context"]);var n=K(t)?t:[t];if(0===n.length)return e.clone();for(var r=e,o=0;o<n.length;++o){var s=n[o];if(null!==s){if(W(s)&&"@context"in s&&(s=s["@context"]),!W(s))throw new D("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:s});if(O.cache.activeCtx){var a=O.cache.activeCtx.get(e,s);if(a){r=e=a;continue}}r=(e=r).clone();var l={};if("@base"in s){var u=s["@base"];if(null===u)u=null;else{if(!Y(u))throw new D('Invalid JSON-LD syntax; the value of "@base" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s});if(""!==u&&!ae(u))throw new D('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI or the empty string.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s})}null!==u&&(u=O.url.parse(u||"")),r["@base"]=u,l["@base"]=!0}if("@vocab"in s){if(null===(c=s["@vocab"]))delete r["@vocab"];else{if(!Y(c))throw new D('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});if(!ae(c))throw new D('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});r["@vocab"]=c}l["@vocab"]=!0}if("@language"in s){var c;if(null===(c=s["@language"]))delete r["@language"];else{if(!Y(c))throw new D('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:s});r["@language"]=c.toLowerCase()}l["@language"]=!0}for(var d in s)q(r,s,d,l);O.cache.activeCtx&&O.cache.activeCtx.set(e,s,r)}else r=e=G(i)}return r};var d,o,k,_=(d={subject:"s",object:"o",name:"g"},(o=function(e){e=e||{},this.name="URDNA2015",this.options=e,this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new pe("_:c14n"),this.quads=[],this.schedule={},this.schedule.MAX_DEPTH="maxCallStackDepth"in e?e.maxCallStackDepth:500,this.schedule.MAX_TOTAL_DEPTH="maxTotalCallStackDepth"in e?e.maxCallStackDepth:4294967295,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice="timeSlice"in e?e.timeSlice:10}).prototype.doWork=function(i,n){var r=this.schedule;if(r.totalDepth>=r.MAX_TOTAL_DEPTH)return n(new Error("Maximum total call stack depth exceeded; normalization aborting."));!function e(){if(r.depth===r.MAX_DEPTH)return r.depth=0,r.running=!1,O.nextTick(e);var t=(new Date).getTime();if(r.running||(r.start=(new Date).getTime(),r.deadline=r.start+r.timeSlice),t<r.deadline)return r.running=!0,r.depth++,r.totalDepth++,i(function(e,t){r.depth--,r.totalDepth--,n(e,t)});r.depth=0,r.running=!1,O.setImmediate(e)}()},o.prototype.forEach=function(e,n,r){var o,t,s=this,i=0;if(K(e))t=e.length,o=function(){return i!==t&&(o.value=e[i++],o.key=i,!0)};else{var a=Object.keys(e);t=a.length,o=function(){return i!==t&&(o.key=a[i++],o.value=e[o.key],!0)}}!function e(t,i){return t?r(t):o()?s.doWork(function(){n(o.value,o.key,e)}):void r()}()},o.prototype.waterfall=function(e,t){var n=this;n.forEach(e,function(e,t,i){n.doWork(e,i)},t)},o.prototype.whilst=function(i,n,r){var o=this;!function e(t){return t?r(t):i()?void o.doWork(n,e):r()}()},o.prototype.main=function(t,i){var r,s=this;if(s.schedule.start=(new Date).getTime(),s.options.format&&"application/nquads"!==s.options.format)return i(new D("Unknown output format.","jsonld.UnknownFormat",{format:s.options.format}));var a={};s.waterfall([function(e){s.forEach(t,function(e,n,t){"@default"===n&&(n=null),s.forEach(e,function(i,e,t){null!==n&&(0===n.indexOf("_:")?i.name={type:"blank node",value:n}:i.name={type:"IRI",value:n}),s.quads.push(i),s.forEachComponent(i,function(e){if("blank node"===e.type){var t=e.value;t in s.blankNodeInfo?s.blankNodeInfo[t].quads.push(i):(a[t]=!0,s.blankNodeInfo[t]={quads:[i]})}}),t()},t)},e)},function(e){var o=!0;s.whilst(function(){return o},function(e){o=!1,s.hashToBlankNodes={},s.waterfall([function(e){s.forEach(a,function(e,i,n){s.hashFirstDegreeQuads(i,function(e,t){if(e)return n(e);t in s.hashToBlankNodes?s.hashToBlankNodes[t].push(i):s.hashToBlankNodes[t]=[i],n()})},e)},function(e){var t=Object.keys(s.hashToBlankNodes).sort();s.forEach(t,function(e,t,i){var n=s.hashToBlankNodes[e];if(1<n.length)return i();var r=n[0];s.canonicalIssuer.getId(r),delete a[r],delete s.hashToBlankNodes[e],o=!0,i()},e)}],e)},e)},function(e){var t=Object.keys(s.hashToBlankNodes).sort();s.forEach(t,function(e,t,i){var r=[],n=s.hashToBlankNodes[e];s.waterfall([function(e){s.forEach(n,function(e,t,i){if(s.canonicalIssuer.hasId(e))return i();var n=new pe("_:b");n.getId(e),s.hashNDegreeQuads(e,n,function(e,t){if(e)return i(e);r.push(t),i()})},e)},function(e){r.sort(function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}),s.forEach(r,function(e,t,i){for(var n in e.issuer.existing)s.canonicalIssuer.getId(n);i()},e)}],i)},e)},function(e){var n=[];s.waterfall([function(e){s.forEach(s.quads,function(e,t,i){s.forEachComponent(e,function(e){"blank node"===e.type&&0!==e.value.indexOf(s.canonicalIssuer.prefix)&&(e.value=s.canonicalIssuer.getId(e.value))}),n.push(he(e)),i()},e)},function(e){if(n.sort(),"application/nquads"===s.options.format)return r=n.join(""),e();r=de(n.join("")),e()}],e)}],function(e){i(e,r)})},o.prototype.hashFirstDegreeQuads=function(r,t){var o=this,i=o.blankNodeInfo[r];if("hash"in i)return t(null,i.hash);var s=[],e=i.quads;o.forEach(e,function(e,t,i){var n={predicate:e.predicate};o.forEachComponent(e,function(e,t){n[t]=o.modifyFirstDegreeComponent(r,e,t)}),s.push(he(n)),i()},function(e){if(e)return t(e);s.sort(),i.hash=ge.hashNQuads(o.name,s),t(null,i.hash)})},o.prototype.modifyFirstDegreeComponent=function(e,t){return"blank node"!==t.type||((t=le(t)).value=t.value===e?"_:a":"_:z"),t},o.prototype.hashRelatedBlankNode=function(e,i,t,n,r){var o,s=this;s.waterfall([function(i){return s.canonicalIssuer.hasId(e)?(o=s.canonicalIssuer.getId(e),i()):t.hasId(e)?(o=t.getId(e),i()):void s.hashFirstDegreeQuads(e,function(e,t){if(e)return i(e);o=t,i()})}],function(e){if(e)return r(e);var t=new ge(s.name);return t.update(n),"g"!==n&&t.update(s.getRelatedPredicate(i)),t.update(o),r(null,t.digest())})},o.prototype.getRelatedPredicate=function(e){return"<"+e.predicate.value+">"},o.prototype.hashNDegreeQuads=function(e,c,t){var n,d=this,r=new ge(d.name);d.waterfall([function(i){d.createHashToRelated(e,c,function(e,t){if(e)return i(e);n=t,i()})},function(e){var t=Object.keys(n).sort();d.forEach(t,function(e,t,i){r.update(e);var a,l="",u=new fe(n[e]);d.whilst(function(){return u.hasNext()},function(r){var t=u.next(),o=c.clone(),s="",n=[];d.waterfall([function(e){d.forEach(t,function(e,t,i){if(d.canonicalIssuer.hasId(e)?s+=d.canonicalIssuer.getId(e):(o.hasId(e)||n.push(e),s+=o.getId(e)),0!==l.length&&s.length>=l.length&&l<s)return r();i()},e)},function(e){d.forEach(n,function(i,e,n){d.hashNDegreeQuads(i,o,function(e,t){return e?n(e):(s+=o.getId(i),s+="<"+t.hash+">",o=t.issuer,0!==l.length&&s.length>=l.length&&l<s?r():void n())})},e)},function(e){(0===l.length||s<l)&&(l=s,a=o),e()}],r)},function(e){if(e)return i(e);r.update(l),c=a,i()})},e)}],function(e){t(e,{hash:r.digest(),issuer:c})})},o.prototype.createHashToRelated=function(s,a,t){var l=this,u={},e=l.blankNodeInfo[s].quads;l.forEach(e,function(o,e,t){l.forEach(o,function(e,t,i){if("predicate"===t||"blank node"!==e.type||e.value===s)return i();var n=e.value,r=d[t];l.hashRelatedBlankNode(n,o,a,r,function(e,t){if(e)return i(e);t in u?u[t].push(n):u[t]=[n],i()})},t)},function(e){t(e,u)})},o.prototype.forEachComponent=function(e,t){for(var i in e)"predicate"!==i&&t(e[i],i,e)},o),F=(((k=function(e){_.call(this,e),this.name="URGNA2012"}).prototype=new _).modifyFirstDegreeComponent=function(e,t,i){return"blank node"!==t.type||((t=le(t)).value="name"===i?"_:g":t.value===e?"_:a":"_:z"),t},k.prototype.getRelatedPredicate=function(e){return e.predicate.value},k.prototype.createHashToRelated=function(o,s,t){var a=this,l={},e=a.blankNodeInfo[o].quads;a.forEach(e,function(e,t,i){var n,r;if("blank node"===e.subject.type&&e.subject.value!==o)r=e.subject.value,n="p";else{if("blank node"!==e.object.type||e.object.value===o)return i();r=e.object.value,n="r"}a.hashRelatedBlankNode(r,e,s,n,function(e,t){t in l?l[t].push(r):l[t]=[r],i()})},function(e){t(e,l)})},k);function S(e,t,i,n,r,o){if(K(e))for(var s=0;s<e.length;++s)S(e[s],t,i,n,void 0,o);else if(W(e))if(re(e)){"@type"in e&&0===(l=e["@type"]).indexOf("_:")&&(e["@type"]=l=n.getId(l)),o&&o.push(e)}else{if("@type"in e){var a=e["@type"];for(s=0;s<a.length;++s){var l;0===(l=a[s]).indexOf("_:")&&n.getId(l)}}te(r)&&(r=se(e)?n.getId(e["@id"]):e["@id"]),o&&o.push({"@id":r});var u=t[i],c=u[r]=u[r]||{};c["@id"]=r;for(var d=Object.keys(e).sort(),h=0;h<d.length;++h){var p=d[h];if("@id"!==p)if("@reverse"!==p)if("@graph"!==p)if("@type"!==p&&X(p)){if("@index"===p&&p in c&&(e[p]!==c[p]||e[p]["@id"]!==c[p]["@id"]))throw new D("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:c});c[p]=e[p]}else{var f=e[p];if(0===p.indexOf("_:")&&(p=n.getId(p)),0!==f.length)for(var g=0;g<f.length;++g){var v=f[g];if("@type"===p&&(v=0===v.indexOf("_:")?n.getId(v):v),ie(v)||ne(v)){var m=se(v)?n.getId(v["@id"]):v["@id"];O.addValue(c,p,{"@id":m},{propertyIsArray:!0,allowDuplicate:!1}),S(v,t,i,n,m)}else if(oe(v)){var y=[];S(v["@list"],t,i,n,r,y),v={"@list":y},O.addValue(c,p,v,{propertyIsArray:!0,allowDuplicate:!1})}else S(v,t,i,n,r),O.addValue(c,p,v,{propertyIsArray:!0,allowDuplicate:!1})}else O.addValue(c,p,[],{propertyIsArray:!0})}else{r in t||(t[r]={});var b="@merged"===i?i:r;S(e[p],t,b,n)}else{var w={"@id":r},x=e["@reverse"];for(var k in x)for(var _=x[k],F=0;F<_.length;++F){var C=_[F],E=C["@id"];se(C)&&(E=n.getId(E)),S(C,t,i,n,E),O.addValue(u[E],k,w,{propertyIsArray:!0,allowDuplicate:!1})}}}}else o&&o.push(e)}function C(e){for(var t=e["@default"],i=Object.keys(e).sort(),n=0;n<i.length;++n){var r=i[n];if("@default"!==r){var o=e[r],s=t[r];s?"@graph"in s||(s["@graph"]=[]):t[r]=s={"@id":r,"@graph":[]};for(var a=s["@graph"],l=Object.keys(o).sort(),u=0;u<l.length;++u){var c=o[l[u]];ne(c)||a.push(c)}}}return t}function R(e){var t={};for(var i in e)void 0!==e[i]&&(t["@"+i]=[e[i]]);return[t]}function j(e,t){for(var i=t.length-1;0<=i;--i)if(t[i]["@id"]===e["@id"])return!0;return!1}function I(e,t,i){var n="@"+i,r=n in e?e[n][0]:t[i];return"embed"===i&&(!0===r?r="@last":!1===r?r="@never":"@always"!==r&&"@never"!==r&&"@link"!==r&&(r="@last")),r}function A(e){if(!K(e)||1!==e.length||!W(e[0]))throw new D("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function $(e,t,i,n){for(var r={},o=0;o<t.length;++o){var s=t[o],a=e.subjects[s];E(a,i,n)&&(r[s]=a)}return r}function E(e,t,i){if("@type"in t&&(1!==t["@type"].length||!W(t["@type"][0]))){for(var n=t["@type"],r=0;r<n.length;++r)if(O.hasValue(e,"@type",n[r]))return!0;return!1}var o=!0,s=!1;for(var a in t){if(X(a)){if("@id"!==a&&"@type"!==a)continue;if(o=!1,"@id"===a&&Y(t[a])){if(e[a]!==t[a])return!1;s=!0;continue}}if(o=!1,a in e){if(K(t[a])&&0===t[a].length&&void 0!==e[a])return!1;s=!0}else{var l=K(t[a])&&W(t[a][0])&&"@default"in t[a][0];if(i.requireAll&&!l)return!1}}return o||s}function B(e,t){var r=e.uniqueEmbeds,i=r[t],n=i.parent,o=i.property,s={"@id":t};if(K(n)){for(var a=0;a<n.length;++a)if(O.compareValues(n[a],s)){n[a]=s;break}}else{var l=K(n[o]);O.removeValue(n,o,s,{propertyIsArray:l}),O.addValue(n,o,s,{propertyIsArray:l})}var u=function(e){for(var t=Object.keys(r),i=0;i<t.length;++i){var n=t[i];n in r&&W(r[n].parent)&&r[n].parent["@id"]===e&&(delete r[n],u(n))}};u(t)}function Q(e,t,i){W(e)?O.addValue(e,t,i,{propertyIsArray:!0}):e.push(i)}function V(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1}function z(e,t,i,n,r){if(null===t)return t;te(i)&&(i=null),te(r)&&(r=!1),n=n||{};var o=e.getInverse();if(X(t))return t in o?o[t]["@none"]["@type"]["@none"]:t;if(n.vocab&&t in o){var s=e["@language"]||"@none",a=[];W(i)&&"@index"in i&&a.push("@index");var l="@language",u="@null";if(r)l="@type",u="@reverse",a.push("@set");else if(oe(i)){"@index"in i||a.push("@list");for(var c=i["@list"],d=0===c.length?s:null,h=null,p=0;p<c.length;++p){var f=c[p],g="@none",v="@none";if(re(f)?"@language"in f?g=f["@language"]:"@type"in f?v=f["@type"]:g="@null":v="@id",null===d?d=g:g!==d&&re(f)&&(d="@none"),null===h?h=v:v!==h&&(h="@none"),"@none"===d&&"@none"===h)break}d=d||"@none",u="@none"!==(h=h||"@none")?(l="@type",h):d}else re(i)?"@language"in i&&!("@index"in i)?(a.push("@language"),u=i["@language"]):"@type"in i&&(u=i[l="@type"]):(l="@type",u="@id"),a.push("@set");a.push("@none");var m=function(e,t,i,n,r,o){null===o&&(o="@null");var s=[];if("@id"!==o&&"@reverse"!==o||!ne(i))s.push(o);else{"@reverse"===o&&s.push("@reverse");var a=z(e,i["@id"],null,{vocab:!0});a in e.mappings&&e.mappings[a]&&e.mappings[a]["@id"]===i["@id"]?s.push.apply(s,["@vocab","@id"]):s.push.apply(s,["@id","@vocab"])}s.push("@none");for(var l=e.inverse[t],u=0;u<n.length;++u){var c=n[u];if(c in l)for(var d=l[c][r],h=0;h<s.length;++h){var p=s[h];if(p in d)return d[p]}}return null}(e,t,i,a,l,u);if(null!==m)return m}if(n.vocab&&"@vocab"in e){var y=e["@vocab"];if(0===t.indexOf(y)&&t!==y){var b=t.substr(y.length);if(!(b in e.mappings))return b}}for(var w=null,x=0,k=[],_=e.fastCurieMap,F=t.length-1;x<F&&t[x]in _;++x)""in(_=_[t[x]])&&k.push(_[""][0]);for(p=k.length-1;0<=p;--p)for(var C=k[p],E=C.terms,T=0;T<E.length;++T){var D=E[T]+":"+t.substr(C.iri.length);(!(D in e.mappings)||null===i&&e.mappings[D]["@id"]===t)&&(null===w||V(D,w)<0)&&(w=D)}return null!==w?w:n.vocab?t:function(e,t){if(null===e)return t;Y(e)&&(e=O.url.parse(e||""));var i="";""!==e.href?i+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(i+="//");if(0!==t.indexOf(i))return t;var n=O.url.parse(t.substr(i.length)),r=e.normalizedPath.split("/"),o=n.normalizedPath.split("/"),s=n.fragment||n.query?0:1;for(;0<r.length&&o.length>s&&r[0]===o[0];)r.shift(),o.shift();var a="";if(0<r.length){r.pop();for(var l=0;l<r.length;++l)a+="../"}a+=o.join("/"),null!==n.query&&(a+="?"+n.query);null!==n.fragment&&(a+="#"+n.fragment);""===a&&(a="./");return a}(e["@base"],t)}function q(e,t,i,n){if(i in n){if(n[i])return;throw new D("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:i})}if(n[i]=!1,X(i))throw new D("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:i});if(""===i)throw new D("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});e.mappings[i]&&delete e.mappings[i];var r=t[i];if(null===r||W(r)&&null===r["@id"])return e.mappings[i]=null,void(n[i]=!0);if(Y(r)&&(r={"@id":r}),!W(r))throw new D("Invalid JSON-LD syntax; @context property values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o=e.mappings[i]={};if(o.reverse=!1,"@reverse"in r){if("@id"in r)throw new D("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var s=r["@reverse"];if(!Y(s))throw new D("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(!ae(a=H(e,s,{vocab:!0,base:!1},t,n)))throw new D("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=a,o.reverse=!0}else if("@id"in r){if(!Y(a=r["@id"]))throw new D("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(a!==i){if(!ae(a=H(e,a,{vocab:!0,base:!1},t,n))&&!X(a))throw new D("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});o["@id"]=a}}var a,l=i.indexOf(":");if(o._termHasColon=-1!==l,!("@id"in o))if(o._termHasColon){var u=i.substr(0,l);if(u in t&&q(e,t,u,n),e.mappings[u]){var c=i.substr(l+1);o["@id"]=e.mappings[u]["@id"]+c}else o["@id"]=i}else{if(!("@vocab"in e))throw new D("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:i});o["@id"]=e["@vocab"]+i}if(n[i]=!0,"@type"in r){var d=r["@type"];if(!Y(d))throw new D("Invalid JSON-LD syntax; an @context @type values must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==d&&"@vocab"!==d){if(!ae(d=H(e,d,{vocab:!0,base:!1},t,n)))throw new D("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===d.indexOf("_:"))throw new D("Invalid JSON-LD syntax; an @context @type values must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}o["@type"]=d}if("@container"in r){var h=r["@container"];if("@list"!==h&&"@set"!==h&&"@index"!==h&&"@language"!==h)throw new D("Invalid JSON-LD syntax; @context @container value must be one of the following: @list, @set, @index, or @language.","jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(o.reverse&&"@index"!==h&&"@set"!==h&&null!==h)throw new D("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});o["@container"]=h}if("@language"in r&&!("@type"in r)){var p=r["@language"];if(null!==p&&!Y(p))throw new D("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==p&&(p=p.toLowerCase()),o["@language"]=p}if("@context"===(a=o["@id"])||"@preserve"===a)throw new D("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t})}function H(e,t,i,n,r){if(null===t||X(t))return t;if(t=String(t),n&&t in n&&!0!==r[t]&&q(e,n,t,r),(i=i||{}).vocab){if(null===(s=e.mappings[t]))return null;if(s)return s["@id"]}var o=t.indexOf(":");if(-1!==o){var s,a=t.substr(0,o),l=t.substr(o+1);return"_"===a||0===l.indexOf("//")?t:(n&&a in n&&q(e,n,a,r),(s=e.mappings[a])?s["@id"]+l:t)}if(i.vocab&&"@vocab"in e)return e["@vocab"]+t;var u=t;return i.base&&(u=O.prependBase(e["@base"],u)),u}function G(e){return{"@base":O.url.parse(e.base||""),mappings:{},inverse:null,getInverse:function(){if(this.inverse)return this.inverse;for(var e=this.inverse={},t=this.fastCurieMap={},i={},n=this["@language"]||"@none",r=this.mappings,o=Object.keys(r).sort(V),s=0;s<o.length;++s){var a=o[s],l=r[a];if(null!==l){var u=l["@container"]||"@none",c=l["@id"];K(c)||(c=[c]);for(var d=0;d<c.length;++d){var h=c[d],p=e[h],f=X(h);if(p)f||l._termHasColon||i[h].push(a);else if(e[h]=p={},!f&&!l._termHasColon){i[h]=[a];var g={iri:h,terms:i[h]};h[0]in t?t[h[0]].push(g):t[h[0]]=[g]}if(p[u]||(p[u]={"@language":{},"@type":{}}),p=p[u],l.reverse)b(l,a,p["@type"],"@reverse");else if("@type"in l)b(l,a,p["@type"],l["@type"]);else if("@language"in l){var v=l["@language"]||"@null";b(l,a,p["@language"],v)}else b(l,a,p["@language"],n),b(l,a,p["@type"],"@none"),b(l,a,p["@language"],"@none")}}}for(var m in t)y(t,m,1);return e},clone:function(){var e={};e["@base"]=this["@base"],e.mappings=le(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e}};function y(e,t,i){for(var n,r,o=e[t],s=e[t]={},a=0;a<o.length;++a)(r=i>=(n=o[a].iri).length?"":n[i])in s?s[r].push(o[a]):s[r]=[o[a]];for(var t in s)""!==t&&y(s,t,i+1)}function b(e,t,i,n){n in i||(i[n]=t)}}function X(e){if(!Y(e))return!1;switch(e){case"@base":case"@context":case"@container":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@language":case"@list":case"@omitDefault":case"@preserve":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@vocab":return!0}return!1}function W(e){return"[object Object]"===Object.prototype.toString.call(e)}function K(e){return Array.isArray(e)}function J(e){if(!Y(e)&&(!W(t=e)||0!==Object.keys(t).length)){var t,i=!1;if(K(e)){i=!0;for(var n=0;n<e.length;++n)if(!Y(e[n])){i=!1;break}}if(!i)throw new D('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}}function Y(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)}function Z(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function ee(e){return Z(e)&&-1!==String(e).indexOf(".")}function te(e){return void 0===e}function ie(e){var t=!1;W(e)&&!("@value"in e||"@set"in e||"@list"in e)&&(t=1<Object.keys(e).length||!("@id"in e));return t}function ne(e){return W(e)&&1===Object.keys(e).length&&"@id"in e}function re(e){return W(e)&&"@value"in e}function oe(e){return W(e)&&"@list"in e}function se(e){var t=!1;return W(e)&&(t="@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)),t}function ae(e){return Y(e)&&-1!==e.indexOf(":")}function le(e){if(e&&"object"==typeof e){var t;if(K(e)){t=[];for(var i=0;i<e.length;++i)t[i]=le(e[i])}else if(W(e))for(var n in t={},e)t[n]=le(e[n]);else t=e.toString();return t}return e}function ue(e,t,i,n){var r=Object.keys(t).length;if(K(e)){for(var o=0;o<e.length;++o)ue(e[o],t,i,n);return r<Object.keys(t).length}if(W(e)){for(var s in e)if("@context"===s){var a=e[s];if(K(a)){var l=a.length;for(o=0;o<l;++o){var u=a[o];Y(u)&&(u=O.prependBase(n,u),i?K(u=t[u])?(Array.prototype.splice.apply(a,[o,1].concat(u)),o+=u.length-1,l=a.length):a[o]=u:u in t||(t[u]=!1))}}else Y(a)&&(a=O.prependBase(n,a),i?e[s]=t[a]:a in t||(t[a]=!1))}else ue(e[s],t,i,n);return r<Object.keys(t).length}return!1}function ce(e,t,i){var d=null,n=t.documentLoader,h=function(e,i,o,t,s){if(Object.keys(i).length>f)return d=new D("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:f}),s(d);var a={},l=function(){ue(e,a,!0,t),s(null,e)};ue(e,a,!1,t)||l();var n=[];for(var r in a)!1===a[r]&&n.push(r);for(var u=n.length,c=0;c<n.length;++c)!function(n){if(n in i)return d=new D("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:n}),s(d);var r=le(i);r[n]=!0;var e=function(t,e){if(!d){var i=e?e.document:null;if(!t&&Y(i))try{i=JSON.parse(i)}catch(e){t=e}if(t?t=new D("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:n,cause:t}):W(i)||(t=new D("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:n,cause:t})),t)return s(d=t);i="@context"in i?{"@context":i["@context"]}:{"@context":{}},e.contextUrl&&(K(i["@context"])||(i["@context"]=[i["@context"]]),i["@context"].push(e.contextUrl)),h(i,r,o,n,function(e,t){if(e)return s(e);a[n]=t["@context"],0===(u-=1)&&l()})}},t=o(n,e);t&&"then"in t&&t.then(e.bind(null,null),e)}(n[c])};h(e,{},n,t.base,i)}function de(e){for(var t=new RegExp("^[ \\t]*(?:#.*)?$"),i=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+))|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-z]+(?:-[a-z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z0-9]+)))[ \\t]*\\.))[ \\t]*(?:#.*)?$'),n={},r=e.split(/(?:\r\n)|(?:\n)|(?:\r)/g),o=0,s=0;s<r.length;++s){var a=r[s];if(o++,!t.test(a)){var l=a.match(i);if(null===l)throw new D("Error while parsing N-Quads; invalid quad.","jsonld.ParseError",{line:o});var u={};if(te(l[1])?u.subject={type:"blank node",value:l[2]}:u.subject={type:"IRI",value:l[1]},u.predicate={type:"IRI",value:l[3]},te(l[4]))if(te(l[5])){u.object={type:"literal"},te(l[7])?te(l[8])?u.object.datatype=m:(u.object.datatype=y,u.object.language=l[8]):u.object.datatype=l[7];var c=l[6].replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");u.object.value=c}else u.object={type:"blank node",value:l[5]};else u.object={type:"IRI",value:l[4]};var d="@default";if(te(l[9])?te(l[10])||(d=l[10]):d=l[9],d in n){for(var h=!0,p=n[d],f=0;h&&f<p.length;++f)x(p[f],u)&&(h=!1);h&&p.push(u)}else n[d]=[u]}}return n}function he(e,t){var i=e.subject,n=e.predicate,r=e.object,o=t||null;"name"in e&&e.name&&(o=e.name.value);var s="";if("IRI"===i.type?s+="<"+i.value+">":s+=i.value,s+=" ","IRI"===n.type?s+="<"+n.value+">":s+=n.value,s+=" ","IRI"===r.type)s+="<"+r.value+">";else if("blank node"===r.type)s+=r.value;else{s+='"'+r.value.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"')+'"',r.datatype===y?r.language&&(s+="@"+r.language):r.datatype!==m&&(s+="^^<"+r.datatype+">")}return null!=o&&(0!==o.indexOf("_:")?s+=" <"+o+">":s+=" "+o),s+=" .\n"}function pe(e){this.prefix=e,this.counter=0,this.existing={}}Object.keys||(Object.keys=function(e){if(e!==Object(e))throw new TypeError("Object.keys called on non-object");var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}),O.registerRDFParser("application/nquads",de),O.registerRDFParser("rdfa-api",function(e){for(var t={"@default":[]},i=e.getSubjects(),n=0;n<i.length;++n){var r=i[n];if(null!==r){var o=e.getSubjectTriples(r);if(null!==o){var s=o.predicates;for(var a in s)for(var l=s[a].objects,u=0;u<l.length;++u){var c=l[u],d={};0===r.indexOf("_:")?d.subject={type:"blank node",value:r}:d.subject={type:"IRI",value:r},0===a.indexOf("_:")?d.predicate={type:"blank node",value:a}:d.predicate={type:"IRI",value:a};var h=c.value;if("http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral"===c.type){g||ve();var p=new g;h="";for(var f=0;f<c.value.length;f++)c.value[f].nodeType===v.ELEMENT_NODE?h+=p.serializeToString(c.value[f]):c.value[f].nodeType===v.TEXT_NODE&&(h+=c.value[f].nodeValue)}d.object={},"http://www.w3.org/1999/02/22-rdf-syntax-ns#object"===c.type?0===c.value.indexOf("_:")?d.object.type="blank node":d.object.type="IRI":(d.object.type="literal","http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral"===c.type?c.language?(d.object.datatype=y,d.object.language=c.language):d.object.datatype=m:d.object.datatype=c.type),d.object.value=h,t["@default"].push(d)}}}}return t}),O.IdentifierIssuer=pe,(O.UniqueNamer=pe).prototype.clone=function(){var e=new pe(this.prefix);return e.counter=this.counter,e.existing=le(this.existing),e},pe.prototype.getId=function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t},pe.prototype.getName=pe.prototype.getName,pe.prototype.isNamed=pe.prototype.hasId=function(e){return e in this.existing};var fe=function(e){this.list=e.sort(),this.done=!1,this.left={};for(var t=0;t<e.length;++t)this.left[e[t]]=!0};fe.prototype.hasNext=function(){return!this.done},fe.prototype.next=function(){for(var e=this.list.slice(),t=null,i=0,n=this.list.length,r=0;r<n;++r){var o=this.list[r],s=this.left[o];(null===t||t<o)&&(s&&0<r&&o>this.list[r-1]||!s&&r<n-1&&o>this.list[r+1])&&(t=o,i=r)}if(null===t)this.done=!0;else{var a=this.left[t]?i-1:i+1;this.list[i]=this.list[a],this.list[a]=t;for(r=0;r<n;++r)this.list[r]>t&&(this.left[this.list[r]]=!this.left[this.list[r]])}return e};var ge=function(e){if(!(this instanceof ge))return new ge(e);if(-1===["URDNA2015","URGNA2012"].indexOf(e))throw new Error("Invalid RDF Dataset Normalization algorithm: "+e);ge._init.call(this,e)};if(ge.hashNQuads=function(e,t){for(var i=new ge(e),n=0;n<t.length;++n)i.update(t[n]);return i.digest()},function(e){if(be){var t=Fe("crypto");return ge._init=function(e){e="URDNA2015"===e?"sha256":"sha1",this.md=t.createHash(e)},ge.prototype.update=function(e){return this.md.update(e,"utf8")},ge.prototype.digest=function(){return this.md.digest("hex")}}ge._init=function(e){e="URDNA2015"===e?new y.Algorithm:new d.Algorithm,this.md=new s(e)},ge.prototype.update=function(e){return this.md.update(e)},ge.prototype.digest=function(){return this.md.digest().toHex()};var s=function(e){if(!(this instanceof s))return new s(e);if(this._algorithm=e,!s._padding||s._padding.length<this._algorithm.blockSize){s._padding=String.fromCharCode(128);for(var t=String.fromCharCode(0),i=64;0<i;)1&i&&(s._padding+=t),0<(i>>>=1)&&(t+=t)}this.start()};s.prototype.start=function(){this.messageLength=0,this.fullMessageLength=[];for(var e=this._algorithm.messageLengthSize/4,t=0;t<e;++t)this.fullMessageLength.push(0);return this._input=new s.ByteBuffer,this.state=this._algorithm.start(),this},s.prototype.update=function(e){e=new s.ByteBuffer(unescape(encodeURIComponent(e))),this.messageLength+=e.length();var t=e.length();t=[t/4294967296>>>0,t>>>0];for(var i=this.fullMessageLength.length-1;0<=i;--i)this.fullMessageLength[i]+=t[1],t[1]=t[0]+(this.fullMessageLength[i]/4294967296>>>0),this.fullMessageLength[i]=this.fullMessageLength[i]>>>0,t[0]=t[1]/4294967296>>>0;for(this._input.putBytes(e.bytes());this._input.length()>=this._algorithm.blockSize;)this.state=this._algorithm.digest(this.state,this._input);return(2048<this._input.read||0===this._input.length())&&this._input.compact(),this},s.prototype.digest=function(){var e=new s.ByteBuffer;e.putBytes(this._input.bytes());var t=this.fullMessageLength[this.fullMessageLength.length-1]+this._algorithm.messageLengthSize&this._algorithm.blockSize-1;e.putBytes(s._padding.substr(0,this._algorithm.blockSize-t));for(var i=new s.ByteBuffer,n=0;n<this.fullMessageLength.length;++n)i.putInt32(this.fullMessageLength[n]<<3|this.fullMessageLength[n+1]>>>28);this._algorithm.writeMessageLength(e,i);var r=this._algorithm.digest(this.state.copy(),e),o=new s.ByteBuffer;return r.write(o),o},s.ByteBuffer=function(e){this.data="string"==typeof e?e:"",this.read=0},s.ByteBuffer.prototype.putInt32=function(e){this.data+=String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)},s.ByteBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},s.ByteBuffer.prototype.putBytes=function(e){this.data+=e},s.ByteBuffer.prototype.bytes=function(){return this.data.slice(this.read)},s.ByteBuffer.prototype.length=function(){return this.data.length-this.read},s.ByteBuffer.prototype.compact=function(){this.data=this.data.slice(this.read),this.read=0},s.ByteBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var i=this.data.charCodeAt(t);i<16&&(e+="0"),e+=i.toString(16)}return e};var d={_w:null,Algorithm:function(){this.name="sha1",this.blockSize=64,this.digestLength=20,this.messageLengthSize=8}};d.Algorithm.prototype.start=function(){return d._w||(d._w=new Array(80)),d._createState()},d.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},d.Algorithm.prototype.digest=function(e,t){for(var i,n,r,o,s,a,l,u=t.length(),c=d._w;64<=u;){for(n=e.h0,r=e.h1,o=e.h2,s=e.h3,a=e.h4,l=0;l<16;++l)i=t.getInt32(),i=(n<<5|n>>>27)+(s^r&(o^s))+a+1518500249+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;for(;l<20;++l)i=(i=c[l-3]^c[l-8]^c[l-14]^c[l-16])<<1|i>>>31,i=(n<<5|n>>>27)+(s^r&(o^s))+a+1518500249+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;for(;l<32;++l)i=(i=c[l-3]^c[l-8]^c[l-14]^c[l-16])<<1|i>>>31,i=(n<<5|n>>>27)+(r^o^s)+a+1859775393+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;for(;l<40;++l)i=(i=c[l-6]^c[l-16]^c[l-28]^c[l-32])<<2|i>>>30,i=(n<<5|n>>>27)+(r^o^s)+a+1859775393+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;for(;l<60;++l)i=(i=c[l-6]^c[l-16]^c[l-28]^c[l-32])<<2|i>>>30,i=(n<<5|n>>>27)+(r&o|s&(r^o))+a+2400959708+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;for(;l<80;++l)i=(i=c[l-6]^c[l-16]^c[l-28]^c[l-32])<<2|i>>>30,i=(n<<5|n>>>27)+(r^o^s)+a+3395469782+(c[l]=i),a=s,s=o,o=r<<30|r>>>2,r=n,n=i;e.h0=e.h0+n|0,e.h1=e.h1+r|0,e.h2=e.h2+o|0,e.h3=e.h3+s|0,e.h4=e.h4+a|0,u-=64}return e},d._createState=function(){var t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520,copy:function(){var e=d._createState();return e.h0=t.h0,e.h1=t.h1,e.h2=t.h2,e.h3=t.h3,e.h4=t.h4,e},write:function(e){e.putInt32(t.h0),e.putInt32(t.h1),e.putInt32(t.h2),e.putInt32(t.h3),e.putInt32(t.h4)}};return t};var y={_k:null,_w:null,Algorithm:function(){this.name="sha256",this.blockSize=64,this.digestLength=32,this.messageLengthSize=8}};y.Algorithm.prototype.start=function(){return y._k||y._init(),y._createState()},y.Algorithm.prototype.writeMessageLength=function(e,t){e.putBytes(t.bytes())},y.Algorithm.prototype.digest=function(e,t){for(var i,n,r,o,s,a,l,u,c,d,h,p,f,g=t.length(),v=y._k,m=y._w;64<=g;){for(s=0;s<16;++s)m[s]=t.getInt32();for(;s<64;++s)i=((i=m[s-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=((n=m[s-15])>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,m[s]=i+m[s-7]+n+m[s-16]|0;for(a=e.h0,l=e.h1,u=e.h2,c=e.h3,d=e.h4,h=e.h5,p=e.h6,f=e.h7,s=0;s<64;++s)r=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),o=a&l|u&(a^l),i=f+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(p^d&(h^p))+v[s]+m[s],f=p,p=h,h=d,d=c+i|0,c=u,u=l,l=a,a=i+(n=r+o)|0;e.h0=e.h0+a|0,e.h1=e.h1+l|0,e.h2=e.h2+u|0,e.h3=e.h3+c|0,e.h4=e.h4+d|0,e.h5=e.h5+h|0,e.h6=e.h6+p|0,e.h7=e.h7+f|0,g-=64}return e},y._createState=function(){var t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225,copy:function(){var e=y._createState();return e.h0=t.h0,e.h1=t.h1,e.h2=t.h2,e.h3=t.h3,e.h4=t.h4,e.h5=t.h5,e.h6=t.h6,e.h7=t.h7,e},write:function(e){e.putInt32(t.h0),e.putInt32(t.h1),e.putInt32(t.h2),e.putInt32(t.h3),e.putInt32(t.h4),e.putInt32(t.h5),e.putInt32(t.h6),e.putInt32(t.h7)}};return t},y._init=function(){y._k=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y._w=new Array(64)}}(),!g)var ve=function(){g=Fe("xmldom").XMLSerializer};function me(e,t){var i="";0===e.indexOf("/")&&(i="/");for(var n=e.split("/"),r=[];0<n.length;)"."===n[0]||""===n[0]&&1<n.length?n.shift():".."!==n[0]?r.push(n.shift()):(n.shift(),t||0<r.length&&".."!==r[r.length-1]?r.pop():r.push(".."));return i+r.join("/")}if(O.url={},O.url.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},O.url.parse=function(e,t){for(var i={},n=O.url.parsers[t||"full"],r=n.regex.exec(e),o=n.keys.length;o--;)i[n.keys[o]]=void 0===r[o]?null:r[o];return i.normalizedPath=me(i.path,!!i.authority),i},be?O.useDocumentLoader("node"):"undefined"!=typeof XMLHttpRequest&&O.useDocumentLoader("xhr"),be){O.use=function(e){switch(e){case"request":O.request=Fe("jsonld-request");break;default:throw new D("Unknown extension.","jsonld.UnknownExtension",{extension:e})}};var ye={exports:{},filename:_e};Fe("pkginfo")(ye,"version"),O.version=ye.exports.version}return O},t=function(){return e(function(){return t()})};!be&&"function"==typeof define&&define.amd?define([],function(){return e(t),t}):(e(t),"function"==typeof Fe&&void 0!==i&&i.exports&&(i.exports=t),we&&("undefined"==typeof jsonld?jsonld=jsonldjs=t:jsonldjs=t))}()}).call(this,Fe("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},"/../node_modules/jsonld/js")},{"7YKIPe":10,crypto:25,"es6-promise":3,http:25,"jsonld-request":25,pkginfo:25,request:25,util:25,xmldom:25}],27:[function(e,t,i){var n=e;e=function(){};i=t.exports={Lexer:e("./lib/N3Lexer"),Parser:e("./lib/N3Parser"),Writer:e("./lib/N3Writer"),Store:e("./lib/N3Store"),StreamParser:e("./lib/N3StreamParser"),StreamWriter:e("./lib/N3StreamWriter"),Util:e("./lib/N3Util")};Object.keys(i).forEach(function(e){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){return delete i[e],i[e]=n("./lib/N3"+e)}})})},{"./lib/N3Lexer":28,"./lib/N3Parser":29,"./lib/N3Store":30,"./lib/N3StreamParser":31,"./lib/N3StreamWriter":32,"./lib/N3Util":33,"./lib/N3Writer":34}],28:[function(e,t,i){var s=String.fromCharCode,o="function"==typeof setImmediate?setImmediate:function(e){setTimeout(e,0)},n=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,a={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},m=/[\x00-\x20<>\\"\{\}\|\^\`]/;function r(e){if(!(this instanceof r))return new r(e);if((e=e||{}).lineMode){this._tripleQuotedString=this._number=this._boolean=/$0^/;var n=this;this._tokenize=this.tokenize,this.tokenize=function(e,i){this._tokenize(e,function(e,t){!e&&/^(?:IRI|blank|literal|langcode|typeIRI|\.|eof)$/.test(t.type)?i&&i(e,t):i&&i(e||n._syntaxError(t.type,i=null))})}}this._n3Mode=!1!==e.n3,this._comments=!!e.comments}r.prototype={_iri:/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,_unescapedIri:/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,_unescapedString:/^"[^"\\\r\n]+"/,_singleQuotedString:/^"(?:[^"\\\r\n]|\\.)*"(?=[^"])|^'(?:[^'\\\r\n]|\\.)*'(?=[^'])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,_prefixed:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u2010-\u2019\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,_variable:/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,_blank:/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,_boolean:/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,_keyword:/^@[a-z]+(?=[\s#<:])/i,_sparqlKeyword:/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_comment:/#([^\n\r]*)/,_whitespace:/^[ \t]+/,_endOfFile:/^(?:#[^\n\r]*)?$/,_tokenizeToEnd:function(t,e){for(var i=this._input,n=this._comments;;){for(var r,o;r=this._newline.exec(i);)n&&(o=this._comment.exec(r[0]))&&t(null,{line:this._line,type:"comment",value:o[1],prefix:""}),i=i.substr(r[0].length,i.length),this._line++;if((r=this._whitespace.exec(i))&&(i=i.substr(r[0].length,i.length)),this._endOfFile.test(i))return e&&(n&&(o=this._comment.exec(i))&&t(null,{line:this._line,type:"comment",value:o[1],prefix:""}),t(i=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=i;var s,a=this._line,l="",u="",c="",d=i[0],h=null,p=0,f=!1;switch(d){case"^":if(i.length<3)break;if("^"!==i[1]){this._n3Mode&&(p=1,l="^");break}if(this._previousMarker="^^","<"!==(i=i.substr(2))[0]){f=!0;break}case"<":if(h=this._unescapedIri.exec(i))l="IRI",u=h[1];else if(h=this._iri.exec(i)){if(null===(s=this._unescape(h[1]))||m.test(s))return v(this);l="IRI",u=s}else this._n3Mode&&1<i.length&&"="===i[1]&&(l="inverse",p=2,u="http://www.w3.org/2000/10/swap/log#implies");break;case"_":((h=this._blank.exec(i))||e&&(h=this._blank.exec(i+" ")))&&(l="blank",c="_",u=h[1]);break;case'"':case"'":if(h=this._unescapedString.exec(i))l="literal",u=h[0];else if(h=this._singleQuotedString.exec(i)){if(null===(s=this._unescape(h[0])))return v(this);l="literal",u=s.replace(/^'|'$/g,'"')}else if(h=this._tripleQuotedString.exec(i)){if(s=h[1]||h[2],this._line+=s.split(/\r\n|\r|\n/).length-1,null===(s=this._unescape(s)))return v(this);l="literal",u=s.replace(/^'|'$/g,'"')}break;case"?":this._n3Mode&&(h=this._variable.exec(i))&&(l="var",u=h[0]);break;case"@":"literal"===this._previousMarker&&(h=this._langcode.exec(i))?(l="langcode",u=h[1]):(h=this._keyword.exec(i))&&(l=h[0]);break;case".":if(1===i.length?e:i[1]<"0"||"9"<i[1]){l=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(h=this._number.exec(i)||e&&(h=this._number.exec(i+" ")))&&(l="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#'+(h[1]?"double":/^[+\-]?\d+$/.test(h[0])?"integer":"decimal"));break;case"B":case"b":case"p":case"P":case"G":case"g":(h=this._sparqlKeyword.exec(i))?l=h[0].toUpperCase():f=!0;break;case"f":case"t":(h=this._boolean.exec(i))?(l="literal",u='"'+h[0]+'"^^http://www.w3.org/2001/XMLSchema#boolean'):f=!0;break;case"a":(h=this._shortPredicates.exec(i))?(l="abbreviation",u="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"):f=!0;break;case"=":this._n3Mode&&1<i.length&&(l="abbreviation",u=">"!==i[1]?(p=1,"http://www.w3.org/2002/07/owl#sameAs"):(p=2,"http://www.w3.org/2000/10/swap/log#implies"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":p=1,l=d;break;default:f=!0}if(f&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(h=this._prefix.exec(i))?((h=this._prefixed.exec(i))||e&&(h=this._prefixed.exec(i+" ")))&&(l="prefixed",c=h[1]||"",u=this._unescape(h[2])):(l="prefix",u=h[1]||"")),"^^"===this._previousMarker)switch(l){case"prefixed":l="type";break;case"IRI":l="typeIRI";break;default:l=""}if(!l)return e||!/^'''|^"""/.test(i)&&/\n|\r/.test(i)?v(this):this._input=i;var g={line:a,type:l,value:u,prefix:c};t(null,g),this.previousToken=g,this._previousMarker=l,i=i.substr(p||h[0].length,i.length)}function v(e){t(e._syntaxError(/^\S*/.exec(i)[0]))}},_unescape:function(e){try{return e.replace(n,function(e,t,i,n){var r;if(t){if(r=parseInt(t,16),isNaN(r))throw new Error;return s(r)}if(i){if(r=parseInt(i,16),isNaN(r))throw new Error;return r<=65535?s(r):s(55296+(r-=65536)/1024,56320+(1023&r))}var o=a[n];if(!o)throw new Error;return o})}catch(e){return null}},_syntaxError:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t},tokenize:function(e,t){var i=this;if(this._line=1,"string"==typeof e){if(this._input=e,"function"!=typeof t){var n,r=[];if(this._tokenizeToEnd(function(e,t){e?n=e:r.push(t)},!0),n)throw n;return r}o(function(){i._tokenizeToEnd(t,!0)})}else this._input="","function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",function(e){null!==i._input&&(i._input+=e,i._tokenizeToEnd(t,!1))}),e.on("end",function(){null!==i._input&&i._tokenizeToEnd(t,!0)}),e.on("error",t)}},t.exports=r},{}],29:[function(e,t,i){var a=e("./N3Lexer"),n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",l=n+"nil",u=n+"first",c=/^[a-z][a-z0-9+.-]*:/i,r=/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i,d=/(?:^|\/)\.\.?(?:$|[\/#?])/,o=0,h=0;function p(e){if(!(this instanceof p))return new p(e);this._tripleStack=[],this._graph=null,e=e||{},this._setBase(e.documentIRI);var t="string"==typeof e.format&&e.format.match(/\w*$/)[0].toLowerCase(),i="turtle"===t,n="trig"===t,r=/triple/.test(t),o=/quad/.test(t),s=r||o;(this._supportsNamedGraphs=!i)||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(i||n||r),s&&(this._base="",this._resolveIRI=function(e){return this._error("Disallowed relative IRI",e),this._callback=f,this._subject=null}),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":"_:"+e.blankNodePrefix.replace(/^_:/,""),this._lexer=e.lexer||new a({lineMode:s})}function f(){}p._resetBlankNodeIds=function(){o=h=0},p.prototype={_setBase:function(e){if(e){if(0<=e.indexOf("#"))throw new Error("Invalid base IRI "+e)}else e=null;(this._base=e)&&(this._basePath=e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(r),this._baseRoot=e[0],this._baseScheme=e[1])},_readInTopContext:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseIRI;case"BASE":return this._sparqlStyle=!0,this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}},_readSubject:function(e){switch(this._predicate=null,e.type){case"IRI":null===this._base||c.test(e.value)?this._subject=e.value:this._subject=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value;break;case"[":return this._subject="_:b"+h++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:l,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;case"}":return this._readPunctuation(e);default:return this._error("Expected subject but got "+e.type,e)}return this._readPredicateOrNamedGraph},_readPredicate:function(e){var t=e.type;switch(t){case"IRI":case"abbreviation":null===this._base||c.test(e.value)?this._predicate=e.value:this._predicate=this._resolveIRI(e);break;case"prefixed":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);var i=this._prefixes[e.prefix];if(void 0===i)return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=i+e.value;break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._readObject},_readObject:function(e){switch(e.type){case"IRI":null===this._base||c.test(e.value)?this._object=e.value:this._object=this._resolveIRI(e);break;case"prefixed":var t=this._prefixes[e.prefix];if(void 0===t)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value;break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"[":var i="_:b"+h++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:i,type:"blank"}),this._subject=i,this._readBlankNodeHead;case"(":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:l,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readPredicateOrNamedGraph:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)},_readGraph:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)},_readBlankNodeHead:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))},_readBlankNodeTail:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""});var t=this._tripleStack.pop();return this._subject=t.subject,null!==t.object?(this._predicate=t.predicate,this._object=t.object,this._getTripleEndReader()):null!==this._predicate?this._readPredicate:this._readPredicateOrNamedGraph},_readDataTypeOrLang:function(e){switch(e.type){case"type":var t;if(""===e.prefix)t=null===this._base||c.test(e.value)?e.value:this._resolveIRI(e);else{var i=this._prefixes[e.prefix];if(void 0===i)return this._error('Undefined prefix "'+e.prefix+':"',e);t=i+e.value}return this._object+="^^"+t,this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,i=null,n=this._subject,r=this._tripleStack,o=r[r.length-1],s=this._readListItem;switch(e.type){case"IRI":t=null===this._base||c.test(e.value)?e.value:this._resolveIRI(e);break;case"prefixed":var a=this._prefixes[e.prefix];if(void 0===a)return this._error('Undefined prefix "'+e.prefix+':"',e);t=a+e.value;break;case"literal":t=e.value,s=this._readDataTypeOrLang;break;case"[":i="_:b"+h++,t="_:b"+h++,r.push({subject:i,predicate:u,object:t,type:"blank"}),this._subject=t,s=this._readBlankNodeHead;break;case"(":i="_:b"+h++,r.push({subject:i,predicate:u,object:l,type:"list"}),this._subject=null,s=this._readListItem;break;case")":if(r.pop(),0!==r.length&&"list"===r[r.length-1].type&&this._callback(null,{subject:o.subject,predicate:o.predicate,object:o.object,graph:this._graph||""}),this._subject=o.subject,null===o.predicate){if(s=this._readPredicate,o.subject===l)return s}else if(this._predicate=o.predicate,this._object=o.object,s=this._getTripleEndReader(),o.object===l)return s;i=l;break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===i&&(this._subject=i="_:b"+h++),null===n?o.object===l?o.object=i:o.subject=i:this._callback(null,{subject:n,predicate:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",object:i,graph:this._graph||""}),null!==t&&this._callback(null,{subject:i,predicate:u,object:t,graph:this._graph||""}),s},_readPunctuation:function(e){var t,i=this._subject,n=this._graph;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);this._graph=null;case".":this._subject=null,t=this._readInTopContext;break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"IRI":if(this._supportsQuads&&null===this._graph){n=null===this._base||c.test(e.value)?e.value:this._resolveIRI(e),i=this._subject,t=this._readQuadPunctuation;break}case"prefixed":if(this._supportsQuads&&null===this._graph){var r=this._prefixes[e.prefix];if(void 0===r)return this._error('Undefined prefix "'+e.prefix+':"',e);n=r+e.value,t=this._readQuadPunctuation;break}default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return null!==i&&this._callback(null,{subject:i,predicate:this._predicate,object:this._object,graph:n||""}),t},_readBlankNodePunctuation:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,graph:this._graph||""}),t},_readQuadPunctuation:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)},_readPrefixIRI:function(e){return"IRI"!==e.type?this._error('Expected IRI to follow prefix "'+this._prefix+':"',e):(t=null===this._base||c.test(e.value)?e.value:this._resolveIRI(e),this._prefixes[this._prefix]=t,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation);var t},_readBaseIRI:function(t){if("IRI"!==t.type)return this._error("Expected IRI to follow base declaration",t);try{this._setBase(null===this._base||c.test(t.value)?t.value:this._resolveIRI(t))}catch(e){this._error(e.message,t)}return this._readDeclarationPunctuation},_readNamedGraphLabel:function(e){switch(e.type){case"IRI":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}},_readNamedGraphBlankLabel:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject="_:b"+h++,this._readGraph)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(new Error(e+" at line "+t.line+"."))},_resolveIRI:function(e){var t=e.value;switch(t[0]){case void 0:return this._base;case"#":return this._base+t;case"?":return this._base.replace(/(?:\?.*)?$/,t);case"/":return("/"===t[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(t);default:return this._removeDotSegments(this._basePath+t)}},_removeDotSegments:function(e){if(!d.test(e))return e;for(var t="",i=e.length,n=-1,r=-1,o=0,s="/";n<i;){switch(s){case":":if(r<0&&"/"===e[++n]&&"/"===e[++n])for(;(r=n+1)<i&&"/"!==e[r];)n=r;break;case"?":case"#":n=i;break;case"/":if("."===e[n+1])switch(s=e[++n+1]){case"/":t+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return t+e.substring(o,n)+e.substr(n+1);case".":if(void 0===(s=e[++n+1])||"/"===s||"?"===s||"#"===s){if((o=(t+=e.substring(o,n-2)).lastIndexOf("/"))>=r&&(t=t.substr(0,o)),"/"!==s)return t+"/"+e.substr(n+1);o=n+1}}}s=e[++n]}return t+e.substring(o)},parse:function(e,t,i){this._readCallback=this._readInTopContext,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix||"_:b"+o+++"_","function"==typeof e&&(i=t,t=e,e=null),this._callback=t||f,this._prefixCallback=i||f;var n=this;this._lexer.tokenize(e,function(e,t){null!==e?(n._callback(e),n._callback=f):void 0!==n._readCallback&&(n._readCallback=n._readCallback(t))}),e||(this.addChunk=this._lexer.addChunk,this.end=this._lexer.end)}},t.exports=p},{"./N3Lexer":28}],30:[function(e,t,i){var o=e("./N3Util").expandPrefixedName;function n(e,t){if(!(this instanceof n))return new n(e,t);this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._prefixes=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),this.defaultGraph=t.defaultGraph||"http://example.org/#defaultGraph",e&&this.addTriples(e)}n.prototype={get size(){var e=this._size;if(null!==e)return e;var t,i,n=this._graphs;for(var r in n)for(var o in t=n[r].subjects)for(var s in i=t[o])e+=Object.keys(i[s]).length;return this._size=e},_addToIndex:function(e,t,i,n){var r=e[t]||(e[t]={}),o=r[i]||(r[i]={}),s=n in o;return s||(o[n]=null),!s},_removeFromIndex:function(e,t,i,n){var r,o=e[t],s=o[i];for(r in delete s[n],s)return;for(r in delete o[i],o)return;delete e[t]},_findInIndex:function(e,t,i,n,r,o,s,a){var l,u,c,d=[],h=1<!t+!i+!n?Object.keys(this._ids):this._entities;for(var p in t&&((l=e,e={})[t]=l[t]),e){var f=h[p];if(u=e[p])for(var g in i&&((l=u,u={})[i]=l[i]),u){var v=h[g];if(c=u[g])for(var m=(n?n in c?[n]:[]:Object.keys(c)),y=m.length-1;0<=y;y--){var b={subject:"",predicate:"",object:"",graph:a};b[r]=f,b[o]=v,b[s]=h[m[y]],d.push(b)}}}return d},_countInIndex:function(e,t,i,n){var r,o,s,a=0;for(var l in t&&((r=e,e={})[t]=r[t]),e)if(o=e[l])for(var u in i&&((r=o,o={})[i]=r[i]),o)(s=o[u])&&(n?n in s&&a++:a+=Object.keys(s).length);return a},addTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||this.defaultGraph;var r=this._graphs[n];r||(r=this._graphs[n]={subjects:{},predicates:{},objects:{}},Object.freeze(r));var o=this._ids,s=this._entities;e=o[e]||(o[s[++this._id]=e]=this._id),t=o[t]||(o[s[++this._id]=t]=this._id),i=o[i]||(o[s[++this._id]=i]=this._id);var a=this._addToIndex(r.subjects,e,t,i);return this._addToIndex(r.predicates,t,i,e),this._addToIndex(r.objects,i,e,t),this._size=null,a},addTriples:function(e){for(var t=e.length-1;0<=t;t--)this.addTriple(e[t])},addPrefix:function(e,t){this._prefixes[e]=t},addPrefixes:function(e){for(var t in e)this.addPrefix(t,e[t])},removeTriple:function(e,t,i,n){t||(n=e.graph,i=e.object,t=e.predicate,e=e.subject),n=n||this.defaultGraph;var r,o,s,a=this._ids,l=this._graphs;if(!(e=a[e]))return!1;if(!(t=a[t]))return!1;if(!(i=a[i]))return!1;if(!(r=l[n]))return!1;if(!(o=r.subjects[e]))return!1;if(!(s=o[t]))return!1;if(!(i in s))return!1;for(e in this._removeFromIndex(r.subjects,e,t,i),this._removeFromIndex(r.predicates,t,i,e),this._removeFromIndex(r.objects,i,e,t),null!==this._size&&this._size--,r.subjects)return!0;return delete l[n],!0},removeTriples:function(e){for(var t=e.length-1;0<=t;t--)this.removeTriple(e[t])},find:function(e,t,i,n){var r=this._prefixes;return this.findByIRI(o(e,r),o(t,r),o(i,r),o(n,r))},findByIRI:function(e,t,i,n){var r,o,s,a,l=[],u={},c=this._ids;for(var d in n?u[n]=this._graphs[n]:u=this._graphs,u)if(r=u[d]){if(e&&!(o=c[e]))return l;if(t&&!(s=c[t]))return l;if(i&&!(a=c[i]))return l;o?a?l.push(this._findInIndex(r.objects,a,o,s,"object","subject","predicate",d)):l.push(this._findInIndex(r.subjects,o,s,null,"subject","predicate","object",d)):s?l.push(this._findInIndex(r.predicates,s,a,null,"predicate","object","subject",d)):a?l.push(this._findInIndex(r.objects,a,null,null,"object","subject","predicate",d)):l.push(this._findInIndex(r.subjects,null,null,null,"subject","predicate","object",d))}return 1===l.length?l[0]:l.concat.apply([],l)},count:function(e,t,i,n){var r=this._prefixes;return this.countByIRI(o(e,r),o(t,r),o(i,r),o(n,r))},countByIRI:function(e,t,i,n){n=n||this.defaultGraph;var r=this._graphs[n],o=this._ids;return r?e&&!(e=o[e])?0:t&&!(t=o[t])?0:i&&!(i=o[i])?0:e?i?this._countInIndex(r.objects,i,e,t):this._countInIndex(r.subjects,e,t,i):t?this._countInIndex(r.predicates,t,i,e):this._countInIndex(r.objects,i,e,t):0},createBlankNode:function(e){var t,i;if(e)for(t=e="_:"+e,i=1;this._ids[t];)t=e+i++;else for(;t="_:b"+this._blankNodeIndex++,this._ids[t];);return this._ids[t]=++this._id,t}},t.exports=n},{"./N3Util":33}],31:[function(e,t,i){var r=e("stream").Transform,n=e("util"),o=e("./N3Parser.js");function s(e){if(!(this instanceof s))return new s(e);r.call(this,{decodeStrings:!0}),this._readableState.objectMode=!0;var i=this,n=new o(e);n.parse(function(e,t){t&&i.push(t)||e&&i.emit("error",e)},this.emit.bind(this,"prefix")),this._transform=function(e,t,i){n.addChunk(e),i()},this._flush=function(e){n.end(),e()}}n.inherits(s,r),t.exports=s},{"./N3Parser.js":29,stream:15,util:38}],32:[function(e,t,i){var o=e("stream").Transform,n=e("util"),s=e("./N3Writer.js");function a(e){if(!(this instanceof a))return new a(e);o.call(this,{encoding:"utf8"}),this._writableState.objectMode=!0;var n=this,r=new s({write:function(e,t,i){n.push(e),i&&i()},end:function(e){n.push(null),e&&e()}},e);this._transform=function(e,t,i){r.addTriple(e,i)},this._flush=function(e){r.end(e)}}n.inherits(a,o),t.exports=a},{"./N3Writer.js":34,stream:15,util:38}],33:[function(e,t,i){var n="http://www.w3.org/2001/XMLSchema#",r=n+"double",o={isIRI:function(e){if("string"!=typeof e)return!1;if(0===e.length)return!0;var t=e[0];return'"'!==t&&"_"!==t},isLiteral:function(e){return"string"==typeof e&&'"'===e[0]},isBlank:function(e){return"string"==typeof e&&"_:"===e.substr(0,2)},isDefaultGraph:function(e){return!e},inDefaultGraph:function(e){return!e.graph},getLiteralValue:function(e){var t=/^"([^]*)"/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]},getLiteralType:function(e){var t=/^"[^]*"(?:\^\^([^"]+)|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")},getLiteralLanguage:function(e){var t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""},isPrefixedName:function(e){return"string"==typeof e&&/^[^:\/"']*:[^:\/"']+$/.test(e)},expandPrefixedName:function(e,t){var i,n,r,o=/(?:^|"\^\^)([^:\/#"'\^_]*):[^\/]*$/.exec(e);return o&&(n=t[i=o[1]],r=o.index),void 0===n?e:0===r?n+e.substr(i.length+1):e.substr(0,r+3)+n+e.substr(r+i.length+4)},createIRI:function(e){return e&&'"'===e[0]?o.getLiteralValue(e):e},createLiteral:function(e,t){if(!t)switch(typeof e){case"boolean":t="http://www.w3.org/2001/XMLSchema#boolean";break;case"number":isFinite(e)?t=e%1==0?"http://www.w3.org/2001/XMLSchema#integer":r:(t=r,isNaN(e)||(e=0<e?"INF":"-INF"));break;default:return'"'+e+'"'}return'"'+e+(/^[a-z]+(-[a-z0-9]+)*$/i.test(t)?'"@'+t.toLowerCase():'"^^'+t)},prefix:function(e){return o.prefixes({"":e})("")},prefixes:function(e){var n=Object.create(null);for(var t in e)i(t,e[t]);function i(e,t){if(t||!(e in n)){var i=Object.create(null);t=t||"",n[e]=function(e){return i[e]||(i[e]=t+e)}}return n[e]}return i}};function s(e,t){for(var i in o)t?e.prototype[i]=a(o[i]):e[i]=o[i];return e}function a(t){return function(e){return t(this,e)}}t.exports=s(s)},{}],34:[function(e,t,i){var n=/^"([^]*)"(?:\^\^(.+)|@([\-a-z]+))?$/i,r=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,o=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,s={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};function a(e,t){if(!(this instanceof a))return new a(e,t);if(e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{var n="";this._outputStream={write:function(e,t,i){n+=e,i&&i()},end:function(e){e&&e(null,n)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?this._writeTriple=this._writeTripleLine:(this._graph="",this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes))}function l(e){var t=s[e];return void 0===t&&(t=1===e.length?(t=e.charCodeAt(0).toString(16),"\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),"\\U00000000".substr(0,10-t.length)+t)),t}a.prototype={_write:function(e,t){this._outputStream.write(e,"utf8",t)},_writeTriple:function(e,t,i,n,r){try{this._graph!==n&&(this._write((null===this._subject?"":this._graph?"\n}\n":".\n")+(n?this._encodeIriOrBlankNode(n)+" {\n":"")),this._subject=null,this._graph="["!==n[0]?n:"]"),this._subject===e?this._predicate===t?this._write(", "+this._encodeObject(i),r):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),r):this._write((null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(i),r)}catch(e){r&&r(e)}},_writeTripleLine:function(e,t,i,n,r){delete this._prefixMatch;try{this._write(this._encodeIriOrBlankNode(e)+" "+this._encodeIriOrBlankNode(t)+" "+this._encodeObject(i)+(n?" "+this._encodeIriOrBlankNode(n)+".\n":".\n"),r)}catch(e){r&&r(e)}},_encodeIriOrBlankNode:function(e){var t=e[0];if("["===t||"("===t||"_"===t&&":"===e[1])return e;r.test(e)&&(e=e.replace(o,l));var i=this._prefixRegex.exec(e);return i?i[1]?this._prefixIRIs[i[1]]+i[2]:e:"<"+e+">"},_encodeLiteral:function(e,t,i){return r.test(e)&&(e=e.replace(o,l)),i?'"'+e+'"@'+i:t?'"'+e+'"^^'+this._encodeIriOrBlankNode(t):'"'+e+'"'},_encodeSubject:function(e){if('"'===e[0])throw new Error("A literal as subject is not allowed: "+e);return"["===e[0]&&(this._subject="]"),this._encodeIriOrBlankNode(e)},_encodePredicate:function(e){if('"'===e[0])throw new Error("A literal as predicate is not allowed: "+e);return"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===e?"a":this._encodeIriOrBlankNode(e)},_encodeObject:function(e){if('"'!==e[0])return this._encodeIriOrBlankNode(e);var t=n.exec(e);if(!t)throw new Error("Invalid literal: "+e);return this._encodeLiteral(t[1],t[2],t[3])},_blockedWrite:function(){throw new Error("Cannot write because the writer has been closed.")},addTriple:function(e,t,i,n,r){void 0===i?this._writeTriple(e.subject,e.predicate,e.object,e.graph||"",t):"string"!=typeof n?this._writeTriple(e,t,i,"",n):this._writeTriple(e,t,i,n,r)},addTriples:function(e){for(var t=0;t<e.length;t++)this.addTriple(e[t])},addPrefix:function(e,t,i){var n={};n[e]=t,this.addPrefixes(n,i)},addPrefixes:function(e,t){var i=this._prefixIRIs,n=!1;for(var r in e){var o=e[r];/[#\/]$/.test(o)&&i[o]!==(r+=":")&&(n=!0,i[o]=r,null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null,this._graph=""),this._write("@prefix "+r+" <"+o+">.\n"))}if(n){var s="",a="";for(var l in i)s+=s?"|"+l:l,a+=(a?"|":"")+i[l];s=s.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+a+")[^/]*$|^("+s+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(n?"\n":"",t)},blank:function(e,t){var i,n,r=e;switch(void 0===e?r=[]:"string"==typeof e?r=[{predicate:e,object:t}]:"length"in e||(r=[e]),n=r.length){case 0:return"[]";case 1:if("["!==(i=r[0]).object[0])return"[ "+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object)+" ]";default:for(var o="[",s=0;s<n;s++)(i=r[s]).predicate===e?o+=", "+this._encodeObject(i.object):(o+=(s?";\n  ":"\n  ")+this._encodePredicate(i.predicate)+" "+this._encodeObject(i.object),e=i.predicate);return o+"\n]"}},list:function(e){for(var t=e&&e.length||0,i=new Array(t),n=0;n<t;n++)i[n]=this._encodeObject(e[n]);return"("+i.join(" ")+")"},_prefixRegex:/$0^/,end:function(i){null!==this._subject&&(this._write(this._graph?"\n}\n":".\n"),this._subject=null),this._write=this._blockedWrite;var n=i&&function(e,t){n=null,i(e,t)};if(this._endStream)try{return this._outputStream.end(n)}catch(e){}n&&n()}},t.exports=a},{}],35:[function(e,I,A){(function(j){!function(e){var t="object"==typeof A&&A,i="object"==typeof I&&I&&I.exports==t&&I,n="object"==typeof j&&j;n.global!==n&&n.window!==n||(e=n);var r,o,m=2147483647,y=36,b=1,w=26,s=38,a=700,x=72,k=128,_="-",l=/^xn--/,u=/[^ -~]/,c=/\x2E|\u3002|\uFF0E|\uFF61/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},h=y-b,F=Math.floor,C=String.fromCharCode;function E(e){throw RangeError(d[e])}function p(e,t){for(var i=e.length;i--;)e[i]=t(e[i]);return e}function f(e,t){return p(e.split(c),t).join(".")}function T(e){for(var t,i,n=[],r=0,o=e.length;r<o;)55296<=(t=e.charCodeAt(r++))&&t<=56319&&r<o?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function D(e){return p(e,function(e){var t="";return 65535<e&&(t+=C((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=C(e)}).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,i){var n=0;for(e=i?F(e/a):e>>1,e+=F(e/t);h*w>>1<e;n+=y)e=F(e/h);return F(n+(h+1)*e/(e+s))}function g(e){var t,i,n,r,o,s,a,l,u,c,d,h=[],p=e.length,f=0,g=k,v=x;for((i=e.lastIndexOf(_))<0&&(i=0),n=0;n<i;++n)128<=e.charCodeAt(n)&&E("not-basic"),h.push(e.charCodeAt(n));for(r=0<i?i+1:0;r<p;){for(o=f,s=1,a=y;p<=r&&E("invalid-input"),d=e.charCodeAt(r++),(y<=(l=d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:y)||l>F((m-f)/s))&&E("overflow"),f+=l*s,!(l<(u=a<=v?b:v+w<=a?w:a-v));a+=y)s>F(m/(c=y-u))&&E("overflow"),s*=c;v=R(f-o,t=h.length+1,0==o),F(f/t)>m-g&&E("overflow"),g+=F(f/t),f%=t,h.splice(f++,0,g)}return D(h)}function v(e){var t,i,n,r,o,s,a,l,u,c,d,h,p,f,g,v=[];for(h=(e=T(e)).length,t=k,o=x,s=i=0;s<h;++s)(d=e[s])<128&&v.push(C(d));for(n=r=v.length,r&&v.push(_);n<h;){for(a=m,s=0;s<h;++s)t<=(d=e[s])&&d<a&&(a=d);for(a-t>F((m-i)/(p=n+1))&&E("overflow"),i+=(a-t)*p,t=a,s=0;s<h;++s)if((d=e[s])<t&&++i>m&&E("overflow"),d==t){for(l=i,u=y;!(l<(c=u<=o?b:o+w<=u?w:u-o));u+=y)g=l-c,f=y-c,v.push(C(S(c+g%f,0))),l=F(g/f);v.push(C(S(l,0))),o=R(i,p,n==r),i=0,++n}++i,++t}return v.join("")}if(r={version:"1.2.4",ucs2:{decode:T,encode:D},decode:g,encode:v,toASCII:function(e){return f(e,function(e){return u.test(e)?"xn--"+v(e):e})},toUnicode:function(e){return f(e,function(e){return l.test(e)?g(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return r});else if(t&&!t.nodeType)if(i)i.exports=r;else for(o in r)r.hasOwnProperty(o)&&(t[o]=r[o]);else e.punycode=r}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],36:[function(e,t,i){var j=e("punycode");function y(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=o,i.resolve=function(e,t){return o(e,!1,!0).resolve(t)},i.resolveObject=function(e,t){return e?o(e,!1,!0).resolveObject(t):t},i.format=function(e){Q(e)&&(e=o(e));return e instanceof y?e.format():y.prototype.format.call(e)},i.Url=y;var I=/^([a-z0-9.+-]+:)/i,n=/:[0-9]*$/,r=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),A=["'"].concat(r),O=["%","/","?",";","#"].concat(A),N=["/","?","#"],L=/^[a-z0-9A-Z_-]{0,63}$/,M=/^([a-z0-9A-Z_-]{0,63})(.*)$/,P={javascript:!0,"javascript:":!0},U={javascript:!0,"javascript:":!0},$={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},B=e("querystring");function o(e,t,i){if(e&&a(e)&&e instanceof y)return e;var n=new y;return n.parse(e,t,i),n}function Q(e){return"string"==typeof e}function a(e){return"object"==typeof e&&null!==e}function b(e){return null===e}y.prototype.parse=function(e,t,i){if(!Q(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e;n=n.trim();var r=I.exec(n);if(r){var o=(r=r[0]).toLowerCase();this.protocol=o,n=n.substr(r.length)}if(i||r||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===n.substr(0,2);!s||r&&U[r]||(n=n.substr(2),this.slashes=!0)}if(!U[r]&&(s||r&&!$[r])){for(var a,l,u=-1,c=0;c<N.length;c++){-1!==(d=n.indexOf(N[c]))&&(-1===u||d<u)&&(u=d)}-1!==(l=-1===u?n.lastIndexOf("@"):n.lastIndexOf("@",u))&&(a=n.slice(0,l),n=n.slice(l+1),this.auth=decodeURIComponent(a)),u=-1;for(c=0;c<O.length;c++){var d;-1!==(d=n.indexOf(O[c]))&&(-1===u||d<u)&&(u=d)}-1===u&&(u=n.length),this.host=n.slice(0,u),n=n.slice(u),this.parseHost(),this.hostname=this.hostname||"";var h="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!h)for(var p=this.hostname.split(/\./),f=(c=0,p.length);c<f;c++){var g=p[c];if(g&&!g.match(L)){for(var v="",m=0,y=g.length;m<y;m++)127<g.charCodeAt(m)?v+="x":v+=g[m];if(!v.match(L)){var b=p.slice(0,c),w=p.slice(c+1),x=g.match(M);x&&(b.push(x[1]),w.unshift(x[2])),w.length&&(n="/"+w.join(".")+n),this.hostname=b.join(".");break}}}if(255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),!h){var k=this.hostname.split("."),_=[];for(c=0;c<k.length;++c){var F=k[c];_.push(F.match(/[^A-Za-z0-9_-]/)?"xn--"+j.encode(F):F)}this.hostname=_.join(".")}var C=this.port?":"+this.port:"",E=this.hostname||"";this.host=E+C,this.href+=this.host,h&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!P[o])for(c=0,f=A.length;c<f;c++){var T=A[c],D=encodeURIComponent(T);D===T&&(D=escape(T)),n=n.split(T).join(D)}var S=n.indexOf("#");-1!==S&&(this.hash=n.substr(S),n=n.slice(0,S));var R=n.indexOf("?");if(-1!==R?(this.search=n.substr(R),this.query=n.substr(R+1),t&&(this.query=B.parse(this.query)),n=n.slice(0,R)):t&&(this.search="",this.query={}),n&&(this.pathname=n),$[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"",F=this.search||"";this.path=C+F}return this.href=this.format(),this},y.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=e+this.host:this.hostname&&(r=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&a(this.query)&&Object.keys(this.query).length&&(o=B.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||$[t])&&!1!==r?(r="//"+(r||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):r||(r=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+r+(i=i.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},y.prototype.resolve=function(e){return this.resolveObject(o(e,!1,!0)).format()},y.prototype.resolveObject=function(t){if(Q(t)){var e=new y;e.parse(t,!1,!0),t=e}var i=new y;if(Object.keys(this).forEach(function(e){i[e]=this[e]},this),i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(i[e]=t[e])}),$[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(t.protocol&&t.protocol!==i.protocol){if(!$[t.protocol])return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.href=i.format(),i;if(i.protocol=t.protocol,t.host||U[t.protocol])i.pathname=t.pathname;else{for(var n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),i.pathname=n.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var r=i.pathname||"",o=i.search||"";i.path=r+o}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var s=i.pathname&&"/"===i.pathname.charAt(0),a=t.host||t.pathname&&"/"===t.pathname.charAt(0),l=a||s||i.host&&t.pathname,u=l,c=i.pathname&&i.pathname.split("/")||[],d=(n=t.pathname&&t.pathname.split("/")||[],i.protocol&&!$[i.protocol]);if(d&&(i.hostname="",i.port=null,i.host&&(""===c[0]?c[0]=i.host:c.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),t.host=null),l=l&&(""===n[0]||""===c[0])),a)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,c=n;else if(n.length)c||(c=[]),c.pop(),c=c.concat(n),i.search=t.search,i.query=t.query;else if(null!=t.search){if(d)i.hostname=i.host=c.shift(),(v=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=v.shift(),i.host=i.hostname=v.shift());return i.search=t.search,i.query=t.query,b(i.pathname)&&b(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!c.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var h=c.slice(-1)[0],p=(i.host||t.host)&&("."===h||".."===h)||""===h,f=0,g=c.length;0<=g;g--)"."==(h=c[g])?c.splice(g,1):".."===h?(c.splice(g,1),f++):f&&(c.splice(g,1),f--);if(!l&&!u)for(;f--;f)c.unshift("..");!l||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift(""),p&&"/"!==c.join("/").substr(-1)&&c.push("");var v,m=""===c[0]||c[0]&&"/"===c[0].charAt(0);d&&(i.hostname=i.host=m?"":c.length?c.shift():"",(v=!!(i.host&&0<i.host.indexOf("@"))&&i.host.split("@"))&&(i.auth=v.shift(),i.host=i.hostname=v.shift()));return(l=l||i.host&&c.length)&&!m&&c.unshift(""),c.length?i.pathname=c.join("/"):(i.pathname=null,i.path=null),b(i.pathname)&&b(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},y.prototype.parseHost=function(){var e=this.host,t=n.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:35,querystring:13}],37:[function(e,t,i){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],38:[function(h,e,T){(function(n,r){var a=/%[sdj%]/g;T.format=function(e){if(!w(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(l(arguments[i]));return t.join(" ")}i=1;for(var n=arguments,r=n.length,o=String(e).replace(a,function(e){if("%%"===e)return"%";if(r<=i)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}}),s=n[i];i<r;s=n[++i])y(s)||!c(s)?o+=" "+s:o+=" "+l(s);return o},T.deprecate=function(e,t){if(x(r.process))return function(){return T.deprecate(e,t).apply(this,arguments)};if(!0===n.noDeprecation)return e;var i=!1;return function(){if(!i){if(n.throwDeprecation)throw new Error(t);n.traceDeprecation?console.trace(t):console.error(t),i=!0}return e.apply(this,arguments)}};var e,o={};function l(e,t){var i={seen:[],stylize:u};return 3<=arguments.length&&(i.depth=arguments[2]),4<=arguments.length&&(i.colors=arguments[3]),m(t)?i.showHidden=t:t&&T._extend(i,t),x(i.showHidden)&&(i.showHidden=!1),x(i.depth)&&(i.depth=2),x(i.colors)&&(i.colors=!1),x(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=s),p(i,e,i.depth)}function s(e,t){var i=l.styles[t];return i?"["+l.colors[i][0]+"m"+e+"["+l.colors[i][1]+"m":e}function u(e,t){return e}function p(t,i,n){if(t.customInspect&&i&&C(i.inspect)&&i.inspect!==T.inspect&&(!i.constructor||i.constructor.prototype!==i)){var e=i.inspect(n,t);return w(e)||(e=p(t,e,n)),e}var r=function(e,t){if(x(t))return e.stylize("undefined","undefined");if(w(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(b(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(t,i);if(r)return r;var o,s=Object.keys(i),a=(o={},s.forEach(function(e,t){o[e]=!0}),o);if(t.showHidden&&(s=Object.getOwnPropertyNames(i)),F(i)&&(0<=s.indexOf("message")||0<=s.indexOf("description")))return f(i);if(0===s.length){if(C(i)){var l=i.name?": "+i.name:"";return t.stylize("[Function"+l+"]","special")}if(k(i))return t.stylize(RegExp.prototype.toString.call(i),"regexp");if(_(i))return t.stylize(Date.prototype.toString.call(i),"date");if(F(i))return f(i)}var u,c="",d=!1,h=["{","}"];(v(i)&&(d=!0,h=["[","]"]),C(i))&&(c=" [Function"+(i.name?": "+i.name:"")+"]");return k(i)&&(c=" "+RegExp.prototype.toString.call(i)),_(i)&&(c=" "+Date.prototype.toUTCString.call(i)),F(i)&&(c=" "+f(i)),0!==s.length||d&&0!=i.length?n<0?k(i)?t.stylize(RegExp.prototype.toString.call(i),"regexp"):t.stylize("[Object]","special"):(t.seen.push(i),u=d?function(t,i,n,r,e){for(var o=[],s=0,a=i.length;s<a;++s)E(i,String(s))?o.push(g(t,i,n,r,String(s),!0)):o.push("");return e.forEach(function(e){e.match(/^\d+$/)||o.push(g(t,i,n,r,e,!0))}),o}(t,i,n,a,s):s.map(function(e){return g(t,i,n,a,e,d)}),t.seen.pop(),function(e,t,i){if(60<e.reduce(function(e,t){return 0,0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0))return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(u,c,h)):h[0]+c+h[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,i,n,r,o){var s,a,l;if((l=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?a=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(a=e.stylize("[Setter]","special")),E(n,r)||(s="["+r+"]"),a||(e.seen.indexOf(l.value)<0?-1<(a=y(i)?p(e,l.value,null):p(e,l.value,i-1)).indexOf("\n")&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n")):a=e.stylize("[Circular]","special")),x(s)){if(o&&r.match(/^\d+$/))return a;s=(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),e.stylize(s,"string"))}return s+": "+a}function v(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function w(e){return"string"==typeof e}function x(e){return void 0===e}function k(e){return c(e)&&"[object RegExp]"===t(e)}function c(e){return"object"==typeof e&&null!==e}function _(e){return c(e)&&"[object Date]"===t(e)}function F(e){return c(e)&&("[object Error]"===t(e)||e instanceof Error)}function C(e){return"function"==typeof e}function t(e){return Object.prototype.toString.call(e)}function i(e){return e<10?"0"+e.toString(10):e.toString(10)}T.debuglog=function(t){if(x(e)&&(e=n.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(e)){var i=n.pid;o[t]=function(){var e=T.format.apply(T,arguments);console.error("%s %d: %s",t,i,e)}}else o[t]=function(){};return o[t]},(T.inspect=l).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},T.isArray=v,T.isBoolean=m,T.isNull=y,T.isNullOrUndefined=function(e){return null==e},T.isNumber=b,T.isString=w,T.isSymbol=function(e){return"symbol"==typeof e},T.isUndefined=x,T.isRegExp=k,T.isObject=c,T.isDate=_,T.isError=F,T.isFunction=C,T.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},T.isBuffer=h("./support/isBuffer");var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(e,t){return Object.prototype.hasOwnProperty.call(e,t)}T.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[i(e.getHours()),i(e.getMinutes()),i(e.getSeconds())].join(":"),[e.getDate(),d[e.getMonth()],t].join(" ")),T.format.apply(T,arguments))},T.inherits=h("inherits"),T._extend=function(e,t){if(!t||!c(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e}}).call(this,h("7YKIPe"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":37,"7YKIPe":10,inherits:24}],39:[function(e,t,i){var n=e("./parser"),a=e("./utils"),d=a;function c(e,t){this.name="NonSupportedSparqlFeatureError",this.feature=e,this.message=t||"SPARQL feature "+e+" non supported"}function r(e){this.name=ParserError,this.message=e||"Error parsing SPARQL query"}c.prototype=new Error,c.constructor=c,r.prototype=new Error,r.constructor=r,AbstractQueryTree=function(){},AbstractQueryTree.prototype.parseQueryString=function(e){return n.parse(e)},AbstractQueryTree.prototype.parseExecutableUnit=function(e){if("select"===e.kind)return this.parseSelect(e);if("ask"===e.kind)return this.parseSelect(e);if("modify"===e.kind)return this.parseSelect(e);if("construct"===e.kind)return this.parseSelect(e);if("insertdata"===e.kind)return this.parseInsertData(e);if("deletedata"===e.kind)return this.parseInsertData(e);if("load"===e.kind)return e;if("clear"===e.kind)return e;if("drop"===e.kind)return e;if("create"===e.kind)return e;throw new Error("unknown executable unit: "+e.kind)},AbstractQueryTree.prototype.parseSelect=function(e){if(null==e)return console.log("error parsing query"),null;return e.pattern=this.build(e.pattern,{freshCounter:0}),e},AbstractQueryTree.prototype.parseInsertData=function(e){return null==e?(console.log("error parsing query"),null):e},AbstractQueryTree.prototype.build=function(e,t){if("groupgraphpattern"===e.token)return this._buildGroupGraphPattern(e,t);if("basicgraphpattern"===e.token){var i={kind:"BGP",value:e.triplesContext};return i=AbstractQueryTree.translatePathExpressionsInBGP(i,t)}if("graphunionpattern"===e.token)return{kind:"UNION",value:[this.build(e.value[0],t),this.build(e.value[1],t)]};if("graphgraphpattern"!==e.token)throw null!=e.token?new c(e.token,"Non implemented SPARQL graph pattern: '"+e.token+"'"):new r("Error parsing graph pattern: '"+JSON.stringify(e)+"'");return{kind:"GRAPH",value:this.build(e.value,t),graph:e.graph}},AbstractQueryTree.translatePathExpressionsInBGP=function(e,t){for(var i,n,r,o=[],s=0;s<e.value.length;s++)if(e.value[s].predicate&&"path"===e.value[s].predicate.token){i=e.value[s],n=e.value.slice(s+1);var a=AbstractQueryTree.translatePathExpression(i,t),l=null;if("BGP"!==a.kind){if("ZERO_OR_MORE_PATH"!==a.kind&&"ONE_OR_MORE_PATH"!==a.kind)return a;if(r=0<o.length?{kind:"JOIN",lvalue:{kind:"BGP",value:o},rvalue:a}:a,"ZERO_OR_MORE_PATH"===a.kind)if("var"===a.y.token&&0===a.y.value.indexOf("fresh:")&&"var"===a.x.token&&0===a.x.value.indexOf("fresh:"))for(var u=0;u<e.value.length;u++)e.value[u].object&&"var"===e.value[u].object.token&&e.value[u].object.value===a.x.value&&((l=d.clone(e.value[u],!0)).object=a.y);else if("var"===a.y.token&&0===a.y.value.indexOf("fresh:"))for(u=0;u<e.value.length;u++)e.value[u].subject&&"var"===e.value[u].subject.token&&e.value[u].subject.value===a.y.value&&((l=d.clone(e.value[u],!0)).subject=a.x);if(0<n.length){var c=AbstractQueryTree.translatePathExpressionsInBGP({kind:"BGP",value:n},t);return null==l?{kind:"JOIN",lvalue:r,rvalue:c}:{kind:"UNION",value:[{kind:"JOIN",lvalue:r,rvalue:c},{kind:"BGP",value:o.concat([l]).concat(n)}]}}return r}o=o.concat(a.value)}else o.push(e.value[s]);return e.value=o,e},AbstractQueryTree.translatePathExpression=function(e,t){if("element"===e.predicate.kind)return"+"!==e.predicate.modifier?"*"!==e.predicate.modifier?(e.predicate=e.predicate.value,{kind:"BGP",value:[e]}):(e.predicate.modifier=null,{kind:"ZERO_OR_MORE_PATH",path:AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object}):(e.predicate.modifier=null,{kind:"ONE_OR_MORE_PATH",path:AbstractQueryTree.translatePathExpression(e,t),x:e.subject,y:e.object});if("sequence"!==e.predicate.kind)throw new c("Non supported path expression "+e.predicate.kind);for(var i,n,r=e.subject,o=e.object,s=e.graph,a=[],l=0;l<e.predicate.value.length;l++)l!=e.predicate.value.length-1?(i={token:"var",value:"fresh:"+t.freshCounter},t.freshCounter++):i=o,n={subject:r,predicate:e.predicate.value[l],object:i},null!=s&&(n.graph=d.clone(s,!0)),a.push(n),l!=e.predicate.value.length-1&&(r=d.clone(i,!0));var u={kind:"BGP",value:a};return AbstractQueryTree.translatePathExpressionsInBGP(u,t)},AbstractQueryTree.prototype._buildGroupGraphPattern=function(e,t){for(var i=e.filters||[],n=e.binds||[],r={kind:"EMPTY_PATTERN"},o=0;o<e.patterns.length;o++){var s=e.patterns[o];if("optionalgraphpattern"===s.token){r="FILTER"===(a=this.build(s.value,t)).kind?{kind:"LEFT_JOIN",lvalue:r,rvalue:a.value,filter:a.filter}:{kind:"LEFT_JOIN",lvalue:r,rvalue:a,filter:!0}}else{var a=this.build(s,t);r="EMPTY_PATTERN"==r.kind?a:{kind:"JOIN",lvalue:r,rvalue:a}}}if(r.binds=n,0==i.length)return r;if("EMPTY_PATTERN"===r.kind)return{kind:"FILTER",filter:i,value:r};if("LEFT_JOIN"===r.kind&&!0===r.filter)return{kind:"FILTER",filter:i,value:r};if("LEFT_JOIN"===r.kind)return{kind:"FILTER",filter:i,value:r};if("JOIN"===r.kind)return{kind:"FILTER",filter:i,value:r};if("UNION"===r.kind)return{kind:"FILTER",filter:i,value:r};if("GRAPH"===r.kind)return{kind:"FILTER",filter:i,value:r};if("BGP"===r.kind)return{kind:"FILTER",filter:i,value:r};throw new Error("Unknow kind of algebra expression: "+r.kind)},AbstractQueryTree.prototype.collectBasicTriples=function(e,t){if(null==t&&(t=[]),"select"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("BGP"===e.kind)t=t.concat(e.value);else if("ZERO_OR_MORE_PATH"===e.kind)t=this.collectBasicTriples(e.path);else if("UNION"===e.kind)t=this.collectBasicTriples(e.value[0],t),t=this.collectBasicTriples(e.value[1],t);else if("GRAPH"===e.kind)t=this.collectBasicTriples(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)t=this.collectBasicTriples(e.lvalue,t),t=this.collectBasicTriples(e.rvalue,t);else if("FILTER"===e.kind)t=this.collectBasicTriples(e.value,t);else if("construct"===e.kind)t=this.collectBasicTriples(e.pattern,t);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return t},AbstractQueryTree.prototype.bind=function(e,t){if(null!=e.graph&&e.graph.token&&"var"===e.graph.token&&null!=t[e.graph.value]&&(e.graph=t[e.graph.value]),null!=e.filter){for(var i=[],n=0;n<e.filter.length;n++)e.filter[n].value=this._bindFilter(e.filter[n].value,t),i.push(e.filter[n]);e.filter=i}if("select"===e.kind)e.pattern=this.bind(e.pattern,t);else if("BGP"===e.kind)e.value=this._bindTripleContext(e.value,t);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._bindTripleContext(e.path,t),e.x&&"var"===e.x.token&&null!=t[e.x.value]&&(e.x=t[e.x.value]),e.y&&"var"===e.y.token&&null!=t[e.y.value]&&(e.y=t[e.y.value]);else if("UNION"===e.kind)e.value[0]=this.bind(e.value[0],t),e.value[1]=this.bind(e.value[1],t);else if("GRAPH"===e.kind)e.value=this.bind(e.value,t);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.bind(e.lvalue,t),e.rvalue=this.bind(e.rvalue,t);else if("FILTER"===e.kind){var r=this;e.value=this.bind(e.value,t),e.filter=e.filter.map(function(e){return{token:"filter",value:r._bindFilter(e.value,t)}})}else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._bindTripleContext=function(e,t){for(var i=0;i<e.length;i++)for(var n in delete e[i].graph,delete e[i].variables,e[i]){var r=e[i][n];"var"===r.token&&null!=t[r.value]&&(e[i][n]=t[r.value])}return e},AbstractQueryTree.prototype._bindFilter=function(e,t){if(null!=e.expressionType){var i=e.expressionType;if("relationalexpression"==i)e.op1=this._bindFilter(e.op1,t),e.op2=this._bindFilter(e.op2,t);else if("conditionalor"==i||"conditionaland"==i)for(var n=0;n<e.operands.length;n++)e.operands[n]=this._bindFilter(e.operands[n],t);else if("additiveexpression"==i){e.summand=this._bindFilter(e.summand,t);for(n=0;n<e.summands.length;n++)e.summands[n].expression=this._bindFilter(e.summands[n].expression,t)}else if("builtincall"==i)for(n=0;n<e.args.length;n++)e.args[n]=this._bindFilter(e.args[n],t);else if("multiplicativeexpression"==i){e.factor=this._bindFilter(e.factor,t);for(n=0;n<e.factors.length;n++)e.factors[n].expression=this._bindFilter(e.factors[n].expression,t)}else if("unaryexpression"==i)e.expression=this._bindFilter(e.expression,t);else if("irireforfunction"==i)for(n=0;n<e.factors.args;n++)e.args[n]=this._bindFilter(e.args[n],t);else if("atomic"==i&&"var"==e.primaryexpression&&null!=t[e.value.value]){var r=t[e.value.value];"uri"===r.token?e.primaryexpression="iri":e.primaryexpression="literal",e.value=r}}return e},AbstractQueryTree.prototype.replace=function(e,t,i,n){if(null!=e.graph&&e.graph.token&&e.graph.token===t.token&&e.graph.value==t.value&&(e.graph=d.clone(i,!0)),null!=e.filter){for(var r=[],o=0;o<e.filter.length;o++)e.filter[o].value=this._replaceFilter(e.filter[o].value,t,i,n),r.push(e.filter[o]);e.filter=r}if("select"===e.kind)e.pattern=this.replace(e.pattern,t,i,n);else if("BGP"===e.kind)e.value=this._replaceTripleContext(e.value,t,i,n);else if("ZERO_OR_MORE_PATH"===e.kind)e.path=this._replaceTripleContext(e.path,t,i,n),e.x&&e.x.token===t.token&&e.value===t.value&&(e.x=d.clone(i,!0)),e.y&&e.y.token===t.token&&e.value===t.value&&(e.y=d.clone(i,!0));else if("UNION"===e.kind)e.value[0]=this.replace(e.value[0],t,i,n),e.value[1]=this.replace(e.value[1],t,i,n);else if("GRAPH"===e.kind)e.value=this.replace(e.value,t,i);else if("LEFT_JOIN"===e.kind||"JOIN"===e.kind)e.lvalue=this.replace(e.lvalue,t,i,n),e.rvalue=this.replace(e.rvalue,t,i,n);else if("FILTER"===e.kind)e.value=this._replaceFilter(e.value,t,i,n);else if("EMPTY_PATTERN"!==e.kind)throw"Unknown pattern: "+e.kind;return e},AbstractQueryTree.prototype._replaceTripleContext=function(e,t,i,n){for(var r=0;r<e.length;r++)for(var o in e[r]){var s=e[r][o];"var"===s.token&&"var"===t.token&&s.value===t.value?e[r][o]=i:"blank"===s.token&&"blank"===t.token&&s.value===t.value?e[r][o]=i:"literal"!==s.token&&"uri"!==s.token||"literal"!==t.token&&"uri"!==t.token||s.token!==t.token||a.lexicalFormTerm(s,n)[s.token]!==a.lexicalFormTerm(t,n)[s.token]||(e[r][o]=i)}return e},AbstractQueryTree.prototype._replaceFilter=function(e,t,i,n){if(null!=e.expressionType){var r=e.expressionType;if("relationalexpression"==r)e.op1=this._replaceFilter(e.op1,t,i,n),e.op2=this._replaceFilter(e.op2,t,i,n);else if("conditionalor"==r||"conditionaland"==r)for(var o=0;o<e.operands.length;o++)e.operands[o]=this._replaceFilter(e.operands[o],t,i,n);else if("additiveexpression"==r){e.summand=this._replaceFilter(e.summand,t,i,n);for(o=0;o<e.summands.length;o++)e.summands[o].expression=this._replaceFilter(e.summands[o].expression,t,i,n)}else if("builtincall"==r)for(o=0;o<e.args.length;o++)e.args[o]=this._replaceFilter(e.args[o],t,i,n);else if("multiplicativeexpression"==r){e.factor=this._replaceFilter(e.factor,t,i,n);for(o=0;o<e.factors.length;o++)e.factors[o].expression=this._replaceFilter(e.factors[o].expression,t,i,n)}else if("unaryexpression"==r)e.expression=this._replaceFilter(e.expression,t,i,n);else if("irireforfunction"==r)for(o=0;o<e.factors.args;o++)e.args[o]=this._replaceFilter(e.args[o],t,i,n);else if("atomic"==r){var s=null;e.primaryexpression==t.token&&e.value==t.value?s=i.value:"iri"==e.primaryexpression&&"uri"==t.token&&e.value==t.value&&(s=i.value),null!=s&&("uri"===i.token?e.primaryexpression="iri":e.primaryexpression=i.token,e.value=s)}}return e},AbstractQueryTree.prototype.treeWithUnion=function(e){if(null==e)return!1;if(null==e.kind)return!1;if("select"===e.kind)return this.treeWithUnion(e.pattern);if("BGP"===e.kind)return this.treeWithUnion(e.value);if("ZERO_OR_MORE_PATH"===e.kind)return!1;if("UNION"===e.kind){if(null==e.value[0].value||null==e.value[0].value.variables||null==e.value[1].value||null==e.value[1].value.variables)return!0;if(e.value[0].variables.join("/")===e.values[1].variables.join("/"))return!!this.treeWithUnion(e.value[0])||this.treeWithUnion(e.value[1])}else{if("GRAPH"===e.kind)return!1;if("LEFT_JOIN"!==e.kind&&"JOIN"!==e.kind)return"FILTER"===e.kind||e.kind,!1;if(this.treeWithUnion(e.lvalue))return!0;this.treeWithUnion(e.rvalue)}},t.exports={AbstractQueryTree:AbstractQueryTree,NonSupportedSparqlFeatureError:c,SparqlParserError:r}},{"./parser":46,"./utils":57}],40:[function(e,t,i){"use strict";var n=e("./utils"),s=n,r=n.nextTick,o=function(e,t){if(0!=arguments.length){this.order=e,this.root=this._allocateNode(),this.root.isLeaf=!0,this.root.level=0;var i=this;this._diskWrite(this.root,function(e){i.root=e,i._updateRootNode(i.root,function(e){i.comparator=function(e,t){return e<t?-1:t<e?1:0},(i.merger=null)!=t&&t(i)})})}};o.prototype._allocateNode=function(){return new a},o.prototype._diskWrite=function(e,t){r(function(){t(e)})},o.prototype._diskRead=function(e,t){r(function(){t(e)})},o.prototype._diskDelete=function(e,t){r(function(){t()})},o.prototype._updateRootNode=function(e,t){t(e)},o.prototype.search=function(e,t,i){var n=this.root;this.__search(this,e,n,t,i)},o.prototype.__search=function(t,i,e,n,r){for(var o=0;o<e.numberActives&&1===t.comparator(i,e.keys[o].key);)o++;o<e.numberActives&&0===t.comparator(e.keys[o].key,i)?n(null!=r&&1==r||e.keys[o].data):!0===e.isLeaf?n(null):t._diskRead(e.children[o],function(e){t.__search(t,i,e,n,r)})},o.prototype.walk=function(e,t){this.__walk(this,this.root,e,t)},o.prototype.__walk=function(i,n,r,t){var e=n.numberActives,o=0;if(n.isLeaf){for(o=0;o<n.numberActives;o++)r(n.keys[o]);return t()}s.whilst(function(){return o<e},function(t){i._diskRead(n.children[o],function(e){i.__walk(i,e,r,function(){i._diskRead(n.keys[o],function(e){r(e),o++,t()})})})},function(){i._diskRead(n.children[e],function(e){i.__walk(i,e,r,function(){t()})})})},o.prototype.walkNodes=function(e){this.__walkNodes(this,root,e,function(){})},o.prototype.__walkNodes=function(i,e,n,t){if(e.isLeaf)return n(e),t();n(e);var r=e.numberActives,o=0;s.whilst(function(){return o<r},function(t){i._diskRead(e.children[o],function(e){i.__walkNodes(i,e,n,function(){o++,t()})})},function(){i._diskRead(e.children[r],function(e){i.__walkNodes(i,e,n,function(){})})})},o.prototype._splitChild=function(t,i,n,r){var e=this._allocateNode();e.isLeaf=n.isLeaf,e.level=n.level,e.numberActives=this.order-1;var o=n.keys[this.order-1];n.keys[this.order-1]=null;for(var s=0;s<this.order-1;s++)e.keys[s]=n.keys[s+this.order],n.keys[s+this.order]=null,n.isLeaf||(e.children[s]=n.children[s+this.order],n.children[s+this.order]=null);for(n.isLeaf||(e.children[s]=n.children[s+this.order],n.children[s+this.order]=null),n.numberActives=this.order-1,s=t.numberActives+1;i+1<s;s--)t.children[s]=t.children[s-1];for(t.children[i+1]=e,s=t.numberActives;i<s;s--)t.keys[s]=t.keys[s-1];t.keys[i]=o,t.numberActives++;var a=this;this._diskWrite(e,function(e){a._diskWrite(t,function(t){t.children[i+1]=e,a._diskWrite(n,function(e){return r(t)})})})},o.prototype.insert=function(t,i,n){if(this.root.numberActives===2*this.order-1){var r=this._allocateNode();r.isLeaf=!1,r.level=this.root.level+1,r.numberActives=0,r.children[0]=this.root;var o=this;this._splitChild(r,0,this.root,function(e){r=e,o.root=r,o._updateRootNode(r,function(e){o._insertNonFull(e,t,i,n)})})}else this._insertNonFull(this.root,t,i,n)},o.prototype._insertNonFull=function(e,t,i,n){var r=e.numberActives-1;this.__insertNonFull(this,e,r,t,i,n)},o.prototype.__insertNonFull=function(t,i,n,r,o,s){if(i.isLeaf){for(;0<=n&&-1===t.comparator(r,i.keys[n].key);)i.keys[n+1]=i.keys[n],n--;0<=n&&0===t.comparator(r,i.keys[n].key)?i.keys[n]={key:r,data:o}:(i.keys[n+1]={key:r,data:o},i.numberActives++),t._diskWrite(i,function(e){return s(e)})}else{for(;0<=n&&-1===t.comparator(r,i.keys[n].key);)n--;n++;var a=t;t._diskRead(i.children[n],function(e){e.numberActives===2*a.order-1?a._splitChild(i,n,e,function(){1===a.comparator(r,i.keys[n].key)&&n++,a._diskRead(i.children[n],function(e){n=e.numberActives-1,a.__insertNonFull(t,e,n,r,o,s)})}):a._diskRead(i.children[n],function(e){n=e.numberActives-1,a.__insertNonFull(t,e,n,r,o,s)})})}},o.prototype.delete=function(e,t){var i=this.root;o.prototype.__deleteSearchNode(this,e,i,t)},o.prototype.__deleteSearchNode=function(o,s,e,a){var l=0;if(0===e.numberActives)return a(!1);for(;l<e.numberActives&&1===o.comparator(s,e.keys[l].key);)l++;var u=l;if(l<e.numberActives&&0===o.comparator(s,e.keys[l].key))return o.__deleteNodeFound(o,u,s,e,a);if(!0===e.isLeaf)return a(!1);var c=e;o._diskRead(e.children[l],function(i){if(null===i)return a(!1);var n=!1,r=!1,e=null,t=null;u===c.numberActives?(r=!0,t=c.children[u-1],e=c.children[u-1]):0===u?(n=!0,e=c.children[1],t=c.children[1]):(t=c.children[u-1],e=c.children[u+1]),o._diskRead(t,function(t){o._diskRead(e,function(e){!0===r&&(e=null),!0===n&&(t=null),i.numberActives===o.order-1&&null!=c?null!=e&&e.numberActives>o.order-1?o._moveKey(c,l,-1,function(e){o.__deleteSearchNode(o,s,i,a)}):null!=t&&t.numberActives>o.order-1?o._moveKey(c,l,1,function(e){o.__deleteSearchNode(o,s,i,a)}):null!=t&&t.numberActives===o.order-1?o._mergeSiblings(c,l,-1,function(e){o.__deleteSearchNode(o,s,e,a)}):null!=e&&e.numberActives===o.order-1&&o._mergeSiblings(c,l,1,function(e){o.__deleteSearchNode(o,s,e,a)}):o.__deleteSearchNode(o,s,i,a)})})})},o.prototype.__deleteNodeFound=function(n,r,o,s,a){return s.isLeaf&&s.numberActives>n.order-1?(n._deleteKeyFromNode(s,r,function(){a(!0)}),!0):s.isLeaf&&s===n.root?(n._deleteKeyFromNode(s,r,function(){a(!0)}),!0):(!1===s.isLeaf&&n._diskRead(s.children[r],function(i){i.numberActives>n.order-1?n._getMaxKeyPos(n,i,function(e){o=e.node.keys[e.index],s.keys[r]=o,n._diskWrite(s,function(e){e=i,o=o.key,n.__deleteSearchNode(n,o,e,a)})}):n._diskRead(s.children[r+1],function(t){t.numberActives>n.order-1?n._getMinKeyPos(n,t,function(e){o=e.node.keys[e.index],s.keys[r]=o,n._diskWrite(s,function(e){e=t,o=o.key,n.__deleteSearchNode(n,o,e,a)})}):i.numberActives===n.order-1&&t.numberActives===n.order-1&&n._mergeNodes(i,s.keys[r],t,function(t){s.children[r]=t;for(var e=++r;e<s.numberActives;e++)s.children[e]=s.children[e+1],s.keys[e-1]=s.keys[e];s.children[e]=null,s.keys[e-1]=null,s.numberActives--,0===s.numberActives&&n.root===s&&(n.root=t),n._diskWrite(s,function(e){n.__deleteSearchNode(n,o,t,a)})})})}),void(s.isLeaf&&s.numberActives>n.order-1&&n._deleteKeyFromNode(s,r,function(e){n.__deleteSearchNode(n,o,e,a)})))},o.prototype._moveKey=function(n,r,o,s){1===o&&r--;var a=this;a._diskRead(n.children[r],function(i){a._diskRead(n.children[r+1],function(t){if(-1==o){i.keys[i.numberActives]=n.keys[r],i.children[i.numberActives+1]=t.children[0],t.children[0]=null,i.numberActives++,n.keys[r]=t.keys[0];for(var e=1;e<t.numberActives;e++)t.keys[e-1]=t.keys[e],t.children[e-1]=t.children[e];t.children[t.numberActives-1]=t.children[t.numberActives],t.numberActives--}else{t.children[t.numberActives+1]=t.children[t.numberActives];for(e=t.numberActives;0<e;e--)t.children[e]=t.children[e-1],t.keys[e]=t.keys[e-1];t.keys[0]=null,t.children[0]=null,t.children[0]=i.children[i.numberActives],t.keys[0]=n.keys[r],t.numberActives++,i.children[i.numberActives]=null,n.keys[r]=i.keys[i.numberActives-1],i.keys[i.numberActives-1]=null,i.numberActives--}a._diskWrite(i,function(e){a._diskWrite(t,function(e){a._diskWrite(n,function(e){return s(e)})})})})})},o.prototype._mergeSiblings=function(r,t,e,o){var s,a,i,l;l=t===r.numberActives?(t--,i=r.children[r.numberActives-1],r.children[r.numberActives]):(i=r.children[t],r.children[t+1]);var u=this;u._diskRead(i,function(n){u._diskRead(l,function(i){var e=u._allocateNode();for(e.isLeaf=n.isLeaf,e.level=n.level,a=0;a<u.order-1;a++)e.keys[a]=n.keys[a],e.children[a]=n.children[a];for(e.keys[u.order-1]=r.keys[t],e.children[u.order-1]=n.children[u.order-1],a=0;a<u.order-1;a++)e.keys[a+u.order]=i.keys[a],e.children[a+u.order]=i.children[a];for(e.children[2*u.order-1]=i.children[u.order-1],r.children[t]=e,a=t;a<r.numberActives;a++)r.keys[a]=r.keys[a+1],r.children[a+1]=r.children[a+2];for(e.numberActives=n.numberActives+i.numberActives+1,r.numberActives--,s=r.numberActives;s<2*u.order-1;s++)r.keys[s]=null;0===r.numberActives&&u.root===r&&((u.root=e).level?e.isLeaf=!1:e.isLeaf=!0),u._diskWrite(e,function(t){u._diskWrite(r,function(e){u._diskDelete(n,function(){u._diskDelete(i,function(){if(u.root!==t)return o(t);u._updateRootNode(u.root,function(){return o(t)})})})})})})})},o.prototype._deleteKeyFromNode=function(e,t,i){var n,r=2*this.order-1;if(e.numberActives<r&&(r=e.numberActives),!1===e.isLeaf)return!1;e.keys[t];for(n=t;n<r-1;n++)e.keys[n]=e.keys[n+1];e.keys.pop(),e.numberActives--,this._diskWrite(e,function(e){return i(e)})},o.prototype._mergeNodes=function(t,e,i,n){var r,o;for((r=this._allocateNode()).isLeaf=!0,o=0;o<t.numberActives;o++)r.keys[o]=t.keys[o],r.children[o]=t.children[o];for(r.children[t.numberActives]=t.children[t.numberActives],r.keys[t.numberActives]=e,o=0;o<i.numberActives;o++)r.keys[o+t.numberActives+1]=i.keys[o],r.children[o+t.numberActives+1]=i.children[o];r.children[2*this.order-1]=i.children[i.numberActives],r.numberActives=t.numberActives+i.numberActives+1,r.isLeaf=t.isLeaf,r.level=t.level;var s=this;this._diskWrite(r,function(e){s._diskDelete(t,function(){s._diskDelete(i,function(){return n(e)})})})},o.prototype.audit=function(o){var s=[],a=[],l=this,u=function(e){for(var t=0;t<a.length;t++)if(0===l.comparator(a[t],e)){var i=" !!! duplicated key "+e;!0===o&&console.log(i),s.push(i)}},c=null;l=this;return this.walkNodes(function(e){!0===o&&(console.log("--- Node at "+e.level+" level"),console.log(" - leaf? "+e.isLeaf),console.log(" - num actives? "+e.numberActives),console.log(" - keys: "));for(var t=e.numberActives;t<e.keys.length;t++)null!=e.keys[t]&&!0===o&&(console.log(" * warning : redundant key data"),s.push(" * warning : redundant key data"));for(t=e.numberActives+1;t<e.children.length;t++)null!=e.children[t]&&!0===o&&(console.log(" * warning : redundant children data"),s.push(" * warning : redundant key data"));if(!1===e.isLeaf)for(t=0;t<e.numberActives;t++){var i=this._diskRead(e.children[t]).keys[this._diskRead(e.children[t]).numberActives-1].key,n=this._diskRead(e.children[t+1]).keys[0].key;if(!0===o&&console.log("   "+e.keys[t].key+"("+i+","+n+")"),-1===l.comparator(e.keys[t].key,i)){var r=" !!! value max left "+i+" > key "+e.keys[t].key;!0===o&&console.log(r),s.push(r)}if(1===l.comparator(e.keys[t].key,n)){r=" !!! value min right "+n+" < key "+e.keys[t].key;!0===o&&console.log(r),s.push(r)}u(e.keys[t].key),a.push(e.keys[t].key)}else{if(null===c)c=e.level;else if(c!=e.level){r=" !!! Leaf node with wrong level value";!0===o&&console.log(r),s.push(r)}for(t=0;t<e.numberActives;t++)!0===o&&console.log(" "+e.keys[t].key),u(e.keys[t].key),a.push(e.keys[t].key)}if(e!=l.root){if(e.numberActives>2*l.order-1){if(!0===o)r=" !!!! MAX num keys restriction violated ";console.log(r),s.push(r)}if(e.numberActives<l.order-1){if(!0===o)r=" !!!! MIN num keys restriction violated ";console.log(r),s.push(r)}}}),s},o.prototype._getMaxKeyPos=function(t,e,i){var n={};return null===e?i(null):!0===e.isLeaf?(n.node=e,n.index=e.numberActives-1,i(n)):(n.node=e,n.index=e.numberActives-1,void t._diskRead(e.children[e.numberActives],function(e){return t._getMaxKeyPos(t,e,i)}))},o.prototype._getMinKeyPos=function(t,e,i){var n={};if(null===e&&i(null),!0===e.isLeaf)return n.node=e,n.index=0,i(n);n.node=e,n.index=0,t._diskRead(e.children[0],function(e){return t._getMinKeyPos(t,e,i)})};var a=function(){this.numberActives=0,this.isLeaf=null,this.keys=[],this.children=[],this.level=0};t.exports={Tree:o,Node:a}},{"./utils":57}],41:[function(e,t,i){var a=e("./query_engine").QueryEngine,l=e("./quad_backend").QuadBackend,u=e("./persistent_quad_backend").PersistentQuadBackend,c=e("./lexicon").Lexicon,d=e("./persistent_lexicon").PersistentLexicon,h=e("./rdf_model"),p=e("./utils");Store=function(e,t){var n=null,r=null;if(0==arguments.length)r={};else if(1==arguments.length)r={},n=e;else{if(!(1<arguments.length))throw"An optional argument map and a callback must be provided";r=e,n=t}null==r.treeOrder&&(r.treeOrder=15);var i=c,o=l;!0===r.persistent&&(i=d,o=u),this.functionMap={};var s=this;this.customFns={},new i(function(i){var e=function(){new o(r,function(e){var t=function(){r.backend=e,r.lexicon=i,s.engine=new a(r),n(null,s)};r.overwrite?e.clear(t):t()})};!0===r.overwrite?i.clear(e):e()},r.name)},Store.prototype.rdf=h.rdf,Store.prototype.rdf.api=h,Store.prototype.registerCustomFunction=function(e,t){this.customFns[e]=t,this.engine.setCustomFunctions(this.customFns)},Store.prototype.execute=function(){if(3===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2]);else if(4===arguments.length)this.executeWithEnvironment(arguments[0],arguments[1],arguments[2],arguments[3]);else{var e;if(1===arguments.length){e=arguments[0];var t=function(){}}else 2===arguments.length&&(e=arguments[0],t=arguments[1]);this.engine.execute(e,t)}},Store.prototype.executeWithEnvironment=function(){var e,t,i;if(3===arguments.length){e=arguments[0];var n=function(){};t=arguments[1],i=arguments[2]}else if(4===arguments.length){e=arguments[0];n=arguments[3];t=arguments[1],i=arguments[2]}t=p.map(t,function(e){return{token:"uri",value:e}}),i=p.map(i,function(e){return{token:"uri",value:e}}),this.engine.execute(e,n,t,i)},Store.prototype.graph=function(){var e=null,t=null;if(1===arguments.length)t=arguments[0]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(2!==arguments.length)throw"An optional graph URI and a callback function must be provided";t=arguments[1]||function(){},e=arguments[0]}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),this.engine.execute("CONSTRUCT { ?s ?p ?o } WHERE { GRAPH <"+e+"> { ?s ?p ?o } }",t)},Store.prototype.node=function(){var e=null,t=null,i=null;if(2===arguments.length)i=arguments[0],t=arguments[1]||function(){},e=this.engine.lexicon.defaultGraphUri;else{if(3!==arguments.length)throw"An optional graph URI, node URI and a callback function must be provided";i=arguments[0],e=arguments[1],t=arguments[2]||function(){}}null!=this.rdf.resolve(e)&&(e=this.rdf.resolve(e)),null!=this.rdf.resolve(i)&&(i=this.rdf.resolve(i)),this.engine.execute("CONSTRUCT { <"+i+"> ?p ?o } WHERE { GRAPH <"+e+"> { <"+i+"> ?p ?o } }",t)},Store.prototype.startObservingNode=function(){var e,t,i;2===arguments.length?(e=arguments[0],i=arguments[1],this.engine.callbacksBackend.observeNode(e,i,function(){})):3===arguments.length&&(e=arguments[0],t=arguments[1],i=arguments[2],this.engine.callbacksBackend.observeNode(e,t,i,function(){}))},Store.prototype.stopObservingNode=function(e){this.engine.callbacksBackend.stopObservingNode(e)},Store.prototype.startObservingQuery=function(){var e=arguments[0],t=arguments[1],i=arguments[2];null!=i?this.engine.callbacksBackend.observeQuery(e,t,i):this.engine.callbacksBackend.observeQuery(e,t,function(){})},Store.prototype.stopObservingQuery=function(e){this.engine.callbacksBackend.stopObservingQuery(e)},Store.prototype.subscribe=function(e,t,i,n,a){var l=this,r=function(e,t){var r=[],o={blanks:{},outCache:{}},s=[];p.each(t,function(e){var t=h.buildRDFResource(e.subject,s,l.engine,o),i=h.buildRDFResource(e.predicate,s,l.engine,o),n=h.buildRDFResource(e.object,s,l.engine,o);null!=t&&null!=i&&null!=n&&(e=new h.Triple(t,i,n),r.push(e))}),a(e,r)};this.functionMap[a]=r,this.engine.callbacksBackend.subscribe(e,t,i,n,r,function(){})},Store.prototype.unsubscribe=function(e){var t=this.functionMap[e];this.engine.callbacksBackend.unsubscribe(t),delete this.functionMap[e]},Store.prototype.setPrefix=function(e,t){this.rdf.setPrefix(e,t)},Store.prototype.setDefaultPrefix=function(e){this.rdf.setDefaultPrefix(e)},Store.prototype.insert=function(){var e,t,i;if(1===arguments.length)t=arguments[0],i=function(){};else if(2===arguments.length)t=arguments[0],i=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to insert, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),i=arguments[2]||function(){}}var n="",r=this;t.forEach(function(e){n=n+r._nodeToQuery(e.subject)+r._nodeToQuery(e.predicate)+r._nodeToQuery(e.object)+"."}),n=null!=e?"INSERT DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"INSERT DATA { "+n+" }",this.engine.execute(n,i)},Store.prototype._nodeToQuery=function(e){if("NamedNode"!==e.interfaceName)return e.toString(!0);var t=this.rdf.resolve(e.valueOf());return null!=t?"<"+t+">":"<"+e.valueOf()+">"},Store.prototype.delete=function(){var e,t,i;if(1===arguments.length)t=arguments[0],i=function(){};else if(2===arguments.length)t=arguments[0],i=arguments[1]||function(){};else{if(3!==arguments.length)throw"The triples to delete, an optional graph and callback must be provided";t=arguments[0],e=this.rdf.createNamedNode(arguments[1]),i=arguments[2]||function(){}}var n="",r=this;t.forEach(function(e){n=n+r._nodeToQuery(e.subject)+r._nodeToQuery(e.predicate)+r._nodeToQuery(e.object)+"."}),n=null!=e?"DELETE DATA { GRAPH "+this._nodeToQuery(e)+" { "+n+" } }":"DELETE DATA { "+n+" }",this.engine.execute(n,i)},Store.prototype.clear=function(){var e;if(0===arguments.length){e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri);var t=function(){}}else if(1===arguments.length)e=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),t=arguments[0]||function(){};else{if(2!==arguments.length)throw"The optional graph and a callback must be provided";e=this.rdf.createNamedNode(arguments[0]),t=arguments[1]||function(){}}var i="CLEAR GRAPH "+this._nodeToQuery(e);this.engine.execute(i,t)},Store.prototype.setBatchLoadEvents=function(e){this.engine.eventsOnBatchLoad=e},Store.prototype.registerDefaultNamespace=function(e,t){this.rdf.prefixes.set(e,t),this.engine.registerDefaultNamespace(e,t)},Store.prototype.registerDefaultProfileNamespaces=function(){var e=this.rdf.prefixes.values();for(var t in e)this.registerDefaultNamespace(t,e[t])},Store.prototype.load=function(){var e,t,i,n,r={};if(3===arguments.length)i=this.rdf.createNamedNode(this.engine.lexicon.defaultGraphUri),e=arguments[0],t=arguments[1],n=arguments[2]||function(){};else if(4===arguments.length)e=arguments[0],t=arguments[1],"string"==typeof(r=arguments[2])?(i=this.rdf.createNamedNode(r),r={}):(i=this.rdf.createNamedNode(r.graph||this.engine.lexicon.defaultGraphUri),delete r.graph),n=arguments[3]||function(){};else if(2===arguments.length)throw"The mediaType of the parser, the data a callback and an optional graph must be provided";if("remote"===e){var o="LOAD <"+(t=this.rdf.createNamedNode(t)).valueOf()+"> INTO GRAPH <"+i.valueOf()+">";this.engine.execute(o,n)}else{var s=this,a=this.engine.rdfLoader.parsers[e];if(!a)return n(new Error("Cannot find parser for the provided media type:"+e));var l=[a,{token:"uri",value:i.valueOf()},t,r,function(e,t){e?n(e,t):s.engine.batchLoad(t,function(e){null!=e?n(null,e):n(new Error("Erro batch-loading triples."))})}];t&&"string"==typeof t&&0===t.indexOf("file://")?this.engine.rdfLoader.loadFromFile.apply(null,l):this.engine.rdfLoader.tryToParse.apply(null,l)}},Store.prototype.registerParser=function(e,t){this.engine.rdfLoader.registerParser(e,t)},Store.prototype.registeredGraphs=function(i){this.engine.lexicon.registeredGraphs(!0,function(e){var t=p.map(e,function(e){return new h.NamedNode(e)});i(null,t)})},Store.prototype.getNetworkTransport=function(){return NetworkTransport},Store.prototype.setNetworkTransport=function(e){NetworkTransport=e},Store.prototype.close=function(e){null==e&&(e=function(){}),this.engine.close?this.engine.close(e):e()},Store.VERSION="0.9.17";Store.yieldFrequency=function(e){p.yieldFrequency(e)},t.exports.Store=Store,t.exports.create=function(){return 1==arguments.length?new Store(arguments[0]):2==arguments.length?new Store(arguments[0],arguments[1]):new Store},t.exports.connect=function(){(1==arguments.length?arguments[0]:2==arguments.length?arguments[1]:arguments[2])(new Error("Store#connect is not supported in the 0.9.X series of the library"))}},{"./lexicon":44,"./persistent_lexicon":47,"./persistent_quad_backend":48,"./quad_backend":49,"./query_engine":51,"./rdf_model":55,"./utils":57}],42:[function(e,t,i){var c=e("./utils"),a=e("./utils"),d=(e("./quad_index").QuadIndex,e("./quad_index").Pattern),p=e("./rdf_model"),n=e("./abstract_query_tree").AbstractQueryTree;Callbacks={ANYTHING:{token:"var",value:"_"},added:"added",deleted:"deleted",eventsFlushed:"eventsFlushed",CallbacksBackend:function(){this.aqt=new n,this.engine=arguments[0],this.indexMap={},this.observersMap={},this.queriesIndexMap={},this.emptyNotificationsMap={},this.queriesList=[],this.pendingQueries=[],this.matchedQueries=[],this.updateInProgress=null,this.indices=["SPOG","GP","OGS","POG","GSP","OS"],this.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},this.callbackCounter=0,this.callbacksMap={},this.callbacksInverseMap={},this.queryCounter=0,this.queriesMap={},this.queriesCallbacksMap={},this.queriesInverseMap={};for(var e=0;e<this.indices.length;e++){var t=this.indices[e];this.indexMap[t]={},this.queriesIndexMap[t]={}}}},Callbacks.CallbacksBackend.prototype.startGraphModification=function(){!0!==this.ongoingModification&&(this.pendingQueries=[].concat(this.queriesList),this.matchedQueries=[],null==this.updateInProgress&&(this.updateInProgress={},this.updateInProgress[Callbacks.added]=[],this.updateInProgress[Callbacks.deleted]=[]))},Callbacks.CallbacksBackend.prototype.nextGraphModification=function(e,t){this.updateInProgress[e].push(t)},Callbacks.CallbacksBackend.prototype.endGraphModification=function(e){if(!0!==this.ongoingModification){var t=this;if(null!=this.updateInProgress){var i=t.updateInProgress;t.updateInProgress=null,this.sendNotification(Callbacks.deleted,i[Callbacks.deleted],function(){t.sendNotification(Callbacks.added,i[Callbacks.added],function(){t.sendEmptyNotification(Callbacks.eventsFlushed,null,function(){t.dispatchQueries(function(){e(!0)})})})})}else e(!0)}else e(!0)},Callbacks.CallbacksBackend.prototype.cancelGraphModification=function(){!0!==this.ongoingModification&&(this.updateInProgress=null)},Callbacks.CallbacksBackend.prototype.sendNotification=function(e,t,i){for(var n={},r=0;r<t.length;r++){var o=t[r];for(var s in this.indexMap){var a=this.indexMap[s],l=this.componentOrders[s];this._searchCallbacksInIndex(a,l,e,o,n),0!=this.pendingQueries.length&&(a=this.queriesIndexMap[s],this._searchQueriesInIndex(a,l,o))}}this.dispatchNotifications(n),null!=i&&i(!0)},Callbacks.CallbacksBackend.prototype.sendEmptyNotification=function(e,t,i){for(var n=this.emptyNotificationsMap[e]||[],r=0;r<n.length;r++)n[r](e,t);i()},Callbacks.CallbacksBackend.prototype.dispatchNotifications=function(e){for(var t in e){var i=this.callbacksMap[t],n=e[t][Callbacks.deleted];if(null!=n)try{i(Callbacks.deleted,n)}catch(e){}for(var r in e[t])if(r!=Callbacks.deleted)try{i(r,e[t][r])}catch(e){}}},Callbacks.CallbacksBackend.prototype._searchCallbacksInIndex=function(e,t,i,n,r){for(var o=n[1],s=(n=n[0],0);s<t.length+1;s++){for(var a=e._||[],l=[],u=0;u<a.length;u++){var c=a[u];null!=this.callbacksMap[c]&&(r[c]=r[c]||{},r[c][i]=r[c][i]||[],r[c][i].push(n),l.push(c))}e._=l;var d=t[s];if(null==e[""+o[d]])break;e=e[""+o[d]]}},Callbacks.CallbacksBackend.prototype.subscribeEmpty=function(e,t){var i=this.emptyNotificationsMap[e]||[];i.push(t),this.emptyNotificationsMap[e]=i},Callbacks.CallbacksBackend.prototype.unsubscribeEmpty=function(e,t){var i=this.emptyNotificationsMap[e];null!=i&&(i=c.reject(i,function(e){return e===t})),this.emptyNotificationsMap[e]=i},Callbacks.CallbacksBackend.prototype.subscribe=function(e,t,i,n,a,l){var r=this._tokenizeComponents(e,t,i,n),o={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,o);var u=this;this.engine.normalizeQuad(r,o,!0,function(e){for(var t=new d(e),i=u._indexForPattern(t),n=u.componentOrders[i],r=u.indexMap[i],o=0;o<n.length;o++){var s=e[n[o]];if("_"===s){null==r._&&(r._=[]),u.callbackCounter++,r._.push(u.callbackCounter),u.callbacksMap[u.callbackCounter]=a,u.callbacksInverseMap[a]=u.callbackCounter;break}o===n.length-1?(r[s]=r[s]||{_:[]},u.callbackCounter++,r[s]._.push(u.callbackCounter),u.callbacksMap[u.callbackCounter]=a,u.callbacksInverseMap[a]=u.callbackCounter):(r[s]=r[s]||{},r=r[s])}null!=l&&l(!0)})},Callbacks.CallbacksBackend.prototype.unsubscribe=function(e){var t=this.callbacksInverseMap[e];null!=t&&(delete this.callbacksInverseMap[e],delete this.callbacksMap[t])},Callbacks.CallbacksBackend.prototype._tokenizeComponents=function(e,t,i,n){var r={};return null==e?r.subject=Callbacks.ANYTHING:0==e.indexOf("_:")?r.subject={token:"blank",value:e}:r.subject={token:"uri",value:e},r.predicate=null==t?Callbacks.ANYTHING:{token:"uri",value:t},r.object=null==i?Callbacks.ANYTHING:{token:"uri",value:i},r.graph=null==n?Callbacks.ANYTHING:{token:"uri",value:n},r},Callbacks.CallbacksBackend.prototype._indexForPattern=function(e){for(var t=e.indexKey,i=this.indices,n=0;n<i.length;n++)for(var r=i[n],o=this.componentOrders[r],s=0;s<o.length&&!1!==c.include(t,o[s]);s++)if(s==t.length-1)return r;return"SPOG"},Callbacks.CallbacksBackend.prototype.observeNode=function(){var n,e,u,r;r=4===arguments.length?(n=arguments[0],e=arguments[1],u=arguments[2],arguments[3]):(n=arguments[0],e=this.engine.lexicon.defaultGraphUri,u=arguments[1],arguments[2]);var t="CONSTRUCT { <"+n+"> ?p ?o } WHERE { GRAPH <"+e+"> { <"+n+"> ?p ?o } }",c=this,d={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,d);var h=[];this.engine.execute(t,function(e,t){if(e)r&&r(!1);else{var a=t,l=!1,i=function(e,t){if("eventsFlushed"===e&&l){l=!1;try{u(a)}catch(e){}}else if("eventsFlushed"!==e){l=!0;for(var i=0;i<t.length;i++){var n=t[i],r=p.buildRDFResource(n.subject,h,c.engine,d),o=p.buildRDFResource(n.predicate,h,c.engine,d),s=p.buildRDFResource(n.object,h,c.engine,d);null!=r&&null!=o&&null!=s&&(n=new p.Triple(r,o,s),e===Callbacks.added?a.add(n):e===Callbacks.deleted&&a.remove(n))}}};c.observersMap[u]=i,c.subscribeEmpty(Callbacks.eventsFlushed,i),c.subscribe(n,null,null,null,i,function(){try{u(a)}catch(e){}r&&r(!0)})}})},Callbacks.CallbacksBackend.prototype.stopObservingNode=function(e){var t=this.observersMap[e];return!!t&&(this.unsubscribe(t),this.unsubscribeEmpty(Callbacks.eventsFlushed,t),!0)},Callbacks.CallbacksBackend.prototype.observeQuery=function(e,i,t){var n=this.aqt.parseQueryString(e),r=this.aqt.parseSelect(n.units[0]),o=this.aqt.collectBasicTriples(r),l=this,s={blanks:{},outCache:{}};this.engine.registerNsInEnvironment(null,s);var u=this.queryCounter;this.queryCounter++,this.queriesMap[u]=e,this.queriesInverseMap[e]=u,this.queriesList.push(u),this.queriesCallbacksMap[u]=i,a.eachSeries(o,function(e,a){null==e.graph&&(e.graph=l.engine.lexicon.defaultGraphUriTerm),l.engine.normalizeQuad(e,s,!0,function(e){for(var t=new d(e),i=l._indexForPattern(t),n=l.componentOrders[i],r=l.queriesIndexMap[i],o=0;o<n.length;o++){var s=e[n[o]];if("string"==typeof s){null==r._&&(r._=[]),r._.push(u);break}o===n.length-1?(r[s]=r[s]||{_:[]},r[s]._.push(u)):(r[s]=r[s]||{},r=r[s])}a()})},function(){l.engine.execute(e,function(e,t){e?console.log("ERROR in query callback "+t):i(t)}),null!=t&&t()})},Callbacks.CallbacksBackend.prototype.stopObservingQuery=function(e){var t=this.queriesInverseMap[e];null!=t&&(delete this.queriesInverseMap[e],delete this.queriesMap[t],this.queriesList=c.reject(this.queriesList,function(e){return e===t}))},Callbacks.CallbacksBackend.prototype._searchQueriesInIndex=function(e,t,i){for(var n=i[1],r=(i=i[0],0);r<t.length+1;r++){for(var o=e._||[],s=[],a=0;a<o.length;a++){var l=o[a];c.include(this.pendingQueries,l)&&(c.remove(this.pendingQueries,function(e){return e===l}),this.matchedQueries.push(l)),null!=this.queriesMap[l]&&s.push(l)}e._=s;var u=t[r];if(null==e[""+n[u]])break;e=e[""+n[u]]}},Callbacks.CallbacksBackend.prototype.dispatchQueries=function(e){var t,n,r=this,o={};a.eachSeries(this.matchedQueries,function(e,i){null==o[e]?(o[e]=!0,t=r.queriesMap[e],n=r.queriesCallbacksMap[e],r.engine.execute(t,function(e,t){if(!e)try{n(t)}catch(e){}i()})):i()},function(){e()})},Callbacks.CallbacksBackend.added=Callbacks.added,Callbacks.CallbacksBackend.deleted=Callbacks.deleted,Callbacks.CallbacksBackend.eventsFlushed=Callbacks.eventsFlushed,t.exports=Callbacks},{"./abstract_query_tree":39,"./quad_index":50,"./rdf_model":55,"./utils":57}],43:[function(e,t,i){var o=e("jsonld");i.JSONLDParser={};var n=i.JSONLDParser;n.parser={async:!0,parse:function(e,t,i,n){try{"string"==typeof e&&(e=JSON.parse(e)),r=e,c=t,d=n,h=null,o.normalize(r,{},function(e,t){if(e)d(e);else{var i=function(e){return"blank node"===e.type?{blank:e.value}:"IRI"===e.type?{token:"uri",value:e.value}:"literal"===e.type?null!=e.language?{literal:'"'+e.value+'"@'+e.language}:null!==e.datatype?{literal:'"'+e.value+'"^^<'+e.datatype+">"}:{literal:'"'+e.value+'"'}:void 0};for(var n in h=[],t)for(var r=t[n],o=0;o<r.length;o++){var s=r[o];a=s.subject,l=s.predicate,u=s.object,h.push({subject:i(a),predicate:i(l),object:i(u),graph:c})}d(null,h)}var a,l,u})}catch(e){n(e)}var r,c,d,h}},t.exports={JSONLDParser:n}},{jsonld:26}],44:[function(e,t,i){var a=e("./utils"),n=e("./btree").Tree;Lexicon=function(e){var i=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,a.seq(function(t){new n(2,function(e){i.uris=e,t()})},function(t){new n(2,function(e){i.literals=e,t()})},function(t){new n(2,function(e){i.knownGraphs=e,t()})},function(t){new n(2,function(e){i.oidUris=e,t()})},function(t){new n(2,function(e){i.oidLiterals=e,t()})},function(t){new n(2,function(e){i.oidBlanks=e,t()})})(function(){null!=e&&e(i)})},Lexicon.prototype.registerGraph=function(e,t,i){e!=this.defaultGraphOid?this.knownGraphs.insert(e,t,function(){i()}):i()},Lexicon.prototype.registeredGraphs=function(t,e){var i=[];this.knownGraphs.walk(function(e){!0===t?i.push(e.data):i.push(e.key)},function(){e(i)})},Lexicon.prototype.registerUri=function(n,r){var o=this;n===this.defaultGraphUri?r(this.defaultGraphOid):this.uris.search(n,function(e){if(null==e){var t=o.oidCounter,i="u"+t;o.oidCounter++,a.seq(function(e){o.uris.insert(n,[t,0],function(){e()})},function(e){o.oidUris.insert(i,n,function(){e()})})(function(){r(t)})}else t=e[0],e[1]=e[1]+1,r(t)})},Lexicon.prototype.resolveUri=function(e,t){e===this.defaultGraphUri?t(this.defaultGraphOid):this.uris.search(e,function(e){t(null!=e?e[0]:-1)})},Lexicon.prototype.resolveUriCost=function(e,t){e===this.defaultGraphUri?t(0):this.uris.search(e,function(e){t(null!=e?e[1]:-1)})},Lexicon.prototype.registerBlank=function(e){var t=this.oidCounter;this.oidCounter++;var i=""+t;this.oidBlanks.insert(i,i,function(){e(t)})},Lexicon.prototype.resolveBlank=function(e,i){var n=this;this.oidBlanks.search(e,function(e){if(null!=e)i(e);else{var t=n.oidCounter;this.oidCounter++,i(""+t)}})},Lexicon.prototype.resolveBlankCost=function(e,t){t(0)},Lexicon.prototype.registerLiteral=function(n,r){var o=this;this.literals.search(n,function(e){if(null==e){var t="l"+(i=o.oidCounter);o.oidCounter++,a.seq(function(e){o.literals.insert(n,[i,0],function(){e()})},function(e){o.oidLiterals.insert(t,n,function(){e()})})(function(){r(i)})}else{var i=e[0];e[1]=e[1]+1,r(i)}})},Lexicon.prototype.resolveLiteral=function(e,t){this.literals.search(e,function(e){t(null!=e?e[0]:-1)})},Lexicon.prototype.resolveLiteralCost=function(e,t){this.literals.search(e,function(e){t(null!=e?e[1]:-1)})},Lexicon.prototype.parseLiteral=function(e){var t;return-1!=(t=e.lastIndexOf("@"))&&'"'===e[t-1]&&null!=e.substring(t,e.length).match(/^@[a-zA-Z\-]+$/g)?{token:"literal",value:e.substring(1,t-1),lang:e.substring(t+1,e.length)}:-1!=(t=e.lastIndexOf("^^"))&&'"'===e[t-1]&&"<"===e[t+2]&&">"===e[e.length-1]?{token:"literal",value:e.substring(1,t-1),type:e.substring(t+3,e.length-1)}:{token:"literal",value:e.substring(1,e.length-1)}},Lexicon.prototype.parseUri=function(e){return{token:"uri",value:e}},Lexicon.prototype.retrieve=function(i,n){var r=this;i===this.defaultGraphOid?n({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):a.seq(function(e,t){r.oidUris.search("u"+i,function(e){t(null,null!=e?r.parseUri(e):null)})},function(e,t){null==e?r.oidLiterals.search("l"+i,function(e){t(null,null!=e?r.parseLiteral(e):null)}):t(null,e)},function(e,t){null==e?r.oidBlanks.search(""+i,function(e){t(null,null!=e?{token:"blank",value:"_:"+i}:null)}):t(null,e)})(null,function(e,t){n(t)})},Lexicon.prototype.clear=function(e){var i=this;this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,a.seq(function(t){new n(2,function(e){i.uris=e,t()})},function(t){new n(2,function(e){i.literals=e,t()})},function(t){new n(2,function(e){i.knownGraphs=e,t()})},function(t){new n(2,function(e){i.oidUris=e,t()})},function(t){new n(2,function(e){i.oidLiterals=e,t()})},function(t){new n(2,function(e){i.oidBlanks=e,t()})})(function(){null!=e&&e()})},Lexicon.prototype.unregister=function(t,i,e){var n=this;a.seq(function(e){n._unregisterTerm(t.subject.token,i.subject,e)},function(e){n._unregisterTerm(t.predicate.token,i.predicate,e)},function(e){n._unregisterTerm(t.object.token,i.object,e)},function(e){null!=t.graph?n._unregisterTerm(t.graph.token,i.graph,e):e()})(function(){e(!0)})},Lexicon.prototype._unregisterTerm=function(e,n,r){var o=this;if("uri"===e)if(n!=this.defaultGraphOid){var s="u"+n;o.oidUris.search(s,function(i){o.uris.search(i,function(e){var t=e[1];""+e[0]==""+n?0===t?a.seq(function(e){o.oidUris.delete(s,function(){e()})},function(e){o.uris.delete(i,function(){e()})},function(e){o.knownGraphs.delete(n,function(){e()})})(function(){r()}):o.uris.insert(i,[n,t-1],function(){r()}):r()})})}else r();else if("literal"===e){this.oidCounter++;s="l"+n;o.oidLiterals.search(s,function(i){o.literals.search(i,function(e){var t=e[1];""+e[0]==""+n?0===t?a.seq(function(e){o.oidLiterals.delete(s,function(){e()})},function(e){o.literals.delete(i,function(){e()})})(function(){r()}):o.literals.insert(i,[n,t-1],function(){r()}):r()})})}else"blank"===e?o.oidBlanks.delete(""+n,function(){r()}):r()},t.exports={Lexicon:Lexicon}},{"./btree":40,"./utils":57}],45:[function(e,t,i){if(!e("./utils").isWorker()){var u=e("http"),c=e("https"),d=e("url");NetworkTransport={load:function(e,r,o,t){var s=null==t?3:t,i=d.parse(e,!0,!0),n={host:i.host,hostname:i.hostname,method:"GET",path:i.path,headers:{host:i.hostname,Accept:r}},a=null;"http:"===i.protocol?(n.port=i.port||80,a=u):"https:"===i.protocol&&(n.port=i.port||443,a=c);var l=a.request(n,function(e){var t=e.headers,i="";if("2"==(""+e.statusCode)[0])e.on("end",function(){o(null,{headers:t,data:i})}),e.on("data",function(e){i+=e});else if("3"==(""+e.statusCode)[0])if(0==s)o(new Error("Too many redirections"));else{var n=t.Location||t.location;null!=n?NetworkTransport.load(n,r,o,s-1):o(new Error("Redirection without location header"))}else o(new Error("HTTP error: "+e.statusCode))});l.on("error",o),l.end()}},t.exports={NetworkTransport:NetworkTransport}}},{"./utils":57,http:7,https:22,url:36}],46:[function(e,t,i){t.exports=function(){"use strict";function Tg(e,t,i,n){this.message=e,this.expected=t,this.found=i,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,Tg)}return function(e,t){function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i}(Tg,Error),Tg.buildMessage=function(e,t){var i,o={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,i="";for(t=0;t<e.parts.length;t++)i+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+i+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+n(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+n(e)})}return"Expected "+function(e){var t,i,n,r=new Array(e.length);for(t=0;t<e.length;t++)r[t]=(n=e[t],o[n.type](n));if(r.sort(),0<r.length){for(i=t=1;t<r.length;t++)r[t-1]!==r[t]&&(r[i]=r[t],i++);r.length=i}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(e)+" but "+((i=t)?'"'+r(i)+'"':"end of input")+" found."},{SyntaxError:Tg,parse:function(w,e){e=void 0!==e?e:{};var t,x={},i={DOCUMENT:Bp},n=Bp,d=Lp("[1] QueryUnit"),h=Lp("[2] Query"),p=function(e,t,i){return{token:"query",kind:"query",prologue:e,units:[t],inlineData:i}},o=Lp("[3] Prologue"),s=function(e,t){return{token:"prologue",base:e,prefixes:t}},a=Lp("[4] BaseDecl"),l="BASE",u=Op("BASE",!1),c="base",f=Op("base",!1),g=function(e){Cg(e);var t={token:"base"};return t.value=e,t},v=Lp("[5] PrefixDecl"),m="PREFIX",y=Op("PREFIX",!1),b="prefix",k=Op("prefix",!1),_=function(e,t){Fg(e,t);var i={token:"prefix"};return i.prefix=e,i.local=t,i},F=Lp("[6] SelectQuery"),C=function(e,t,i,n){for(var r={named:[],implicit:[]},o=0;o<t.length;o++){var s=t[o];"default"===s.kind?r.implicit.push(s.graph):r.named.push(s.graph)}0===r.named.length&&0===r.implicit.length&&r.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var a={kind:"select",token:"executableunit"};return a.dataset=r,a.projection=e.vars,a.modifier=e.modifier,a.pattern=i,null!=n&&null!=n.limit&&(a.limit=n.limit),null!=n&&null!=n.offset&&(a.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(a.order=n.order),null!=n&&null!=n.group&&(a.group=n.group),a},E=Lp("[7] SubSelect"),T=function(e,t,i){var n={kind:"select",token:"subselect"};return n.projection=e.vars,n.modifier=e.modifier,n.pattern=t,null!=i&&null!=i.limit&&(n.limit=i.limit),null!=i&&null!=i.offset&&(n.offset=i.offset),null!=i&&null!=i.order&&""!=i.order&&(n.order=i.order),null!=i&&null!=i.group&&(n.group=i.group),n},D=Lp("[8] SelectClause"),S="SELECT",R=Op("SELECT",!1),j="select",I=Op("select",!1),A="DISTINCT",O=Op("DISTINCT",!1),N="distinct",L=Op("distinct",!1),M="REDUCED",P=Op("REDUCED",!1),U="reduced",$=Op("reduced",!1),B="(",Q=Op("(",!1),V="AS",z=Op("AS",!1),q="as",H=Op("as",!1),G=")",X=Op(")",!1),W="*",K=Op("*",!1),J=function(e,t){var i=[];if(3===t.length&&"*"===t[1])return{vars:[{token:"variable",kind:"*"}],modifier:Eg(e)};for(var n=0;n<t.length;n++){var r=t[n];3===r.length?i.push({token:"variable",kind:"var",value:r[1]}):i.push({token:"variable",kind:"aliased",expression:r[3],alias:r[7]})}return{vars:i,modifier:Eg(e)}},Y=Lp("[9] ConstructQuery"),Z="CONSTRUCT",ee=Op("CONSTRUCT",!1),te="construct",ie=Op("construct",!1),ne=function(e,t,i,n){for(var r={named:[],implicit:[]},o=0;o<t.length;o++){var s=t[o];"default"===s.kind?r.implicit.push(s.graph):r.named.push(s.graph)}0===r.named.length&&0===r.implicit.length&&r.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var a={kind:"construct",token:"executableunit"};return a.dataset=r,a.template=e,a.pattern=i,null!=n&&null!=n.limit&&(a.limit=n.limit),null!=n&&null!=n.offset&&(a.offset=n.offset),null!=n&&null!=n.order&&""!=n.order&&(a.order=n.order),a},re="WHERE",oe=Op("WHERE",!1),se="where",ae=Op("where",!1),le="{",ue=Op("{",!1),ce="}",de=Op("}",!1),he=function(e,t,i){for(var n={named:[],implicit:[]},r=0;r<e.length;r++){var o=e[r];"default"===o.kind?n.implicit.push(o.graph):n.named.push(o.graph)}0===n.named.length&&0===n.implicit.length&&n.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var s={kind:"construct",token:"executableunit"};return s.dataset=n,s.template=t,s.pattern={token:"basicgraphpattern",triplesContext:t.triplesContext},null!=i&&null!=i.limit&&(s.limit=i.limit),null!=i&&null!=i.offset&&(s.offset=i.offset),null!=i&&null!=i.order&&""!=i.order&&(s.order=i.order),s},pe=Lp("[10] DescribeQuery"),fe="DESCRIBE",ge=Op("DESCRIBE",!1),ve=Lp("[11] AskQuery"),me="ASK",ye=Op("ASK",!1),be="ask",we=Op("ask",!1),xe=function(e,t){for(var i={named:[],implicit:[]},n=0;n<e.length;n++){var r=e[n];"implicit"===r.kind?i.implicit.push(r.graph):i.named.push(r.graph)}0===i.named.length&&0===i.implicit.length&&i.implicit.push({token:"uri",prefix:null,suffix:null,value:"https://github.com/antoniogarrote/rdfstore-js#default_graph"});var o={kind:"ask",token:"executableunit"};return o.dataset=i,o.pattern=t,o},ke=Lp("[12] DatasetClause"),_e="FROM",Fe=Op("FROM",!1),Ce="from",Ee=Op("from",!1),Te=function(e){return e},De=Lp("[13] DefaultGraphClause"),Se=function(e){return{graph:e,kind:"default",token:"graphClause"}},Re=Lp("[14] NamedGraphClause"),je="NAMED",Ie=Op("NAMED",!1),Ae="named",Oe=Op("named",!1),Ne=function(e){return{graph:e,kind:"named",token:"graphCluase"}},r=Lp("[15] SourceSelector"),Le=Lp("[16] WhereClause"),Me=function(e){return e},Pe=Lp("[17] SolutionModifier"),Ue=function(e,t,i){var n={};return null!=i&&(null!=i.limit&&(n.limit=i.limit),null!=i.offset&&(n.offset=i.offset)),null!=e&&(n.group=e),n.order=t,n},$e=Lp("[18] GroupClause"),Be="GROUP",Qe=Op("GROUP",!1),Ve="group",ze=Op("group",!1),qe="BY",He=Op("BY",!1),Ge="by",Xe=Op("by",!1),We=function(e){return e},Ke=Lp("[19] GroupCondition"),Je=function(e){return e},Ye=function(e){return e},Ze=function(e,t){return 0!=t.length?{token:"aliased_expression",expression:e,alias:t[2]}:e},et=function(e){return e},tt=Lp("[20] HavingClause"),it="HAVING",nt=Op("HAVING",!1),rt=Lp("[21] HavingCondition"),ot=Lp("[22] OrderClause"),st="ORDER",at=Op("ORDER",!1),lt="order",ut=Op("order",!1),ct=function(e){return e},dt=Lp("[23] OrderCondition"),ht="ASC",pt=Op("ASC",!1),ft="asc",gt=Op("asc",!1),vt="DESC",mt=Op("DESC",!1),yt="desc",bt=Op("desc",!1),wt=function(e,t){return{direction:e.toUpperCase(),expression:t}},xt=function(e){return"var"===e.token&&(e={token:"expression",expressionType:"atomic",primaryexpression:"var",value:e}),{direction:"ASC",expression:e}},kt=Lp("[24] LimitOffsetClauses"),_t=function(e){for(var t={},i=0;i<e.length;i++){var n=e[i];null!=n&&null!=n.limit?t.limit=n.limit:null!=n&&null!=n.offset&&(t.offset=n.offset)}return t},Ft=Lp("[25] LimitClause"),Ct="LIMIT",Et=Op("LIMIT",!1),Tt="limit",Dt=Op("limit",!1),St=function(e){return{limit:parseInt(e.value)}},Rt=Lp("[26] OffsetClause"),jt="OFFSET",It=Op("OFFSET",!1),At="offset",Ot=Op("offset",!1),Nt=function(e){return{offset:parseInt(e.value)}},Lt=Lp("[27] BindingsClause"),Mt="BINDINGS",Pt=Op("BINDINGS",!1),Ut=Lp("[28] BindingValue"),$t="UNDEF",Bt=Op("UNDEF",!1),Qt=Lp("[28]\tValuesClause\t  ::=\t( 'VALUES' DataBlock )?"),Vt="VALUES",zt=Op("VALUES",!1),qt="values",Ht=Op("values",!1),Gt=function(e){return null!=e?e[1]:null},Xt=Lp("[29] UpdateUnit"),Wt=Lp("[30] Update"),Kt=";",Jt=Op(";",!1),Yt=function(e,t,i){var n={token:"query",kind:"update"};n.prologue=e;var r=[t];return null!=i&&null!=i.length&&null!=i[3]&&null!=i[3].units&&(r=r.concat(i[3].units)),n.units=r,n},Zt=Lp("[31] Update1"),ei=Lp("[32] Load"),ti="LOAD",ii=Op("LOAD",!1),ni="load",ri=Op("load",!1),oi="INTO",si=Op("INTO",!1),ai="into",li=Op("into",!1),ui=function(e,t){var i={kind:"load",token:"executableunit"};return i.sourceGraph=e,null!=t&&(i.destinyGraph=t[2]),i},ci=Lp("[33] Clear"),di="CLEAR",hi=Op("CLEAR",!1),pi="clear",fi=Op("clear",!1),gi="SILENT",vi=Op("SILENT",!1),mi="silent",yi=Op("silent",!1),bi=function(e){var t={kind:"clear",token:"executableunit"};return t.destinyGraph=e,t},wi=Lp("[34] Drop"),xi="DROP",ki=Op("DROP",!1),_i="drop",Fi=Op("drop",!1),Ci=function(e){var t={kind:"drop",token:"executableunit"};return t.destinyGraph=e,t},Ei=Lp("[35] Create"),Ti="CREATE",Di=Op("CREATE",!1),Si="create",Ri=Op("create",!1),ji=function(e){var t={kind:"create",token:"executableunit"};return t.destinyGraph=e,t},Ii=Lp("[36] InsertData"),Ai="INSERT",Oi=Op("INSERT",!1),Ni="insert",Li=Op("insert",!1),Mi="DATA",Pi=Op("DATA",!1),Ui="data",$i=Op("data",!1),Bi=function(e){var t={kind:"insertdata",token:"executableunit"};return t.quads=e,t},Qi=Lp("[37] DeleteData"),Vi="DELETE",zi=Op("DELETE",!1),qi="delete",Hi=Op("delete",!1),Gi=function(e){var t={kind:"deletedata",token:"executableunit"};return t.quads=e,t},Xi=Lp("[38] DeleteWhere"),Wi=function(e){var t={kind:"modify"};t.pattern=e,t.with=null,t.using=null;var i=[],n=e.patterns[0];n=null==n.triplesContext&&null!=n.patterns?n.patterns[0].triplesContext:n.triplesContext;for(var r=0;r<n.length;r++){var o={},s=n[r];o.subject=s.subject,o.predicate=s.predicate,o.object=s.object,o.graph=s.graph,i.push(o)}return t.delete=i,t},Ki=Lp("[39] Modify"),Ji="WITH",Yi=Op("WITH",!1),Zi="with",en=Op("with",!1),tn=function(e,t,i,n){var r={kind:"modify"};return r.with=""!=e&&null!=e?e[2]:null,3!==t.length||""!==t[2]&&null!=t[2]?3===t.length&&null!=t[0].length&&null!=t[1].length&&null!=t[2].length?(r.delete=t[0],r.insert=t[2]):(r.insert=t,r.delete=null):(r.delete=t[0],r.insert=null),""!=i&&(r.using=i),r.pattern=n,r},nn=Lp("[40] DeleteClause"),rn=function(e){return e},on=Lp("[41] InsertClause"),sn=Lp("[42] UsingClause"),an="USING",ln=Op("USING",!1),un="using",cn=Op("using",!1),dn=function(e){return null!=e.length?{kind:"named",uri:e[2]}:{kind:"default",uri:e}},hn=Lp("[43] GraphRef"),pn="GRAPH",fn=Op("GRAPH",!1),gn="graph",vn=Op("graph",!1),mn=function(e){return e},yn=Lp("[44] GraphRefAll"),bn="DEFAULT",wn=Op("DEFAULT",!1),xn="default",kn=Op("default",!1),_n=function(){return"default"},Fn=function(){return"named"},Cn="ALL",En=Op("ALL",!1),Tn="all",Dn=Op("all",!1),Sn=function(){return"all"},Rn=Lp("[45] QuadPattern"),jn=function(e){return e.quadsContext},In=Lp("[46] QuadData"),An=Lp("[47] Quads"),On=".",Nn=Op(".",!1),Ln=function(e,t){var i=[];if(null!=e&&null!=e.triplesContext)for(var n=0;n<e.triplesContext.length;n++)(r=e.triplesContext[n]).graph=null,i.push(r);if(t&&0<t.length&&0<t[0].length&&(i=i.concat(t[0][0].quadsContext),null!=t[0][2]&&null!=t[0][2].triplesContext))for(n=0;n<t[0][2].triplesContext.length;n++){var r;(r=t[0][2].triplesContext[n]).graph=null,i.push(r)}return{token:"quads",quadsContext:i}},Mn=Lp("[48] QuadsNotTriples"),Pn=function(e,t){var i=[];if(null!=t)for(var n=0;n<t.triplesContext.length;n++){var r=t.triplesContext[n];r.graph=e,i.push(r)}return{token:"quadsnottriples",quadsContext:i}},Un=Lp("[49] TriplesTemplate"),$n=function(e,t){var i=e.triplesContext;return null!=t&&"object"==typeof t&&null!=t.length&&null!=t[3]&&null!=t[3].triplesContext&&(i=i.concat(t[3].triplesContext)),{token:"triplestemplate",triplesContext:i}},Bn=Lp("[50] GroupGraphPattern"),Qn=function(e){return e},Vn=Lp("[51] GroupGraphPatternSub"),zn=function(e,t){var i=[];null!=e&&e!=[]&&i.push(e);for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)null!=t[n][r]&&null!=t[n][r].token&&i.push(t[n][r]);var o=[],s=[],a=[],l=[];for(n=0;n<i.length;n++)if("triplespattern"!==i[n].token&&"filter"!==i[n].token&&"bind"!==i[n].token){if(0!=s.length||0!=a.length){var u=[];for(r=0;r<s.length;r++)u=u.concat(s[r].triplesContext);0<u.length&&o.push({token:"basicgraphpattern",triplesContext:u}),s=[]}o.push(i[n])}else"triplespattern"===i[n].token?s.push(i[n]):"bind"===i[n].token?l.push(i[n]):a.push(i[n]);if(0!=s.length||0!=a.length){for(u=[],r=0;r<s.length;r++)u=u.concat(s[r].triplesContext);0<u.length&&o.push({token:"basicgraphpattern",triplesContext:u})}return{token:"groupgraphpattern",patterns:o,filters:a,binds:l}},qn=Lp("[54] TriplesBlock"),Hn=function(e,t){var i=e.triplesContext;return null!=t&&"object"==typeof t&&null!=t&&null!=t.length&&null!=t[2]&&null!=t[2].triplesContext&&(i=i.concat(t[2].triplesContext)),{token:"triplespattern",triplesContext:i}},Gn=Lp("[53] GraphPatternNotTriples"),Xn=Lp("[54] OptionalGraphPattern"),Wn="OPTIONAL",Kn=Op("OPTIONAL",!1),Jn="optional",Yn=Op("optional",!1),Zn=function(e){return{token:"optionalgraphpattern",value:e}},er=Lp("[55] GraphGraphPattern"),tr=function(e,t){for(var i=0;i<t.patterns.length;i++)for(var n=t.patterns[i],r=0;r<n.triplesContext.length;r++)n.triplesContext[r].graph=e;return t.token="groupgraphpattern",t},ir=Lp("[56] ServiceGraphPattern"),nr="SERVICE",rr=Op("SERVICE",!1),or=function(e,t){return{token:"servicegraphpattern",status:"todo",value:[e,t]}},sr=Lp("[57] MinusGraphPattern"),ar="MINUS",lr=Op("MINUS",!1),ur="minus",cr=Op("minus",!1),dr=function(e){return{token:"minusgraphpattern",status:"todo",value:e}},hr=Lp("[58] GroupOrUnionGraphPattern"),pr="UNION",fr=Op("UNION",!1),gr="union",vr=Op("union",!1),mr=function(e,t){if(0===t.length)return e;for(var i={token:"graphunionpattern",value:[e]},n=0;n<t.length;n++)n==t.length-1?i.value.push(t[n][3]):(i.value.push(t[n][3]),i={token:"graphunionpattern",value:[i]});return i},yr=Lp("[59] Filter"),br="FILTER",wr=Op("FILTER",!1),xr="filter",kr=Op("filter",!1),_r=function(e){return{token:"filter",value:e}},Fr=Lp("[60] Bind"),Cr="BIND",Er=Op("BIND",!1),Tr="bind",Dr=Op("bind",!1),Sr=function(e,t){return{token:"bind",expression:e,as:t}},Rr=Lp("[60] Constraint"),jr=Lp("[61] InlineData"),Ir=function(e){return e},Ar=Lp("[62] DataBlock"),Or=Lp("[63] InlineDataOneVar"),Nr=function(e,t){return{token:"inlineData",values:[{var:e,value:t}]}},Lr=Lp("[64] InlineDataFull"),Mr=function(e,t){return{token:"inlineData",values:[],todo:!0}},Pr=Lp("[65] DataBlockValue"),Ur=Lp("[61] FunctionCall"),$r=function(e,t){var i={token:"expression",expressionType:"irireforfunction"};return i.iriref=e,i.args=t.value,i},Br=Lp("[62] ArgList"),Qr=function(){var e={token:"args",value:[]};return e},Vr=",",zr=Op(",",!1),qr=function(e,t,i){for(var n=[],r=0;r<i.length;r++)n.push(i[r][2]);var o={token:"args"};return o.value=[t].concat(n),null!=e&&"DISTINCT"===e.toUpperCase()?o.distinct=!0:o.distinct=!1,o},Hr=Lp("[63] ExpressionList"),Gr=function(e,t){for(var i=[],n=0;n<t.length;n++)i.push(t[n][2]);var r={token:"args"};return r.value=[e].concat(i),r},Xr=Lp("[64] ConstructTemplate"),Wr=function(e){return e},Kr=Lp("[65] ConstructTriples"),Jr=function(e,t){var i=e.triplesContext;return null!=t&&"object"==typeof t&&null!=t.length&&null!=t[3]&&null!=t[3].triplesContext&&(i=i.concat(t[3].triplesContext)),{token:"triplestemplate",triplesContext:i}},Yr=Lp("[66] TriplesSameSubject"),Zr=function(e,t){var i=t.triplesContext,n=e;if(t.pairs)for(var r=0;r<t.pairs.length;r++){var o=t.pairs[r],s=null;null!=o[1].length&&(o[1]=o[1][0]),n.token&&"triplesnodecollection"===n.token?(s={subject:n.chainSubject[0],predicate:o[0],object:o[1]},i.push(s),i=i.concat(n.triplesContext)):(s={subject:n,predicate:o[0],object:o[1]},i.push(s))}var a={token:"triplessamesubject"};return a.triplesContext=i,a.chainSubject=n,a},eo=function(e,t){var i=e.triplesContext,n=e.chainSubject;if(t.pairs)for(var r=0;r<t.pairs.length;r++){var o=t.pairs[r];if(null!=o[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===e.token)for(var s=0;s<n.length;s++){var a=n[s];if(null!=a.triplesContext){var l={subject:a.chainSubject,predicate:o[0],object:o[1]};i.concat(a.triplesContext)}else l={subject:n[s],predicate:o[0],object:o[1]},i.push(l)}else l={subject:n,predicate:o[0],object:o[1]},i.push(l)}var u={token:"triplessamesubject"};return u.triplesContext=i,u.chainSubject=n,u},to=Lp("[83] PropertyListPathNotEmpty"),io=function(e,t,i){for(var n={token:"propertylist"},r=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(r=r.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<i.length;s++)for(var a=i[s][3],l=a[0],u=a[2]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(r=r.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=r,n},no=Lp("[67] PropertyListNotEmpty"),ro=function(e,t,i){for(var n={token:"propertylist"},r=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(r=r.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<i.length;s++)for(var a=i[s][3],l=a[0],u=a[2]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(r=r.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=r,n},oo=Lp("[68] PropertyList"),so=Lp("[86] ObjectListPath"),ao=function(e,t){var i=[];i.push(e);for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)"object"==typeof t[n][r]&&null!=t[n][r].token&&i.push(t[n][r]);return i},lo=Lp("[69] ObjectList"),uo=function(e,t){var i=[];i.push(e);for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++)"object"==typeof t[n][r]&&null!=t[n][r].token&&i.push(t[n][r]);return i},co=Lp("[87] ObjectPath"),ho=Lp("[70] Object"),po=Lp("[71] Verb"),fo="a",go=Op("a",!1),vo=function(){return{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}},mo=Lp("[72] TriplesSameSubjectPath"),yo=function(e,t){var i=t.triplesContext,n=e;if(t.pairs)for(var r=0;r<t.pairs.length;r++){var o=t.pairs[r],s=null;null!=o[1].length&&(o[1]=o[1][0]),n.token&&"triplesnodecollection"===n.token?("path"===(s={subject:n.chainSubject[0],predicate:o[0],object:o[1]}).predicate.token&&"element"===s.predicate.kind&&(s.predicate=s.predicate.value),i.push(s),i=i.concat(n.triplesContext)):("path"===(s={subject:n,predicate:o[0],object:o[1]}).predicate.token&&"element"===s.predicate.kind&&(s.predicate=s.predicate.value),i.push(s))}var a={token:"triplessamesubject"};return a.triplesContext=i,a.chainSubject=n,a},bo=function(e,t){var i=e.triplesContext,n=e.chainSubject;if(null!=t&&null!=t.pairs)for(var r=0;r<t.pairs.length;r++){var o=t.pairs[r];if(null!=o[1].length&&(o[1]=o[1][0]),"triplesnodecollection"===e.token)for(var s=0;s<n.length;s++){var a=n[s];if(null!=a.triplesContext){var l={subject:a.chainSubject,predicate:o[0],object:o[1]};i.concat(a.triplesContext)}else l={subject:n[s],predicate:o[0],object:o[1]},i.push(l)}else l={subject:n,predicate:o[0],object:o[1]},i.push(l)}var u={token:"triplessamesubject"};return u.triplesContext=i,u.chainSubject=n,u},wo=Lp("[73] PropertyListNotEmptyPath"),xo=function(e,t,i){for(var n={token:"propertylist"},r=[],o=[],s=0;s<t.length;s++)null!=t[s].triplesContext?(r=r.concat(t[s].triplesContext),"triplesnodecollection"===t[s].token&&null!=t[s].chainSubject.length?o.push([e,t[s].chainSubject[0]]):o.push([e,t[s].chainSubject])):o.push([e,t[s]]);for(s=0;s<i.length;s++)for(var a=i[s][3],l=a[0],u=a[1]||[],c=0;c<u.length;c++)null!=u[c].triplesContext?(r=r.concat(u[c].triplesContext),o.push([l,u[c].chainSubject])):o.push([l,u[c]]);return n.pairs=o,n.triplesContext=r,n},ko=Lp("[74] PropertyListPath"),_o=Lp("[75]"),Fo=function(e){var t={token:"path",kind:"element"};return t.value=e},Co=Lp("[76] VerbSimple"),Eo=Lp("[77] Path"),To=Lp("[78] PathAlternative"),Do="|",So=Op("|",!1),Ro=function(e,t){if(null==t||0===t.length)return e;for(var i=[],n=0;n<t.length;n++)i.push(t[1]);var r={token:"path",kind:"alternative"};return r.value=i,r},jo=Lp("[79] PathSequence"),Io="/",Ao=Op("/",!1),Oo=function(e,t){if(null==t||0===t.length)return e;for(var i=[e],n=0;n<t.length;n++)i.push(t[n][1]);var r={token:"path",kind:"sequence"};return r.value=i,r},No=Lp("[88] PathElt"),Lo=function(e,t){if(e.token&&"path"!=e.token&&""==t)return e;if(e.token&&e.token!=i&&""!=t){var i={token:"path",kind:"element"};return i.value=e,i.modifier=t,i}return e.modifier=t,e},Mo=Lp("[81] PathEltOrInverse"),Po="^",Uo=Op("^",!1),$o=function(e){var t={token:"path",kind:"inversePath"};return t.value=e,t},Bo=Lp("[82] PathMod"),Qo="?",Vo=Op("?",!1),zo="+",qo=Op("+",!1),Ho=Lp("[83] PathPrimary"),Go="!",Xo=Op("!",!1),Wo=Lp("[85] PathOneInPropertySet"),Ko=Lp("[86] Integer"),Jo=Lp("[100] TriplesNodePath"),Yo=function(e){for(var t=[],i=[],n=null,r=0;r<e.length;r++){kg++;var o=null;null==e[r].chainSubject&&null==e[r].triplesContext?o=e[r]:(o=e[r].chainSubject,t=t.concat(e[r].triplesContext)),n={subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==r&&i.push(n.subject),t.push(n),n=r===e.length-1?{subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(kg+1)}},t.push(n)}return{token:"triplesnodecollection",triplesContext:t,chainSubject:i}},Zo=Lp("[87] TriplesNode"),es=function(e){for(var t=[],i=[],n=null,r=0;r<e.length;r++){kg++;var o=null;null==e[r].chainSubject&&null==e[r].triplesContext?o=e[r]:(o=e[r].chainSubject,t=t.concat(o.triplesContext)),n={subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#first"},object:o},0==r&&i.push(n.subject),t.push(n),n=r===e.length-1?{subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}}:{subject:{token:"blank",value:"_:"+kg},predicate:{token:"uri",prefix:null,suffix:null,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"},object:{token:"blank",value:"_:"+(kg+1)}},t.push(n)}return{token:"triplesnodecollection",triplesContext:t,chainSubject:i}},ts=Lp("[101] BlankNodePropertyListPath"),is="[",ns=Op("[",!1),rs="]",os=Op("]",!1),ss=function(e){for(var t={token:"blank",value:"_:"+ ++kg},i=[],n=0;n<e.pairs.length;n++){var r=e.pairs[n],o={};o.subject=t,o.predicate=r[0],null!=r[1].length&&(r[1]=r[1][0]),o.object=r[1],i.push(o)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(i),chainSubject:t}},as=Lp("[88] BlankNodePropertyList"),ls=function(e){for(var t={token:"blank",value:"_:"+ ++kg},i=[],n=0;n<e.pairs.length;n++){var r=e.pairs[n],o={};o.subject=t,o.predicate=r[0],null!=r[1].length&&(r[1]=r[1][0]),o.object=r[1],i.push(o)}return{token:"triplesnode",kind:"blanknodepropertylist",triplesContext:e.triplesContext.concat(i),chainSubject:t}},us=Lp("[103] CollectionPath"),cs=function(e){return e},ds=Lp("[89] Collection"),hs=Lp("[105] GraphNodePath"),ps=function(e){return e[1]},fs=Lp("[90] GraphNode"),gs=Lp("[91] VarOrTerm"),vs=Lp("[92] VarOrIRIref"),ms=Lp("[93] Var"),ys=function(e){var t={token:"var"};return t.value=e,t},bs=Lp("[94] GraphTerm"),ws=Lp("[95] Expression"),xs=Lp("[96] ConditionalOrExpression"),ks="||",_s=Op("||",!1),Fs=function(e,t){if(0===t.length)return e;for(var i={token:"expression",expressionType:"conditionalor"},n=[e],r=0;r<t.length;r++)n.push(t[r][3]);return i.operands=n,i},Cs=Lp("[97] ConditionalAndExpression"),Es="&&",Ts=Op("&&",!1),Ds=function(e,t){if(0===t.length)return e;for(var i={token:"expression",expressionType:"conditionaland"},n=[e],r=0;r<t.length;r++)n.push(t[r][3]);return i.operands=n,i},Ss=Lp("[98] ValueLogical"),Rs=Lp("[99] RelationalExpression"),js="=",Is=Op("=",!1),As="!=",Os=Op("!=",!1),Ns="<",Ls=Op("<",!1),Ms=">",Ps=Op(">",!1),Us="<=",$s=Op("<=",!1),Bs=">=",Qs=Op(">=",!1),Vs="I",zs=Op("I",!1),qs="i",Hs=Op("i",!1),Gs="N",Xs=Op("N",!1),Ws="n",Ks=Op("n",!1),Js="O",Ys=Op("O",!1),Zs="o",ea=Op("o",!1),ta="T",ia=Op("T",!1),na="t",ra=Op("t",!1),oa=function(e,t){if(0===t.length)return e;if("i"!==t[0][1]&&"I"!==t[0][1]&&"n"!==t[0][1]&&"N"!==t[0][1])return(i={expressionType:"relationalexpression"}).operator=t[0][1],i.op1=e,i.op2=t[0][3],i.token="expression",i;var i={};if("i"===t[0][1]||"I"===t[0][1]){var n="=";i.expressionType="conditionalor"}else n="!=",i.expressionType="conditionaland";for(var r=e,o=[],s=0;s<t[0].length;s++)if("args"===t[0][s].token){o=t[0][s].value;break}i.token="expression",i.operands=[];for(var a=0;a<o.length;a++){var l={token:"expression",expressionType:"relationalexpression"};l.operator=n,l.op1=r,l.op2=o[a],i.operands.push(l)}return i},sa=Lp("[100] NumericExpression"),aa=Lp("[101] AdditiveExpression"),la="-",ua=Op("-",!1),ca=function(e,t){if(0===t.length)return e;var i={token:"expression",expressionType:"additiveexpression"};i.summand=e,i.summands=[];for(var n=0;n<t.length;n++){var r=t[n],o={};if(4==r.length&&"string"==typeof r[1])o.operator=r[1],o.expression=r[3];else{var s={},a=o[0],l=(o[1][1],o[1][3]);a.value<0?(o.operator="-",a.value=-a.value):o.operator="+",s.token="expression",s.expressionType="multiplicativeexpression",s.operator=a,s.factors=[{operator:null,expression:l}],o.expression=s}i.summands.push(o)}return i},da=Lp("[102] MultiplicativeExpression"),ha=function(e,t){if(0===t.length)return e;var i={token:"expression",expressionType:"multiplicativeexpression"};i.factor=e,i.factors=[];for(var n=0;n<t.length;n++){var r=t[n],o={};o.operator=r[1],o.expression=r[3],i.factors.push(o)}return i},pa=Lp("[103] UnaryExpression"),fa=function(e){var t={token:"expression",expressionType:"unaryexpression",unaryexpression:"!"};return t.expression=e,t},ga=function(e){var t={token:"expression",expressionType:"unaryexpression",unaryexpression:"+"};return t.expression=e,t},va=function(e){var t={token:"expression",expressionType:"unaryexpression",unaryexpression:"-"};return t.expression=e,t},ma=Lp("[104] PrimaryExpression"),ya=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"rdfliteral"};return t.value=e,t},ba=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"numericliteral"};return t.value=e,t},wa=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"booleanliteral"};return t.value=e,t},xa=function(e){var t={token:"expression",expressionType:"atomic",primaryexpression:"var"};return t.value=e,t},ka=Lp("[105] BrackettedExpression"),_a=function(e){return e},Fa=Lp("[106] BuiltInCall"),Ca="STR",Ea=Op("STR",!1),Ta="str",Da=Op("str",!1),Sa=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"str"};return t.args=[e],t},Ra="LANG",ja=Op("LANG",!1),Ia="lang",Aa=Op("lang",!1),Oa=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"lang"};return t.args=[e],t},Na="LANGMATCHES",La=Op("LANGMATCHES",!1),Ma="langmatches",Pa=Op("langmatches",!1),Ua=function(e,t){var i={token:"expression",expressionType:"builtincall",builtincall:"langmatches"};return i.args=[e,t],i},$a="DATATYPE",Ba=Op("DATATYPE",!1),Qa="datatype",Va=Op("datatype",!1),za=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"datatype"};return t.args=[e],t},qa="BOUND",Ha=Op("BOUND",!1),Ga="bound",Xa=Op("bound",!1),Wa=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"bound"};return t.args=[e],t},Ka="IRI",Ja=Op("IRI",!1),Ya="iri",Za=Op("iri",!1),el=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"iri"};return t.args=[e],t},tl="URI",il=Op("URI",!1),nl="uri",rl=Op("uri",!1),ol=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"uri"};return t.args=[e],t},sl="BNODE",al=Op("BNODE",!1),ll="bnode",ul=Op("bnode",!1),cl=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"bnode"};return 5===e.length?t.args=[e[2]]:t.args=null,t},dl="COALESCE",hl=Op("COALESCE",!1),pl="coalesce",fl=Op("coalesce",!1),gl=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"coalesce"};return t.args=e,t},vl="IF",ml=Op("IF",!1),yl="if",bl=Op("if",!1),wl=function(e,t,i){var n={token:"expression",expressionType:"builtincall",builtincall:"if"};return n.args=[e,t,i],n},xl="ISLITERAL",kl=Op("ISLITERAL",!1),_l="isliteral",Fl=Op("isliteral",!1),Cl="isLITERAL",El=Op("isLITERAL",!1),Tl=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isliteral"};return t.args=[e],t},Dl="ISBLANK",Sl=Op("ISBLANK",!1),Rl="isblank",jl=Op("isblank",!1),Il="isBLANK",Al=Op("isBLANK",!1),Ol=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isblank"};return t.args=[e],t},Nl="SAMETERM",Ll=Op("SAMETERM",!1),Ml="sameterm",Pl=Op("sameterm",!1),Ul=function(e,t){var i={token:"expression",expressionType:"builtincall",builtincall:"sameterm"};return i.args=[e,t],i},$l="ISURI",Bl=Op("ISURI",!1),Ql="isuri",Vl=Op("isuri",!1),zl="isURI",ql=Op("isURI",!1),Hl="ISIRI",Gl=Op("ISIRI",!1),Xl="isiri",Wl=Op("isiri",!1),Kl="isIRI",Jl=Op("isIRI",!1),Yl=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"isuri"};return t.args=[e],t},Zl="custom:",eu=Op("custom:",!1),tu="CUSTOM:",iu=Op("CUSTOM:",!1),nu=/^[a-zA-Z0-9_]/,ru=Np([["a","z"],["A","Z"],["0","9"],"_"],!1,!1),ou=function(e,t,i){var n={token:"expression",expressionType:"custom"};n.name=e.join("");for(var r=[],o=0;o<t.length;o++)r.push(t[o][1]);return r.push(i),n.args=r,n},su=Lp("[107] RegexExpression"),au="REGEX",lu=Op("REGEX",!1),uu="regex",cu=Op("regex",!1),du=function(e,t,i){var n={token:"expression",expressionType:"regex"};return n.text=e,n.pattern=t,null!=i&&(n.flags=i[2]),n},hu=Lp("[108] ExistsFunc"),pu="EXISTS",fu=Op("EXISTS",!1),gu="exists",vu=Op("exists",!1),mu=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"exists"};return t.args=[e],t},yu=Lp("[109] NotExistsFunc"),bu="NOT",wu=Op("NOT",!1),xu="not",ku=Op("not",!1),_u=function(e){var t={token:"expression",expressionType:"builtincall",builtincall:"notexists"};return t.args=[e],t},Fu=Lp("[110] Aggregate"),Cu="COUNT",Eu=Op("COUNT",!1),Tu="count",Du=Op("count",!1),Su=function(e,t){var i={token:"expression",expressionType:"aggregate",aggregateType:"count"};return i.distinct=""!=e&&null!=e?"DISTINCT":e,i.expression=t,i},Ru="GROUP_CONCAT",ju=Op("GROUP_CONCAT",!1),Iu="group_concat",Au=Op("group_concat",!1),Ou="SEPARATOR",Nu=Op("SEPARATOR",!1),Lu=function(e,t,i){var n={token:"expression",expressionType:"aggregate",aggregateType:"group_concat"};return n.distinct=""!=e&&null!=e?"DISTINCT":e,n.expression=t,n.separator=i,n},Mu="SUM",Pu=Op("SUM",!1),Uu="sum",$u=Op("sum",!1),Bu=function(e,t){var i={token:"expression",expressionType:"aggregate",aggregateType:"sum"};return i.distinct=""!=e&&null!=e?"DISTINCT":e,i.expression=t,i},Qu="MIN",Vu=Op("MIN",!1),zu="min",qu=Op("min",!1),Hu=function(e,t){var i={token:"expression",expressionType:"aggregate",aggregateType:"min"};return i.distinct=""!=e&&null!=e?"DISTINCT":e,i.expression=t,i},Gu="MAX",Xu=Op("MAX",!1),Wu="max",Ku=Op("max",!1),Ju=function(e,t){var i={token:"expression",expressionType:"aggregate",aggregateType:"max"};return i.distinct=""!=e&&null!=e?"DISTINCT":e,i.expression=t,i},Yu="AVG",Zu=Op("AVG",!1),ec="avg",tc=Op("avg",!1),ic=function(e,t){var i={token:"expression",expressionType:"aggregate",aggregateType:"avg"};return i.distinct=""!=e&&null!=e?"DISTINCT":e,i.expression=t,i},nc=Lp("[117] IRIrefOrFunction"),rc=function(e,t){var i={token:"expression",expressionType:"irireforfunction"};return i.iriref=e,i.args=null!=t?t.value:t,i},oc=Lp("[112] RDFLiteral"),sc="^^",ac=Op("^^",!1),lc=function(e,t){var i=e.value.replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");return"string"==typeof t&&0<t.length?{token:"literal",value:i,lang:t.slice(1),type:null}:null!=t&&"object"==typeof t?(t.shift(),{token:"literal",value:i,lang:null,type:t[0]}):{token:"literal",value:i,lang:null,type:null}},uc=Lp("[113] NumericLiteral"),cc=Lp("[114] NumericLiteralUnsigned"),dc=Lp("[115] NumericLiteralPositive"),hc=Lp("[116] NumericLiteralNegative"),pc=Lp("[117] BooleanLiteral"),fc="TRUE",gc=Op("TRUE",!1),vc="true",mc=Op("true",!1),yc=function(){var e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!0};return e},bc="FALSE",wc=Op("FALSE",!1),xc="false",kc=Op("false",!1),_c=function(){var e={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#boolean",value:!1};return e},Fc=Lp("[118] String"),Cc=function(e){return{token:"string",value:e}},Ec=Lp("[119] IRIref"),Tc=function(e){return{token:"uri",prefix:null,suffix:null,value:e}},Dc=function(e){return e},Sc=Lp("[120] PrefixedName"),Rc=function(e){return{token:"uri",prefix:e[0],suffix:e[1],value:null}},jc=function(e){return{token:"uri",prefix:e,suffix:"",value:null}},Ic=Lp("[121] BlankNode"),Ac=function(e){return{token:"blank",value:e}},Oc=function(){return{token:"blank",value:"_:"+ ++kg}},Nc=Lp("[122] IRI_REF"),Lc=/^[^<>"{}|\^`\\]/,Mc=Np(["<",">",'"',"{","}","|","^","`","\\"],!0,!1),Pc=function(e){return e.join("")},Uc=Lp("[123] PNAME_NS"),$c=":",Bc=Op(":",!1),Qc=Lp("[124] PNAME_LN"),Vc=function(e,t){return[e,t]},zc=Lp("[125] BLANK_NODE_LABEL"),qc="_:",Hc=Op("_:",!1),Gc=function(e){return e},Xc=Lp("[126] VAR1"),Wc=function(e){return e},Kc=Lp("[127] VAR2"),Jc="$",Yc=Op("$",!1),Zc=Lp("[128] LANGTAG"),ed="@",td=Op("@",!1),id=/^[a-zA-Z]/,nd=Np([["a","z"],["A","Z"]],!1,!1),rd=/^[a-zA-Z0-9]/,od=Np([["a","z"],["A","Z"],["0","9"]],!1,!1),sd=function(e,t){return 0===t.length?("@"+e.join("")).toLowerCase():("@"+e.join("")+"-"+t[0][1].join("")).toLowerCase()},ad=Lp("[129] INTEGER"),ld=/^[0-9]/,ud=Np([["0","9"]],!1,!1),cd=function(e){var t={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#integer"};return t.value=xg(e),t},dd=Lp("[130] DECIMAL"),hd=function(e,t,i){var n={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};return n.value=xg([e,t,i]),n},pd=function(e,t){var i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#decimal"};return i.value=xg([e,t]),i},fd=Lp("[131] DOUBLE"),gd=function(e,t,i,n){var r={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};return r.value=xg([e,t,i,n]),r},vd=function(e,t,i){var n={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};return n.value=xg([e,t,i]),n},md=function(e,t){var i={token:"literal",lang:null,type:"http://www.w3.org/2001/XMLSchema#double"};return i.value=xg([e,t]),i},yd=Lp("[132] INTEGER_POSITIVE"),bd=function(e){return e.value="+"+e.value,e},wd=Lp("[133] DECIMAL_POSITIVE"),xd=function(e){return e.value="+"+e.value,e},kd=Lp("[134] DOUBLE_POSITIVE"),_d=Lp("[135] INTEGER_NEGATIVE"),Fd=function(e){return e.value="-"+e.value,e},Cd=Lp("[136] DECIMAL_NEGATIVE"),Ed=Lp("[137] DOUBLE_NEGATIVE"),Td=Lp("[138] EXPONENT"),Dd=/^[eE]/,Sd=Np(["e","E"],!1,!1),Rd=/^[+\-]/,jd=Np(["+","-"],!1,!1),Id=function(e,t,i){return xg([e,t,i])},Ad=Lp("[139] STRING_LITERAL1"),Od="'",Nd=Op("'",!1),Ld=/^[^'\\\n\r]/,Md=Np(["'","\\","\n","\r"],!0,!1),Pd=function(e){return xg(e)},Ud=Lp("[140] STRING_LITERAL2"),$d='"',Bd=Op('"',!1),Qd=/^[^"\\\n\r]/,Vd=Np(['"',"\\","\n","\r"],!0,!1),zd=Lp("[141] STRING_LITERAL_LONG1"),qd="'''",Hd=Op("'''",!1),Gd=/^[^'\\]/,Xd=Np(["'","\\"],!0,!1),Wd=Lp("[142] STRING_LITERAL_LONG2"),Kd='"""',Jd=Op('"""',!1),Yd=/^[^"\\]/,Zd=Np(['"',"\\"],!0,!1),eh=Lp("[143] ECHAR"),th="\\",ih=Op("\\",!1),nh=/^[tbnrf"']/,rh=Np(["t","b","n","r","f",'"',"'"],!1,!1),oh=Lp("[144] NIL"),sh=function(){return{token:"triplesnodecollection",triplesContext:[],chainSubject:[{token:"uri",value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"}]}},ah=Lp("[145] WS"),lh=/^[ ]/,uh=Np([" "],!1,!1),ch=/^[\t]/,dh=Np(["\t"],!1,!1),hh=/^[\r]/,ph=Np(["\r"],!1,!1),fh=/^[\n]/,gh=Np(["\n"],!1,!1),vh=Lp(" COMMENT"),mh="#",yh=Op("#",!1),bh=/^[^\n\r]/,wh=Np(["\n","\r"],!0,!1),xh=Lp("[146] ANON"),kh=Lp("[147] PN_CHARS_BASE"),_h=/^[A-Z]/,Fh=Np([["A","Z"]],!1,!1),Ch=/^[a-z]/,Eh=Np([["a","z"]],!1,!1),Th=/^[\xC0-\xD6]/,Dh=Np([["À","Ö"]],!1,!1),Sh=/^[\xD8-\xF6]/,Rh=Np([["Ø","ö"]],!1,!1),jh=/^[\xF8-\u02FF]/,Ih=Np([["ø","˿"]],!1,!1),Ah=/^[\u0370-\u037D]/,Oh=Np([["Ͱ","ͽ"]],!1,!1),Nh=/^[\u037F-\u1FFF]/,Lh=Np([["Ϳ","῿"]],!1,!1),Mh=/^[\u200C-\u200D]/,Ph=Np([["‌","‍"]],!1,!1),Uh=/^[\u2070-\u218F]/,$h=Np([["⁰","↏"]],!1,!1),Bh=/^[\u2C00-\u2FEF]/,Qh=Np([["Ⰰ","⿯"]],!1,!1),Vh=/^[\u3001-\uD7FF]/,zh=Np([["、","퟿"]],!1,!1),qh=/^[\uF900-\uFDCF]/,Hh=Np([["豈","﷏"]],!1,!1),Gh=/^[\uFDF0-\uFFFD]/,Xh=Np([["ﷰ","�"]],!1,!1),Wh=/^[\u1000-\uEFFF]/,Kh=Np([["က",""]],!1,!1),Jh=Lp("[148] PN_CHARS_U"),Yh="_",Zh=Op("_",!1),ep=Lp("[149] VARNAME"),tp=/^[\xB7]/,ip=Np(["·"],!1,!1),np=/^[\u0300-\u036F]/,rp=Np([["̀","ͯ"]],!1,!1),op=/^[\u203F-\u2040]/,sp=Np([["‿","⁀"]],!1,!1),ap=function(e,t){return e+t.join("")},lp=Lp("[150] PN_CHARS"),up=Lp("[151] PN_PREFIX"),cp=function(e,t){if("."==t[t.length-1])throw new Error("Wrong PN_PREFIX, cannot finish with '.'");return e+t.join("")},dp=Lp("[152] PN_LOCAL"),hp=function(e,t){return e+(t||[]).join("")},pp=Lp("[170] PLX"),fp=Lp("[171] PERCENT"),gp="%",vp=Op("%",!1),mp=function(e){return e.join("")},yp=Lp("[172] HEX"),bp=/^[A-F]/,wp=Np([["A","F"]],!1,!1),xp=/^[a-f]/,kp=Np([["a","f"]],!1,!1),_p=Lp("[173] PN_LOCAL_ESC"),Fp="~",Cp=Op("~",!1),Ep="&",Tp=Op("&",!1),Dp=function(e){return"\\"+e},Sp=0,Rp=[{line:1,column:1}],jp=0,Ip=[],Ap=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');n=i[e.startRule]}function Op(e,t){return{type:"literal",text:e,ignoreCase:t}}function Np(e,t,i){return{type:"class",parts:e,inverted:t,ignoreCase:i}}function Lp(e){return{type:"other",description:e}}function Mp(e){var t,i=Rp[e];if(i)return i;for(t=e-1;!Rp[t];)t--;for(i={line:(i=Rp[t]).line,column:i.column};t<e;)10===w.charCodeAt(t)?(i.line++,i.column=1):i.column++,t++;return Rp[e]=i}function Pp(e,t){var i=Mp(e),n=Mp(t);return{start:{offset:e,line:i.line,column:i.column},end:{offset:t,line:n.line,column:n.column}}}function Up(e){Sp<jp||(jp<Sp&&(jp=Sp,Ip=[]),Ip.push(e))}function $p(e,t,i){return new Tg(Tg.buildMessage(e,t),e,t,i)}function Bp(){return Ap++,Ap++,n=Sp,n=(r=Qp())!==x?((o=function(){var e,t,i,n,r,o,s,a,l,u;if(Ap++,e=Sp,(t=zp())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){for(n=[],r=qp();r!==x;)n.push(r),r=qp();if(n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=Gp())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=Xp())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();e=l!==x&&(u=function(){var e,t,i,n,r,o,s,a,l;if(Ap++,e=Sp,w.substr(Sp,8)===Mt?(t=Mt,Sp+=8):(t=x,0===Ap&&Up(Pt)),t!==x){for(i=[],n=Vf();n!==x;)i.push(n),n=Vf();if(i!==x)if(123===w.charCodeAt(Sp)?(n=le,Sp++):(n=x,0===Ap&&Up(ue)),n!==x){if(r=[],o=Sp,40===w.charCodeAt(Sp)?(s=B,Sp++):(s=x,0===Ap&&Up(Q)),s!==x){if(a=[],(l=ef())!==x)for(;l!==x;)a.push(l),l=ef();else a=x;o=a!==x?(41===w.charCodeAt(Sp)?(l=G,Sp++):(l=x,0===Ap&&Up(X)),l!==x?s=[s,a,l]:(Sp=o,x)):(Sp=o,x)}else Sp=o,o=x;for(o===x&&(o=hg());o!==x;){if(r.push(o),o=Sp,40===w.charCodeAt(Sp)?(s=B,Sp++):(s=x,0===Ap&&Up(Q)),s!==x){if(a=[],(l=ef())!==x)for(;l!==x;)a.push(l),l=ef();else a=x;o=a!==x?(41===w.charCodeAt(Sp)?(l=G,Sp++):(l=x,0===Ap&&Up(X)),l!==x?s=[s,a,l]:(Sp=o,x)):(Sp=o,x)}else Sp=o,o=x;o===x&&(o=hg())}e=r!==x?(125===w.charCodeAt(Sp)?(o=ce,Sp++):(o=x,0===Ap&&Up(de)),o!==x?t=[t,i,n,r,o]:(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return e===x&&(e=null),Ap--,e===x&&(t=x,0===Ap&&Up(Lt)),e}())!==x?t=C(t,n,o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(F)),e}())===x&&(o=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,9)===Z?(i=Z,Sp+=9):(i=x,0===Ap&&Up(ee)),i===x&&(w.substr(Sp,9)===te?(i=te,Sp+=9):(i=x,0===Ap&&Up(ie))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,123===w.charCodeAt(Sp)?(t=le,Sp++):(t=x,0===Ap&&Up(ue)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=function e(){var t,i,n,r,o,s,a;if(Ap++,t=Sp,(i=xf())!==x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(46===w.charCodeAt(Sp)?(o=On,Sp++):(o=x,0===Ap&&Up(Nn)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x?((a=e())===x&&(a=null),a!==x?r=[r,o,s,a]:(Sp=n,x)):(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;n===x&&(n=null),t=n!==x?i=Jr(i,n):(Sp=t,x)}else Sp=t,t=x;return Ap--,t===x&&(i=x,0===Ap&&Up(Kr)),t}())===x&&(n=null),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?(125===w.charCodeAt(Sp)?(o=ce,Sp++):(o=x,0===Ap&&Up(de)),o!==x?t=Wr(n):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Xr)),e}())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x){for(s=[],a=qp();a!==x;)s.push(a),a=qp();if(s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if((l=Gp())!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();e=u!==x&&(c=Xp())!==x?t=ne(r,s,l,c):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,9)===Z?(i=Z,Sp+=9):(i=x,0===Ap&&Up(ee)),i===x&&(w.substr(Sp,9)===te?(i=te,Sp+=9):(i=x,0===Ap&&Up(ie))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x){for(r=[],o=qp();o!==x;)r.push(o),o=qp();if(r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(w.substr(Sp,5)===re?(s=re,Sp+=5):(s=x,0===Ap&&Up(oe)),s===x&&(w.substr(Sp,5)===se?(s=se,Sp+=5):(s=x,0===Ap&&Up(ae))),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if(123===w.charCodeAt(Sp)?(l=le,Sp++):(l=x,0===Ap&&Up(ue)),l!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();if(u!==x)if((c=df())===x&&(c=null),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();if(d!==x)if(125===w.charCodeAt(Sp)?(h=ce,Sp++):(h=x,0===Ap&&Up(de)),h!==x){for(p=[],f=pg();f!==x;)p.push(f),f=pg();e=p!==x&&(f=Xp())!==x?t=he(r,c,f):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}return Ap--,e===x&&(t=x,0===Ap&&Up(Y)),e}())===x&&(o=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,8)===fe?(t=fe,Sp+=8):(t=x,0===Ap&&Up(ge)),t!==x){if(i=[],(n=Qf())!==x)for(;n!==x;)i.push(n),n=Qf();else i=x;if(i===x&&(42===w.charCodeAt(Sp)?(i=W,Sp++):(i=x,0===Ap&&Up(K))),i!==x){for(n=[],r=qp();r!==x;)n.push(r),r=qp();e=n!==x?((r=Gp())===x&&(r=null),r!==x&&(o=Xp())!==x?t=[t,i,n,r,o]:(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(pe)),e}())===x&&(o=function(){var e,t,i,n,r,o,s;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,3)===me?(i=me,Sp+=3):(i=x,0===Ap&&Up(ye)),i===x&&(w.substr(Sp,3)===be?(i=be,Sp+=3):(i=x,0===Ap&&Up(we))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x){for(r=[],o=qp();o!==x;)r.push(o),o=qp();if(r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();e=o!==x&&(s=Gp())!==x?t=xe(r,s):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ve)),e}()),o!==x?(Ap++,l=a=Sp,w.substr(Sp,6)===Vt?(u=Vt,Sp+=6):(u=x,0===Ap&&Up(zt)),u===x&&(w.substr(Sp,6)===qt?(u=qt,Sp+=6):(u=x,0===Ap&&Up(Ht))),(l=u!==x&&(c=vf())!==x?u=[u,c]:(Sp=l,x))===x&&(l=null),l!==x&&(l=Gt(l)),Ap--,(a=l)===x&&(l=x,0===Ap&&Up(Qt)),(s=a)!==x?r=p(r,o,s):(Sp=n,x)):(Sp=n,x)):(Sp=n,x),Ap--,n===x&&(r=x,0===Ap&&Up(h)),Ap--,(i=n)===x&&0===Ap&&Up(d),(e=i)===x&&(Ap++,t=function e(){var t,i,n,r,o,s,a,l,u;if(Ap++,t=Sp,(i=Qp())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=tf())!==x){for(o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x?((u=e())===x&&(u=null),u!==x?s=[s,a,l,u]:(Sp=o,x)):(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x;o===x&&(o=null),t=o!==x?i=Yt(i,r,o):(Sp=t,x)}else Sp=t,t=x;else Sp=t,t=x}else Sp=t,t=x;return Ap--,t===x&&(i=x,0===Ap&&Up(Wt)),t}(),Ap--,t===x&&0===Ap&&Up(Xt),e=t),e;var e,t,i,n,r,o,s,a,l,u,c}function Qp(){var e,t,i,n,r;if(Ap++,e=Sp,(t=function(){var e,t,i,n,r;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,4)===l?(i=l,Sp+=4):(i=x,0===Ap&&Up(u)),i===x&&(w.substr(Sp,4)===c?(i=c,Sp+=4):(i=x,0===Ap&&Up(f))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=og())!==x?t=g(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(a)),e}())===x&&(t=null),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){for(n=[],r=Vp();r!==x;)n.push(r),r=Vp();e=n!==x?t=s(t,n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(o)),e}function Vp(){var e,t,i,n,r,o,s;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,6)===m?(i=m,Sp+=6):(i=x,0===Ap&&Up(y)),i===x&&(w.substr(Sp,6)===b?(i=b,Sp+=6):(i=x,0===Ap&&Up(k))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=sg())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();e=o!==x&&(s=og())!==x?t=_(r,s):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(v)),e}function zp(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f,g,v,m,y,b;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,6)===S?(i=S,Sp+=6):(i=x,0===Ap&&Up(R)),i===x&&(w.substr(Sp,6)===j?(i=j,Sp+=6):(i=x,0===Ap&&Up(I))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(w.substr(Sp,8)===A?(r=A,Sp+=8):(r=x,0===Ap&&Up(O)),r===x&&(w.substr(Sp,8)===N?(r=N,Sp+=8):(r=x,0===Ap&&Up(L))),r===x&&(w.substr(Sp,7)===M?(r=M,Sp+=7):(r=x,0===Ap&&Up(P)),r===x&&(w.substr(Sp,7)===U?(r=U,Sp+=7):(r=x,0===Ap&&Up($)))),r===x&&(r=null),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x){for(s=[],a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=Vf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();a=c!==x?l=[l,u,c]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x;if(a===x){for(a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(40===w.charCodeAt(Sp)?(u=B,Sp++):(u=x,0===Ap&&Up(Q)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x)if((d=zf())!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if(w.substr(Sp,2)===V?(p=V,Sp+=2):(p=x,0===Ap&&Up(z)),p===x&&(w.substr(Sp,2)===q?(p=q,Sp+=2):(p=x,0===Ap&&Up(H))),p!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();if(f!==x)if((g=Vf())!==x){for(v=[],m=pg();m!==x;)v.push(m),m=pg();if(v!==x)if(41===w.charCodeAt(Sp)?(m=G,Sp++):(m=x,0===Ap&&Up(X)),m!==x){for(y=[],b=pg();b!==x;)y.push(b),b=pg();a=y!==x?l=[l,u,c,d,h,p,f,g,v,m,y]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}if(a!==x)for(;a!==x;){for(s.push(a),a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=Vf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();a=c!==x?l=[l,u,c]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x;if(a===x){for(a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(40===w.charCodeAt(Sp)?(u=B,Sp++):(u=x,0===Ap&&Up(Q)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x)if((d=zf())!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if(w.substr(Sp,2)===V?(p=V,Sp+=2):(p=x,0===Ap&&Up(z)),p===x&&(w.substr(Sp,2)===q?(p=q,Sp+=2):(p=x,0===Ap&&Up(H))),p!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();if(f!==x)if((g=Vf())!==x){for(v=[],m=pg();m!==x;)v.push(m),m=pg();if(v!==x)if(41===w.charCodeAt(Sp)?(m=G,Sp++):(m=x,0===Ap&&Up(X)),m!==x){for(y=[],b=pg();b!==x;)y.push(b),b=pg();a=y!==x?l=[l,u,c,d,h,p,f,g,v,m,y]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x}}else s=x;if(s===x){for(s=Sp,a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if(42===w.charCodeAt(Sp)?(l=W,Sp++):(l=x,0===Ap&&Up(K)),l!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();s=u!==x?a=[a,l,u]:(Sp=s,x)}else Sp=s,s=x;else Sp=s,s=x}e=s!==x?t=J(r,s):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(D)),e}function qp(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,4)===_e?(t=_e,Sp+=4):(t=x,0===Ap&&Up(Fe)),t===x&&(w.substr(Sp,4)===Ce?(t=Ce,Sp+=4):(t=x,0===Ap&&Up(Ee))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=function(){var e,t,i;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();return e=t!==x?(i=Hp())!==x?t=Se(i):(Sp=e,x):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(De)),e}())===x&&(n=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,5)===je?(t=je,Sp+=5):(t=x,0===Ap&&Up(Ie)),t===x&&(w.substr(Sp,5)===Ae?(t=Ae,Sp+=5):(t=x,0===Ap&&Up(Oe))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=Hp())!==x?t=Ne(n):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Re)),e}()),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?t=Te(n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ke)),e}function Hp(){var e;return Ap++,e=rg(),Ap--,e===x&&0===Ap&&Up(r),e}function Gp(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,5)===re?(t=re,Sp+=5):(t=x,0===Ap&&Up(oe)),t===x&&(w.substr(Sp,5)===se?(t=se,Sp+=5):(t=x,0===Ap&&Up(ae))),t===x&&(t=null),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=hf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?t=Me(n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Le)),e}function Xp(){var e,t,i,n,r,o,s,a,l;return Ap++,e=Sp,(t=function(){var e,t,i,n,r,o,s;if(Ap++,e=Sp,w.substr(Sp,5)===Be?(t=Be,Sp+=5):(t=x,0===Ap&&Up(Qe)),t===x&&(w.substr(Sp,5)===Ve?(t=Ve,Sp+=5):(t=x,0===Ap&&Up(ze))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,2)===qe?(n=qe,Sp+=2):(n=x,0===Ap&&Up(He)),n===x&&(w.substr(Sp,2)===Ge?(n=Ge,Sp+=2):(n=x,0===Ap&&Up(Xe))),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){if(o=[],(s=Wp())!==x)for(;s!==x;)o.push(s),s=Wp();else o=x;e=o!==x?t=We(o):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up($e)),e}())===x&&(t=null),e=t!==x?((i=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,6)===it?(t=it,Sp+=6):(t=x,0===Ap&&Up(nt)),t!==x){if(i=[],(n=Kp())!==x)for(;n!==x;)i.push(n),n=Kp();else i=x;e=i!==x?t=[t,i]:(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(tt)),e}())===x&&(i=null),i!==x?((n=function(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,w.substr(Sp,5)===st?(t=st,Sp+=5):(t=x,0===Ap&&Up(at)),t===x&&(w.substr(Sp,5)===lt?(t=lt,Sp+=5):(t=x,0===Ap&&Up(ut))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,2)===qe?(n=qe,Sp+=2):(n=x,0===Ap&&Up(He)),n===x&&(w.substr(Sp,2)===Ge?(n=Ge,Sp+=2):(n=x,0===Ap&&Up(Xe))),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){if(o=[],(s=Jp())!==x)for(;s!==x;)o.push(s),s=Jp();else o=x;if(o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?t=ct(o):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ot)),e}())===x&&(n=null),n!==x?(Ap++,s=o=Sp,(s=(a=Yp())!==x?((l=Zp())===x&&(l=null),l!==x?a=[a,l]:(Sp=s,x)):(Sp=s,x))===x&&(s=Sp,a=Zp(),s=a!==x?((l=Yp())===x&&(l=null),l!==x?a=[a,l]:(Sp=s,x)):(Sp=s,x)),s!==x&&(s=_t(s)),Ap--,(o=s)===x&&(s=x,0===Ap&&Up(kt)),(r=o)===x&&(r=null),r!==x?t=Ue(t,n,r):(Sp=e,x)):(Sp=e,x)):(Sp=e,x)):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(Pe)),e}function Wp(){var e,t,i,n,r,o,s,a,l,u,c;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Yf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?t=Je(i):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=yf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?t=Ye(i):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(40===w.charCodeAt(Sp)?(i=B,Sp++):(i=x,0===Ap&&Up(Q)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=zf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x){if(s=Sp,w.substr(Sp,2)===V?(a=V,Sp+=2):(a=x,0===Ap&&Up(z)),a===x&&(w.substr(Sp,2)===q?(a=q,Sp+=2):(a=x,0===Ap&&Up(H))),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();s=l!==x&&(u=Vf())!==x?a=[a,l,u]:(Sp=s,x)}else Sp=s,s=x;if(s===x&&(s=null),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if(41===w.charCodeAt(Sp)?(l=G,Sp++):(l=x,0===Ap&&Up(X)),l!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();e=u!==x?t=Ze(r,s):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Vf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?t=et(i):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}}}return Ap--,e===x&&(t=x,0===Ap&&Up(Ke)),e}function Kp(){var e;return Ap++,e=gf(),Ap--,e===x&&0===Ap&&Up(rt),e}function Jp(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,3)===ht?(t=ht,Sp+=3):(t=x,0===Ap&&Up(pt)),t===x&&(w.substr(Sp,3)===ft?(t=ft,Sp+=3):(t=x,0===Ap&&Up(gt)),t===x&&(w.substr(Sp,4)===vt?(t=vt,Sp+=4):(t=x,0===Ap&&Up(mt)),t===x&&(w.substr(Sp,4)===yt?(t=yt,Sp+=4):(t=x,0===Ap&&Up(bt))))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Jf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?t=wt(t,n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x)if(e=Sp,(t=gf())===x&&(t=Vf()),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x?t=xt(t):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(dt)),e}function Yp(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,5)===Ct?(t=Ct,Sp+=5):(t=x,0===Ap&&Up(Et)),t===x&&(w.substr(Sp,5)===Tt?(t=Tt,Sp+=5):(t=x,0===Ap&&Up(Dt))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=ag())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?t=St(n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ft)),e}function Zp(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,6)===jt?(t=jt,Sp+=6):(t=x,0===Ap&&Up(It)),t===x&&(w.substr(Sp,6)===At?(t=At,Sp+=6):(t=x,0===Ap&&Up(Ot))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=ag())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?t=Nt(n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Rt)),e}function ef(){var e;return Ap++,(e=rg())===x&&(e=Zf())===x&&(e=eg())===x&&(e=ig())===x&&(w.substr(Sp,5)===$t?(e=$t,Sp+=5):(e=x,0===Ap&&Up(Bt))),Ap--,e===x&&0===Ap&&Up(Ut),e}function tf(){var e;return Ap++,(e=function(){var e,t,i,n,r,o,s,a,l;if(Ap++,e=Sp,w.substr(Sp,4)===ti?(t=ti,Sp+=4):(t=x,0===Ap&&Up(ii)),t===x&&(w.substr(Sp,4)===ni?(t=ni,Sp+=4):(t=x,0===Ap&&Up(ri))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=rg())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){if(o=Sp,w.substr(Sp,4)===oi?(s=oi,Sp+=4):(s=x,0===Ap&&Up(si)),s===x&&(w.substr(Sp,4)===ai?(s=ai,Sp+=4):(s=x,0===Ap&&Up(li))),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();o=a!==x&&(l=of())!==x?s=[s,a,l]:(Sp=o,x)}else Sp=o,o=x;o===x&&(o=null),e=o!==x?t=ui(n,o):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ei)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,5)===di?(t=di,Sp+=5):(t=x,0===Ap&&Up(hi)),t===x&&(w.substr(Sp,5)===pi?(t=pi,Sp+=5):(t=x,0===Ap&&Up(fi))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,6)===gi?(n=gi,Sp+=6):(n=x,0===Ap&&Up(vi)),n===x&&(w.substr(Sp,6)===mi?(n=mi,Sp+=6):(n=x,0===Ap&&Up(yi))),n===x&&(n=null),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=sf())!==x?t=bi(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ci)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,4)===xi?(t=xi,Sp+=4):(t=x,0===Ap&&Up(ki)),t===x&&(w.substr(Sp,4)===_i?(t=_i,Sp+=4):(t=x,0===Ap&&Up(Fi))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,6)===gi?(n=gi,Sp+=6):(n=x,0===Ap&&Up(vi)),n===x&&(w.substr(Sp,6)===mi?(n=mi,Sp+=6):(n=x,0===Ap&&Up(yi))),n===x&&(n=null),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=sf())!==x?t=Ci(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(wi)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,6)===Ti?(t=Ti,Sp+=6):(t=x,0===Ap&&Up(Di)),t===x&&(w.substr(Sp,6)===Si?(t=Si,Sp+=6):(t=x,0===Ap&&Up(Ri))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,6)===gi?(n=gi,Sp+=6):(n=x,0===Ap&&Up(vi)),n===x&&(w.substr(Sp,6)===mi?(n=mi,Sp+=6):(n=x,0===Ap&&Up(yi))),n===x&&(n=null),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=of())!==x?t=ji(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ei)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,6)===Ai?(t=Ai,Sp+=6):(t=x,0===Ap&&Up(Oi)),t===x&&(w.substr(Sp,6)===Ni?(t=Ni,Sp+=6):(t=x,0===Ap&&Up(Li))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,4)===Mi?(n=Mi,Sp+=4):(n=x,0===Ap&&Up(Pi)),n===x&&(w.substr(Sp,4)===Ui?(n=Ui,Sp+=4):(n=x,0===Ap&&Up($i))),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=lf())!==x?t=Bi(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ii)),e}())===x&&(e=function(){var e,t,i,n,r;if(Ap++,e=Sp,w.substr(Sp,6)===Vi?(t=Vi,Sp+=6):(t=x,0===Ap&&Up(zi)),t===x&&(w.substr(Sp,6)===qi?(t=qi,Sp+=6):(t=x,0===Ap&&Up(Hi))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x?(w.substr(Sp,4)===Mi?(n=Mi,Sp+=4):(n=x,0===Ap&&Up(Pi)),n===x&&(w.substr(Sp,4)===Ui?(n=Ui,Sp+=4):(n=x,0===Ap&&Up($i))),n!==x&&(r=lf())!==x?t=Gi(r):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Qi)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,6)===Vi?(t=Vi,Sp+=6):(t=x,0===Ap&&Up(zi)),t===x&&(w.substr(Sp,6)===qi?(t=qi,Sp+=6):(t=x,0===Ap&&Up(Hi))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,5)===re?(n=re,Sp+=5):(n=x,0===Ap&&Up(oe)),n===x&&(w.substr(Sp,5)===se?(n=se,Sp+=5):(n=x,0===Ap&&Up(ae))),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=hf())!==x?t=Wi(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Xi)),e}())===x&&(e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f;if(Ap++,t=e=Sp,w.substr(Sp,4)===Ji?(i=Ji,Sp+=4):(i=x,0===Ap&&Up(Yi)),i===x&&(w.substr(Sp,4)===Zi?(i=Zi,Sp+=4):(i=x,0===Ap&&Up(en))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();t=n!==x&&(r=rg())!==x?i=[i,n,r]:(Sp=t,x)}else Sp=t,t=x;if(t===x&&(t=null),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){if(Ap++,h=n=Sp,w.substr(Sp,6)===Vi?(p=Vi,Sp+=6):(p=x,0===Ap&&Up(zi)),p===x&&(w.substr(Sp,6)===qi?(p=qi,Sp+=6):(p=x,0===Ap&&Up(Hi))),h=p!==x&&(f=af())!==x?p=rn(f):(Sp=h,x),Ap--,h===x&&(p=x,0===Ap&&Up(nn)),(r=h)!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();n=o!==x?((s=nf())===x&&(s=null),s!==x?r=[r,o,s]:(Sp=n,x)):(Sp=n,x)}else Sp=n,n=x;if(n===x&&(n=nf()),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){for(o=[],s=rf();s!==x;)o.push(s),s=rf();if(o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(w.substr(Sp,5)===re?(a=re,Sp+=5):(a=x,0===Ap&&Up(oe)),a===x&&(w.substr(Sp,5)===se?(a=se,Sp+=5):(a=x,0===Ap&&Up(ae))),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=hf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=tn(t,n,o,u):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ki)),e}()),Ap--,e===x&&0===Ap&&Up(Zt),e}function nf(){var e,t,i;return Ap++,e=Sp,w.substr(Sp,6)===Ai?(t=Ai,Sp+=6):(t=x,0===Ap&&Up(Oi)),t===x&&(w.substr(Sp,6)===Ni?(t=Ni,Sp+=6):(t=x,0===Ap&&Up(Li))),e=t!==x&&(i=af())!==x?t=rn(i):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(on)),e}function rf(){var e,t,i,n,r,o,s,a;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,5)===an?(i=an,Sp+=5):(i=x,0===Ap&&Up(ln)),i===x&&(w.substr(Sp,5)===un?(i=un,Sp+=5):(i=x,0===Ap&&Up(cn))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x){if((r=rg())===x)if(r=Sp,w.substr(Sp,5)===je?(o=je,Sp+=5):(o=x,0===Ap&&Up(Ie)),o===x&&(w.substr(Sp,5)===Ae?(o=Ae,Sp+=5):(o=x,0===Ap&&Up(Oe))),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();r=s!==x&&(a=rg())!==x?o=[o,s,a]:(Sp=r,x)}else Sp=r,r=x;e=r!==x?t=dn(r):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(sn)),e}function of(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,5)===pn?(t=pn,Sp+=5):(t=x,0===Ap&&Up(fn)),t===x&&(w.substr(Sp,5)===gn?(t=gn,Sp+=5):(t=x,0===Ap&&Up(vn))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=rg())!==x?t=mn(n):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(hn)),e}function sf(){var e,t;return Ap++,e=Sp,(t=of())!==x&&(t=Me(t)),(e=t)===x&&(e=Sp,w.substr(Sp,7)===bn?(t=bn,Sp+=7):(t=x,0===Ap&&Up(wn)),t===x&&(w.substr(Sp,7)===xn?(t=xn,Sp+=7):(t=x,0===Ap&&Up(kn))),t!==x&&(t=_n()),(e=t)===x&&(e=Sp,w.substr(Sp,5)===je?(t=je,Sp+=5):(t=x,0===Ap&&Up(Ie)),t===x&&(w.substr(Sp,5)===Ae?(t=Ae,Sp+=5):(t=x,0===Ap&&Up(Oe))),t!==x&&(t=Fn()),(e=t)===x&&(e=Sp,w.substr(Sp,3)===Cn?(t=Cn,Sp+=3):(t=x,0===Ap&&Up(En)),t===x&&(w.substr(Sp,3)===Tn?(t=Tn,Sp+=3):(t=x,0===Ap&&Up(Dn))),t!==x&&(t=Sn()),e=t))),Ap--,e===x&&(t=x,0===Ap&&Up(yn)),e}function af(){var e,t,i,n,r,o,s,a,l;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(123===w.charCodeAt(Sp)?(i=le,Sp++):(i=x,0===Ap&&Up(ue)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=uf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(125===w.charCodeAt(Sp)?(s=ce,Sp++):(s=x,0===Ap&&Up(de)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?t=jn(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Rn)),e}function lf(){var e,t,i,n,r,o,s,a,l;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(123===w.charCodeAt(Sp)?(i=le,Sp++):(i=x,0===Ap&&Up(ue)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=uf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(125===w.charCodeAt(Sp)?(s=ce,Sp++):(s=x,0===Ap&&Up(de)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?t=jn(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(In)),e}function uf(){var e,t,i,n,r,o,s;if(Ap++,e=Sp,(t=df())===x&&(t=null),t!==x){for(i=[],n=Sp,n=(r=cf())!==x?(46===w.charCodeAt(Sp)?(o=On,Sp++):(o=x,0===Ap&&Up(Nn)),o===x&&(o=null),o!==x?((s=df())===x&&(s=null),s!==x?r=[r,o,s]:(Sp=n,x)):(Sp=n,x)):(Sp=n,x);n!==x;)i.push(n),n=Sp,n=(r=cf())!==x?(46===w.charCodeAt(Sp)?(o=On,Sp++):(o=x,0===Ap&&Up(Nn)),o===x&&(o=null),o!==x?((s=df())===x&&(s=null),s!==x?r=[r,o,s]:(Sp=n,x)):(Sp=n,x)):(Sp=n,x);e=i!==x?t=Ln(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(An)),e}function cf(){var e,t,i,n,r,o,s,a,l,u,c,d,h;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,5)===pn?(i=pn,Sp+=5):(i=x,0===Ap&&Up(fn)),i===x&&(w.substr(Sp,5)===gn?(i=gn,Sp+=5):(i=x,0===Ap&&Up(vn))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=Qf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(123===w.charCodeAt(Sp)?(s=le,Sp++):(s=x,0===Ap&&Up(ue)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if((l=df())===x&&(l=null),l!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();if(u!==x)if(125===w.charCodeAt(Sp)?(c=ce,Sp++):(c=x,0===Ap&&Up(de)),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();e=d!==x?t=Pn(r,l):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Mn)),e}function df(){var e,t,i,n,r,o,s;if(Ap++,e=Sp,(t=xf())!==x){for(i=Sp,n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(46===w.charCodeAt(Sp)?(r=On,Sp++):(r=x,0===Ap&&Up(Nn)),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();i=o!==x?((s=df())===x&&(s=null),s!==x?n=[n,r,o,s]:(Sp=i,x)):(Sp=i,x)}else Sp=i,i=x;else Sp=i,i=x;i===x&&(i=null),e=i!==x?t=$n(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Un)),e}function hf(){var e,t,i,n,r,o,s,a,l,u;if(Ap++,e=Sp,123===w.charCodeAt(Sp)?(t=le,Sp++):(t=x,0===Ap&&Up(ue)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(Ap++,s=Sp,s=(a=zp())!==x&&(l=Gp())!==x&&(u=Xp())!==x?a=T(a,l,u):(Sp=s,x),Ap--,s===x&&(a=x,0===Ap&&Up(E)),(n=s)!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?(125===w.charCodeAt(Sp)?(o=ce,Sp++):(o=x,0===Ap&&Up(de)),o!==x?t=Qn(n):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x)if(e=Sp,123===w.charCodeAt(Sp)?(t=le,Sp++):(t=x,0===Ap&&Up(ue)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=function(){var e,t,i,n,r,o,s,a,l,u;if(Ap++,e=Sp,(t=pf())===x&&(t=null),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){if(n=[],r=Sp,(o=ff())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(46===w.charCodeAt(Sp)?(a=On,Sp++):(a=x,0===Ap&&Up(Nn)),a===x&&(a=null),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();r=l!==x?((u=pf())===x&&(u=null),u!==x?o=[o,s,a,l,u]:(Sp=r,x)):(Sp=r,x)}else Sp=r,r=x;else Sp=r,r=x}else Sp=r,r=x;for(;r!==x;)if(n.push(r),r=Sp,(o=ff())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(46===w.charCodeAt(Sp)?(a=On,Sp++):(a=x,0===Ap&&Up(Nn)),a===x&&(a=null),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();r=l!==x?((u=pf())===x&&(u=null),u!==x?o=[o,s,a,l,u]:(Sp=r,x)):(Sp=r,x)}else Sp=r,r=x;else Sp=r,r=x}else Sp=r,r=x;e=n!==x?t=zn(t,n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Vn)),e}())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?(125===w.charCodeAt(Sp)?(o=ce,Sp++):(o=x,0===Ap&&Up(de)),o!==x?t=Qn(n):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Bn)),e}function pf(){var e,t,i,n,r,o;if(Ap++,e=Sp,(t=function(){var e,t,i,n,r,o;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Bf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=Df())!==x?t=yo(i,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Mf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?(Ap++,(o=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h;if(Ap++,e=Sp,(t=Sf())===x&&(t=Rf()),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=_f())!==x){for(r=[],o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x){if(u=Sp,(c=Sf())===x&&(c=Rf()),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();u=d!==x&&(h=Ff())!==x?c=[c,d,h]:(Sp=u,x)}else Sp=u,u=x;u===x&&(u=null),o=u!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x}else Sp=o,o=x;else Sp=o,o=x;for(;o!==x;){for(r.push(o),o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x){if(u=Sp,(c=Sf())===x&&(c=Rf()),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();u=d!==x&&(h=Ff())!==x?c=[c,d,h]:(Sp=u,x)}else Sp=u,u=x;u===x&&(u=null),o=u!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x}else Sp=o,o=x;else Sp=o,o=x}e=r!==x?t=io(t,n,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(to)),e}())===x&&(o=null),Ap--,o===x&&0===Ap&&Up(ko),(r=o)!==x?t=bo(i,r):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}return Ap--,e===x&&(t=x,0===Ap&&Up(mo)),e}())!==x){for(i=Sp,n=[],r=pg();r!==x;)n.push(r),r=pg();(i=n!==x?(46===w.charCodeAt(Sp)?(r=On,Sp++):(r=x,0===Ap&&Up(Nn)),r!==x?((o=pf())===x&&(o=null),o!==x?n=[n,r,o]:(Sp=i,x)):(Sp=i,x)):(Sp=i,x))===x&&(i=null),e=i!==x?t=Hn(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(qn)),e}function ff(){var e,t,i,n,r;return Ap++,(e=function(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=hf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,5)===pr?(o=pr,Sp+=5):(o=x,0===Ap&&Up(fr)),o===x&&(w.substr(Sp,5)===gr?(o=gr,Sp+=5):(o=x,0===Ap&&Up(vr))),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=hf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,5)===pr?(o=pr,Sp+=5):(o=x,0===Ap&&Up(fr)),o===x&&(w.substr(Sp,5)===gr?(o=gr,Sp+=5):(o=x,0===Ap&&Up(vr))),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=hf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}e=i!==x?t=mr(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(hr)),e}())===x&&(e=function(){var e,t,i,n,r;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,8)===Wn?(i=Wn,Sp+=8):(i=x,0===Ap&&Up(Kn)),i===x&&(w.substr(Sp,8)===Jn?(i=Jn,Sp+=8):(i=x,0===Ap&&Up(Yn))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=hf())!==x?t=Zn(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Xn)),e}())===x&&(e=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,5)===ar?(t=ar,Sp+=5):(t=x,0===Ap&&Up(lr)),t===x&&(w.substr(Sp,5)===ur?(t=ur,Sp+=5):(t=x,0===Ap&&Up(cr))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=hf())!==x?t=dr(n):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(sr)),e}())===x&&(e=function(){var e,t,i,n,r,o,s;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,5)===pn?(i=pn,Sp+=5):(i=x,0===Ap&&Up(fn)),i===x&&(w.substr(Sp,5)===gn?(i=gn,Sp+=5):(i=x,0===Ap&&Up(vn))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=Qf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();e=o!==x&&(s=hf())!==x?t=tr(r,s):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(er)),e}())===x&&(Ap++,t=Sp,w.substr(Sp,7)===nr?(i=nr,Sp+=7):(i=x,0===Ap&&Up(rr)),t=i!==x&&(n=Qf())!==x&&(r=hf())!==x?i=or(n,r):(Sp=t,x),Ap--,t===x&&(i=x,0===Ap&&Up(ir)),(e=t)===x)&&(e=function(){var e,t,i,n,r;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,6)===br?(i=br,Sp+=6):(i=x,0===Ap&&Up(wr)),i===x&&(w.substr(Sp,6)===xr?(i=xr,Sp+=6):(i=x,0===Ap&&Up(kr))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=gf())!==x?t=_r(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(yr)),e}())===x&&(e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,4)===Cr?(i=Cr,Sp+=4):(i=x,0===Ap&&Up(Er)),i===x&&(w.substr(Sp,4)===Tr?(i=Tr,Sp+=4):(i=x,0===Ap&&Up(Dr))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(40===w.charCodeAt(Sp)?(r=B,Sp++):(r=x,0===Ap&&Up(Q)),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if((s=zf())!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();if(a!==x)if(w.substr(Sp,2)===q?(l=q,Sp+=2):(l=x,0===Ap&&Up(H)),l===x&&(w.substr(Sp,2)===V?(l=V,Sp+=2):(l=x,0===Ap&&Up(z))),l!==x){for(u=[],c=pg();c!==x;)u.push(c),c=pg();if(u!==x)if((c=Vf())!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();e=d!==x?(41===w.charCodeAt(Sp)?(h=G,Sp++):(h=x,0===Ap&&Up(X)),h!==x?t=Sr(s,c):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Fr)),e}())===x&&(e=function(){var e,t,i,n,r;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(w.substr(Sp,6)===Vt?(i=Vt,Sp+=6):(i=x,0===Ap&&Up(zt)),i===x&&(w.substr(Sp,6)===qt?(i=qt,Sp+=6):(i=x,0===Ap&&Up(Ht))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=vf())!==x?t=Ir(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(jr)),e}()),Ap--,e===x&&0===Ap&&Up(Gn),e}function gf(){var e;return Ap++,(e=Jf())===x&&(e=Yf())===x&&(e=yf()),Ap--,e===x&&0===Ap&&Up(Rr),e}function vf(){var e;return Ap++,(e=function(){var e,t,i,n,r,o,s,a;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Vf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(123===w.charCodeAt(Sp)?(r=le,Sp++):(r=x,0===Ap&&Up(ue)),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x){for(s=[],a=mf();a!==x;)s.push(a),a=mf();e=s!==x?(125===w.charCodeAt(Sp)?(a=ce,Sp++):(a=x,0===Ap&&Up(de)),a!==x?t=Nr(i,s):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Or)),e}())===x&&(e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f,g;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x){if((i=hg())===x)if(i=Sp,40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){for(o=[],s=Vf();s!==x;)o.push(s),s=Vf();if(o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();i=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?n=[n,r,o,s,a]:(Sp=i,x)):(Sp=i,x)}else Sp=i,i=x}else Sp=i,i=x}else Sp=i,i=x;if(i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(123===w.charCodeAt(Sp)?(r=le,Sp++):(r=x,0===Ap&&Up(ue)),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x){for(s=[],a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(40===w.charCodeAt(Sp)?(u=B,Sp++):(u=x,0===Ap&&Up(Q)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x){for(d=[],h=mf();h!==x;)d.push(h),h=mf();if(d!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if(41===w.charCodeAt(Sp)?(p=G,Sp++):(p=x,0===Ap&&Up(X)),p!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();a=f!==x?l=[l,u,c,d,h,p,f]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x}else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x;for(a===x&&(a=hg());a!==x;){for(s.push(a),a=Sp,l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(40===w.charCodeAt(Sp)?(u=B,Sp++):(u=x,0===Ap&&Up(Q)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x){for(d=[],h=mf();h!==x;)d.push(h),h=mf();if(d!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if(41===w.charCodeAt(Sp)?(p=G,Sp++):(p=x,0===Ap&&Up(X)),p!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();a=f!==x?l=[l,u,c,d,h,p,f]:(Sp=a,x)}else Sp=a,a=x;else Sp=a,a=x}else Sp=a,a=x}else Sp=a,a=x}else Sp=a,a=x;else Sp=a,a=x;a===x&&(a=hg())}if(s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?(125===w.charCodeAt(Sp)?(l=ce,Sp++):(l=x,0===Ap&&Up(de)),l!==x?t=Mr(i,s):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Lr)),e}()),Ap--,e===x&&0===Ap&&Up(Ar),e}function mf(){var e,t,i,n,r;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=og())===x&&(i=Zf())===x&&(i=eg())===x&&(i=ig())===x&&(w.substr(Sp,5)===$t?(i=$t,Sp+=5):(i=x,0===Ap&&Up(Bt))),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?t=et(i):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Pr)),e}function yf(){var e,t,i,n;if(Ap++,e=Sp,(t=rg())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=bf())!==x?t=$r(t,n):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ur)),e}function bf(){var e,t,i,n,r,o,s,a,l,u,c,d;if(Ap++,e=Sp,(t=hg())!==x&&(t=Qr()),(e=t)===x)if(e=Sp,40===w.charCodeAt(Sp)?(t=B,Sp++):(t=x,0===Ap&&Up(Q)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,8)===A?(n=A,Sp+=8):(n=x,0===Ap&&Up(O)),n===x&&(w.substr(Sp,8)===N?(n=N,Sp+=8):(n=x,0===Ap&&Up(L))),n===x&&(n=null),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x){if(a=[],l=Sp,44===w.charCodeAt(Sp)?(u=Vr,Sp++):(u=x,0===Ap&&Up(zr)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();l=c!==x&&(d=zf())!==x?u=[u,c,d]:(Sp=l,x)}else Sp=l,l=x;for(;l!==x;)if(a.push(l),l=Sp,44===w.charCodeAt(Sp)?(u=Vr,Sp++):(u=x,0===Ap&&Up(zr)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();l=c!==x&&(d=zf())!==x?u=[u,c,d]:(Sp=l,x)}else Sp=l,l=x;e=a!==x?(41===w.charCodeAt(Sp)?(l=G,Sp++):(l=x,0===Ap&&Up(X)),l!==x?t=qr(n,o,a):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Br)),e}function wf(){var e,t,i,n,r,o,s,a,l,u;if(Ap++,e=Sp,(t=hg())!==x&&(t=Qr()),(e=t)===x)if(e=Sp,40===w.charCodeAt(Sp)?(t=B,Sp++):(t=x,0===Ap&&Up(Q)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=rg())===x&&(n=zf()),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x){if(o=[],s=Sp,44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();s=l!==x?((u=rg())===x&&(u=zf()),u!==x?a=[a,l,u]:(Sp=s,x)):(Sp=s,x)}else Sp=s,s=x;for(;s!==x;)if(o.push(s),s=Sp,44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();s=l!==x?((u=rg())===x&&(u=zf()),u!==x?a=[a,l,u]:(Sp=s,x)):(Sp=s,x)}else Sp=s,s=x;e=o!==x?(41===w.charCodeAt(Sp)?(s=G,Sp++):(s=x,0===Ap&&Up(X)),s!==x?t=Gr(n,o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Hr)),e}function xf(){var e,t,i,n,r,o;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Bf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(r=kf())!==x?t=Zr(i,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x){for(e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if((i=Pf())!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x&&(Ap++,(o=kf())===x&&(o=null),Ap--,o===x&&0===Ap&&Up(oo),(r=o)!==x)?t=eo(i,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}return Ap--,e===x&&(t=x,0===Ap&&Up(Yr)),e}function kf(){var e,t,i,n,r,o,s,a,l,u,c,d,h;if(Ap++,e=Sp,(t=Tf())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Ff())!==x){for(r=[],o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x){if(u=Sp,(c=Tf())!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();u=d!==x&&(h=Ff())!==x?c=[c,d,h]:(Sp=u,x)}else Sp=u,u=x;u===x&&(u=null),o=u!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x}else Sp=o,o=x;else Sp=o,o=x;for(;o!==x;){for(r.push(o),o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x){if(u=Sp,(c=Tf())!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();u=d!==x&&(h=Ff())!==x?c=[c,d,h]:(Sp=u,x)}else Sp=u,u=x;u===x&&(u=null),o=u!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x}else Sp=o,o=x;else Sp=o,o=x}e=r!==x?t=ro(t,n,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(no)),e}function _f(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=Cf())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){if(n=[],r=Sp,44===w.charCodeAt(Sp)?(o=Vr,Sp++):(o=x,0===Ap&&Up(zr)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();r=s!==x&&(a=Cf())!==x?o=[o,s,a]:(Sp=r,x)}else Sp=r,r=x;for(;r!==x;)if(n.push(r),r=Sp,44===w.charCodeAt(Sp)?(o=Vr,Sp++):(o=x,0===Ap&&Up(zr)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();r=s!==x&&(a=Cf())!==x?o=[o,s,a]:(Sp=r,x)}else Sp=r,r=x;e=n!==x?t=ao(t,n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(so)),e}function Ff(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=Ef())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){if(n=[],r=Sp,44===w.charCodeAt(Sp)?(o=Vr,Sp++):(o=x,0===Ap&&Up(zr)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();r=s!==x&&(a=Ef())!==x?o=[o,s,a]:(Sp=r,x)}else Sp=r,r=x;for(;r!==x;)if(n.push(r),r=Sp,44===w.charCodeAt(Sp)?(o=Vr,Sp++):(o=x,0===Ap&&Up(zr)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();r=s!==x&&(a=Ef())!==x?o=[o,s,a]:(Sp=r,x)}else Sp=r,r=x;e=n!==x?t=uo(t,n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(lo)),e}function Cf(){var e;return Ap++,e=Uf(),Ap--,e===x&&0===Ap&&Up(co),e}function Ef(){var e;return Ap++,e=$f(),Ap--,e===x&&0===Ap&&Up(ho),e}function Tf(){var e,t;return Ap++,(e=Qf())===x&&(e=Sp,97===w.charCodeAt(Sp)?(t=fo,Sp++):(t=x,0===Ap&&Up(go)),t!==x&&(t=vo()),e=t),Ap--,e===x&&(t=x,0===Ap&&Up(po)),e}function Df(){var e,t,i,n,r,o,s,a,l,u,c,d;if(Ap++,e=Sp,(t=Sf())===x&&(t=Rf()),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=_f())!==x){for(r=[],o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x?(u=Sp,(c=Sf())===x&&(c=Rf()),(u=c!==x&&(d=Ff())!==x?c=[c,d]:(Sp=u,x))===x&&(u=null),u!==x?s=[s,a,l,u]:(Sp=o,x)):(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x;for(;o!==x;){for(r.push(o),o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(59===w.charCodeAt(Sp)?(a=Kt,Sp++):(a=x,0===Ap&&Up(Jt)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x?(u=Sp,(c=Sf())===x&&(c=Rf()),(u=c!==x&&(d=Ff())!==x?c=[c,d]:(Sp=u,x))===x&&(u=null),u!==x?s=[s,a,l,u]:(Sp=o,x)):(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x}e=r!==x?t=xo(t,n,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(wo)),e}function Sf(){var e,t;return Ap++,e=Sp,(t=jf())!==x&&(t=Fo(t)),Ap--,(e=t)===x&&(t=x,0===Ap&&Up(_o)),e}function Rf(){var e;return Ap++,e=Vf(),Ap--,e===x&&0===Ap&&Up(Co),e}function jf(){var e;return Ap++,e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,(t=If())!==x){for(i=[],n=Sp,124===w.charCodeAt(Sp)?(r=Do,Sp++):(r=x,0===Ap&&Up(So)),n=r!==x&&(o=If())!==x?r=[r,o]:(Sp=n,x);n!==x;)i.push(n),n=Sp,124===w.charCodeAt(Sp)?(r=Do,Sp++):(r=x,0===Ap&&Up(So)),n=r!==x&&(o=If())!==x?r=[r,o]:(Sp=n,x);e=i!==x?t=Ro(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(To)),e}(),Ap--,e===x&&0===Ap&&Up(Eo),e}function If(){var e,t,i,n,r,o;if(Ap++,e=Sp,(t=Of())!==x){for(i=[],n=Sp,47===w.charCodeAt(Sp)?(r=Io,Sp++):(r=x,0===Ap&&Up(Ao)),n=r!==x&&(o=Of())!==x?r=[r,o]:(Sp=n,x);n!==x;)i.push(n),n=Sp,47===w.charCodeAt(Sp)?(r=Io,Sp++):(r=x,0===Ap&&Up(Ao)),n=r!==x&&(o=Of())!==x?r=[r,o]:(Sp=n,x);e=i!==x?t=Oo(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(jo)),e}function Af(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f,g;return Ap++,e=Sp,Ap++,(h=rg())===x&&(h=Sp,97===w.charCodeAt(Sp)?(p=fo,Sp++):(p=x,0===Ap&&Up(go)),p!==x&&(p=vo()),(h=p)===x&&(h=Sp,33===w.charCodeAt(Sp)?(p=Go,Sp++):(p=x,0===Ap&&Up(Xo)),(h=p!==x&&(f=function(){var e,t,i,n,r,o,s,a;if((e=Nf())===x)if(e=Sp,40===w.charCodeAt(Sp)?(t=B,Sp++):(t=x,0===Ap&&Up(Q)),t!==x){if(i=Sp,(n=Nf())!==x){for(r=[],o=Sp,124===w.charCodeAt(Sp)?(s=Do,Sp++):(s=x,0===Ap&&Up(So)),o=s!==x&&(a=Nf())!==x?s=[s,a]:(Sp=o,x);o!==x;)r.push(o),o=Sp,124===w.charCodeAt(Sp)?(s=Do,Sp++):(s=x,0===Ap&&Up(So)),o=s!==x&&(a=Nf())!==x?s=[s,a]:(Sp=o,x);i=r!==x?n=[n,r]:(Sp=i,x)}else Sp=i,i=x;i===x&&(i=null),e=i!==x?(41===w.charCodeAt(Sp)?(n=G,Sp++):(n=x,0===Ap&&Up(X)),n!==x?t=[t,i,n]:(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return e}())!==x?p=[p,f]:(Sp=h,x))===x&&(h=Sp,40===w.charCodeAt(Sp)?(p=B,Sp++):(p=x,0===Ap&&Up(Q)),h=p!==x&&(f=jf())!==x?(41===w.charCodeAt(Sp)?(g=G,Sp++):(g=x,0===Ap&&Up(X)),g!==x?p=Qn(f):(Sp=h,x)):(Sp=h,x)))),Ap--,h===x&&(p=x,0===Ap&&Up(Ho)),e=(t=h)!==x?(Ap++,42===w.charCodeAt(Sp)?(n=W,Sp++):(n=x,0===Ap&&Up(K)),n===x&&(63===w.charCodeAt(Sp)?(n=Qo,Sp++):(n=x,0===Ap&&Up(Vo)),n===x&&(43===w.charCodeAt(Sp)?(n=zo,Sp++):(n=x,0===Ap&&Up(qo)),n===x&&(n=Sp,123===w.charCodeAt(Sp)?(r=le,Sp++):(r=x,0===Ap&&Up(ue)),n=r!==x?(o=Sp,s=Lf(),(o=s!==x?(a=Sp,44===w.charCodeAt(Sp)?(l=Vr,Sp++):(l=x,0===Ap&&Up(zr)),(a=l!==x?(125===w.charCodeAt(Sp)?(u=ce,Sp++):(u=x,0===Ap&&Up(de)),u===x&&(u=Sp,c=Lf(),u=c!==x?(125===w.charCodeAt(Sp)?(d=ce,Sp++):(d=x,0===Ap&&Up(de)),d!==x?c=[c,d]:(Sp=u,x)):(Sp=u,x)),u!==x?l=[l,u]:(Sp=a,x)):(Sp=a,x))===x&&(125===w.charCodeAt(Sp)?(a=ce,Sp++):(a=x,0===Ap&&Up(de))),a!==x?s=[s,a]:(Sp=o,x)):(Sp=o,x))===x&&(o=Sp,44===w.charCodeAt(Sp)?(s=Vr,Sp++):(s=x,0===Ap&&Up(zr)),o=s!==x&&(a=Lf())!==x?(125===w.charCodeAt(Sp)?(l=ce,Sp++):(l=x,0===Ap&&Up(de)),l!==x?s=[s,a,l]:(Sp=o,x)):(Sp=o,x)),o!==x?r=[r,o]:(Sp=n,x)):(Sp=n,x)))),Ap--,n===x&&(r=x,0===Ap&&Up(Bo)),(i=n)===x&&(i=null),i!==x?t=Lo(t,i):(Sp=e,x)):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(No)),e}function Of(){var e,t,i;return Ap++,(e=Af())===x&&(e=Sp,94===w.charCodeAt(Sp)?(t=Po,Sp++):(t=x,0===Ap&&Up(Uo)),e=t!==x&&(i=Af())!==x?t=$o(i):(Sp=e,x)),Ap--,e===x&&(t=x,0===Ap&&Up(Mo)),e}function Nf(){var e,t,i;return Ap++,(e=rg())===x&&(97===w.charCodeAt(Sp)?(e=fo,Sp++):(e=x,0===Ap&&Up(go)),e===x&&(e=Sp,94===w.charCodeAt(Sp)?(t=Po,Sp++):(t=x,0===Ap&&Up(Uo)),e=t!==x?((i=rg())===x&&(97===w.charCodeAt(Sp)?(i=fo,Sp++):(i=x,0===Ap&&Up(go))),i!==x?t=[t,i]:(Sp=e,x)):(Sp=e,x))),Ap--,e===x&&(t=x,0===Ap&&Up(Wo)),e}function Lf(){var e;return Ap++,e=ag(),Ap--,e===x&&0===Ap&&Up(Ko),e}function Mf(){var e,t;return Ap++,e=Sp,(t=function(){var e,t,i,n,r,o,s,a,l;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(40===w.charCodeAt(Sp)?(i=B,Sp++):(i=x,0===Ap&&Up(Q)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x){if(r=[],(o=Uf())!==x)for(;o!==x;)r.push(o),o=Uf();else r=x;if(r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(41===w.charCodeAt(Sp)?(s=G,Sp++):(s=x,0===Ap&&Up(X)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?t=cs(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(us)),e}())!==x&&(t=Yo(t)),(e=t)===x&&(e=function(){var e,t,i,n,r,o,s,a;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(91===w.charCodeAt(Sp)?(i=is,Sp++):(i=x,0===Ap&&Up(ns)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=Df())!==x)if(93===w.charCodeAt(Sp)?(o=rs,Sp++):(o=x,0===Ap&&Up(os)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?t=ss(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ts)),e}()),Ap--,e===x&&(t=x,0===Ap&&Up(Jo)),e}function Pf(){var e,t;return Ap++,e=Sp,(t=function(){var e,t,i,n,r,o,s,a,l;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(40===w.charCodeAt(Sp)?(i=B,Sp++):(i=x,0===Ap&&Up(Q)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x){if(r=[],(o=$f())!==x)for(;o!==x;)r.push(o),o=$f();else r=x;if(r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(41===w.charCodeAt(Sp)?(s=G,Sp++):(s=x,0===Ap&&Up(X)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?t=cs(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ds)),e}())!==x&&(t=es(t)),(e=t)===x&&(e=function(){var e,t,i,n,r,o,s,a,l;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(91===w.charCodeAt(Sp)?(i=is,Sp++):(i=x,0===Ap&&Up(ns)),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if((r=kf())!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if(93===w.charCodeAt(Sp)?(s=rs,Sp++):(s=x,0===Ap&&Up(os)),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();e=a!==x?t=ls(r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(as)),e}()),Ap--,e===x&&(t=x,0===Ap&&Up(Zo)),e}function Uf(){var e,t,i,n,r,o;for(Ap++,t=e=Sp,i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Bf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();t=r!==x?i=[i,n,r]:(Sp=t,x)}else Sp=t,t=x;else Sp=t,t=x;if(t===x){for(t=Sp,i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Mf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();t=r!==x?i=[i,n,r]:(Sp=t,x)}else Sp=t,t=x;else Sp=t,t=x}return t!==x&&(t=ps(t)),Ap--,(e=t)===x&&(t=x,0===Ap&&Up(hs)),e}function $f(){var e,t,i,n,r,o;for(Ap++,t=e=Sp,i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Bf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();t=r!==x?i=[i,n,r]:(Sp=t,x)}else Sp=t,t=x;else Sp=t,t=x;if(t===x){for(t=Sp,i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=Pf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();t=r!==x?i=[i,n,r]:(Sp=t,x)}else Sp=t,t=x;else Sp=t,t=x}return t!==x&&(t=ps(t)),Ap--,(e=t)===x&&(t=x,0===Ap&&Up(fs)),e}function Bf(){var e,t,i,n,r,o,s;return Ap++,(e=Vf())===x&&(Ap++,(t=rg())===x&&(t=Zf())===x&&(t=eg())===x&&(t=ig())===x&&(Ap++,Ap++,r=i=Sp,w.substr(Sp,2)===qc?(o=qc,Sp+=2):(o=x,0===Ap&&Up(Hc)),r=o!==x&&(s=yg())!==x?o=Gc(s):(Sp=r,x),Ap--,r===x&&(o=x,0===Ap&&Up(zc)),(n=r)!==x&&(n=Ac(n)),(i=n)===x&&(i=Sp,(n=function(){var e,t,i,n;if(Ap++,e=Sp,91===w.charCodeAt(Sp)?(t=is,Sp++):(t=x,0===Ap&&Up(ns)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x?(93===w.charCodeAt(Sp)?(n=rs,Sp++):(n=x,0===Ap&&Up(os)),n!==x?t=[t,i,n]:(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(xh)),e}())!==x&&(n=Oc()),i=n),Ap--,i===x&&(n=x,0===Ap&&Up(Ic)),(t=i)===x)&&(t=hg()),Ap--,t===x&&0===Ap&&Up(bs),e=t),Ap--,e===x&&0===Ap&&Up(gs),e}function Qf(){var e;return Ap++,(e=Vf())===x&&(e=rg()),Ap--,e===x&&0===Ap&&Up(vs),e}function Vf(){var e,t,i,n,r,o,s,a,l,u,c;for(Ap++,e=Sp,t=[],i=pg();i!==x;)t.push(i),i=pg();if(t!==x)if(Ap++,l=Sp,63===w.charCodeAt(Sp)?(u=Qo,Sp++):(u=x,0===Ap&&Up(Vo)),l=u!==x&&(c=vg())!==x?u=Wc(c):(Sp=l,x),Ap--,l===x&&(u=x,0===Ap&&Up(Xc)),(i=l)===x&&(Ap++,o=Sp,36===w.charCodeAt(Sp)?(s=Jc,Sp++):(s=x,0===Ap&&Up(Yc)),o=s!==x&&(a=vg())!==x?s=Wc(a):(Sp=o,x),Ap--,o===x&&(s=x,0===Ap&&Up(Kc)),i=o),i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();e=n!==x?t=ys(i):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ms)),e}function zf(){var e;return Ap++,e=function(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=qf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===ks?(o=ks,Sp+=2):(o=x,0===Ap&&Up(_s)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=qf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===ks?(o=ks,Sp+=2):(o=x,0===Ap&&Up(_s)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=qf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}e=i!==x?t=Fs(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(xs)),e}(),Ap--,e===x&&0===Ap&&Up(ws),e}function qf(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=Hf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Es?(o=Es,Sp+=2):(o=x,0===Ap&&Up(Ts)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Hf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Es?(o=Es,Sp+=2):(o=x,0===Ap&&Up(Ts)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Hf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}e=i!==x?t=Ds(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Cs)),e}function Hf(){var e;return Ap++,e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h;if(Ap++,e=Sp,(t=Gf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(61===w.charCodeAt(Sp)?(o=js,Sp++):(o=x,0===Ap&&Up(Is)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===As?(o=As,Sp+=2):(o=x,0===Ap&&Up(Os)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(60===w.charCodeAt(Sp)?(o=Ns,Sp++):(o=x,0===Ap&&Up(Ls)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(62===w.charCodeAt(Sp)?(o=Ms,Sp++):(o=x,0===Ap&&Up(Ps)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Us?(o=Us,Sp+=2):(o=x,0===Ap&&Up($s)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Bs?(o=Bs,Sp+=2):(o=x,0===Ap&&Up(Qs)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(73===w.charCodeAt(Sp)?(o=Vs,Sp++):(o=x,0===Ap&&Up(zs)),o===x&&(105===w.charCodeAt(Sp)?(o=qs,Sp++):(o=x,0===Ap&&Up(Hs))),o!==x)if(78===w.charCodeAt(Sp)?(s=Gs,Sp++):(s=x,0===Ap&&Up(Xs)),s===x&&(110===w.charCodeAt(Sp)?(s=Ws,Sp++):(s=x,0===Ap&&Up(Ks))),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();n=a!==x&&(l=wf())!==x?r=[r,o,s,a,l]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(78===w.charCodeAt(Sp)?(o=Gs,Sp++):(o=x,0===Ap&&Up(Xs)),o===x&&(110===w.charCodeAt(Sp)?(o=Ws,Sp++):(o=x,0===Ap&&Up(Ks))),o!==x)if(79===w.charCodeAt(Sp)?(s=Js,Sp++):(s=x,0===Ap&&Up(Ys)),s===x&&(111===w.charCodeAt(Sp)?(s=Zs,Sp++):(s=x,0===Ap&&Up(ea))),s!==x)if(84===w.charCodeAt(Sp)?(a=ta,Sp++):(a=x,0===Ap&&Up(ia)),a===x&&(116===w.charCodeAt(Sp)?(a=na,Sp++):(a=x,0===Ap&&Up(ra))),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(73===w.charCodeAt(Sp)?(u=Vs,Sp++):(u=x,0===Ap&&Up(zs)),u===x&&(105===w.charCodeAt(Sp)?(u=qs,Sp++):(u=x,0===Ap&&Up(Hs))),u!==x)if(78===w.charCodeAt(Sp)?(c=Gs,Sp++):(c=x,0===Ap&&Up(Xs)),c===x&&(110===w.charCodeAt(Sp)?(c=Ws,Sp++):(c=x,0===Ap&&Up(Ks))),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();n=d!==x&&(h=wf())!==x?r=[r,o,s,a,l,u,c,d,h]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x}}}}}}}for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(61===w.charCodeAt(Sp)?(o=js,Sp++):(o=x,0===Ap&&Up(Is)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===As?(o=As,Sp+=2):(o=x,0===Ap&&Up(Os)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(60===w.charCodeAt(Sp)?(o=Ns,Sp++):(o=x,0===Ap&&Up(Ls)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(62===w.charCodeAt(Sp)?(o=Ms,Sp++):(o=x,0===Ap&&Up(Ps)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Us?(o=Us,Sp+=2):(o=x,0===Ap&&Up($s)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,2)===Bs?(o=Bs,Sp+=2):(o=x,0===Ap&&Up(Qs)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Gf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(73===w.charCodeAt(Sp)?(o=Vs,Sp++):(o=x,0===Ap&&Up(zs)),o===x&&(105===w.charCodeAt(Sp)?(o=qs,Sp++):(o=x,0===Ap&&Up(Hs))),o!==x)if(78===w.charCodeAt(Sp)?(s=Gs,Sp++):(s=x,0===Ap&&Up(Xs)),s===x&&(110===w.charCodeAt(Sp)?(s=Ws,Sp++):(s=x,0===Ap&&Up(Ks))),s!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();n=a!==x&&(l=wf())!==x?r=[r,o,s,a,l]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(78===w.charCodeAt(Sp)?(o=Gs,Sp++):(o=x,0===Ap&&Up(Xs)),o===x&&(110===w.charCodeAt(Sp)?(o=Ws,Sp++):(o=x,0===Ap&&Up(Ks))),o!==x)if(79===w.charCodeAt(Sp)?(s=Js,Sp++):(s=x,0===Ap&&Up(Ys)),s===x&&(111===w.charCodeAt(Sp)?(s=Zs,Sp++):(s=x,0===Ap&&Up(ea))),s!==x)if(84===w.charCodeAt(Sp)?(a=ta,Sp++):(a=x,0===Ap&&Up(ia)),a===x&&(116===w.charCodeAt(Sp)?(a=na,Sp++):(a=x,0===Ap&&Up(ra))),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(73===w.charCodeAt(Sp)?(u=Vs,Sp++):(u=x,0===Ap&&Up(zs)),u===x&&(105===w.charCodeAt(Sp)?(u=qs,Sp++):(u=x,0===Ap&&Up(Hs))),u!==x)if(78===w.charCodeAt(Sp)?(c=Gs,Sp++):(c=x,0===Ap&&Up(Xs)),c===x&&(110===w.charCodeAt(Sp)?(c=Ws,Sp++):(c=x,0===Ap&&Up(Ks))),c!==x){for(d=[],h=pg();h!==x;)d.push(h),h=pg();n=d!==x&&(h=wf())!==x?r=[r,o,s,a,l,u,c,d,h]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x}else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x;else Sp=n,n=x}}}}}}}}e=i!==x?t=oa(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Rs)),e}(),Ap--,e===x&&0===Ap&&Up(Ss),e}function Gf(){var e;return Ap++,e=function(){var e,t,i,n,r,o,s,a,l,u;if(Ap++,e=Sp,(t=Xf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(43===w.charCodeAt(Sp)?(o=zo,Sp++):(o=x,0===Ap&&Up(qo)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Xf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(45===w.charCodeAt(Sp)?(o=la,Sp++):(o=x,0===Ap&&Up(ua)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Xf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x)if(n=Sp,(r=tg())===x&&(r=tg()),r!==x){for(o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(42===w.charCodeAt(Sp)?(a=W,Sp++):(a=x,0===Ap&&Up(K)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x&&(u=Wf())!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x;if(o===x){for(o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(47===w.charCodeAt(Sp)?(a=Io,Sp++):(a=x,0===Ap&&Up(Ao)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x&&(u=Wf())!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x}o===x&&(o=null),n=o!==x?r=[r,o]:(Sp=n,x)}else Sp=n,n=x}for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(43===w.charCodeAt(Sp)?(o=zo,Sp++):(o=x,0===Ap&&Up(qo)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Xf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(45===w.charCodeAt(Sp)?(o=la,Sp++):(o=x,0===Ap&&Up(ua)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Xf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x)if(n=Sp,(r=tg())===x&&(r=tg()),r!==x){for(o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(42===w.charCodeAt(Sp)?(a=W,Sp++):(a=x,0===Ap&&Up(K)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x&&(u=Wf())!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x;if(o===x){for(o=Sp,s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(47===w.charCodeAt(Sp)?(a=Io,Sp++):(a=x,0===Ap&&Up(Ao)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();o=l!==x&&(u=Wf())!==x?s=[s,a,l,u]:(Sp=o,x)}else Sp=o,o=x;else Sp=o,o=x}o===x&&(o=null),n=o!==x?r=[r,o]:(Sp=n,x)}else Sp=n,n=x}}e=i!==x?t=ca(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(aa)),e}(),Ap--,e===x&&0===Ap&&Up(sa),e}function Xf(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,(t=Wf())!==x){for(i=[],n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(42===w.charCodeAt(Sp)?(o=W,Sp++):(o=x,0===Ap&&Up(K)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Wf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(47===w.charCodeAt(Sp)?(o=Io,Sp++):(o=x,0===Ap&&Up(Ao)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Wf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}for(;n!==x;){for(i.push(n),n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(42===w.charCodeAt(Sp)?(o=W,Sp++):(o=x,0===Ap&&Up(K)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Wf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x;if(n===x){for(n=Sp,r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(47===w.charCodeAt(Sp)?(o=Io,Sp++):(o=x,0===Ap&&Up(Ao)),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();n=s!==x&&(a=Wf())!==x?r=[r,o,s,a]:(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}}e=i!==x?t=ha(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(da)),e}function Wf(){var e,t,i,n;if(Ap++,e=Sp,33===w.charCodeAt(Sp)?(t=Go,Sp++):(t=x,0===Ap&&Up(Xo)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=Kf())!==x?t=fa(n):(Sp=e,x)}else Sp=e,e=x;if(e===x){if(e=Sp,43===w.charCodeAt(Sp)?(t=zo,Sp++):(t=x,0===Ap&&Up(qo)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=Kf())!==x?t=ga(n):(Sp=e,x)}else Sp=e,e=x;if(e===x){if(e=Sp,45===w.charCodeAt(Sp)?(t=la,Sp++):(t=x,0===Ap&&Up(ua)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=Kf())!==x?t=va(n):(Sp=e,x)}else Sp=e,e=x;e===x&&(e=Kf())}}return Ap--,e===x&&(t=x,0===Ap&&Up(pa)),e}function Kf(){var e,t;return Ap++,(e=Jf())===x&&(e=Yf())===x&&(e=function(){var e,t,i,n;if(Ap++,e=Sp,(t=rg())!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x?((n=bf())===x&&(n=null),n!==x?t=rc(t,n):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(nc)),e}())===x&&(e=Sp,(t=Zf())!==x&&(t=ya(t)),(e=t)===x&&(e=Sp,(t=eg())!==x&&(t=ba(t)),(e=t)===x&&(e=Sp,(t=ig())!==x&&(t=wa(t)),(e=t)===x&&(e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f,g,v,m;if(Ap++,e=Sp,w.substr(Sp,5)===Cu?(t=Cu,Sp+=5):(t=x,0===Ap&&Up(Eu)),t===x&&(w.substr(Sp,5)===Tu?(t=Tu,Sp+=5):(t=x,0===Ap&&Up(Du))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(42===w.charCodeAt(Sp)?(a=W,Sp++):(a=x,0===Ap&&Up(K)),a===x&&(a=zf()),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=Su(o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,12)===Ru?(t=Ru,Sp+=12):(t=x,0===Ap&&Up(ju)),t===x&&(w.substr(Sp,12)===Iu?(t=Iu,Sp+=12):(t=x,0===Ap&&Up(Au))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){if(l=Sp,59===w.charCodeAt(Sp)?(u=Kt,Sp++):(u=x,0===Ap&&Up(Jt)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x)if(w.substr(Sp,9)===Ou?(d=Ou,Sp+=9):(d=x,0===Ap&&Up(Nu)),d!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if(61===w.charCodeAt(Sp)?(p=js,Sp++):(p=x,0===Ap&&Up(Is)),p!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();if(f!==x)if((g=ng())!==x){for(v=[],m=pg();m!==x;)v.push(m),m=pg();l=v!==x?u=[u,c,d,h,p,f,g,v]:(Sp=l,x)}else Sp=l,l=x;else Sp=l,l=x}else Sp=l,l=x;else Sp=l,l=x}else Sp=l,l=x;else Sp=l,l=x}else Sp=l,l=x;if(l===x&&(l=null),l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=Lu(o,a,l):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,3)===Mu?(t=Mu,Sp+=3):(t=x,0===Ap&&Up(Pu)),t===x&&(w.substr(Sp,3)===Uu?(t=Uu,Sp+=3):(t=x,0===Ap&&Up($u))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=Bu(o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,3)===Qu?(t=Qu,Sp+=3):(t=x,0===Ap&&Up(Vu)),t===x&&(w.substr(Sp,3)===zu?(t=zu,Sp+=3):(t=x,0===Ap&&Up(qu))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=Hu(o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,3)===Gu?(t=Gu,Sp+=3):(t=x,0===Ap&&Up(Xu)),t===x&&(w.substr(Sp,3)===Wu?(t=Wu,Sp+=3):(t=x,0===Ap&&Up(Ku))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=Ju(o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x)if(e=Sp,w.substr(Sp,3)===Yu?(t=Yu,Sp+=3):(t=x,0===Ap&&Up(Zu)),t===x&&(w.substr(Sp,3)===ec?(t=ec,Sp+=3):(t=x,0===Ap&&Up(tc))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if(w.substr(Sp,8)===A?(o=A,Sp+=8):(o=x,0===Ap&&Up(O)),o===x&&(w.substr(Sp,8)===N?(o=N,Sp+=8):(o=x,0===Ap&&Up(L))),o===x&&(o=null),o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?t=ic(o,a):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}}}}return Ap--,e===x&&(t=x,0===Ap&&Up(Fu)),e}())===x&&(e=Sp,(t=Vf())!==x&&(t=xa(t)),e=t)))),Ap--,e===x&&(t=x,0===Ap&&Up(ma)),e}function Jf(){var e,t,i,n,r,o;if(Ap++,e=Sp,40===w.charCodeAt(Sp)?(t=B,Sp++):(t=x,0===Ap&&Up(Q)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if((n=zf())!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x?(41===w.charCodeAt(Sp)?(o=G,Sp++):(o=x,0===Ap&&Up(X)),o!==x?t=_a(n):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ka)),e}function Yf(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f,g;if(Ap++,e=Sp,w.substr(Sp,3)===Ca?(t=Ca,Sp+=3):(t=x,0===Ap&&Up(Ea)),t===x&&(w.substr(Sp,3)===Ta?(t=Ta,Sp+=3):(t=x,0===Ap&&Up(Da))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Sa(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,4)===Ra?(t=Ra,Sp+=4):(t=x,0===Ap&&Up(ja)),t===x&&(w.substr(Sp,4)===Ia?(t=Ia,Sp+=4):(t=x,0===Ap&&Up(Aa))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Oa(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,11)===Na?(t=Na,Sp+=11):(t=x,0===Ap&&Up(La)),t===x&&(w.substr(Sp,11)===Ma?(t=Ma,Sp+=11):(t=x,0===Ap&&Up(Pa))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=zf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?(41===w.charCodeAt(Sp)?(d=G,Sp++):(d=x,0===Ap&&Up(X)),d!==x?t=Ua(o,u):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,8)===$a?(t=$a,Sp+=8):(t=x,0===Ap&&Up(Ba)),t===x&&(w.substr(Sp,8)===Qa?(t=Qa,Sp+=8):(t=x,0===Ap&&Up(Va))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=za(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,5)===qa?(t=qa,Sp+=5):(t=x,0===Ap&&Up(Ha)),t===x&&(w.substr(Sp,5)===Ga?(t=Ga,Sp+=5):(t=x,0===Ap&&Up(Xa))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=Vf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Wa(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,3)===Ka?(t=Ka,Sp+=3):(t=x,0===Ap&&Up(Ja)),t===x&&(w.substr(Sp,3)===Ya?(t=Ya,Sp+=3):(t=x,0===Ap&&Up(Za))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=el(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,3)===tl?(t=tl,Sp+=3):(t=x,0===Ap&&Up(il)),t===x&&(w.substr(Sp,3)===nl?(t=nl,Sp+=3):(t=x,0===Ap&&Up(rl))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=ol(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,5)===sl?(t=sl,Sp+=5):(t=x,0===Ap&&Up(al)),t===x&&(w.substr(Sp,5)===ll?(t=ll,Sp+=5):(t=x,0===Ap&&Up(ul))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x){if(n=Sp,40===w.charCodeAt(Sp)?(r=B,Sp++):(r=x,0===Ap&&Up(Q)),r!==x){for(o=[],s=pg();s!==x;)o.push(s),s=pg();if(o!==x)if((s=zf())!==x){for(a=[],l=pg();l!==x;)a.push(l),l=pg();n=a!==x?(41===w.charCodeAt(Sp)?(l=G,Sp++):(l=x,0===Ap&&Up(X)),l!==x?r=[r,o,s,a,l]:(Sp=n,x)):(Sp=n,x)}else Sp=n,n=x;else Sp=n,n=x}else Sp=n,n=x;n===x&&(n=hg()),e=n!==x?t=cl(n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,8)===dl?(t=dl,Sp+=8):(t=x,0===Ap&&Up(hl)),t===x&&(w.substr(Sp,8)===pl?(t=pl,Sp+=8):(t=x,0===Ap&&Up(fl))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=wf())!==x?t=gl(n):(Sp=e,x)}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,2)===vl?(t=vl,Sp+=2):(t=x,0===Ap&&Up(ml)),t===x&&(w.substr(Sp,2)===yl?(t=yl,Sp+=2):(t=x,0===Ap&&Up(bl))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=zf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x)if(44===w.charCodeAt(Sp)?(d=Vr,Sp++):(d=x,0===Ap&&Up(zr)),d!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();if(h!==x)if((p=zf())!==x){for(f=[],g=pg();g!==x;)f.push(g),g=pg();e=f!==x?(41===w.charCodeAt(Sp)?(g=G,Sp++):(g=x,0===Ap&&Up(X)),g!==x?t=wl(o,u,p):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,9)===xl?(t=xl,Sp+=9):(t=x,0===Ap&&Up(kl)),t===x&&(w.substr(Sp,9)===_l?(t=_l,Sp+=9):(t=x,0===Ap&&Up(Fl)),t===x&&(w.substr(Sp,9)===Cl?(t=Cl,Sp+=9):(t=x,0===Ap&&Up(El)))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Tl(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,7)===Dl?(t=Dl,Sp+=7):(t=x,0===Ap&&Up(Sl)),t===x&&(w.substr(Sp,7)===Rl?(t=Rl,Sp+=7):(t=x,0===Ap&&Up(jl)),t===x&&(w.substr(Sp,7)===Il?(t=Il,Sp+=7):(t=x,0===Ap&&Up(Al)))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Ol(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,8)===Nl?(t=Nl,Sp+=8):(t=x,0===Ap&&Up(Ll)),t===x&&(w.substr(Sp,8)===Ml?(t=Ml,Sp+=8):(t=x,0===Ap&&Up(Pl))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=zf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();e=c!==x?(41===w.charCodeAt(Sp)?(d=G,Sp++):(d=x,0===Ap&&Up(X)),d!==x?t=Ul(o,u):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,5)===$l?(t=$l,Sp+=5):(t=x,0===Ap&&Up(Bl)),t===x&&(w.substr(Sp,5)===Ql?(t=Ql,Sp+=5):(t=x,0===Ap&&Up(Vl)),t===x&&(w.substr(Sp,5)===zl?(t=zl,Sp+=5):(t=x,0===Ap&&Up(ql)),t===x&&(w.substr(Sp,5)===Hl?(t=Hl,Sp+=5):(t=x,0===Ap&&Up(Gl)),t===x&&(w.substr(Sp,5)===Xl?(t=Xl,Sp+=5):(t=x,0===Ap&&Up(Wl)),t===x&&(w.substr(Sp,5)===Kl?(t=Kl,Sp+=5):(t=x,0===Ap&&Up(Jl))))))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();e=s!==x?(41===w.charCodeAt(Sp)?(a=G,Sp++):(a=x,0===Ap&&Up(X)),a!==x?t=Yl(o):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;if(e===x){if(e=Sp,w.substr(Sp,7)===Zl?(t=Zl,Sp+=7):(t=x,0===Ap&&Up(eu)),t===x&&(w.substr(Sp,7)===tu?(t=tu,Sp+=7):(t=x,0===Ap&&Up(iu))),t!==x){if(i=[],nu.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ru)),n!==x)for(;n!==x;)i.push(n),nu.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ru));else i=x;if(i!==x){for(n=[],r=pg();r!==x;)n.push(r),r=pg();if(n!==x)if(40===w.charCodeAt(Sp)?(r=B,Sp++):(r=x,0===Ap&&Up(Q)),r!==x){for(o=[],s=Sp,a=[],l=pg();l!==x;)a.push(l),l=pg();for(s=a!==x&&(l=zf())!==x?(44===w.charCodeAt(Sp)?(u=Vr,Sp++):(u=x,0===Ap&&Up(zr)),u!==x?a=[a,l,u]:(Sp=s,x)):(Sp=s,x);s!==x;){for(o.push(s),s=Sp,a=[],l=pg();l!==x;)a.push(l),l=pg();s=a!==x&&(l=zf())!==x?(44===w.charCodeAt(Sp)?(u=Vr,Sp++):(u=x,0===Ap&&Up(zr)),u!==x?a=[a,l,u]:(Sp=s,x)):(Sp=s,x)}if(o!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if((a=zf())!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();e=l!==x?(41===w.charCodeAt(Sp)?(u=G,Sp++):(u=x,0===Ap&&Up(X)),u!==x?t=ou(i,o,a):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;e===x&&(e=function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f;if(Ap++,e=Sp,w.substr(Sp,5)===au?(t=au,Sp+=5):(t=x,0===Ap&&Up(lu)),t===x&&(w.substr(Sp,5)===uu?(t=uu,Sp+=5):(t=x,0===Ap&&Up(cu))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();if(r!==x)if((o=zf())!==x){for(s=[],a=pg();a!==x;)s.push(a),a=pg();if(s!==x)if(44===w.charCodeAt(Sp)?(a=Vr,Sp++):(a=x,0===Ap&&Up(zr)),a!==x){for(l=[],u=pg();u!==x;)l.push(u),u=pg();if(l!==x)if((u=zf())!==x){for(c=[],d=pg();d!==x;)c.push(d),d=pg();if(c!==x){if(d=Sp,44===w.charCodeAt(Sp)?(h=Vr,Sp++):(h=x,0===Ap&&Up(zr)),h!==x){for(p=[],f=pg();f!==x;)p.push(f),f=pg();d=p!==x&&(f=zf())!==x?h=[h,p,f]:(Sp=d,x)}else Sp=d,d=x;if(d===x&&(d=null),d!==x){for(h=[],p=pg();p!==x;)h.push(p),p=pg();e=h!==x?(41===w.charCodeAt(Sp)?(p=G,Sp++):(p=x,0===Ap&&Up(X)),p!==x?t=du(o,u,d):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(su)),e}())===x&&(e=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,6)===pu?(t=pu,Sp+=6):(t=x,0===Ap&&Up(fu)),t===x&&(w.substr(Sp,6)===gu?(t=gu,Sp+=6):(t=x,0===Ap&&Up(vu))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x&&(n=hf())!==x?t=mu(n):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(hu)),e}())===x&&(e=function(){var e,t,i,n,r,o;if(Ap++,e=Sp,w.substr(Sp,3)===bu?(t=bu,Sp+=3):(t=x,0===Ap&&Up(wu)),t===x&&(w.substr(Sp,3)===xu?(t=xu,Sp+=3):(t=x,0===Ap&&Up(ku))),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();if(i!==x)if(w.substr(Sp,6)===pu?(n=pu,Sp+=6):(n=x,0===Ap&&Up(fu)),n===x&&(w.substr(Sp,6)===gu?(n=gu,Sp+=6):(n=x,0===Ap&&Up(vu))),n!==x){for(r=[],o=pg();o!==x;)r.push(o),o=pg();e=r!==x&&(o=hf())!==x?t=_u(o):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(yu)),e}())}}}}}}}}}}}}}}return Ap--,e===x&&(t=x,0===Ap&&Up(Fa)),e}function Zf(){var e,t,i,n,r;return Ap++,e=Sp,e=(t=ng())!==x?((i=function(){var e,t,i,n,r,o,s,a;if(Ap++,e=Sp,64===w.charCodeAt(Sp)?(t=ed,Sp++):(t=x,0===Ap&&Up(td)),t!==x){if(i=[],id.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(nd)),n!==x)for(;n!==x;)i.push(n),id.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(nd));else i=x;if(i!==x){if(n=[],r=Sp,45===w.charCodeAt(Sp)?(o=la,Sp++):(o=x,0===Ap&&Up(ua)),o!==x){if(s=[],rd.test(w.charAt(Sp))?(a=w.charAt(Sp),Sp++):(a=x,0===Ap&&Up(od)),a!==x)for(;a!==x;)s.push(a),rd.test(w.charAt(Sp))?(a=w.charAt(Sp),Sp++):(a=x,0===Ap&&Up(od));else s=x;r=s!==x?o=[o,s]:(Sp=r,x)}else Sp=r,r=x;for(;r!==x;)if(n.push(r),r=Sp,45===w.charCodeAt(Sp)?(o=la,Sp++):(o=x,0===Ap&&Up(ua)),o!==x){if(s=[],rd.test(w.charAt(Sp))?(a=w.charAt(Sp),Sp++):(a=x,0===Ap&&Up(od)),a!==x)for(;a!==x;)s.push(a),rd.test(w.charAt(Sp))?(a=w.charAt(Sp),Sp++):(a=x,0===Ap&&Up(od));else s=x;r=s!==x?o=[o,s]:(Sp=r,x)}else Sp=r,r=x;e=n!==x?t=sd(i,n):(Sp=e,x)}else Sp=e,e=x}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Zc)),e}())===x&&(i=Sp,w.substr(Sp,2)===sc?(n=sc,Sp+=2):(n=x,0===Ap&&Up(ac)),i=n!==x&&(r=rg())!==x?n=[n,r]:(Sp=i,x)),i===x&&(i=null),i!==x?t=lc(t,i):(Sp=e,x)):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(oc)),e}function eg(){var e,t,i,n,r,o,s,a,l,u,c,d;return Ap++,Ap++,(d=ug())===x&&(d=lg())===x&&(d=ag()),Ap--,d===x&&0===Ap&&Up(cc),(e=d)===x&&(Ap++,Ap++,l=Sp,43===w.charCodeAt(Sp)?(u=zo,Sp++):(u=x,0===Ap&&Up(qo)),l=u!==x&&(c=ug())!==x?u=xd(c):(Sp=l,x),Ap--,l===x&&(u=x,0===Ap&&Up(kd)),(t=l)===x&&(Ap++,o=Sp,43===w.charCodeAt(Sp)?(s=zo,Sp++):(s=x,0===Ap&&Up(qo)),o=s!==x&&(a=lg())!==x?s=xd(a):(Sp=o,x),Ap--,o===x&&(s=x,0===Ap&&Up(wd)),(t=o)===x)&&(Ap++,i=Sp,43===w.charCodeAt(Sp)?(n=zo,Sp++):(n=x,0===Ap&&Up(qo)),i=n!==x&&(r=ag())!==x?n=bd(r):(Sp=i,x),Ap--,i===x&&(n=x,0===Ap&&Up(yd)),t=i),Ap--,t===x&&0===Ap&&Up(dc),(e=t)===x)&&(e=tg()),Ap--,e===x&&0===Ap&&Up(uc),e}function tg(){var e,t,i,n,r,o,s,a,l,u;return Ap++,Ap++,a=Sp,45===w.charCodeAt(Sp)?(l=la,Sp++):(l=x,0===Ap&&Up(ua)),a=l!==x&&(u=ug())!==x?l=Fd(u):(Sp=a,x),Ap--,a===x&&(l=x,0===Ap&&Up(Ed)),(e=a)===x&&(Ap++,r=Sp,45===w.charCodeAt(Sp)?(o=la,Sp++):(o=x,0===Ap&&Up(ua)),r=o!==x&&(s=lg())!==x?o=Fd(s):(Sp=r,x),Ap--,r===x&&(o=x,0===Ap&&Up(Cd)),(e=r)===x)&&(Ap++,t=Sp,45===w.charCodeAt(Sp)?(i=la,Sp++):(i=x,0===Ap&&Up(ua)),t=i!==x&&(n=ag())!==x?i=Fd(n):(Sp=t,x),Ap--,t===x&&(i=x,0===Ap&&Up(_d)),e=t),Ap--,e===x&&0===Ap&&Up(hc),e}function ig(){var e,t;return Ap++,e=Sp,w.substr(Sp,4)===fc?(t=fc,Sp+=4):(t=x,0===Ap&&Up(gc)),t===x&&(w.substr(Sp,4)===vc?(t=vc,Sp+=4):(t=x,0===Ap&&Up(mc))),t!==x&&(t=yc()),(e=t)===x&&(e=Sp,w.substr(Sp,5)===bc?(t=bc,Sp+=5):(t=x,0===Ap&&Up(wc)),t===x&&(w.substr(Sp,5)===xc?(t=xc,Sp+=5):(t=x,0===Ap&&Up(kc))),t!==x&&(t=_c()),e=t),Ap--,e===x&&(t=x,0===Ap&&Up(pc)),e}function ng(){var e,t;return Ap++,e=Sp,(t=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,3)===qd?(t=qd,Sp+=3):(t=x,0===Ap&&Up(Hd)),t!==x){for(i=[],Gd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Xd)),n===x&&(n=dg());n!==x;)i.push(n),Gd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Xd)),n===x&&(n=dg());e=i!==x?(w.substr(Sp,3)===qd?(n=qd,Sp+=3):(n=x,0===Ap&&Up(Hd)),n!==x?t=Pd(i):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(zd)),e}())!==x&&(t=Cc(t)),(e=t)===x&&(e=Sp,(t=function(){var e,t,i,n;if(Ap++,e=Sp,w.substr(Sp,3)===Kd?(t=Kd,Sp+=3):(t=x,0===Ap&&Up(Jd)),t!==x){for(i=[],Yd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Zd)),n===x&&(n=dg());n!==x;)i.push(n),Yd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Zd)),n===x&&(n=dg());e=i!==x?(w.substr(Sp,3)===Kd?(n=Kd,Sp+=3):(n=x,0===Ap&&Up(Jd)),n!==x?t=Pd(i):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Wd)),e}())!==x&&(t=Cc(t)),(e=t)===x&&(e=Sp,(t=function(){var e,t,i,n;if(Ap++,e=Sp,39===w.charCodeAt(Sp)?(t=Od,Sp++):(t=x,0===Ap&&Up(Nd)),t!==x){for(i=[],Ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Md)),n===x&&(n=dg());n!==x;)i.push(n),Ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Md)),n===x&&(n=dg());e=i!==x?(39===w.charCodeAt(Sp)?(n=Od,Sp++):(n=x,0===Ap&&Up(Nd)),n!==x?t=Pd(i):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ad)),e}())!==x&&(t=Cc(t)),(e=t)===x&&(e=Sp,(t=function(){var e,t,i,n;if(Ap++,e=Sp,34===w.charCodeAt(Sp)?(t=$d,Sp++):(t=x,0===Ap&&Up(Bd)),t!==x){for(i=[],Qd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Vd)),n===x&&(n=dg());n!==x;)i.push(n),Qd.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Vd)),n===x&&(n=dg());e=i!==x?(34===w.charCodeAt(Sp)?(n=$d,Sp++):(n=x,0===Ap&&Up(Bd)),n!==x?t=Pd(i):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Ud)),e}())!==x&&(t=Cc(t)),e=t))),Ap--,e===x&&(t=x,0===Ap&&Up(Fc)),e}function rg(){var e,t,i,n,r,o,s;return Ap++,e=Sp,(t=og())!==x&&(t=Tc(t)),(e=t)===x&&(Ap++,Ap++,r=i=e=Sp,r=(o=sg())!==x&&(s=yg())!==x?o=Vc(o,s):(Sp=r,x),Ap--,r===x&&(o=x,0===Ap&&Up(Qc)),(n=r)!==x&&(n=Rc(n)),(i=n)===x&&(i=Sp,(n=sg())!==x&&(n=jc(n)),i=n),Ap--,i===x&&(n=x,0===Ap&&Up(Sc)),(t=i)!==x&&(t=Dc(t)),e=t),Ap--,e===x&&(t=x,0===Ap&&Up(Ec)),e}function og(){var e,t,i,n;if(Ap++,e=Sp,60===w.charCodeAt(Sp)?(t=Ns,Sp++):(t=x,0===Ap&&Up(Ls)),t!==x){for(i=[],Lc.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Mc));n!==x;)i.push(n),Lc.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(Mc));e=i!==x?(62===w.charCodeAt(Sp)?(n=Ms,Sp++):(n=x,0===Ap&&Up(Ps)),n!==x?t=Pc(i):(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Nc)),e}function sg(){var e,t,i;return Ap++,e=Sp,(t=function(){var e,t,i,n;if(Ap++,e=Sp,(t=fg())!==x){for(i=[],(n=mg())===x&&(46===w.charCodeAt(Sp)?(n=On,Sp++):(n=x,0===Ap&&Up(Nn)));n!==x;)i.push(n),(n=mg())===x&&(46===w.charCodeAt(Sp)?(n=On,Sp++):(n=x,0===Ap&&Up(Nn)));e=i!==x?t=cp(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(up)),e}())===x&&(t=null),e=t!==x?(58===w.charCodeAt(Sp)?(i=$c,Sp++):(i=x,0===Ap&&Up(Bc)),i!==x?t=Dc(t):(Sp=e,x)):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(Uc)),e}function ag(){var e,t,i;if(Ap++,e=Sp,t=[],ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud)),i!==x)for(;i!==x;)t.push(i),ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud));else t=x;return t!==x&&(t=cd(t)),Ap--,(e=t)===x&&(t=x,0===Ap&&Up(ad)),e}function lg(){var e,t,i,n,r;if(Ap++,e=Sp,t=[],ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud)),i!==x)for(;i!==x;)t.push(i),ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud));else t=x;if(t!==x)if(46===w.charCodeAt(Sp)?(i=On,Sp++):(i=x,0===Ap&&Up(Nn)),i!==x){for(n=[],ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud));r!==x;)n.push(r),ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud));e=n!==x?t=hd(t,i,n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x)if(e=Sp,46===w.charCodeAt(Sp)?(t=On,Sp++):(t=x,0===Ap&&Up(Nn)),t!==x){if(i=[],ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud)),n!==x)for(;n!==x;)i.push(n),ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud));else i=x;e=i!==x?t=pd(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(dd)),e}function ug(){var e,t,i,n,r;if(Ap++,e=Sp,t=[],ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud)),i!==x)for(;i!==x;)t.push(i),ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud));else t=x;if(t!==x)if(46===w.charCodeAt(Sp)?(i=On,Sp++):(i=x,0===Ap&&Up(Nn)),i!==x){for(n=[],ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud));r!==x;)n.push(r),ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud));e=n!==x&&(r=cg())!==x?t=gd(t,i,n,r):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;if(e===x){if(e=Sp,46===w.charCodeAt(Sp)?(t=On,Sp++):(t=x,0===Ap&&Up(Nn)),t!==x){if(i=[],ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud)),n!==x)for(;n!==x;)i.push(n),ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud));else i=x;e=i!==x&&(n=cg())!==x?t=vd(t,i,n):(Sp=e,x)}else Sp=e,e=x;if(e===x){if(e=Sp,t=[],ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud)),i!==x)for(;i!==x;)t.push(i),ld.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(ud));else t=x;e=t!==x&&(i=cg())!==x?t=md(t,i):(Sp=e,x)}}return Ap--,e===x&&(t=x,0===Ap&&Up(fd)),e}function cg(){var e,t,i,n,r;if(Ap++,e=Sp,Dd.test(w.charAt(Sp))?(t=w.charAt(Sp),Sp++):(t=x,0===Ap&&Up(Sd)),t!==x)if(Rd.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(jd)),i===x&&(i=null),i!==x){if(n=[],ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud)),r!==x)for(;r!==x;)n.push(r),ld.test(w.charAt(Sp))?(r=w.charAt(Sp),Sp++):(r=x,0===Ap&&Up(ud));else n=x;e=n!==x?t=Id(t,i,n):(Sp=e,x)}else Sp=e,e=x;else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(Td)),e}function dg(){var e,t,i;return Ap++,e=Sp,92===w.charCodeAt(Sp)?(t=th,Sp++):(t=x,0===Ap&&Up(ih)),e=t!==x?(nh.test(w.charAt(Sp))?(i=w.charAt(Sp),Sp++):(i=x,0===Ap&&Up(rh)),i!==x?t=[t,i]:(Sp=e,x)):(Sp=e,x),Ap--,e===x&&(t=x,0===Ap&&Up(eh)),e}function hg(){var e,t,i,n;if(Ap++,e=Sp,40===w.charCodeAt(Sp)?(t=B,Sp++):(t=x,0===Ap&&Up(Q)),t!==x){for(i=[],n=pg();n!==x;)i.push(n),n=pg();e=i!==x?(41===w.charCodeAt(Sp)?(n=G,Sp++):(n=x,0===Ap&&Up(X)),n!==x?t=sh():(Sp=e,x)):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(oh)),e}function pg(){var e;return Ap++,lh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(uh)),e===x&&(ch.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(dh)),e===x&&(hh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(ph)),e===x&&(fh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(gh)),e===x&&(e=function(){var e,t,i,n;if(Ap++,e=Sp,35===w.charCodeAt(Sp)?(t=mh,Sp++):(t=x,0===Ap&&Up(yh)),t!==x){for(i=[],bh.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(wh));n!==x;)i.push(n),bh.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(wh));e=i!==x?t=[t,i]:(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(vh)),e}())))),Ap--,e===x&&0===Ap&&Up(ah),e}function fg(){var e;return Ap++,_h.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Fh)),e===x&&(Ch.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Eh)),e===x&&(Th.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Dh)),e===x&&(Sh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Rh)),e===x&&(jh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Ih)),e===x&&(Ah.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Oh)),e===x&&(Nh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Lh)),e===x&&(Mh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Ph)),e===x&&(Uh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up($h)),e===x&&(Bh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Qh)),e===x&&(Vh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(zh)),e===x&&(qh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Hh)),e===x&&(Gh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Xh)),e===x&&(Wh.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(Kh))))))))))))))),Ap--,e===x&&0===Ap&&Up(kh),e}function gg(){var e;return Ap++,(e=fg())===x&&(95===w.charCodeAt(Sp)?(e=Yh,Sp++):(e=x,0===Ap&&Up(Zh))),Ap--,e===x&&0===Ap&&Up(Jh),e}function vg(){var e,t,i,n;if(Ap++,e=Sp,(t=gg())===x&&(ld.test(w.charAt(Sp))?(t=w.charAt(Sp),Sp++):(t=x,0===Ap&&Up(ud))),t!==x){for(i=[],(n=gg())===x&&(ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud)),n===x&&(tp.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ip)),n===x&&(np.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(rp)),n===x&&(op.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(sp))))));n!==x;)i.push(n),(n=gg())===x&&(ld.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ud)),n===x&&(tp.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(ip)),n===x&&(np.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(rp)),n===x&&(op.test(w.charAt(Sp))?(n=w.charAt(Sp),Sp++):(n=x,0===Ap&&Up(sp))))));e=i!==x?t=ap(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(ep)),e}function mg(){var e;return Ap++,(e=gg())===x&&(45===w.charCodeAt(Sp)?(e=la,Sp++):(e=x,0===Ap&&Up(ua)),e===x&&(ld.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(ud)),e===x&&(tp.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(ip)),e===x&&(np.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(rp)),e===x&&(op.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(sp))))))),Ap--,e===x&&0===Ap&&Up(lp),e}function yg(){var e,t,i,n;if(Ap++,e=Sp,(t=gg())===x&&(ld.test(w.charAt(Sp))?(t=w.charAt(Sp),Sp++):(t=x,0===Ap&&Up(ud)),t===x&&(58===w.charCodeAt(Sp)?(t=$c,Sp++):(t=x,0===Ap&&Up(Bc)),t===x&&(t=bg()))),t!==x){for(i=[],(n=mg())===x&&(46===w.charCodeAt(Sp)?(n=On,Sp++):(n=x,0===Ap&&Up(Nn)),n===x&&(58===w.charCodeAt(Sp)?(n=$c,Sp++):(n=x,0===Ap&&Up(Bc)),n===x&&(n=bg())));n!==x;)i.push(n),(n=mg())===x&&(46===w.charCodeAt(Sp)?(n=On,Sp++):(n=x,0===Ap&&Up(Nn)),n===x&&(58===w.charCodeAt(Sp)?(n=$c,Sp++):(n=x,0===Ap&&Up(Bc)),n===x&&(n=bg())));e=i!==x?t=hp(t,i):(Sp=e,x)}else Sp=e,e=x;return Ap--,e===x&&(t=x,0===Ap&&Up(dp)),e}function bg(){var e,t,i,n,r,o,s,a,l;return Ap++,Ap++,o=r=Sp,37===w.charCodeAt(Sp)?(s=gp,Sp++):(s=x,0===Ap&&Up(vp)),(o=s!==x&&(a=wg())!==x&&(l=wg())!==x?s=[s,a,l]:(Sp=o,x))!==x&&(o=mp(o)),Ap--,(r=o)===x&&(o=x,0===Ap&&Up(fp)),(e=r)===x&&(Ap++,t=Sp,92===w.charCodeAt(Sp)?(i=th,Sp++):(i=x,0===Ap&&Up(ih)),t=i!==x?(95===w.charCodeAt(Sp)?(n=Yh,Sp++):(n=x,0===Ap&&Up(Zh)),n===x&&(126===w.charCodeAt(Sp)?(n=Fp,Sp++):(n=x,0===Ap&&Up(Cp)),n===x&&(46===w.charCodeAt(Sp)?(n=On,Sp++):(n=x,0===Ap&&Up(Nn)),n===x&&(45===w.charCodeAt(Sp)?(n=la,Sp++):(n=x,0===Ap&&Up(ua)),n===x&&(33===w.charCodeAt(Sp)?(n=Go,Sp++):(n=x,0===Ap&&Up(Xo)),n===x&&(36===w.charCodeAt(Sp)?(n=Jc,Sp++):(n=x,0===Ap&&Up(Yc)),n===x&&(38===w.charCodeAt(Sp)?(n=Ep,Sp++):(n=x,0===Ap&&Up(Tp)),n===x&&(39===w.charCodeAt(Sp)?(n=Od,Sp++):(n=x,0===Ap&&Up(Nd)),n===x&&(40===w.charCodeAt(Sp)?(n=B,Sp++):(n=x,0===Ap&&Up(Q)),n===x&&(41===w.charCodeAt(Sp)?(n=G,Sp++):(n=x,0===Ap&&Up(X)),n===x&&(42===w.charCodeAt(Sp)?(n=W,Sp++):(n=x,0===Ap&&Up(K)),n===x&&(43===w.charCodeAt(Sp)?(n=zo,Sp++):(n=x,0===Ap&&Up(qo)),n===x&&(44===w.charCodeAt(Sp)?(n=Vr,Sp++):(n=x,0===Ap&&Up(zr)),n===x&&(59===w.charCodeAt(Sp)?(n=Kt,Sp++):(n=x,0===Ap&&Up(Jt)),n===x&&(58===w.charCodeAt(Sp)?(n=$c,Sp++):(n=x,0===Ap&&Up(Bc)),n===x&&(61===w.charCodeAt(Sp)?(n=js,Sp++):(n=x,0===Ap&&Up(Is)),n===x&&(47===w.charCodeAt(Sp)?(n=Io,Sp++):(n=x,0===Ap&&Up(Ao)),n===x&&(63===w.charCodeAt(Sp)?(n=Qo,Sp++):(n=x,0===Ap&&Up(Vo)),n===x&&(35===w.charCodeAt(Sp)?(n=mh,Sp++):(n=x,0===Ap&&Up(yh)),n===x&&(64===w.charCodeAt(Sp)?(n=ed,Sp++):(n=x,0===Ap&&Up(td)),n===x&&(37===w.charCodeAt(Sp)?(n=gp,Sp++):(n=x,0===Ap&&Up(vp)))))))))))))))))))))),n!==x?i=Dp(n):(Sp=t,x)):(Sp=t,x),Ap--,t===x&&(i=x,0===Ap&&Up(_p)),e=t),Ap--,e===x&&0===Ap&&Up(pp),e}function wg(){var e;return Ap++,ld.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(ud)),e===x&&(bp.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(wp)),e===x&&(xp.test(w.charAt(Sp))?(e=w.charAt(Sp),Sp++):(e=x,0===Ap&&Up(kp)))),Ap--,e===x&&0===Ap&&Up(yp),e}var xg=function(e){for(var t="",i=0;i<e.length;i++)"string"==typeof e[i]?t+=e[i]:t+=e[i].join("");return t},kg=0,_g={},Fg=function(e,t){_g[e]=t},Cg=function(e){_g.null=e},Eg=function(e){var t="";if(null==e)return null;for(var i=0;i<e.length;i++)t+=e[i];return t.toUpperCase()};if((t=n())!==x&&Sp===w.length)return t;throw t!==x&&Sp<w.length&&Up({type:"end"}),$p(Ip,jp<w.length?w.charAt(jp):null,jp<w.length?Pp(jp,jp+1):Pp(jp,jp))}}}()},{}],47:[function(e,t,i){e("./btree").Tree;var r=e("./utils"),o=r,n=e("./lexicon").Lexicon;PersistentLexicon=function(t,e){var i=this;r.registerIndexedDB(i),this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri},this.oidCounter=1,i.dbName=e||"rdfstorejs";var n=i.indexedDB.open(this.dbName+"_lexicon",1);n.onerror=function(e){t(null,new Error("Error opening IndexedDB: "+e.target.errorCode))},n.onsuccess=function(e){i.db=e.target.result,t(i)},n.onupgradeneeded=function(e){i.db=e.target.result,i.db.createObjectStore("knownGraphs",{keyPath:"oid"}).createIndex("uriToken","uriToken",{unique:!0}),i.db.createObjectStore("components",{keyPath:"id",autoIncrement:!0}).createIndex("value","value",{unique:!0})}},PersistentLexicon.prototype.registerGraph=function(t,i,n){if(t!=this.defaultGraphOid){var e=this.db.transaction(["knownGraphs"],"readwrite");e.onerror=function(e){n(null,new Error(e.target.statusCode))};var r=e.objectStore("knownGraphs");r.get(i).onsuccess=function(e){e.target.result?n(!0):r.add({oid:t,uriToken:i}).onsuccess=function(e){n(!0)}}}else n()},PersistentLexicon.prototype.registeredGraphs=function(i,n){var r=[],e=this.db.transaction(["knownGraphs"],"readwrite").objectStore("knownGraphs").openCursor();e.onsuccess=function(e){var t=e.target.result;t?(!0===i?r.push(t.value.uriToken):r.push(t.value.oid),t.continue()):n(r)},e.onerror=function(e){n(null,new Error("Error retrieving data from the cursor: "+e.target.errorCode))}},PersistentLexicon.prototype.registerUri=function(o,s){if(o===this.defaultGraphUri)s(this.defaultGraphOid);else{var a=this.db.transaction(["components"],"readwrite").objectStore("components"),e=a.index("value").get("_u:"+o);e.onsuccess=function(e){var t=e.target.result;if(t){t.counter++;var i=t.id,n=a.put(t);n.onsuccess=function(e){s(i)},n.onerror=function(e){s(null,new Error("Error updating the URI data"+e.target.errorCode))}}else{var r=a.add({value:"_u:"+o,counter:0,uri:!0});r.onsuccess=function(e){s(e.target.result)},r.onerror=function(e){s(null,new Error("Error inserting the URI data"+e.target.errorCode))}}},e.onerror=function(e){s(null,new Error("Error retrieving the URI data"+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUri=function(e,t){if(e===this.defaultGraphUri)t(this.defaultGraphOid);else{var i=this.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);i.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},i.onerror=function(e){t(null,new Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.resolveUriCost=function(e,t){if(e===this.defaultGraphUri)t(0);else{var i=that.db.transaction(["components"]).objectStore("components").index("value").get("_u:"+e);i.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},i.onerror=function(e){t(null,new Error("Error retrieving uri data "+e.target.errorCode))}}},PersistentLexicon.prototype.registerBlank=function(t){var e=guid(),i=this.db.transaction(["components"],"readwrite").objectStore("components").add({value:"_b:"+e,counter:0,label:!0});i.onsuccess=function(e){t(e.target.result)},i.onerror=function(e){t(null,new Error("Error inserting the URI data"+e.target.errorCode))}},PersistentLexicon.prototype.resolveBlankCost=function(e,t){t(0)},PersistentLexicon.prototype.registerLiteral=function(o,s){var a=this.db.transaction(["components"],"readwrite").objectStore("components"),e=a.index("value").get("_l:"+o);e.onsuccess=function(e){var t=e.target.result;if(t){t.counter++;var i=t.id,n=a.put(t);n.onsuccess=function(e){s(i)},n.onerror=function(e){s(null,new Error("Error updating the literal data"+e.target.errorCode))}}else{var r=a.add({value:"_l:"+o,counter:0,literal:!0});r.onsuccess=function(e){s(e.target.result)},r.onerror=function(e){s(null,new Error("Error inserting the literal data"+e.target.errorCode))}}},e.onerror=function(e){s(null,new Error("Error retrieving the literal data"+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteral=function(e,t){var i=that.db.transaction(["components"]).objectStore("components").index("value").get("_l:"+e);i.onsuccess=function(e){null!=e.target.result?t(e.target.result.id):t(-1)},i.onerror=function(e){t(null,new Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.resolveLiteralCost=function(e,t){var i=that.db.transaction(["components"]).objectStore("components").index("components").get(e);i.onsuccess=function(e){null!=e.target.result?t(e.target.result.cost):t(-1)},i.onerror=function(e){t(null,new Error("Error retrieving literal data "+e.target.errorCode))}},PersistentLexicon.prototype.parseLiteral=function(e){return n.prototype.parseLiteral(e)},PersistentLexicon.prototype.parseUri=function(e){return n.prototype.parseUri(e)},PersistentLexicon.prototype.retrieve=function(e,i){var t,n=this;e===this.defaultGraphOid?i({token:"uri",value:this.defaultGraphUri,prefix:null,suffix:null,defaultGraph:!0}):((t=n.db.transaction(["components"]).objectStore("components").get(e)).onsuccess=function(e){if(null!=e.target.result)if(null!=e.target.result.label){var t="_:"+e.target.result.id;i({token:"blank",value:t})}else null!=e.target.result.uri?i(n.parseUri(e.target.result.value.slice(3,e.target.result.value.length))):null!=e.target.result.literal?i(n.parseLiteral(e.target.result.value.slice(3,e.target.result.value.length))):(console.log(e.target.result),i(null,new Error("Unknown type of component "+e.target.result)));else i(null,null)},t.onerror=function(e){i(null,new Error("Error searching in blanks data "+e.target.errorCode))})},PersistentLexicon.prototype.clear=function(e){this.defaultGraphOid=0,this.defaultGraphUri="https://github.com/antoniogarrote/rdfstore-js#default_graph",this.defaultGraphUriTerm={token:"uri",prefix:null,suffix:null,value:this.defaultGraphUri};var t,i=function(){null!=e&&e()};(t=this.db.transaction(["components"],"readwrite").objectStore("components").clear()).onsuccess=i,t.onerror=i},PersistentLexicon.prototype.unregister=function(t,i,e){var n=this;o.seq(function(e){n._unregisterTerm(t.subject.token,i.subject,e)},function(e){n._unregisterTerm(t.predicate.token,i.predicate,e)},function(e){n._unregisterTerm(t.object.token,i.object,e)},function(e){null!=t.graph?n._unregisterTerm(t.graph.token,i.graph,e):e()})(function(){e(!0)})},PersistentLexicon.prototype._unregisterTerm=function(e,t,i){var n=this.db.transaction(["components","knownGraphs"],"readwrite");if("uri"===e)if(t!=this.defaultGraphOid){n.objectStore("components").delete(t).onsuccess=void(n.objectStore("knownGraphs").delete(t).onsuccess=function(){i()})}else i();else n.objectStore("components").delete(t).onsuccess=function(){i()}},t.exports={PersistentLexicon:PersistentLexicon}},{"./btree":40,"./lexicon":44,"./utils":57}],48:[function(e,t,i){var s=e("./utils");PersistentQuadBackend=function(e,t){var i=this;if(0!==arguments){for(var n in s.registerIndexedDB(i),this.indexMap={},this.indices=["S","P","O","G","SP","SO","SG","PO","PG","OG","SPO","SPG","SOG","POG","SPOG"],this.componentOrders={S:["subject","predicate","object","graph"],P:["predicate","subject","object","graph"],O:["object","subject","predicate","graph"],G:["graph","subject","predicate","object"],SP:["subject","predicate","object","graph"],SO:["subject","object","predicate","graph"],SG:["subject","graph","predicate","object"],PO:["predicate","object","subject","graph"],PG:["predicate","graph","subject","object"],OG:["object","graph","subject","predicate"],SPO:["subject","predicate","object","graph"],SPG:["subject","predicate","graph","object"],SOG:["subject","object","graph","predicate"],POG:["predicate","object","graph","subject"],SPOG:["subject","predicate","object","graph"]},this.componentOrdersMap={},this.componentOrders){var r=this.componentOrders[n].slice(0,n.length).sort().join(".");this.componentOrdersMap[r]=n}i.dbName=e.name||"rdfstorejs";var o=i.indexedDB.open(this.dbName+"_db",1);o.onerror=function(e){t(null,new Error("Error opening IndexedDB: "+e.target.errorCode))},o.onsuccess=function(e){i.db=e.target.result,t(i)},o.onupgradeneeded=function(e){var t=e.target.result.createObjectStore(i.dbName,{keyPath:"SPOG"});s.each(i.indices,function(e){"SPOG"!==e&&t.createIndex(e,e,{unique:!1})})}}},PersistentQuadBackend.prototype.index=function(t,i){var n=this;s.each(this.indices,function(e){t[e]=n._genMinIndexKey(t,e)});var e=n.db.transaction([n.dbName],"readwrite");e.oncomplete=function(e){},e.onerror=function(e){i(null,new Error(e.target.statusCode))},e.objectStore(n.dbName).add(t).onsuccess=function(e){i(!0)}},PersistentQuadBackend.prototype.range=function(e,i){var t=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._indexForPattern(e),r=this._genMinIndexKey(e,n),o=this._genMaxIndexKey(e,n),s=this.IDBKeyRange.bound(r,o,!1,!1),a=[];("SPOG"===n?t:t.index(n)).openCursor(s).onsuccess=function(e){var t=e.target.result;t?(a.push(t.value),t.continue()):i(a)}},PersistentQuadBackend.prototype.search=function(e,t){var i=this.db.transaction([this.dbName]).objectStore(this.dbName),n=this._genMinIndexKey(e,"SPOG"),r=i.get(n);r.onerror=function(e){t(null,new Error(e.target.statusCode))},r.onsuccess=function(e){t(null!=e.target.result)}},PersistentQuadBackend.prototype.delete=function(e,t){var i=this._genMinIndexKey(e,"SPOG"),n=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).delete(i);n.onsuccess=function(){t(!0)},n.onerror=function(e){t(null,new Error(e.target.statusCode))}},PersistentQuadBackend.prototype._genMinIndexKey=function(t,e){var i=this.componentOrders[e];return s.map(i,function(e){return"string"==typeof t[e]||null==t[e]?"0":t[e]}).join(".")},PersistentQuadBackend.prototype._genMaxIndexKey=function(e,t){for(var i=this.componentOrders[t],n=[],r=0;r<i.length;r++){var o=e[i[r]];n[r]="string"==typeof o?"z":o}return s.map(n,function(e){return""+e}).join(".")},PersistentQuadBackend.prototype._indexForPattern=function(e){var t=e.indexKey.sort().join("."),i=this.componentOrdersMap[t];if(null==i)throw new Error("Error, cannot find index for indexKey "+t);return i},PersistentQuadBackend.prototype.clear=function(e){var t;(t=this.db.transaction([this.dbName],"readwrite").objectStore(this.dbName).clear()).onsuccess=function(){e()},t.onerror=function(){e()}},t.exports.PersistentQuadBackend=PersistentQuadBackend},{"./utils":57}],49:[function(e,t,i){var r=e("./quad_index").QuadIndex,s=e("./utils");QuadBackend=function(e,t){this.indexMap={},this.treeOrder=e.treeOrder,this.indices=e.index||QuadBackend.allIndices,this.componentOrders=QuadBackend.componentOrders;var n=this;s.eachSeries(this.indices,function(t,i){new r({order:n.treeOrder,componentOrder:n.componentOrders[t]},function(e){n.indexMap[t]=e,i()})},function(){t(n)})},QuadBackend.allIndices=["SPOG","GP","OGS","POG","GSP","OS"],QuadBackend.componentOrders={SPOG:["subject","predicate","object","graph"],GP:["graph","predicate","subject","object"],OGS:["object","graph","subject","predicate"],POG:["predicate","object","graph","subject"],GSP:["graph","subject","predicate","object"],OS:["object","subject","predicate","graph"]},QuadBackend.prototype._indexForPattern=function(e){for(var t=e.indexKey,i=0;i<QuadBackend.allIndices.length;i++)for(var n=QuadBackend.allIndices[i],r=QuadBackend.componentOrders[n],o=0;o<r.length&&!1!==s.include(t,r[o]);o++)if(o==t.length-1)return n;return"SPOG"},QuadBackend.prototype.index=function(i,e){var n=this;s.eachSeries(this.indices,function(e,t){n.indexMap[e].insert(i,function(){t()})},function(){e(!0)})},QuadBackend.prototype.range=function(e,t){var i=this._indexForPattern(e),n=this.indexMap[i];null!=n&&n.range(e,function(e){t(e)})},QuadBackend.prototype.search=function(e,t){var i=this.indexMap.SPOG;null!=i&&i.search(e,function(e){t(null!=e)})},QuadBackend.prototype.delete=function(i,e){var n=this;s.eachSeries(this.indices,function(e,t){n.indexMap[e].delete(i,function(){t()})},function(){e(!0)})},QuadBackend.prototype.clear=function(e){var n=this;s.eachSeries(this.indices,function(t,i){new r({order:n.treeOrder,componentOrder:n.componentOrders[t]},function(e){n.indexMap[t]=e,i()})},function(){e(!0)})},t.exports.QuadBackend=QuadBackend},{"./quad_index":50,"./utils":57}],50:[function(e,t,i){var n=e("./btree").Tree,r=e("./utils"),u=e("./utils");NodeKey=function(e,t){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.order=t},NodeKey.prototype.comparator=function(e){for(var t=0;t<this.order.length;t++){var i=this.order[t];if(null==e[i])return 0;if(this[i]<e[i])return-1;if(this[i]>e[i])return 1}return 0},Pattern=function(e){this.subject=e.subject,this.predicate=e.predicate,this.object=e.object,this.graph=e.graph,this.indexKey=[],this.keyComponents={};var t=[],i=[],n=this;r.forEach(["subject","predicate","object","graph"],function(e){"string"==typeof n[e]?(i.push(e),n.keyComponents[e]=null):(t.push(e),n.keyComponents[e]=n[e],n.indexKey.push(e))}),this.order=t.concat(i),this.key=new NodeKey(this.keyComponents,this.order)},QuadIndex=function(e,t){0!=arguments&&(this.componentOrder=e.componentOrder,n.call(this,e.order,function(s){s.comparator=function(e,t){for(var i=0;i<s.componentOrder.length;i++){var n=s.componentOrder[i],r=e[n],o=t[n];if(r<o)return-1;if(o<r)return 1}return 0},s.rangeComparator=function(e,t){for(var i=0;i<s.componentOrder.length;i++){var n=s.componentOrder[i];if(null==t[n]||null==e[n])return 0;if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}return 0},t(s)}))},QuadIndex.prototype=r.create(n.prototype,{constructor:n}),QuadIndex.prototype.insert=function(e,t){n.prototype.insert.call(this,e,null,function(e){t(e)})},QuadIndex.prototype.search=function(e,t){n.prototype.search.call(this,e,function(e){t(e)},!0)},QuadIndex.prototype.range=function(e,t){this._rangeTraverse(this,this.root,e,t)},QuadIndex.prototype._rangeTraverse=function(o,e,t,i){var s=t.key,a=[],l=[e];u.whilst(function(){return 0<l.length},function(t){for(var n=l.shift(),r=0;r<n.numberActives&&-1===o.rangeComparator(n.keys[r].key,s);)r++;if(!0===n.isLeaf){for(var e=r;e<n.numberActives&&0===o.rangeComparator(n.keys[e].key,s);)a.push(n.keys[e].key),e++;t()}else o._diskRead(n.children[r],function(e){l.push(e);var i=r;u.whilst(function(){return i<n.numberActives&&0===o.rangeComparator(n.keys[i].key,s)},function(t){a.push(n.keys[i].key),i++,o._diskRead(n.children[i],function(e){l.push(e),t()})},function(){t()})})},function(){i(a)})},t.exports={QuadIndex:QuadIndex,Pattern:Pattern,NodeKey:NodeKey}},{"./btree":40,"./utils":57}],51:[function(e,t,i){var n=e("./abstract_query_tree").AbstractQueryTree,s=e("./abstract_query_tree").NonSupportedSparqlFeatureError,c=e("./utils"),u=e("./quad_index"),f=e("./query_plan").QueryPlan,g=e("./query_filters").QueryFilters,b=e("./rdf_model"),r=e("./rdf_loader").RDFLoader,d=e("./graph_callbacks").CallbacksBackend,v=e("./utils"),l=e("./utils");function m(e,t,i){this.name="BindExpressionError",this.bind=t,this.error=i,this.message=e}m.prototype=new Error,m.constructor=m,QueryEngine=function(e){0!=arguments.length&&(this.backend=e.backend,this.lexicon=e.lexicon,this.eventsOnBatchLoad=e.eventsOnBatchLoad||!1,this.defaultPrefixes={},this.abstractQueryTree=new n,this.rdfLoader=new r(e.communication),this.callbacksBackend=new d(this),this.customFns=e.customFns||{})},QueryEngine.prototype.setCustomFunctions=function(e){this.customFns=e},QueryEngine.prototype.registerNsInEnvironment=function(e,t){var i=[];null!=e&&null!=e.prefixes&&(i=e.prefixes);var n={};for(var r in this.defaultPrefixes)n[r]=this.defaultPrefixes[r];for(var o=0;o<i.length;o++){var s=i[o];"prefix"===s.token&&(n[s.prefix]=s.local)}t.namespaces=n,null!=e&&e.base&&"object"==typeof e.base?t.base=e.base.value:t.base=null},QueryEngine.prototype.applyModifier=function(e,t){if("DISTINCT"!=e)return t;for(var i={},n=[],r=0;r<t.length;r++){var o=t[r],s="";for(var a in o){var l=o[a];null==l?s=s+a+"null":"literal"==l.token?(null!=l.value&&(s+=l.value),null!=l.lang&&(s+=l.lang),null!=l.type&&(s+=l.type)):s=l.value?s+a+l.value:s+a+l}null==i[s]&&(n.push(o),i[s]=!0)}return n},QueryEngine.prototype.applyLimitOffset=function(e,t,i){return null==t&&null==e?i:(null==e&&(e=0),t=null==t?i.length:e+t,i.slice(e,t))},QueryEngine.prototype.applySingleOrderBy=function(e,i,n,r,t){var o=[],s=this;v.eachSeries(e,function(e,t){g.collect(e.expression,[i],n,r,s,function(e){o.push(e[0].value),t()})},function(){t({binding:i,value:o})})},QueryEngine.prototype.applyOrderBy=function(i,e,n,r,o){var s=this,a=[];null!=i&&0<i.length?v.eachSeries(e,function(e,t){s.applySingleOrderBy(i,e,n,r,function(e){a.push(e),t()})},function(){a.sort(function(e,t){return s.compareFilteredBindings(e,t,i,r)});for(var e=[],t=0;t<a.length;t++)e.push(a[t].binding);o(e)}):o(e)},QueryEngine.prototype.compareFilteredBindings=function(e,t,i,n){for(var r=0;;){if(r==e.value.length)return 0;var o,s=i[r].direction;if(null!=e.value[r]||null!=t.value[r]){if(null==e.value[r])o={value:!1};else if(null==t.value[r])o={value:!0};else{if("blank"===e.value[r].token&&"blank"===t.value[r].token){r++;continue}if("blank"===e.value[r].token)o={value:!1};else if("blank"===t.value[r].token)o={value:!0};else if("uri"===e.value[r].token&&"uri"===t.value[r].token){if(1==g.runEqualityFunction(e.value[r],t.value[r],[],this,n).value){r++;continue}o=g.runTotalGtFunction(e.value[r],t.value[r],[])}else if("uri"===e.value[r].token)o={value:!1};else if("uri"===t.value[r].token)o={value:!0};else if("literal"===e.value[r].token&&"literal"===t.value[r].token&&null==e.value[r].type&&null==t.value[r].type){if(1==g.runEqualityFunction(e.value[r],t.value[r],[],this,n).value){r++;continue}o=g.runTotalGtFunction(e.value[r],t.value[r],[])}else if("literal"===e.value[r].token&&null==e.value[r].type)o={value:!1};else if("literal"===t.value[r].token&&null==t.value[r].type)o={value:!0};else{if(1==g.runEqualityFunction(e.value[r],t.value[r],[],this,n).value){r++;continue}o=g.runTotalGtFunction(e.value[r],t.value[r],[])}}return 1==o.value?"ASC"===s?1:-1:"ASC"===s?-1:1}r++}},QueryEngine.prototype.removeDefaultGraphBindings=function(e,t){for(var i=[],n={},r=0;r<t.named.length;r++)n[t.named[r].oid]=!0;for(r=0;r<t.implicit.length;r++)null==n[t.implicit[r].oid]&&i.push(t.implicit[r].oid);var o=[];for(r=0;r<e.length;r++){var s=e[r],a=!1;for(var l in s){for(var u=0;u<n.length;u++)if(s[l]===n[u]){a=!0;break}if(a)break}a||o.push(s)}return o},QueryEngine.prototype.aggregateBindings=function(r,e,o,s,a){this.copyDenormalizedBindings(e,s.outCache,function(e){for(var t={},i=0;i<r.length;i++){var n=g.runAggregator(r[i],e,this,o,s);r[i].alias?t[r[i].alias.value]=n:t[r[i].value.value]=n}a(t)})},QueryEngine.prototype.projectBindings=function(e,t,i){if("*"===e[0].kind)return t;for(var n=[],r=0;r<t.length;r++){for(var o=t[r],s={},a=!0,l=0;l<e.length;l++)if("variable"==e[l].token&&"aliased"!=e[l].kind)s[e[l].value.value]=o[e[l].value.value];else if("variable"==e[l].token&&"aliased"==e[l].kind){var u=g.runFilter(e[l].expression,o,this,i,{blanks:{},outCache:{}});if(g.isEbvError(u)){a=!1;break}s[e[l].alias.value]=u}!0===a&&n.push(s)}return n},QueryEngine.prototype.resolveNsInEnvironment=function(e,t){return t.namespaces[e]},QueryEngine.prototype.normalizeTerm=function(e,t,i,n){if("uri"===e.token){var r=c.lexicalFormBaseUri(e,t);null==r?n(null):i?this.lexicon.registerUri(r,n):this.lexicon.resolveUri(r,n)}else if("literal"===e.token){var o=c.lexicalFormLiteral(e,t);i?this.lexicon.registerLiteral(o,n):this.lexicon.resolveLiteral(o,n)}else if("blank"===e.token){var s=e.value,a=t.blanks[s];null!=a?n(a):i?this.lexicon.registerBlank(function(e){t.blanks[s]=e,n(e)}):this.lexicon.resolveBlank(function(e){t.blanks[s]=e,n(e)})}else"var"===e.token?n(e.value):n(null)},QueryEngine.prototype.normalizeDatasets=function(e,n,t){var r=this;v.eachSeries(e,function(t,i){t.value===r.lexicon.defaultGraphUri?(t.oid=r.lexicon.defaultGraphOid,i()):r.normalizeTerm(t,n,!1,function(e){null!=e&&(t.oid=e),i()})},function(){t(!0)})},QueryEngine.prototype.normalizeQuad=function(n,e,r,t){var i=null,o=null,s=null,a=null,l=this,u=!1;v.seq(function(t){if(null==n.graph||n.graph.value===l.lexicon.defaultGraphUri)a=0,t();else{var i=c.lexicalFormBaseUri(n.graph,e);l.normalizeTerm(n.graph,e,r,function(e){null!=e?(a=e,!0===r&&"var"!=n.graph.token?l.lexicon.registerGraph(e,i,function(){t()}):t()):(u=!0,t())})}},function(t){!1===u?l.normalizeTerm(n.subject,e,r,function(e){null!=e?i=e:u=!0,t()}):t()},function(t){!1===u?l.normalizeTerm(n.predicate,e,r,function(e){null!=e?o=e:u=!0,t()}):t()},function(t){!1===u?l.normalizeTerm(n.object,e,r,function(e){null!=e?s=e:u=!0,t()}):t()})(function(){t(!0===u?null:{subject:i,predicate:o,object:s,graph:a})})},QueryEngine.prototype.denormalizeBindingsList=function(e,i,t){var n=this,r=[];v.eachSeries(e,function(e,t){n.denormalizeBindings(e,i,function(e){r.push(e),t()})},function(){t(r)})},QueryEngine.prototype.copyDenormalizedBindings=function(e,s,t){var a=this,i=[];v.eachSeries(e,function(r,e){var o={},t=l.keys(r);v.eachSeries(t,function(t,i){var n=r[t];if(null==n)o[t]=null,i();else if("object"==typeof n)o[t]=n,i();else{var e=s[n];null!=e?(o[t]=e,i()):a.lexicon.retrieve(n,function(e){s[n]=e,o[t]=e,i()})}},function(){i.push(o),e()})},function(){t(i)})},QueryEngine.prototype.denormalizeBindings=function(r,o,e){var t=l.keys(r),s=o.outCache,a=this;v.eachSeries(t,function(t,i){var n=r[t];null==n?(r[t]=null,i()):"object"==typeof n?i():null!=s[n]?(r[t]=s[n],i()):a.lexicon.retrieve(n,function(e){"blank"===(r[t]=e).token&&(o.blanks[e.value]=n),i()})},function(){e(r)})},QueryEngine.prototype.execute=function(e,i,t,n){e=c.normalizeUnicodeLiterals(e);var r=this.abstractQueryTree.parseQueryString(e);if(null==r)i(!1,"Error parsing query string");else if("query"===r.token&&"update"==r.kind){this.callbacksBackend.startGraphModification();var o=this;this.executeUpdate(r,function(e,t){o.lexicon.updateAfterWrite&&o.lexicon.updateAfterWrite(),e?(o.callbacksBackend.cancelGraphModification(),i(e,t)):o.callbacksBackend.endGraphModification(function(){i(e,t)})})}else"query"===r.token&&"query"==r.kind&&this.executeQuery(r,i,t,n)},QueryEngine.prototype.executeQuery=function(e,g,t,i){var n=e.prologue,r=e.units,v=this,m={blanks:{},outCache:{}};this.registerNsInEnvironment(n,m);var y=v.abstractQueryTree.parseExecutableUnit(r[0]);"select"===y.kind?this.executeSelect(y,m,t,i,function(e,t){null==e?"object"==typeof t&&!0===t.denorm?g(null,t.bindings):v.denormalizeBindingsList(t,m,function(e){g(null,e)}):g(e)}):"ask"===y.kind?(y.projection=[{token:"variable",kind:"*"}],this.executeSelect(y,m,t,i,function(e,t){null==e?0<t.length?g(null,!0):g(null,!1):g(e)})):"construct"===y.kind&&(y.projection=[{token:"variable",kind:"*"}],(v=this).executeSelect(y,m,t,i,function(e,t){null==e?v.denormalizeBindingsList(t,m,function(e){if(null!=e){var t=new b.Graph;null==y.template&&(y.template={triplesContext:y.pattern});for(var i=1,n=[],r=0;r<e.length;r++){for(var o=e[r],s=0;s<n.length;s++)delete n[s].valuetmp;for(s=0;s<y.template.triplesContext.length;s++){for(var a=["subject","predicate","object"],l=y.template.triplesContext[s],u=0;u<a.length;u++){var c=a[u];if("blank"===l[c].token)if(l[c].valuetmp&&null!=l[c].valuetmp);else{var d="_:b"+i;i++,l[c].valuetmp=d,n.push(l[c])}}var h=b.buildRDFResource(l.subject,o,v,m),p=(u=b.buildRDFResource(l.predicate,o,v,m),b.buildRDFResource(l.object,o,v,m));if(null!=h&&null!=u&&null!=p){var f=new b.Triple(h,u,p);t.add(f)}}}g(null,t)}else g(new Error("Error denormalizing bindings."))}):g(e)}))},QueryEngine.prototype.executeSelect=function(n,r,e,t,o){if("select"===n.kind||"ask"===n.kind||"construct"===n.kind||"modify"===n.kind){var s=n.projection,a=n.dataset,l=n.modifier,u=n.limit,c=n.offset,d=n.order,h=this;null==e&&null==t||(a.implicit=e||[],a.named=t||[]),null!=a.implicit&&0===a.implicit.length&&null!=a.named&&0===a.named.length&&a.implicit.push(this.lexicon.defaultGraphUriTerm),h.normalizeDatasets(a.implicit.concat(a.named),r,function(){try{h.executeSelectUnit(s,a,n.pattern,r,function(e){if(null!=e){if(null!=n.group&&""===n.group){for(var t=!1,i=0;i<n.projection.length;i++)if(null!=n.projection[i].expression&&"aggregate"===n.projection[i].expression.expressionType){t=!0;break}!0===t&&(n.group="singleGroup")}n.group&&""!=n.group?h.checkGroupSemantics(n.group,s)?h.groupSolution(e,n.group,a,r,function(e){var i=[];v.eachSeries(e,function(e,t){h.aggregateBindings(s,e,a,r,function(e){i.push(e),t()})},function(){o(null,{bindings:i,denorm:!0})})}):o(new Error("Incompatible Group and Projection variables")):h.applyOrderBy(d,e,a,r,function(e){var t=h.projectBindings(s,e,a),i=h.applyModifier(l,t),n=h.applyLimitOffset(c,u,i),r=h.removeDefaultGraphBindings(n,a);o(null,r)})}else o(new Error("Error executing SELECT query."))})}catch(e){o(e)}})}else o(new Error("Cannot execute "+n.kind+" query as a select query"))},QueryEngine.prototype.groupSolution=function(e,t,a,l,u){var c=[],d=[],h=!1,p=this;"singleGroup"===t?u([e]):v.eachSeries(e,function(o,e){var s=!0;v.eachSeries(t,function(i,n){var r=null;if("var"===i.token)r=i.value,0==h&&c.push(r),n();else if("aliased_expression"===i.token){if(r=i.alias.value,0==h&&c.push(r),"var"===i.expression.primaryexpression)o[i.alias.value]=o[i.expression.value.value];else{var e=p.copyDenormalizedBindings([o],l.outCache),t=g.runFilter(i.expression,e[0],p,a,l);g.isEbvError(t)?s=!1:(null!=t.value&&(t.value=""+t.value),o[i.alias.value]=t)}n()}else p.copyDenormalizedBindings([o],l.outCache,function(e){var t=g.runFilter(i,e[0],p,l);g.isEbvError(t)?s=!1:(o["groupCondition"+env._i]=t,r="groupCondition"+env._i,0==h&&c.push(r)),n()})},function(){0==h&&(h=!0),!0===s&&d.push(o),e()})},function(){for(var e={},t={},i=0;i<d.length;i++){for(var n=d[i],r="",o=0;o<c.length;o++){var s=n[c[o]];r+="object"==typeof s?s.value:s}null==e[r]?(t[r]=0,e[r]=[n]):e[r].push(n)}var a=[];for(var l in e)a.push(e[l]);u(a)})},QueryEngine.prototype.executeSelectUnit=function(e,t,i,n,r){if("BGP"===i.kind)this.executeAndBGP(e,t,i,n,r);else if("UNION"===i.kind)this.executeUNION(e,t,i.value,n,r);else if("JOIN"===i.kind)this.executeJOIN(e,t,i,n,r);else if("LEFT_JOIN"===i.kind)this.executeLEFT_JOIN(e,t,i,n,r);else if("FILTER"===i.kind){var o=this;this.executeSelectUnit(e,t,i.value,n,function(e){null!=e?g.checkFilters(i,e,!1,t,n,o,r):r([])})}else{if("EMPTY_PATTERN"!==i.kind)throw new s(i.kind);r([])}},QueryEngine.prototype.executeUNION=function(e,i,n,r,o){var s,a,l=n[0],u=n[1],c=null;if(2!=n.length)throw"SPARQL algebra UNION with more than two components";var d=this;v.seq(function(t){try{d.executeSelectUnit(e,i,l,r,function(e){s=e,t()})}catch(e){c=e,t()}},function(t){if(null==c)try{d.executeSelectUnit(e,i,u,r,function(e){a=e,t()})}catch(e){c=e,t()}else t()})(function(){if(null!=c)o(c);else{var e=f.unionBindings(s,a);d.runBinds(n.binds,e,i,r,function(e,t){if(null!=e)throw new m("Error processing bind expressions",n.binds,e);g.checkFilters(n,t,!1,i,r,d,o)})}})},QueryEngine.prototype.executeAndBGP=function(e,i,n,r,o){var s=this;f.executeAndBGPsDPSize(n.value,i,this,r,function(e){null!=e?s.runBinds(n.binds,e,i,r,function(e,t){if(null!=e)throw new m("Error processing bind expressions",n.binds,e);g.checkFilters(n,t,!1,i,r,s,o)}):o(null)})},QueryEngine.prototype.executeLEFT_JOIN=function(e,n,r,o,l){var i=r.lvalue,s=r.rvalue;if("EMPTY_PATTERN"===i.kind)this.executeSelectUnit(e,n,s,o,l);else{var u,c,d=null,h=null,a=null,p=this;v.seq(function(t){try{p.executeSelectUnit(e,n,i,o,function(e){d=e,t()})}catch(e){a=e,t()}},function(t){if(null!=a)t();else try{p.executeSelectUnit(e,n,s,o,function(e){h=e,t()})}catch(e){a=e,t()}})(function(){if(null!=a)l(a);else{var i=f.leftOuterJoinBindings(d,h);p.runBinds(r.binds,i,n,o,function(e,t){if(null!=e)throw new m("Error processing bind expressions",r.binds,e);g.checkFilters(r,i,!0,n,o,p,function(e){if(1<d.length&&1<h.length){var t=[],i={};for(var n in d[0])i[n]=!0;for(n in h[0])1!=i[n]&&t.push(n);u=[],c={};for(var r=0;r<e.length;r++)if(!0===e[r].__nullify__){for(var o=0;o<t.length;o++)e[r].bindings[t[o]]=null;var s=[],a=[];for(var n in e[r].bindings)null!=e[r].bindings[n]&&(s.push(n+e[r].bindings[n]),s.sort(),a.push(s.join("")));if(null==c[s.join("")]){for(o=0;o<a.length;o++)c[a[o]]=!0;u.push(e[r].bindings)}}else{u.push(e[r]);s=[],a=[];for(var n in e[r])s.push(n+e[r][n]),s.sort(),c[s.join("")]=!0}l(u)}else l(e)})})}})}},QueryEngine.prototype.executeJOIN=function(e,r,o,s,a){var l=o.lvalue,u=o.rvalue,c=null,d=null,h=null,p=this;v.seq(function(t){try{p.executeSelectUnit(e,r,l,s,function(e){c=e,t()})}catch(e){h=e,t()}},function(t){if(null!=h)t();else try{p.executeSelectUnit(e,r,u,s,function(e){d=e,t()})}catch(e){h=e,t()}})(function(){var e=null;if(null!=h)a(h);else if(0===c.length||0===d.length)a([]);else{var t={},i=[];for(var n in c[0])t[n]=!1;for(var n in d[0])!1===t[n]&&i.push(n);e=0==i.length?f.joinBindings(c,d):p.abstractQueryTree.treeWithUnion(l)||p.abstractQueryTree.treeWithUnion(u)?f.joinBindings(c,d):f.joinBindings2(i,c,d),p.runBinds(o.binds,e,r,s,function(e,t){if(null!=e)throw new m("Error processing bind expressions",o.binds,e);g.checkFilters(o,t,!1,r,s,p,a)})}})},QueryEngine.prototype.rangeQuery=function(e,t,i){var n=this;n.normalizeQuad(e,t,!1,function(e){null!=e?n.backend.range(new u.Pattern(e),function(e){null==e||0==e.length?i([]):i(e)}):i(null)})},QueryEngine.prototype.executeUpdate=function(e,i){var t=e.prologue,n=e.units,r=this,o={blanks:{},outCache:{}};this.registerNsInEnvironment(t,o);for(var s=0;s<n.length;s++){var a=r.abstractQueryTree.parseExecutableUnit(n[s]);if("insertdata"===a.kind){var l=null;v.eachSeries(a.quads,function(e,t){null===l?r._executeQuadInsert(e,o,function(e){null!=e&&(l=e),t()}):t()},function(){null===l?i(null,!0):i(l)})}else if("deletedata"===a.kind){l=null;v.eachSeries(a.quads,function(e,t){null===l?r._executeQuadDelete(e,o,function(e){null!=e&&(l=e),t()}):t()},function(){null===l?i(null,!0):i(l)})}else if("modify"===a.kind)this._executeModifyQuery(a,o,i);else if("create"===a.kind)i(!0);else if("load"===a.kind){var u={uri:c.lexicalFormBaseUri(a.sourceGraph,o)};null!=a.destinyGraph&&(u={uri:c.lexicalFormBaseUri(a.destinyGraph,o)});r=this;this.rdfLoader.load(a.sourceGraph.value,u,function(e,t){e?i(new Error("error batch loading quads")):r.batchLoad(t,function(e){null!==e?i(null,e):i(new Error("Error batch loading quads"))})})}else if("drop"===a.kind)this._executeClearGraph(a.destinyGraph,o,i);else{if("clear"!==a.kind)throw new Error("not supported execution unit");this._executeClearGraph(a.destinyGraph,o,i)}}},QueryEngine.prototype.batchLoad=function(e,t){var s=0,a={},l=this;this.eventsOnBatchLoad&&this.callbacksBackend.startGraphModification();v.eachSeries(e,function(n,r){var o={};v.eachSeries(["subject","predicate","object","graph"],function(e,t){!function(i,n,r,o){var e;if(i[n].uri||"uri"===i[n].token){var s=i[n].uri||i[n].value;l.lexicon.registerUri(s,function(e){var t=function(){null!=i[n].uri&&(i[n]={token:"uri",value:i[n].uri},delete i[n].uri),r[n]=e,o()};"graph"===n?l.lexicon.registerGraph(e,s,function(){t()}):t()})}else i[n].literal||"literal"===i[n].token?l.lexicon.registerLiteral(i[n].literal||i[n].value,function(e){null!=i[n].literal&&(i[n]=l.lexicon.parseLiteral(i[n].literal),delete i[n].literal),r[n]=e,o()}):null==(e=a[i[n].blank||i[n].value])?l.lexicon.registerBlank(function(e){a[i[n].blank||i[n].value]=e,null==i[n].token&&(i[n].token="blank",i[n].value=i[n].blank,delete i[n].blank),r[n]=e,o()}):(null==i[n].token&&(i[n].token="blank",i[n].value=i[n].blank,delete i[n].blank),r[n]=e,o())}(n,e,o,t)},function(){var t=n;n=o;var i=new u.NodeKey(n);l.backend.search(i,function(e){e?r():l.backend.index(i,function(e){e&&(l.eventsOnBatchLoad&&l.callbacksBackend.nextGraphModification(d.added,[t,n]),s+=1),r()})})})},function(){null!=l.lexicon.updateAfterWrite&&l.lexicon.updateAfterWrite();var e=function(){t(s)};l.eventsOnBatchLoad?l.callbacksBackend.endGraphModification(e()):e()})},QueryEngine.prototype._executeModifyQuery=function(c,d,e){var h=this,p=!0,o=new Error("Error executing modify query"),f=null,g=["subject","predicate","object","graph"];c.insert=null==c.insert?[]:c.insert,c.delete=null==c.delete?[]:c.delete,v.seq(function(i){var e=[],t=[];if(null!=c.with&&e.push(c.with),null!=c.using){t=[];for(var n=0;n<c.using.length;n++){var r=c.using[n];"named"===r.kind?t.push(r.uri):e.push(r.uri)}}c.dataset={},c.projection=[{token:"variable",kind:"*"}],h.executeSelect(c,d,e,t,function(e,t){if(e)return o=e,p=!1,i();h.denormalizeBindingsList(t,d,function(e){null!=e?f=e:(o=new Error("Error denormalizing bindings list"),p=!1),i()})})},function(e){var t=c.with;if(p){for(var i=[],n=0;n<c.delete.length;n++)for(var r=c.delete[n],o=0;o<f.length;o++){for(var s={},a=f[o],l=0;l<g.length;l++){var u=g[l];"graph"==u&&null==r[u]?s.graph=t:"var"===r[u].token?s[u]=a[r[u].value]:s[u]=r[u]}i.push(s)}v.eachSeries(i,function(e,t){h._executeQuadDelete(e,d,function(){t()})},function(){e()})}else e()},function(e){var t=c.with;if(p){for(var i=[],n=0;n<c.insert.length;n++)for(var r=c.insert[n],o=0;o<f.length;o++){for(var s={},a=f[o],l=0;l<g.length;l++){var u=g[l];"graph"==u&&null==r[u]?s.graph=t:"var"===r[u].token?s[u]=a[r[u].value]:s[u]=r[u]}i.push(s)}v.eachSeries(i,function(e,t){h._executeQuadInsert(e,d,function(){t()})},function(){e()})}else e()})(function(){e(p?null:o)})},QueryEngine.prototype._executeQuadInsert=function(n,e,t){var r,o=this,s=!1,i=null;v.seq(function(t){o.normalizeQuad(n,e,!0,function(e){null!=e?r=e:(s=!0,i="Error normalizing quad."),t()})},function(t){if(!1===s){var i=new u.NodeKey(r);o.backend.search(i,function(e){!0===e?t():o.backend.index(i,function(){o.callbacksBackend.nextGraphModification(d.added,[n,r]),t()})})}else t()})(function(){s?t(new Error(i)):t(null,!0)})},QueryEngine.prototype._executeQuadDelete=function(i,e,t){var n,r,o,s=this,a=!1;v.seq(function(t){s.normalizeQuad(i,e,!0,function(e){null!=e?n=e:(a=!0,r="Error normalizing quad."),t()})},function(e){!1===a?(o=new u.NodeKey(n),s.backend.delete(o,function(){e()})):e()},function(e){!1===a?s.lexicon.unregister(i,o,function(){s.callbacksBackend.nextGraphModification(d.deleted,[i,n]),e()}):e()})(function(){a?t(new Error(r)):t(null,!0)})},QueryEngine.prototype._executeClearGraph=function(e,t,i){var o=this;if("default"===e)this.execute("DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }",i);else if("named"===e)o.lexicon.registeredGraphs(!0,function(e){if(null!=e){var r=!1;v.eachSeries(e,function(i,n){r?n():o.execute("DELETE { GRAPH <"+i+"> { ?s ?p ?o } } WHERE { GRAPH <"+i+"> { ?s ?p ?o } }",function(e,t){e?(r=e,n()):o.lexicon.resolveUri(i,function(e){-1!=e?o.lexicon.knownGraphs.delete(e,function(){n()}):(r="Cannot find graph "+i+" to clear it",n())})})},function(){i(!r)})}else i(!1,"Error deleting named graphs")});else if("all"===e){o=this;this.execute("CLEAR DEFAULT",function(e,t){e?i(!1,t):o.execute("CLEAR NAMED",i)})}else if("uri"==e.token){var n=c.lexicalFormBaseUri(e,t);null!=n?(this.callbacksBackend.ongoingModification=!0,this.execute("DELETE { GRAPH <"+n+"> { ?s ?p ?o } } WHERE { GRAPH <"+n+"> { ?s ?p ?o } }",function(e){o.callbacksBackend.ongoingModification=!1,i(e)})):i(!1,"wrong graph URI")}else i(!1,"wrong graph URI")},QueryEngine.prototype.checkGroupSemantics=function(e,t){if("singleGroup"===e)return!0;for(var i={},n=0;n<e.length;n++){var r=e[n];"var"===r.token?i[r.value]=!0:"aliased_expression"===r.token&&(i[r.alias.value]=!0)}for(n=0;n<t.length;n++){var o=t[n];if("var"===o.kind){if(null==i[o.value.value])return!1}else if("aliased"===o.kind&&o.expression&&"var"===o.expression.primaryexpression&&null==i[o.expression.value.value])return!1}return!0},QueryEngine.prototype.runBinds=function(s,a,l,u,c){var d=this,h=a;null!=s&&0<s.length?d.copyDenormalizedBindings(a,u.outCache,function(e){for(var t=0;t<a.length;t++)for(var i=0;i<s.length;i++){var n=s[i],r=e[t],o=g.runFilter(n.expression,r,d,l,u);g.isEbvError(o)?c(o):h[t][n.as.value]=o}c(null,a)}):c(null,a)},QueryEngine.prototype.computeCosts=function(e,t,i){for(var n=0;n<e.length;n++)e[n]._cost=this.quadCost(e[n],t);i(e)},QueryEngine.prototype.quadCost=function(e,t){return 1},QueryEngine.prototype.registerDefaultNamespace=function(e,t){this.defaultPrefixes[e]=t},t.exports={QueryEngine:QueryEngine}},{"./abstract_query_tree":39,"./graph_callbacks":42,"./quad_index":50,"./query_filters":52,"./query_plan":53,"./rdf_loader":54,"./rdf_model":55,"./utils":57}],52:[function(e,t,i){var g=e("./utils"),d=g,h=e("./utils");QueryFilters={};var v="http://www.w3.org/2001/XMLSchema#";QueryFilters.checkFilters=function(e,o,t,i,n,s,r){var a=[];e.filter&&"function"!=typeof e.filter&&(a=e.filter);var l=[];if(null==a||0===a.length||null!=e.length)return r(o);QueryFilters.preprocessExistentialFilters(a,o,s,i,n,function(e){h.eachSeries(e,function(e,r){QueryFilters.run(e.value,o,t,i,n,s,function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];null!=n.__nullify__?l.push(n):t.push(n)}o=t,r()})},function(){r(o.concat(l))})})},QueryFilters.preprocessExistentialFilters=function(e,r,l,u,c,t){var o=[];h.eachSeries(e,function(t,i){if("builtincall"!==t.value.expressionType||"exists"!==t.value.builtincall&&"notexists"!==t.value.builtincall)if("conditionalor"===t.value.expressionType||"conditionaland"===t.value.expressionType){var e=d.map(t.value.operands,function(e){return{value:e}});QueryFilters.preprocessExistentialFilters(e,r,l,u,c,function(e){t.value.operands=e.map(function(e){return e.value}),o.push(t),i()})}else if("multiplicativeexpression"===t.value.expressionType){e=d.map(t.value.factors,function(e){return{value:e}});QueryFilters.preprocessExistentialFilters(e,r,l,u,c,function(e){t.value.factors=e.map(function(e){return e.value}),o.push(t),i()})}else if("additiveexpression"===t.value.expressionType){e=d.map(t.value.summands,function(e){return{value:e}});QueryFilters.preprocessExistentialFilters(e,r,l,u,c,function(e){t.value.summands=e.map(function(e){return e.value}),o.push(t),i()})}else if("relationalexpression"===t.value.expressionType){e=[{value:t.value.op1},{value:t.value.op2}];QueryFilters.preprocessExistentialFilters(e,r,l,u,c,function(e){t.value.op1=e[0].value,t.value.op2=e[1].value,o.push(t),i()})}else if("irireforfunction"===t.value.expressionType||"custom"===t.value.expressionType)if(null!=t.value.args){e=d.map(t.value.args,function(e){return{value:e}});QueryFilters.preprocessExistentialFilters(e,r,l,u,c,function(e){t.value.args=e.map(function(e){return e.value}),o.push(t),i()})}else o.push(t),i();else o.push(t),i();else{var s=t.value.builtincall,n=t.value.args,a={};l.copyDenormalizedBindings(r,c.outCache,function(e){h.eachSeries(e,function(r,o){var e=d.clone(n[0],!0),t=l.abstractQueryTree.parseSelect({pattern:e},r);t=l.abstractQueryTree.bind(t.pattern,r),l.executeSelectUnit([{kind:"*"}],u,t,c,function(e){var t=null;t="exists"===s?QueryFilters.ebvBoolean(0!==e.length):QueryFilters.ebvBoolean(0===e.length);var i=[];for(var n in r)i.push(JSON.stringify(r[n]));i=i.sort().join(""),a[i]=t,o()})},function(){t.value.origArgs=t.value.args,t.value.args=a,o.push(t),i()})})}},function(){t(o)})},QueryFilters.boundVars=function(e){if(null==e.expressionType)throw"Cannot find bound expressions in a no expression token";var t=e.expressionType;if("relationalexpression"==t){var i=e.op1,n=e.op2;return QueryFilters.boundVars(i)+QueryFilters.boundVars(n)}if("conditionalor"==t||"conditionaland"==t){for(var r=[],o=0;o<e.operands;o++)r=r.concat(QueryFilters.boundVars(e.operands[o]));return r}if("builtincall"==t){if(null==e.args)return[];var s=[];for(o=0;o<e.args.length;o++)s=s.concat(QueryFilters.boundVars(e.args[o]));return s}if("multiplicativeexpression"==t){var s=QueryFilters.boundVars(e.factor);for(o=0;o<e.factors.length;o++)s=s.concat(QueryFilters.boundVars(e.factors[o].expression));return s}if("additiveexpression"!=t)return"regex"==t?(s=QueryFilters.boundVars(e.expression1)).concat(QueryFilters.boundVars(e.expression2)):"unaryexpression"==t?QueryFilters.boundVars(e.expression):"atomic"==t?"var"==e.primaryexpression?[e.value]:[]:void 0;for(s=QueryFilters.boundVars(e.summand),o=0;o<e.summands.length;o++)s=s.concat(QueryFilters.boundVars(e.summands[o].expression));return s},QueryFilters.run=function(s,a,l,u,c,d,h){d.copyDenormalizedBindings(a,c.outCache,function(e){for(var t=[],i=0;i<a.length;i++){var n=e[i],r=QueryFilters.runFilter(s,n,d,u,c);r=QueryFilters.ebv(r);if(QueryFilters.isEbvError(r)){if(l){var o={__nullify__:!0,bindings:a[i]};t.push(o)}}else if(!0===r)t.push(a[i]);else if(l){o={__nullify__:!0,bindings:a[i]};t.push(o)}}h(t)})},QueryFilters.collect=function(o,s,a,l,u,c){u.copyDenormalizedBindings(s,l.outCache,function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r=QueryFilters.runFilter(o,n,u,a,l);t.push({binding:s[i],value:r})}return c(t)})},QueryFilters.runDistinct=function(e,t){},QueryFilters.runAggregator=function(e,t,i,n,r){if(null==t||0===t.length)return QueryFilters.ebvError();if("variable"===e.token&&"var"==e.kind)return t[0][e.value.value];if("variable"===e.token&&"aliased"===e.kind){if("atomic"===e.expression.expressionType&&"var"===e.expression.primaryexpression)return t[0][e.expression.value.value];if("aggregate"===e.expression.expressionType){if("max"===e.expression.aggregateType){for(var o=null,s=0;s<t.length;s++){var a=t[s],l=QueryFilters.runFilter(e.expression.expression,a,i,n,r);QueryFilters.isEbvError(l)||(null===o?o=l:!0===QueryFilters.runLtFunction(o,l).value&&(o=l))}return null===o?QueryFilters.ebvError():o}if("min"===e.expression.aggregateType){var u=null;for(s=0;s<t.length;s++){a=t[s],l=QueryFilters.runFilter(e.expression.expression,a,i,n,r);QueryFilters.isEbvError(l)||(null===u?u=l:!0===QueryFilters.runGtFunction(u,l).value&&(u=l))}return null===u?QueryFilters.ebvError():u}if("count"===e.expression.aggregateType){var c={},d=0;if("*"===e.expression.expression)if(null!=e.expression.distinct&&""!=e.expression.distinct)for(s=0;s<t.length;s++){a=t[s];null==c[f=g.hashTerm(a)]&&(c[f]=!0,d++)}else d=t.length;else for(s=0;s<t.length;s++){a=t[s],l=QueryFilters.runFilter(e.expression.expression,a,i,n,r);if(!QueryFilters.isEbvError(l))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==c[f=g.hashTerm(l)]&&(c[f]=!0,d++);else d++}return{token:"literal",type:v+"integer",value:""+d}}if("avg"===e.expression.aggregateType){c={};var h={token:"literal",type:v+"integer",value:"0"};for(d=0,s=0;s<t.length;s++){a=t[s],l=QueryFilters.runFilter(e.expression.expression,a,i,n,r);if(!QueryFilters.isEbvError(l))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==c[f=g.hashTerm(l)]&&(c[f]=!0,QueryFilters.isNumeric(l)&&(h=QueryFilters.runSumFunction(h,l),d++));else QueryFilters.isNumeric(l)&&(h=QueryFilters.runSumFunction(h,l),d++)}var p=QueryFilters.runDivFunction(h,{token:"literal",type:v+"integer",value:""+d});return p.value=""+p.value,p}if("sum"!==e.expression.aggregateType)return l=QueryFilters.runFilter(aggregate.expression,t[0],n,{blanks:{},outCache:{}});for(c={},h={token:"literal",type:v+"integer",value:"0"},s=0;s<t.length;s++){a=t[s];var f,l=QueryFilters.runFilter(e.expression.expression,a,i,n,r);if(!QueryFilters.isEbvError(l))if(null!=e.expression.distinct&&""!=e.expression.distinct)null==c[f=g.hashTerm(l)]&&(c[f]=!0,QueryFilters.isNumeric(l)&&(h=QueryFilters.runSumFunction(h,l)));else QueryFilters.isNumeric(l)&&(h=QueryFilters.runSumFunction(h,l))}return h.value=""+h.value,h}}},QueryFilters.runFilter=function(e,t,i,n,r){if(null==e.expressionType)throw"Cannot find bound expressions in a no expression token";var o=e.expressionType;if("relationalexpression"==o){var s=QueryFilters.runFilter(e.op1,t,i,n,r),a=QueryFilters.runFilter(e.op2,t,i,n,r);return QueryFilters.runRelationalFilter(e,s,a,t,i,n,r)}if("conditionalor"==o)return QueryFilters.runOrFunction(e,t,i,n,r);if("conditionaland"==o)return QueryFilters.runAndFunction(e,t,i,n,r);if("additiveexpression"==o)return QueryFilters.runAddition(e.summand,e.summands,t,i,n,r);if("builtincall"==o)return QueryFilters.runBuiltInCall(e.builtincall,e.args,t,i,n,r);if("multiplicativeexpression"==o)return QueryFilters.runMultiplication(e.factor,e.factors,t,i,n,r);if("unaryexpression"==o)return QueryFilters.runUnaryExpression(e.unaryexpression,e.expression,t,i,n,r);if("irireforfunction"==o)return QueryFilters.runIriRefOrFunction(e.iriref,e.args,t,i,n,r);if("regex"==o)return QueryFilters.runRegex(e.text,e.pattern,e.flags,t,i,n,r);if("custom"==o)return QueryFilters.runBuiltInCall(e.name,e.args,t,i,n,r);if("atomic"==o)return"var"==e.primaryexpression?t[e.value.value]:("object"!=typeof e.value||null==e.value.type||"object"!=typeof e.value.type||(e.value.type=g.lexicalFormBaseUri(e.value.type,r)),e.value);throw"Unknown filter expression type"},QueryFilters.isRDFTerm=function(e){return null!=e&&!!(e.token&&"literal"==e.token||e.token&&"uri"==e.token||e.token&&"blank"==e.token)},QueryFilters.RDFTermEquality=function(e,t,i,n){return"literal"===e.token&&"literal"===t.token?e.lang==t.lang&&e.type==t.type&&e.value==t.value||(null!=e.type&&null!=t.type?QueryFilters.ebvError():QueryFilters.isSimpleLiteral(e)&&null!=t.type?QueryFilters.ebvError():!(!QueryFilters.isSimpleLiteral(t)||null==e.type)&&QueryFilters.ebvError()):"uri"===e.token&&"uri"===t.token?g.lexicalFormBaseUri(e,n)==g.lexicalFormBaseUri(t,n):"blank"===e.token&&"blank"===t.token&&e.value==t.value},QueryFilters.isInteger=function(e){return null!=e&&("literal"===e.token&&(e.type==v+"integer"||e.type==v+"decimal"||e.type==v+"double"||e.type==v+"nonPositiveInteger"||e.type==v+"negativeInteger"||e.type==v+"long"||e.type==v+"int"||e.type==v+"short"||e.type==v+"byte"||e.type==v+"nonNegativeInteger"||e.type==v+"unsignedLong"||e.type==v+"unsignedInt"||e.type==v+"unsignedShort"||e.type==v+"unsignedByte"||e.type==v+"positiveInteger"))},QueryFilters.isFloat=function(e){return null!=e&&("literal"===e.token&&e.type==v+"float")},QueryFilters.isDecimal=function(e){return null!=e&&("literal"===e.token&&e.type==v+"decimal")},QueryFilters.isDouble=function(e){return null!=e&&("literal"===e.token&&e.type==v+"double")},QueryFilters.isNumeric=function(e){return null!=e&&("literal"===e.token&&(e.type==v+"integer"||e.type==v+"decimal"||e.type==v+"float"||e.type==v+"double"||e.type==v+"nonPositiveInteger"||e.type==v+"negativeInteger"||e.type==v+"long"||e.type==v+"int"||e.type==v+"short"||e.type==v+"byte"||e.type==v+"nonNegativeInteger"||e.type==v+"unsignedLong"||e.type==v+"unsignedInt"||e.type==v+"unsignedShort"||e.type==v+"unsignedByte"||e.type==v+"positiveInteger"))},QueryFilters.isSimpleLiteral=function(e){return!(!e||"literal"!=e.token)&&(null==e.type&&null==e.lang)},QueryFilters.isXsdType=function(e,t){return!(!t||"literal"!=t.token)&&t.type==v+""+e},QueryFilters.ebv=function(e){if(null==e||QueryFilters.isEbvError(e))return QueryFilters.ebvError();if(e.token&&"literal"===e.token){if(e.type!=v+"integer"&&e.type!=v+"decimal"&&e.type!=v+"double"&&e.type!=v+"nonPositiveInteger"&&e.type!=v+"negativeInteger"&&e.type!=v+"long"&&e.type!=v+"int"&&e.type!=v+"short"&&e.type!=v+"byte"&&e.type!=v+"nonNegativeInteger"&&e.type!=v+"unsignedLong"&&e.type!=v+"unsignedInt"&&e.type!=v+"unsignedShort"&&e.type!=v+"unsignedByte"&&e.type!=v+"positiveInteger")return e.type===v+"boolean"?"true"===e.value||!0===e.value||"True"===e.value:e.type===v+"string"?""!=e.value:e.type===v+"dateTime"?null!=new Date(e.value):QueryFilters.isEbvError(e)?e:null==e.type?""!=e.value:QueryFilters.ebvError();var t=parseFloat(e.value);return!isNaN(t)&&0!=parseFloat(e.value)}return!0===e.value},QueryFilters.effectiveBooleanValue=QueryFilters.ebv,QueryFilters.ebvTrue=function(){return{token:"literal",type:v+"boolean",value:!0}},QueryFilters.ebvFalse=function(){return{token:"literal",type:v+"boolean",value:!1}},QueryFilters.ebvError=function(){return{token:"literal",type:"https://github.com/antoniogarrote/js-tools/types#error",value:null}},QueryFilters.isEbvError=function(e){return"object"==typeof e&&null!=e&&"https://github.com/antoniogarrote/js-tools/types#error"===e.type},QueryFilters.ebvBoolean=function(e){return QueryFilters.isEbvError(e)?e:!0===e?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.runRelationalFilter=function(e,t,i,n,r,o,s){var a=e.operator;if("="===a)return QueryFilters.runEqualityFunction(t,i,n,r,o,s);if("!="===a){var l=QueryFilters.runEqualityFunction(t,i,n,r,o,s);return QueryFilters.isEbvError(l)||(l.value=!l.value),l}if("<"===a)return QueryFilters.runLtFunction(t,i,n);if(">"===a)return QueryFilters.runGtFunction(t,i,n);if("<="===a)return QueryFilters.runLtEqFunction(t,i,n);if(">="===a)return QueryFilters.runGtEqFunction(t,i,n);throw"Error applying relational filter, unknown operator"},QueryFilters.effectiveTypeValue=function(e){if("literal"!=e.token)throw console.log("not implemented yet"),console.log(e),"value not supported in operations yet";if(e.type==v+"integer")return parseInt(e.value);if(e.type==v+"decimal")return parseFloat(e.value);if(e.type==v+"float")return parseFloat(e.value);if(e.type==v+"double")return parseFloat(e.value);if(e.type==v+"nonPositiveInteger")return parseFloat(e.value);if(e.type==v+"negativeInteger")return parseInt(e.value);if(e.type==v+"long")return parseInt(e.value);if(e.type==v+"int")return parseInt(e.value);if(e.type==v+"short")return parseInt(e.value);if(e.type==v+"byte")return parseInt(e.value);if(e.type==v+"nonNegativeInteger")return parseInt(e.value);if(e.type==v+"unsignedLong")return parseInt(e.value);if(e.type==v+"unsignedInt")return parseInt(e.value);if(e.type==v+"unsignedShort")return parseInt(e.value);if(e.type==v+"unsignedByte")return parseInt(e.value);if(e.type==v+"positiveInteger")return parseInt(e.value);if(e.type!=v+"date"&&e.type!=v+"dateTime")return e.type==v+"boolean"?!0===e.value||"true"===e.value||"1"===e.value||1===e.value||!0===e.value||!1!==e.value&&"false"!==e.value&&"0"!==e.value&&0!==e.value&&!1!==e.value&&void 0:e.type==v+"string"?null===e.value||void 0===e.value?void 0:""+e.value:(e.type,e.value);try{return g.parseISO8601(e.value)}catch(e){return null}},QueryFilters.runOrFunction=function(e,t,i,n,r){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,i,n,r);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o||QueryFilters.ebvError():!0===a?o=!0:QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError())}return QueryFilters.ebvBoolean(o)},QueryFilters.runAndFunction=function(e,t,i,n,r){for(var o=null,s=0;s<e.operands.length;s++){var a=QueryFilters.runFilter(e.operands[s],t,i,n,r);0==QueryFilters.isEbvError(a)&&(a=QueryFilters.ebv(a)),null==o?o=a:QueryFilters.isEbvError(a)?o=QueryFilters.isEbvError(o)?QueryFilters.ebvError():!0===o&&QueryFilters.ebvError():!0===a?QueryFilters.isEbvError(o)&&(o=QueryFilters.ebvError()):o=!1}return QueryFilters.ebvBoolean(o)},QueryFilters.runEqualityFunction=function(e,t,i,n,r,o){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)){var s=QueryFilters.effectiveTypeValue(e),a=QueryFilters.effectiveTypeValue(t);return isNaN(s)||isNaN(a)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,n,o)):QueryFilters.ebvBoolean(s==a)}if((QueryFilters.isSimpleLiteral(e)||QueryFilters.isXsdType("string",e))&&(QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",t)))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)==QueryFilters.effectiveTypeValue(t));if(!QueryFilters.isXsdType("dateTime",e)&&!QueryFilters.isXsdType("date",e)||!QueryFilters.isXsdType("dateTime",t)&&!QueryFilters.isXsdType("date",t))return QueryFilters.isRDFTerm(e)&&QueryFilters.isRDFTerm(t)?QueryFilters.ebvBoolean(QueryFilters.RDFTermEquality(e,t,n,o)):QueryFilters.ebvFalse();if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var l=g.compareDateComponents(e.value,t.value);return null!=l?0==l?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()},QueryFilters.runGtFunction=function(e,t,i){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>QueryFilters.effectiveTypeValue(t));if(!QueryFilters.isXsdType("dateTime",e)&&!QueryFilters.isXsdType("date",e)||!QueryFilters.isXsdType("dateTime",t)&&!QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var n=g.compareDateComponents(e.value,t.value);return null!=n?1==n?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()},QueryFilters.runTotalGtFunction=function(e,t){return QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t)?QueryFilters.ebvError():QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t)||QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t)||QueryFilters.isXsdType("string",e)&&QueryFilters.isSimpleLiteral("string",t)||QueryFilters.isXsdType("boolean",e)&&QueryFilters.isSimpleLiteral("boolean",t)||QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isSimpleLiteral("dateTime",t)?QueryFilters.runGtFunction(e,t,[]):e.token&&"uri"===e.token&&t.token&&"uri"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.token&&"literal"===e.token&&t.token&&"literal"===t.token?QueryFilters.ebvBoolean(""+e.value+e.type+e.lang>""+t.value+t.type+t.lang):e.token&&"blank"===e.token&&t.token&&"blank"===t.token?QueryFilters.ebvBoolean(e.value>t.value):e.value&&t.value?QueryFilters.ebvBoolean(e.value>t.value):QueryFilters.ebvTrue()},QueryFilters.runLtFunction=function(e,t,i){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<QueryFilters.effectiveTypeValue(t));if(!QueryFilters.isXsdType("dateTime",e)&&!QueryFilters.isXsdType("date",e)||!QueryFilters.isXsdType("dateTime",t)&&!QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var n=g.compareDateComponents(e.value,t.value);return null!=n?-1==n?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()},QueryFilters.runGtEqFunction=function(e,t,i){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)>=QueryFilters.effectiveTypeValue(t));if(!QueryFilters.isXsdType("dateTime",e)&&!QueryFilters.isXsdType("date",e)||!QueryFilters.isXsdType("dateTime",t)&&!QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var n=g.compareDateComponents(e.value,t.value);return null!=n?-1!=n?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()},QueryFilters.runLtEqFunction=function(e,t,i){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();if(QueryFilters.isNumeric(e)&&QueryFilters.isNumeric(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isSimpleLiteral(e)&&QueryFilters.isSimpleLiteral(t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("string",e)&&QueryFilters.isXsdType("string",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(QueryFilters.isXsdType("boolean",e)&&QueryFilters.isXsdType("boolean",t))return QueryFilters.ebvBoolean(QueryFilters.effectiveTypeValue(e)<=QueryFilters.effectiveTypeValue(t));if(!QueryFilters.isXsdType("dateTime",e)&&!QueryFilters.isXsdType("date",e)||!QueryFilters.isXsdType("dateTime",t)&&!QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("dateTime",e)&&QueryFilters.isXsdType("date",t))return QueryFilters.ebvFalse();if(QueryFilters.isXsdType("date",e)&&QueryFilters.isXsdType("dateTime",t))return QueryFilters.ebvFalse();var n=g.compareDateComponents(e.value,t.value);return null!=n?1!=n?QueryFilters.ebvTrue():QueryFilters.ebvFalse():QueryFilters.ebvError()},QueryFilters.runAddition=function(e,t,i,n,r,o){var s=QueryFilters.runFilter(e,i,n,r,o);if(QueryFilters.isEbvError(s))return QueryFilters.ebvError();var a=s;if(QueryFilters.isNumeric(s)){for(var l=0;l<t.length;l++){var u=QueryFilters.runFilter(t[l].expression,i,n,r,o);if(!QueryFilters.isNumeric(u))return QueryFilters.ebvFalse();"+"===t[l].operator?a=QueryFilters.runSumFunction(a,u):"-"===t[l].operator&&(a=QueryFilters.runSubFunction(a,u))}return a}return QueryFilters.ebvFalse()},QueryFilters.runSumFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var i=QueryFilters.effectiveTypeValue(e)+QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:v+"double",value:i}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:v+"float",value:i}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:v+"decimal",value:i}:{token:"literal",type:v+"integer",value:i}},QueryFilters.runSubFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var i=QueryFilters.effectiveTypeValue(e)-QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:v+"double",value:i}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:v+"float",value:i}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:v+"decimal",value:i}:{token:"literal",type:v+"integer",value:i}},QueryFilters.runMultiplication=function(e,t,i,n,r,o){var s=QueryFilters.runFilter(e,i,n,r,o);if(QueryFilters.isEbvError(s))return s;var a=s;if(QueryFilters.isNumeric(s)){for(var l=0;l<t.length;l++){var u=QueryFilters.runFilter(t[l].expression,i,n,r,o);if(QueryFilters.isEbvError(u))return s;if(!QueryFilters.isNumeric(u))return QueryFilters.ebvFalse();"*"===t[l].operator?a=QueryFilters.runMulFunction(a,u):"/"===t[l].operator&&(a=QueryFilters.runDivFunction(a,u))}return a}return QueryFilters.ebvFalse()},QueryFilters.runMulFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var i=QueryFilters.effectiveTypeValue(e)*QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:v+"double",value:i}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:v+"float",value:i}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:v+"decimal",value:i}:{token:"literal",type:v+"integer",value:i}},QueryFilters.runDivFunction=function(e,t){if(QueryFilters.isEbvError(e)||QueryFilters.isEbvError(t))return QueryFilters.ebvError();var i=QueryFilters.effectiveTypeValue(e)/QueryFilters.effectiveTypeValue(t);return QueryFilters.isDouble(e)||QueryFilters.isDouble(t)?{token:"literal",type:v+"double",value:i}:QueryFilters.isFloat(e)||QueryFilters.isFloat(t)?{token:"literal",type:v+"float",value:i}:QueryFilters.isDecimal(e)||QueryFilters.isDecimal(t)?{token:"literal",type:v+"decimal",value:i}:{token:"literal",type:v+"integer",value:i}},QueryFilters.runBuiltInCall=function(e,t,i,n,r,o){if("notexists"===e||"exists"===e){var s=[];for(var a in i)s.push(JSON.stringify(i[a]));return t[s=s.sort().join("")]}for(var l=[],u=0;u<t.length;u++)if("var"===t[u].token)l.push(t[u]);else{var c=QueryFilters.runFilter(t[u],i,n,r,o);if(QueryFilters.isEbvError(c))return c;l.push(c)}if("str"===e)return"literal"===l[0].token?{token:"literal",type:null,value:""+l[0].value}:"uri"===l[0].token?{token:"literal",type:null,value:l[0].value}:QueryFilters.ebvFalse();if("lang"===e)return"literal"===l[0].token?null!=l[0].lang?{token:"literal",value:""+l[0].lang}:{token:"literal",value:""}:QueryFilters.ebvError();if("datatype"===e){if("literal"!==l[0].token)return QueryFilters.ebvError();var d=l[0];return null!=d.type?"string"==typeof d.type?{token:"uri",value:d.type,prefix:null,suffix:null}:d.type:null==d.lang?{token:"uri",value:"http://www.w3.org/2001/XMLSchema#string",prefix:null,suffix:null}:QueryFilters.ebvError()}if("isliteral"===e)return"literal"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isblank"===e)return"blank"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("isuri"===e||"isiri"===e)return"uri"===l[0].token?QueryFilters.ebvTrue():QueryFilters.ebvFalse();if("sameterm"===e){var h=l[0],p=l[1],f=QueryFilters.RDFTermEquality(h,p,n,o);return QueryFilters.isEbvError(f)&&(f=!1),QueryFilters.ebvBoolean(f)}if("langmatches"===e){var g=l[0],v=l[1];return"literal"===g.token&&"literal"===v.token?"*"===v.value&&""!=g.value?QueryFilters.ebvTrue():QueryFilters.ebvBoolean(0===g.value.toLowerCase().indexOf(v.value.toLowerCase())):QueryFilters.ebvError()}if("bound"===e){var m=l[0].value;return null==m?QueryFilters.ebvError():null!=i[m]?QueryFilters.ebvTrue():QueryFilters.ebvFalse()}if(null!=n.customFns[e])return n.customFns[e](QueryFilters,l);throw"Builtin call "+e+" not implemented yet"},QueryFilters.runUnaryExpression=function(e,t,i,n,r,o){var s=QueryFilters.runFilter(t,i,n,r,o);if(QueryFilters.isEbvError(s))return s;if("!"===e){var a=QueryFilters.ebv(s);return QueryFilters.isEbvError(a)?QueryFilters.ebvFalse():(a=!a,QueryFilters.ebvBoolean(a))}if("+"===e)return QueryFilters.isNumeric(s)?s:QueryFilters.ebvError();if("-"===e){if(QueryFilters.isNumeric(s)){var l={};for(var u in s)l[u]=s[u];return l.value=-l.value,l}return QueryFilters.ebvError()}},QueryFilters.runRegex=function(e,t,i,n,r,o,s){if(null==e)return QueryFilters.ebvError();if(e=QueryFilters.runFilter(e,n,r,o,s),null==t)return QueryFilters.ebvError();if(t=QueryFilters.runFilter(t,n,r,o,s),null!=i&&(i=QueryFilters.runFilter(i,n,r,o,s)),null==t||"literal"!==t.token||null!=i&&"literal"!==i.token)return QueryFilters.ebvError();if(t=t.value,i=null==i?null:i.value,null!=e&&"var"==e.token){if(null==n[e.value])return QueryFilters.ebvError();e=n[e.value]}else{if(null==e||"literal"!==e.token)return QueryFilters.ebvError();if(null!=e.type&&!QueryFilters.isXsdType("string",e))return QueryFilters.ebvError();e=e.value}return(null==i?new RegExp(t):new RegExp(t,i.toLowerCase())).exec(e)?QueryFilters.ebvTrue():QueryFilters.ebvFalse()},QueryFilters.normalizeLiteralDatatype=function(e,t,i){return null==e.value.type||"object"!=typeof e.value.type||(e.value.type=g.lexicalFormBaseUri(e.value.type,i)),e},QueryFilters.runIriRefOrFunction=function(e,t,i,n,r,o){if(null==t)return e;for(var s=[],a=0;a<t.length;a++)s.push(QueryFilters.runFilter(t[a],i,n,r,o));var l=g.lexicalFormBaseUri(e,o);if(l==v+"integer"||l==v+"decimal"||l==v+"double"||l==v+"nonPositiveInteger"||l==v+"negativeInteger"||l==v+"long"||l==v+"int"||l==v+"short"||l==v+"byte"||l==v+"nonNegativeInteger"||l==v+"unsignedLong"||l==v+"unsignedInt"||l==v+"unsignedShort"||l==v+"unsignedByte"||l==v+"positiveInteger"){if("literal"!==(u=s[0]).token)return QueryFilters.ebvError();if((u=QueryFilters.normalizeLiteralDatatype(u,n,o)).type==v+"integer"||u.type==v+"decimal"||u.type==v+"double"||u.type==v+"nonPositiveInteger"||u.type==v+"negativeInteger"||u.type==v+"long"||u.type==v+"int"||u.type==v+"short"||u.type==v+"byte"||u.type==v+"nonNegativeInteger"||u.type==v+"unsignedLong"||u.type==v+"unsignedInt"||u.type==v+"unsignedShort"||u.type==v+"unsignedByte"||u.type==v+"positiveInteger")return u.type=l,u;if("http://www.w3.org/2001/XMLSchema#boolean"==u.type)return 1==QueryFilters.ebv(u)?(u.type=l,u.value=1):(u.type=l,u.value=0),u;if("http://www.w3.org/2001/XMLSchema#float"==u.type||"http://www.w3.org/2001/XMLSchema#double"==u.type)return u.type=l,u.value=parseInt(u.value),u;if("http://www.w3.org/2001/XMLSchema#string"!=u.type&&null!=u.type)return QueryFilters.ebvError();if(2<u.value.split(".").length)return QueryFilters.ebvError();if(2<u.value.split("-").length)return QueryFilters.ebvError();if(2<u.value.split("/").length)return QueryFilters.ebvError();if(2<u.value.split("+").length)return QueryFilters.ebvError();if(l==v+"decimal"&&(-1!=u.value.indexOf("e")||-1!=u.value.indexOf("E")))return QueryFilters.ebvError();if(!(l!=v+"int"&&l!=v+"integer"||-1==u.value.indexOf("e")&&-1==u.value.indexOf("E")&&-1==u.value.indexOf(".")))return QueryFilters.ebvError();try{return u.value=parseInt(parseFloat(u.value)),isNaN(u.value)?QueryFilters.ebvError():(u.type=l,u)}catch(e){return QueryFilters.ebvError()}}else{if(l==v+"boolean")return"literal"===(u=s[0]).token&&null==u.type?"true"===u.value||"1"===u.value?QueryFilters.ebvTrue():"false"===u.value||"0"===u.value?QueryFilters.ebvFalse():QueryFilters.ebvError():"literal"===u.token?QueryFilters.isEbvError(u)?u:QueryFilters.ebvBoolean(u):QueryFilters.ebvError();if(l==v+"string")return"literal"===(u=s[0]).token?(u=QueryFilters.normalizeLiteralDatatype(u,n,o)).type==v+"integer"||u.type==v+"decimal"||u.type==v+"double"||u.type==v+"nonPositiveInteger"||u.type==v+"negativeInteger"||u.type==v+"long"||u.type==v+"int"||u.type==v+"short"||u.type==v+"byte"||u.type==v+"nonNegativeInteger"||u.type==v+"unsignedLong"||u.type==v+"unsignedInt"||u.type==v+"unsignedShort"||u.type==v+"unsignedByte"||u.type==v+"positiveInteger"||u.type==v+"float"?(u.type=l,u.value=""+u.value,u):u.type==v+"string"?u:u.type==v+"boolean"?(QueryFilters.ebv(u)?(u.type=l,u.value="true"):(u.type=l,u.value="false"),u):u.type==v+"dateTime"||u.type==v+"date"?(u.type=l,"string"!=typeof u.value&&(u.value=g.iso8601(u.value)),u):null==u.type?(u.value=""+u.value,u.type=l,u):QueryFilters.ebvError():"uri"===u.token?{token:"literal",value:g.lexicalFormBaseUri(u,o),type:l,lang:null}:QueryFilters.ebvError();if(l==v+"dateTime"||l==v+"date"){if((u=s[0]).type==v+"dateTime"||u.type==v+"date")return u;if(u.type!=v+"string"&&null!=u.type)return QueryFilters.ebvError();try{return u.value=g.iso8601(g.parseISO8601(u.value)),u.type=l,u}catch(e){return QueryFilters.ebvError()}}else{if(l!=v+"float")return null!=n.customFns[l]?n.customFns[l](QueryFilters,s):QueryFilters.ebvError();var u;if("literal"!==(u=s[0]).token)return QueryFilters.ebvError();if("http://www.w3.org/2001/XMLSchema#decimal"==(u=QueryFilters.normalizeLiteralDatatype(u,n,o)).type||"http://www.w3.org/2001/XMLSchema#int"==u.type)return u.type=l,u.value=parseFloat(u.value),u;if("http://www.w3.org/2001/XMLSchema#boolean"==u.type)return 1==QueryFilters.ebv(u)?(u.type=l,u.value=1):(u.type=l,u.value=0),u;if("http://www.w3.org/2001/XMLSchema#float"==u.type||"http://www.w3.org/2001/XMLSchema#double"==u.type)return u.type=l,u.value=parseFloat(u.value),u;if("http://www.w3.org/2001/XMLSchema#string"==u.type)try{return u.value=parseFloat(u.value),isNaN(u.value)?QueryFilters.ebvError():(u.type=l,u)}catch(e){return QueryFilters.ebvError()}else{if(null!=u.type)return QueryFilters.ebvError();if(2<u.value.split(".").length)return QueryFilters.ebvError();if(2<u.value.split("-").length)return QueryFilters.ebvError();if(2<u.value.split("/").length)return QueryFilters.ebvError();if(2<u.value.split("+").length)return QueryFilters.ebvError();try{return u.value=parseFloat(u.value),isNaN(u.value)?QueryFilters.ebvError():(u.type=l,u)}catch(e){return QueryFilters.ebvError()}}}}},t.exports={QueryFilters:QueryFilters}},{"./utils":57}],53:[function(e,t,i){var p=e("./utils"),c=e("./utils"),E={variablesInBGP:function(e){var t=e.variables;if(t)return t;var i=e.value||e;for(var n in t=[],i)i[n]&&"var"===i[n].token?t.push(i[n].value):i[n]&&"blank"===i[n].token&&t.push("blank:"+i[n].value);return e.variables=t},connected:function(e,t){for(var i="/"+e.vars.join("/")+"/",n=0;n<t.vars.length;n++)if(-1!=i.indexOf("/"+t.vars[n]+"/"))return!0;return!1}};E.variablesIntersectionBGP=function(e,t){return function(e,t){for(var i={},n=0;n<e.lenght;n++)i[e[n]]=1;for(n=0;n<t.length;n++){var r=i[t[n]]||0;r++,i[t[n]]=r}var o=[];for(var s in i)2==i[s]&&o.push(i[s]);return o}(E.variablesInBGP(e),E.variablesInBGP(t))},E.executeAndBGPsGroups=function(e){for(var l={},u={},t=0,i=function(e,t){for(var i=0;i<e.length;i++){var n="/"+e[i]+"/";if(-1!=t.indexOf(n))return!0}return!1},n=function(e,t,i,n){var r=[],o="",s="";for(var a in t)o+=a,r=r.concat(l[a]),s+=u[a];s=s+c.join("/")+"/",r.push(e),i[o]=r,n[o]=s},r=0;r<e.length;r++){var o=e[r],s={},a={},c=E.variablesInBGP(o),d={};for(var h in u)i(c,u[h])?d[h]=!0:(s[h]=l[h],a[h]=u[h]);0===p.size(d)?(s["g"+t]=[o],a["g"+t]="/"+c.join("/")+"/",t++):n(o,d,s,a),l=s,u=a}return p.values(l)},E.intersectionSize=function(e,t){for(var i=t.i.split("_"),n=0;n<i.length;n++)if(""!=i[n]&&-1!=e.i.indexOf("_"+i[n]+"_"))return 1;return 0},E.createJoinTree=function(e,t){for(var i="/"+e.vars.join("/")+"/",n=e.vars.concat([]),r=[],o=0;o<t.vars.length;o++)-1!=i.indexOf("/"+t.vars[o]+"/")?0==t.vars[o].indexOf("_:")?r.push("blank:"+t.vars[o]):r.push(t.vars[o]):n.push(t.vars[o]);var s=t.i.split("_"),a=e.i.split("_"),l={};for(o=0;o<s.length;o++)""!=s[o]&&(l[s[o]]=!0);for(o=0;o<a.length;o++)""!=a[o]&&(l[a[o]]=!0);var u=p.keys(l);return{left:e,right:t,cost:e.cost+t.cost,i:"_"+u.sort().join("_")+"_",vars:n,join:r}},E.executeBushyTree=function(i,e,n,r,o){null==i.left?E.executeEmptyJoinBGP(i.right,e,n,r,o):null==i.right?E.executeEmptyJoinBGP(i.left,e,n,r,o):E.executeBushyTree(i.left,e,n,r,function(t){null!=t?E.executeBushyTree(i.right,e,n,r,function(e){o(null!=e?E.joinBindings2(i.join,t,e):null)}):o(null)})},E.executeAndBGPsDPSize=function(e,n,r,o,t){var i=E.executeAndBGPsGroups(e),C=[];c.eachSeries(i,function(e,F){r.computeCosts(e,o,function(e){var t={},i={},n={},r=1,o=null,s={};n[1]=[];for(var a=0;a<e.length;a++){var l=[];for(var u in delete e[a].variables,e[a])"_cost"!=u&&("var"===e[a][u].token?l.push(e[a][u].value):"blank"===e[a][u].token&&l.push(e[a][u].value));i["_"+a+"_"]={left:e[a],right:null,cost:e[a]._cost,i:"_"+a+"_",vars:l};var c={left:e[a],right:null,cost:e[a]._cost,i:"_"+a+"_",vars:l};t["_"+a+"_"]=c,delete e[a]._cost,s["_"+a+"_"]=!0,n[1].push("_"+a+"_"),(null==o||o.cost>c.cost)&&(o=c)}for(var d=2;d<=e.length;d++)for(var h=1;h<d;h++){var p=d-h,f=n[""+h]||[],g=n[""+p]||[];for(a=0;a<f.length;a++)for(var v=0;v<g.length;v++)if(f[a]!==g[v]){var m=i[f[a]],y=i[g[v]];if(0==E.intersectionSize(m,y)&&E.connected(m,y)){r=d;var b=t[m.i],w=t[y.i],x=E.createJoinTree(b,w);if(!s[x.i]){s[x.i]=!0;var k=x.cost+1;null!=t[x.i]&&(k=t[x.i].cost);var _=n[d]||[];_.push(x.i),i[x.i]=x,n[d]=_,k>x.cost&&(r===d&&(o=x),t[x.i]=x)}}}}C.push(o),F()})},function(){var i=null;c.eachSeries(C,function(e,t){E.executeBushyTree(e,n,r,o,function(e){e?(i=null==i?e:E.crossProductBindings(i,e),t()):t("Error executing bushy tree")})},function(e){e?t(null,e):t(i)})})},E.executeEmptyJoinBGP=function(e,t,i,n,r){return E.executeBGPDatasets(e,t,i,n,r)},E.executeBGPDatasets=function(r,e,o,s,t){var a={};if(null==r.graph){var l=[];c.eachSeries(e.implicit,function(e,t){null==a[e.oid]?(a[e.oid]=!0,r.graph=e,o.rangeQuery(r,s,function(e){e=E.buildBindingsFromRange(e,r),l.push(e),t()})):t()},function(){var e=E.unionManyBindings(l);t(e)})}else if("var"===r.graph.token){var u=r.graph.value;l=[];c.eachSeries(e.named,function(i,n){null==a[i.oid]?(a[i.oid]=!0,r.graph=i,null!=l?o.rangeQuery(r,s,function(e){if(null!=e){e=E.buildBindingsFromRange(e,r);for(var t=0;t<e.length;t++)e[t][u]=i.oid;l.push(e)}else l=null;n()}):n()):n()},function(){if(null==l)t(null);else{var e=E.unionManyBindings(l);t(e)}})}else o.rangeQuery(r,s,function(e){null!=e?(e=E.buildBindingsFromRange(e,r),t(e)):t(null)})},E.buildBindingsFromRange=function(e,t){E.variablesInBGP(t);var i=t.value||t,n={};for(u in i)i[u]&&"var"===i[u].token?n[u]=i[u].value:i[u]&&"blank"===i[u].token&&(n[u]="blank:"+i[u].value);var r=[];if(null!=e)for(var o=0;o<e.length;o++){var s={},a=e[o],l=!1;for(var u in n){var c=a[u];if(null!=s[n[u]]&&s[n[u]]!==c){l=!0;break}s[n[u]]=c}l||r.push(s)}return r},E.areCompatibleBindings=function(e,t){for(var i in e)if(null!=t[i]&&t[i]!=e[i])return!1;return!0},E.mergeBindings=function(e,t){var i={};for(var n in e)i[n]=e[n];for(var n in t)i[n]=t[n];return i},E.joinBindings2=function(e,t,i){for(var n,r,o,s,a={},l=[],u=0;u<t.length;u++){n=t[u],s=a;for(var c=0;c<e.length;c++)r=n[e[c]],c==e.length-1?((o=s[r]||[]).push(n),s[r]=o):(o=s[r]||{},s[r]=o,s=o)}for(u=0;u<i.length;u++){n=i[u],s=a;for(c=0;c<e.length;c++)if(null!=s[r=n[e[c]]])if(c==e.length-1)for(var d=0;d<s[r].length;d++)l.push(E.mergeBindings(s[r][d],n));else s=s[r]}return l},E.joinBindings=function(e,t){for(var i=[],n=0;n<e.length;n++)for(var r=e[n],o=0;o<t.length;o++){var s=t[o];E.areCompatibleBindings(r,s)&&i.push(E.mergeBindings(r,s))}return i},E.augmentMissingBindings=function(e,t){for(var i in t)null==e[i]&&(e[i]=null);return e},E.leftOuterJoinBindings=function(e,t){for(var i=[],n=0;n<e.length;n++){for(var r=e[n],o=!1,s=0;s<t.length;s++){var a=t[s];E.areCompatibleBindings(r,a)&&(o=!0,i.push(E.mergeBindings(r,a)))}!1===o&&(E.augmentMissingBindings(r,a),i.push(r))}return i},E.crossProductBindings=function(e,t){for(var i=[],n=0;n<e.length;n++)for(var r=e[n],o=0;o<t.length;o++){var s=t[o];i.push(E.mergeBindings(r,s))}return i},E.unionBindings=function(e,t){return e.concat(t)},E.unionManyBindings=function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];t=E.unionBindings(t,n)}return t},t.exports={QueryPlan:E}},{"./utils":57}],54:[function(e,t,i){var n=e("./network_transport").NetworkTransport,r=e("./rvn3_parser").RVN3Parser,o=e("./jsonld_parser").JSONLDParser,s=e("./utils"),a=function(e){if(this.precedences=["text/turtle","text/n3","application/ld+json","application/json"],this.parsers={"text/turtle":r.parser,"text/n3":r.parser,"application/ld+json":o.parser,"application/json":o.parser},void 0!==RDFXMLParser&&(this.precedences.push("application/rdf+xml"),this.parsers["application/rdf+xml"]=RDFXMLParser.parser),null!=e)for(var t in e.parsers)this.parsers[t]=e.parsers[t];if(e&&null!=e.precedences)for(var t in this.precedences=e.precedences,e.parsers)s.include(this.precedences,t)||this.precedences.push(t);this.acceptHeaderValue="";for(var i=0;i<this.precedences.length;i++)this.acceptHeaderValue=0!=i?this.acceptHeaderValue+","+this.precedences[i]:this.acceptHeaderValue+this.precedences[i]};a.prototype.registerParser=function(e,t){this.parsers[e]=t,this.precedences.push(e)},a.prototype.unregisterParser=function(e){delete this.parsers[e];for(var t=[],i=0;i<this.precedences.length;i++)this.precedences[i]!=e&&t.push(this.precedences[i]);this.precedences=t},a.prototype.setAcceptHeaderPrecedence=function(e){this.precedences=e},a.prototype.load=function(s,a,l){var u=this;n.load(s,this.acceptHeaderValue,function(e,t){if(e)l(e);else{var i=t.headers["Content-Type"]||t.headers["content-type"],n=t.data;if(null!=i){for(var r in i=i.split(";")[0],u.parsers)if(-1!=r.indexOf("/")){var o=r.split("/");if("*"===o[1]){if(-1!=i.indexOf(o[0]))return u.tryToParse(u.parsers[r],a,n,{documentURI:s},l)}else{if(-1!=i.indexOf(r))return u.tryToParse(u.parsers[r],a,n,{documentURI:s},l);if(-1!=i.indexOf(o[1]))return u.tryToParse(u.parsers[r],a,n,{documentURI:s},l)}}else if(-1!=i.indexOf(r))return u.tryToParse(u.parsers[r],a,n,{documentURI:s},l);l(new Error("Unknown media type : "+i))}else l(new Error("Uknown media type"))}})},a.prototype.loadFromFile=function(i,n,r,o){try{var s=this;e("fs").readFile(r.split("file:/")[1],function(e,t){if(e)o(e);else{t=t.toString("utf8");s.tryToParse(i,n,t,{documentURI:r},o)}})}catch(e){o(e)}},a.prototype.tryToParse=function(e,t,i,n,r){try{"string"==typeof i&&(i=s.normalizeUnicodeLiterals(i)),e.parse(i,t,n,r)}catch(e){console.log(e.message),console.log(e.stack),r(e)}},t.exports={RDFLoader:a}},{"./jsonld_parser":43,"./network_transport":45,"./rvn3_parser":56,"./utils":57,fs:5}],55:[function(e,t,i){var n=e("./utils"),r=e("./query_filters").QueryFilters;RDFModel={defaultContext:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dcterms:"http://purl.org/dc/terms/",foaf:"http://xmlns.com/foaf/0.1/",cal:"http://www.w3.org/2002/12/cal/ical#",vcard:"http://www.w3.org/2006/vcard/ns# ",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",cc:"http://creativecommons.org/ns#",sioc:"http://rdfs.org/sioc/ns#",doap:"http://usefulinc.com/ns/doap#",com:"http://purl.org/commerce#",ps:"http://purl.org/payswarm#",gr:"http://purl.org/goodrelations/v1#",sig:"http://purl.org/signature#",ccard:"http://purl.org/commerce/creditcard#",ldp:"http://www.w3.org/ns/ldp#"},UrisMap:function(){this.defaultNs="",this.interfaceProperties=["get","remove","set","setDefault","addAll","resolve","shrink"]}},RDFModel.UrisMap.prototype.values=function(){var e={};for(var t in this)n.include(this.interfaceProperties,t)||"function"==typeof this[t]||"defaultNs"===t||"interfaceProperties"===t||(e[t]=this[t]);return e},RDFModel.UrisMap.prototype.get=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return this[e]},RDFModel.UrisMap.prototype.remove=function(e){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";return delete this[e],null},RDFModel.UrisMap.prototype.set=function(e,t){if(-1!=e.indexOf(" "))throw"Prefix must not contain any whitespaces";this[e]=t},RDFModel.UrisMap.prototype.setDefault=function(e){this.defaultNs=e},RDFModel.UrisMap.prototype.addAll=function(e,t){for(var i in e)n.include(this.interfaceProperties,i)||(null!=this[i]?!0===t&&(this[i]=e[i]):this[i]=e[i]);return this},RDFModel.UrisMap.prototype.resolve=function(e){var t=e.split(":"),i=t[0],n=t[1];return""===i?null==this.defaultNs?null:this.defaultNs+n:null!=this[i]?this[i]+n:null},RDFModel.UrisMap.prototype.shrink=function(e){for(var t in this){var i=this[t];if(0===e.indexOf(i))if(""!==i&&"defaultNs"!=t)return t+":"+e.split(i)[1]}return e},RDFModel.Profile=function(){this.prefixes=new RDFModel.UrisMap,this.terms=new RDFModel.UrisMap},RDFModel.Profile.prototype.importProfile=function(e,t){this.prefixes.addAll(e.prefixes,t),this.terms.addAll(e.terms,t)},RDFModel.Profile.prototype.resolve=function(e){return-1!=e.indexOf(":")?this.prefixes.resolve(e):null!=this.terms[e]?this.terms.resolve(e):null},RDFModel.Profile.prototype.setDefaultPrefix=function(e){this.prefixes.setDefault(e)},RDFModel.Profile.prototype.setDefaultVocabulary=function(e){this.terms.setDefault(e)},RDFModel.Profile.prototype.setPrefix=function(e,t){this.prefixes.set(e,t)},RDFModel.Profile.prototype.setTerm=function(e,t){this.terms.set(e,t)},RDFModel.RDFEnvironment=function(){RDFModel.Profile.call(this),this.blankNodeCounter=0;var e=this;for(var t in this.filters={s:function(t){return function(e){return e.subject.equals(t)}},p:function(t){return function(e){return e.predicate.equals(t)}},o:function(t){return function(e){return e.object.equals(t)}},sp:function(t,i){return function(e){return e.subject.equals(t)&&e.predicate.equals(i)}},so:function(t,i){return function(e){return e.subject.equals(t)&&e.object.equals(i)}},po:function(t,i){return function(e){return e.predicate.equals(t)&&e.object.equals(i)}},spo:function(t,i,n){return function(e){return e.subject.equals(t)&&e.predicate.equals(i)&&e.object.equals(n)}},describes:function(t){return function(e){return e.subject.equals(t)||e.object.equals(t)}},type:function(t){var i=e.resolve("rdf:type");return function(e){return e.predicate.equals(i)&&e.object.equals(t)}}},RDFModel.defaultContext)this.prefixes.set(t,RDFModel.defaultContext[t])},RDFModel.RDFEnvironment.prototype=n.create(RDFModel.Profile.prototype,{constructor:RDFModel.RDFEnvironment}),RDFModel.RDFEnvironment.prototype.createBlankNode=function(){var e=new RDFModel.BlankNode(this.blankNodeCounter);return this.blankNodeCounter++,e},RDFModel.RDFEnvironment.prototype.createNamedNode=function(e){var t=this.resolve(e);return null!=t?new RDFModel.NamedNode(t):new RDFModel.NamedNode(e)},RDFModel.RDFEnvironment.prototype.createLiteral=function(e,t,i){return null!=i?new RDFModel.Literal(e,t,i.toString()):new RDFModel.Literal(e,t,i)},RDFModel.RDFEnvironment.prototype.createTriple=function(e,t,i){return new RDFModel.Triple(e,t,i)},RDFModel.RDFEnvironment.prototype.createGraph=function(e){var t=new RDFModel.Graph;if(null!=e)for(var i=0;i<e.length;i++)t.add(e[i]);return t},RDFModel.RDFEnvironment.prototype.createAction=function(t,i){return function(e){return t(e)?i(e):e}},RDFModel.RDFEnvironment.prototype.createProfile=function(e){if(!0===e)return new RDFModel.RDFEnvironment.Profile;var t=new RDFModel.RDFEnvironment.Profile;return t.importProfile(this),t},RDFModel.RDFEnvironment.prototype.createTermMap=function(e){if(!0===e)return new RDFModel.UrisMap;var t=this.terms.values(),i=new RDFModel.UrisMap;for(var n in t)i[n]=t[n];return i},RDFModel.RDFEnvironment.prototype.createPrefixMap=function(e){if(!0===e)return new RDFModel.UrisMap;var t=this.prefixes.values(),i=new RDFModel.UrisMap;for(var n in t)i[n]=t[n];return i},RDFModel.RDFNode=function(e){this.interfaceName=e,this.attributes=["interfaceName","nominalValue"]},RDFModel.RDFNode.prototype.equals=function(e){if(null==e.interfaceName)return this.valueOf()==e;for(var t in this.attributes){var i=this.attributes[t];if(this[i]!=e[i])return!1}return!0},RDFModel.BlankNode=function(e){RDFModel.RDFNode.call(this,"BlankNode"),this.nominalValue="_:"+e,this.bnodeId=e},RDFModel.BlankNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.BlankNode}),RDFModel.BlankNode.prototype.toString=function(){return this.nominalValue},RDFModel.BlankNode.prototype.toNT=function(){return this.nominalValue},RDFModel.BlankNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Literal=function(e,t,i){RDFModel.RDFNode.call(this,"Literal");var n=e.replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\\\/g,"\\");this.nominalValue=n,null!=t?this.language=t:null!=i&&(this.datatype=i)},RDFModel.Literal.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.Literal}),RDFModel.Literal.prototype.toString=function(e){var t=this.nominalValue;e&&(t=t.replace(/\\/g,"\\\\").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\"/g,'\\"'));t='"'+t+'"';return null!=this.language?t=t+"@"+this.language:(null!=this.datatype||this.type)&&(t=t+"^^<"+(this.datatype||this.type)+">"),t},RDFModel.Literal.prototype.toNT=function(){return this.toString(!0)},RDFModel.Literal.prototype.valueOf=function(){return r.effectiveTypeValue({token:"literal",type:this.type||this.datatype,value:this.nominalValue,language:this.language})},RDFModel.NamedNode=function(e){RDFModel.RDFNode.call(this,"NamedNode"),null!=e.value?this.nominalValue=e.value:this.nominalValue=e},RDFModel.NamedNode.prototype=n.create(RDFModel.RDFNode.prototype,{constructor:RDFModel.NamedNode}),RDFModel.NamedNode.prototype.toString=function(){return this.nominalValue},RDFModel.NamedNode.prototype.toNT=function(){return"<"+this.toString()+">"},RDFModel.NamedNode.prototype.valueOf=function(){return this.nominalValue},RDFModel.Triple=function(e,t,i){this.subject=e,this.predicate=t,this.object=i},RDFModel.Triple.prototype.equals=function(e){return this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)},RDFModel.Triple.prototype.toString=function(){return this.subject.toNT()+" "+this.predicate.toNT()+" "+this.object.toNT()+" . \r\n"},RDFModel.Graph=function(){this.triples=[],this.duplicates={},this.actions=[],this.length=0},RDFModel.Graph.prototype.add=function(e){for(var t=0;t<this.actions.length;t++)e=this.actions[t](e);var i=e.subject.toString()+e.predicate.toString()+e.object.toString();return this.duplicates[i]||(this.duplicates[i]=!0,this.triples.push(e)),this.length=this.triples.length,this},RDFModel.Graph.prototype.addAction=function(e,t){if(this.actions.push(e),1==t)for(var i=0;i<this.triples.length;i++)this.triples[i]=e(this.triples[i]);return this},RDFModel.Graph.prototype.addAll=function(e){for(var t=e.toArray(),i=0;i<t.length;i++)this.add(t[i]);return this.length=this.triples.length,this},RDFModel.Graph.prototype.remove=function(e){for(var t=null,i=0;i<this.triples.length;i++)if(this.triples[i].equals(e)){var n=e.subject.toString()+e.predicate.toString()+e.object.toString();delete this.duplicates[n],t=i;break}return null!=t&&this.triples.splice(t,1),this.length=this.triples.length,this},RDFModel.Graph.prototype.toArray=function(){return this.triples},RDFModel.Graph.prototype.some=function(e){for(var t=0;t<this.triples.length;t++)if(!0===e(this.triples[t],this))return!0;return!1},RDFModel.Graph.prototype.every=function(e){for(var t=0;t<this.triples.length;t++)if(!1===e(this.triples[t],this))return!1;return!0},RDFModel.Graph.prototype.filter=function(e){for(var t=new RDFModel.Graph,i=0;i<this.triples.length;i++)!0===e(this.triples[i],this)&&t.add(this.triples[i]);return t},RDFModel.Graph.prototype.forEach=function(e){for(var t=0;t<this.triples.length;t++)e(this.triples[t],this)},RDFModel.Graph.prototype.merge=function(e){for(var t=new RDFModel.Graph,i=0;i<this.triples.length;i++)t.add(this.triples[i]);return t},RDFModel.Graph.prototype.match=function(e,t,i,n){for(var r=new RDFModel.Graph,o=0,s=0;s<this.triples.length;s++){var a=this.triples[s];if((null==e||a.subject.equals(e))&&(null==t||a.predicate.equals(t))&&(null==i||a.object.equals(i))){if(!(null==n||o<n))return r;o++,r.add(a)}}return r},RDFModel.Graph.prototype.removeMatches=function(e,t,i){for(var n=[],r=0;r<this.triples.length;r++){var o=this.triples[r];(null==e||o.subject.equals(e))&&(null==t||o.predicate.equals(t))&&(null==i||o.object.equals(i))&&n.push(o)}for(r=0;r<n.length;r++)this.remove(n[r]);return this},RDFModel.Graph.prototype.toNT=function(){var t="";return this.forEach(function(e){t+=e.toString()}),t},RDFModel.buildRDFResource=function(e,t,i,n){if("blank"===e.token)return RDFModel.buildBlankNode(e,t,i,n);if("literal"===e.token)return RDFModel.buildLiteral(e,t,i,n);if("uri"===e.token)return RDFModel.buildNamedNode(e,t,i,n);if("var"!==e.token)return null;var r=t[e.value];return null!=r?RDFModel.buildRDFResource(r,t,i,n):null},RDFModel.buildBlankNode=function(e,t,i,n){return null!=e.valuetmp&&(e.value=e.valuetmp),0===e.value.indexOf("_:")&&(e.value=e.value.split("_:")[1]),new RDFModel.BlankNode(e.value)},RDFModel.buildLiteral=function(e,t,i,n){return new RDFModel.Literal(e.value,e.lang,e.type)},RDFModel.buildNamedNode=function(e,t,i,n){if(null!=e.value)return new RDFModel.NamedNode(e);if(null==e.prefix)return new RDFModel.NamedNode(e);var r=i.resolveNsInEnvironment(e.prefix,n);return e.value=r+e.suffix,new RDFModel.NamedNode(e)},RDFModel.rdf=new RDFModel.RDFEnvironment,t.exports=RDFModel},{"./query_filters":52,"./utils":57}],56:[function(e,t,i){var o=e("n3").Parser,n={};function s(e){switch(e[0]){case'"':if(0<e.indexOf("^^")){var t=e.split("^^");return{literal:t[0]+"^^<"+t[1]+">"}}return{literal:e};case"_":return{blank:e.replace("b","")};default:return{token:"uri",value:e,prefix:null,suffix:null}}}n.parser={async:!0,parse:function(e,i,t,n){n||(n=t,t=i,i=null),i&&"string"==typeof i&&(i={token:"uri",value:i,prefix:null,suffix:null}),t&&t.baseURI&&(t.documentIRI=t.baseURI);var r=[];new o(t).parse(e,function(e,t){e?n(e):t?r.push({subject:s(t.subject),predicate:s(t.predicate),object:s(t.object),graph:i}):n(!1,r)})},resetBlankNodeIds:function(){o._resetBlankNodeIds()}},t.exports={RVN3Parser:n}},{n3:27}],57:[function(_dereq_,module,exports){(function(process){var slowNextTick=void 0!==process&&process.nextTick?process.nextTick:"undefined"!=typeof window&&window.setImmediate?window.setImmediate:function(e){setTimeout(e,0)},spin=0,yieldFrequency=100,nextTick=function(e){++spin<yieldFrequency?e():(spin=0,slowNextTick(e))},hashTerm=function(t){try{if(null==t)return"";if("uri"===t.token)return"u"+t.value;if("blank"===t.token)return"b"+t.value;if("literal"===t.token){var e="l"+t.value;return e+=t.type||"",e+=t.lang||""}}catch(e){if("object"!=typeof t)return t;var i="";for(p in t)i=i+p+t[p];return i}},lexicalFormBaseUri=function(e,t){var i=null;if(t=t||{},null==e.value){var n=e.prefix,r=e.suffix,o=t.namespaces[n];i=null!=o?o+r:n+":"+r}else i=e.value;return null===i?null:(-1==i.indexOf(":")&&(i=(t.base||"")+i),i)};parseISO8601=function(e){return Date.parse(e)},Date.prototype.toISOString||function(){function e(e){return e<10?"0"+e:e}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),iso8601=function(e){return e.toISOString()},compareDateComponents=function(e,t){var i=parseISO8601(e),n=parseISO8601(t);return i==n?0:i<n?-1:1},lexicalFormLiteral=function(e,t){var i=e.value,n=e.lang,r=e.type,o=null;if(null!=i&&null!=r&&"string"!=typeof r){var s=r.value;if(null==s){var a=r.prefix,l=r.suffix,u=t.namespaces[a];e.type=u+l,s=u+l}o='"'+e.value+'"^^<'+s+">"}else o=null==n&&null==r?'"'+i+'"':null==r?'"'+i+'"@'+n:'"'+e.value+'"^^<'+r+">";return o},normalizeUnicodeLiterals=function(string){for(var escapedUnicode=string.match(/\\u[0-9abcdefABCDEF]{4,4}/g)||[],dups={},i=0;i<escapedUnicode.length;i++)null==dups[escapedUnicode[i]]&&(dups[escapedUnicode[i]]=!0,string=string.replace(new RegExp("\\"+escapedUnicode[i],"g"),eval("'"+escapedUnicode[i]+"'")));return string},registerIndexedDB=function(e){if("undefined"==typeof window&&void 0!==process&&!1===process.browser){var t=_dereq_("sqlite3"),i=_dereq_("indexeddb-js"),n=new t.Database(":memory:"),r=i.makeScope("sqlite3",n);e.indexedDB=r.indexedDB,e.IDBKeyRange=r.IDBKeyRange}else{var o;(o="undefined"==typeof window?self:window).indexedDB=o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,o.IDBKeyRange=o.IDBKeyRange||o.webkitIDBKeyRange||o.msIDBKeyRange,o.indexedDB?(e.indexedDB=o.indexedDB,e.IDBKeyRange=o.IDBKeyRange):console.log("The browser does not support IndexDB.")}},guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},hashTerm=function(t){try{if(null==t)return"";if("uri"===t.token)return"u"+t.value;if("blank"===t.token)return"b"+t.value;if("literal"===t.token){var e="l"+t.value;return e+=t.type||"",e+=t.lang||""}}catch(e){if("object"!=typeof t)return t;var i="";for(p in t)i=i+p+t[p];return i}};var reject=function(e,t){for(var i=[],n=0;n<e.length;n++)t(e[n])&&i.push(e[n]);return i},include=function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return!0;return!1},each=function(e,t){if(e.forEach)e.forEach(t);else for(var i=0;i<e.length;i++)t(e[i])},map=function(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n]);return i},keys=function(e){var t=[];for(var i in e)t.push(i);return t},values=function(e){var t=[];for(var i in e)t.push(e[i]);return t},size=function(e){if(e.length)return e.length;var t=0;for(var i in e)t++;return t};clone=function(e){return JSON.parse(JSON.stringify(e))};var isObject=function(e){var t=typeof e;return"function"==t||e&&"object"==t||!1},create=function(){function i(){}return function(e){if(isObject(e)){i.prototype=e;var t=new i;i.prototype=null}return t||void 0}}(),whilst=function(t,i,n){t()?i(function(e){if(e)return n(e);whilst(t,i,n)}):n()},eachSeries=function(t,e,i){if(i=i||function(){},!t.length)return i();var n=0,r=function(){e(t[n],function(e){e?(i(e),i=function(){}):(n+=1)>=t.length?i():nextTick(r)})};r()},eachParallel=function(t,e,i){if(i=i||function(){},!t.length)return i();for(var n=!1,r=0,o=function(e){if(e)throw n=!0,new Error(e);n||++r===t.length&&i()},s=0;s<t.length;s++)!function(e,t,i,n){nextTick(function(){try{n(e[t],function(){i()})}catch(e){i(e)}})}(t,s,o,e)},reduce=function(e,n,t,i){eachSeries(e,function(e,i){t(n,e,function(e,t){n=t,i(e)})},function(e){i(e,n)})},seq=function(){var t=arguments;return function(){var n=this,e=Array.prototype.slice.call(arguments),i=e.pop();reduce(t,e,function(e,t,i){t.apply(n,e.concat([function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);i(e,t)}]))},function(e,t){i.apply(n,[e].concat(t))})}},isWorker=function(){return(void 0===process||!0===process.browser)&&"undefined"==typeof window};module.exports={isWorker:isWorker,nextTick:nextTick,hasTerm:hashTerm,lexicalFormBaseUri:lexicalFormBaseUri,parseISO8601:parseISO8601,compareDateComponents:compareDateComponents,iso8601:iso8601,normalizeUnicodeLiterals:normalizeUnicodeLiterals,lexicalFormLiteral:lexicalFormLiteral,registerIndexedDB:registerIndexedDB,guid:guid,hashTerm:hashTerm,keys:keys,values:values,size:size,map:map,each:each,forEach:each,include:include,reject:reject,remove:reject,clone:clone,create:create,whilst:whilst,eachSeries:eachSeries,eachParallel:eachParallel,seq:seq,yieldFrequency:function(e){yieldFrequency=e}}}).call(this,_dereq_("7YKIPe"))},{"7YKIPe":10}]},{},[41])(41)});var TabulatorRDFXMLParser=function(){var y=function(e,t){var i=t.indexOf("#");if(0<i&&(t=t.slice(0,i)),0==e.length)return t;if(0==e.indexOf("#"))return t+e;if(0<=e.indexOf(":"))return e;var n=t.indexOf(":");if(""==t)return e;if(n<0)throw"Invalid Base URI";var r,o=t.slice(0,n+1);if(0==e.indexOf("//"))return o+e;if(t.indexOf("//",n)==n+1){if((r=t.indexOf("/",n+3))<0)return 0<t.length-n-3?t+"/"+e:o+e}else if((r=t.indexOf("/",n+1))<0)return 0<t.length-n-1?t+"/"+e:o+e;if(0==e.indexOf("/"))return t.slice(0,r)+e;var s=t.slice(r),a=s.lastIndexOf("/");if(a<0)return o+e;for(0<=a&&a<s.length-1&&(s=s.slice(0,a+1)),s+=e;s.match(/[^\/]*\/\.\.\//);)s=s.replace(/[^\/]*\/\.\.\//,"");return s=(s=s.replace(/\.\//g,"")).replace(/\/\.$/,"/"),t.slice(0,r)+s},o=function(e){var m={ns:{RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},nodeType:{ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12}};this.frameFactory=function(e,t,i){return{NODE:1,ARC:2,parent:t,parser:e,store:e.store,element:i,lastChild:0,base:null,lang:null,node:null,nodeType:null,listIndex:1,rdfid:null,datatype:null,collection:!1,terminateFrame:function(){this.collection&&this.node.close()},addSymbol:function(e,t){t=y(t,this.base),this.node=this.store.sym(t),this.nodeType=e},loadTriple:function(){if(this.parent.parent.collection?this.parent.parent.node.append(this.node):this.store.add(this.parent.parent.node,this.parent.node,this.node,this.parser.why),null!=this.parent.rdfid){var e=this.store.sym(y("#"+this.parent.rdfid,this.base));this.store.add(e,this.store.sym(m.ns.RDF+"type"),this.store.sym(m.ns.RDF+"Statement"),this.parser.why),this.store.add(e,this.store.sym(m.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.store.add(e,this.store.sym(m.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.store.add(e,this.store.sym(m.ns.RDF+"object"),this.node,this.parser.why)}},isTripleToLoad:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType==this.NODE&&this.parent.nodeType==this.ARC&&this.parent.parent.nodeType==this.NODE},addNode:function(e){this.addSymbol(this.NODE,e),this.isTripleToLoad()&&this.loadTriple()},addCollection:function(){this.nodeType=this.NODE,this.node=this.store.collection(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()},addCollectionArc:function(){this.nodeType=this.ARC},addBNode:function(e){null!=e?null!=this.parser.bnodes[e]?this.node=this.parser.bnodes[e]:this.node=this.parser.bnodes[e]=this.store.bnode():this.node=this.store.bnode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()},addArc:function(e){e==m.ns.RDF+"li"&&(e=m.ns.RDF+"_"+this.parent.listIndex++),this.addSymbol(this.ARC,e)},addLiteral:function(e){this.parent.datatype?this.node=this.store.literal(e,"",this.store.sym(this.parent.datatype)):this.node=this.store.literal(e,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}},this.getAttributeNodeNS=function(e,t,i){var n=null;if(e.getAttributeNodeNS)n=e.getAttributeNodeNS(t,i);else for(var r,o=e.attributes,s=0;s<o.length;++s)if((r=o[s]).namespaceURI==t&&(r.prefix?r.prefix+":"+i:i)==r.nodeName){n=r;break}return n},this.store=e,this.bnodes={},this.why=null,this.reify=!1,this.parse=function(e,t,i){var n=e.childNodes;if(this.cleanParser(),e.nodeType==m.nodeType.DOCUMENT){for(var r=0;r<n.length;r++)if(n[r].nodeType==m.nodeType.ELEMENT){var o=n[r];break}}else{if(e.nodeType!=m.nodeType.ELEMENT)throw new Error("RDFParser: can't find root in "+t+". Halting. ");o=e}this.why=i;var s=this.frameFactory(this);return this.base=t,s.base=t,s.lang="",this.parseDOM(this.buildFrame(s,o)),!0},this.parseDOM=function(e){for(var t=function(e){var t="";return e.namespaceURI&&(t+=e.namespaceURI),e.localName?t+=e.localName:e.nodeName&&(0<=e.nodeName.indexOf(":")?t+=e.nodeName.split(":")[1]:t+=e.nodeName),t},i=!0;e.parent;){var n=e.element,r=n.attributes;if(n.nodeType==m.nodeType.TEXT||n.nodeType==m.nodeType.CDATA_SECTION)e.addLiteral(n.nodeValue);else if(t(n)!=m.ns.RDF+"RDF")if(e.parent&&e.parent.collection&&(e.addCollectionArc(),(e=this.buildFrame(e,e.element)).parent.element=null),e.parent&&e.parent.nodeType&&e.parent.nodeType!=e.ARC){if(e.addArc(t(n)),this.reify)(d=this.getAttributeNodeNS(n,m.ns.RDF,"ID"))&&(e.rdfid=d.nodeValue,n.removeAttributeNode(d));var o=this.getAttributeNodeNS(n,m.ns.RDF,"parseType"),s=this.getAttributeNodeNS(n,m.ns.RDF,"datatype");if(s&&(e.datatype=s.nodeValue,n.removeAttributeNode(s)),o){var a=o.nodeValue;"Literal"==a?(e.datatype=m.ns.RDF+"XMLLiteral",(e=this.buildFrame(e)).addLiteral(n),i=!1):"Resource"==a?((e=this.buildFrame(e,e.element)).parent.element=null,e.addBNode()):"Collection"==a&&((e=this.buildFrame(e,e.element)).parent.element=null,e.addCollection()),n.removeAttributeNode(o)}if(0!=r.length){var l=this.getAttributeNodeNS(n,m.ns.RDF,"resource");h=this.getAttributeNodeNS(n,m.ns.RDF,"nodeID");e=this.buildFrame(e),l?(e.addNode(l.nodeValue),n.removeAttributeNode(l)):h?(e.addBNode(h.nodeValue),n.removeAttributeNode(h)):e.addBNode();for(f=r.length-1;0<=f;f--){var u=this.buildFrame(e);u.addArc(t(r[f])),t(r[f])==m.ns.RDF+"type"?this.buildFrame(u).addNode(r[f].nodeValue):this.buildFrame(u).addLiteral(r[f].nodeValue)}}else 0==n.childNodes.length&&this.buildFrame(e).addLiteral("")}else{var c=this.getAttributeNodeNS(n,m.ns.RDF,"about"),d=this.getAttributeNodeNS(n,m.ns.RDF,"ID");if(c&&d)throw new Error("RDFParser: "+n.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(null==c&&d)e.addNode("#"+d.nodeValue),n.removeAttributeNode(d);else if(null==c&&null==d){var h;(h=this.getAttributeNodeNS(n,m.ns.RDF,"nodeID"))?(e.addBNode(h.nodeValue),n.removeAttributeNode(h)):e.addBNode()}else e.addNode(c.nodeValue),n.removeAttributeNode(c);var p=this.getAttributeNodeNS(n,m.ns.RDF,"type");m.ns.RDF+"Description"!=t(n)&&(p={nodeValue:t(n)}),null!=p&&(this.store.add(e.node,this.store.sym(m.ns.RDF+"type"),this.store.sym(y(p.nodeValue,e.base)),this.why),p.nodeName&&n.removeAttributeNode(p));for(var f=r.length-1;0<=f;f--)this.store.add(e.node,this.store.sym(t(r[f])),this.store.literal(r[f].nodeValue,e.lang),this.why)}for(n=e.element;e.parent;){for(var g=e;null==n;)n=(e=e.parent).element;var v=n.childNodes[e.lastChild];if(null!=v&&i){if((v.nodeType==m.nodeType.ELEMENT||v.nodeType==m.nodeType.TEXT||v.nodeType==m.nodeType.CDATA_SECTION)&&(v.nodeType!=m.nodeType.TEXT&&v.nodeType!=m.nodeType.CDATA_SECTION||1==n.childNodes.length)){e.lastChild++,e=this.buildFrame(g,n.childNodes[e.lastChild-1]);break}e.lastChild++}else{if(e.terminateFrame(),!(e=e.parent))break;n=e.element,i=!0}}}},this.cleanParser=function(){this.bnodes={},this.why=null},this.buildFrame=function(e,t){var i=this.frameFactory(this,e,t);if(e&&(i.base=e.base,i.lang=e.lang),null==t||t.nodeType==m.nodeType.TEXT||t.nodeType==m.nodeType.CDATA_SECTION)return i;var n=t.attributes,r=t.getAttributeNode("xml:base");null!=r&&(i.base=r.nodeValue,t.removeAttribute("xml:base"));var o=t.getAttributeNode("xml:lang");null!=o&&(i.lang=o.nodeValue,t.removeAttribute("xml:lang"));for(var s=n.length-1;0<=s;s--)if("xml"==n[s].nodeName.substr(0,3)){if("xmlns:"==n[s].name.slice(0,6)){var a=n[s].nodeValue;this.base&&(a=y(a,this.base)),this.store.setPrefixForURI(n[s].name.slice(6),a)}t.removeAttributeNode(n[s])}return i}},s=function(n){this.statements=[],this.namespaces={},this.add=function(e,t,i){this.statements.push({subject:e,predicate:t,object:i,graph:n})},this.sym=function(e){return{token:"uri",value:e}},this.literal=function(e,t,i){return e='"'+(e=(e=(e=e.replace(/\\/g,"\\\\")).replace(/\"/g,'\\"')).replace(/\n/g,"\\n"))+'"',i&&(e=e+"^^"+i),t&&(e=e+"@"+t),{literal:e}};var t=0;this.bnode=function(e){return{blank:e=e||"_:bnid"+t++}},this.setPrefixForURI=function(e,t){if(this.namespaces[e]||t!=t)throw"Can't redefine prefix "+e;this.namespaces[e]=t}};return{parse:function(e,t){var i,n=e;("string"==typeof(i=e)||"[object String]"===Object.prototype.toString.call(i))&&(n=function(e){var t;if("undefined"!=typeof module){var i=require("jsdom");t=i.jsdom(e,i.level(2,"core"),{})}else window.DOMParser?t=(new DOMParser).parseFromString(e,"text/xml"):window.ActiveXObject&&((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e));return t}(e));var r=new s(t);return new o(r).parse(n,"http://nobase"),r.statements}}}(),RDFXMLParser={parser:{}};RDFXMLParser.parser.parse=function(e,t,i,n){n||(n=i,i=t,t=null),t&&"string"==typeof t&&(t={token:"uri",value:t,prefix:null,suffix:null}),i&&i.baseURI&&(i.documentIRI=i.baseURI);try{n(!1,TabulatorRDFXMLParser.parse(e,t))}catch(e){n(e)}},window.RDFE||(window.RDFE={}),RDFE.Utils={},RDFE.Utils.createTitle=function(e){if(e){var t=(e=e.replace(/_/g," ")).replace(/^\s*/,"");return t=t.replace(/^[a-z]|[^\sA-Z][A-Z]/g,function(e,t){return 0==t?e.toUpperCase():e.substr(0,1)+" "+e.substr(1).toUpperCase()})}return e},RDFE.Utils.escapeXml=function(e){return e.replace(/[<>&'"]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;"}})},RDFE.Utils.trim=function(e,t){if(e){for(t||(t=" ");e.substring(0,1)==t;)e=e.substring(1,e.length);for(;e.substring(e.length-1,e.length)==t;)e=e.substring(0,e.length-1)}return e},RDFE.Utils.namingSchemaLabel=function(e,t,i,n){var r=!0===i?1:0,o=t[e][r];return!0===n?o.toLowerCase():o},RDFE.Utils.uriParams=function(){var e={},t=location.search;if(1<t.length&&(t=t.substring(1)),t||(t=(t=location.hash).substring(t.indexOf("?")+1)),t)for(var i=t.split("&"),n=0;n<i.length;n++){var r=i[n];if(r){var o=r.indexOf("=");if(-1==o)e[decodeURIComponent(r)]="";else{var s=r.substring(0,o),a=r.substring(o+1);s=decodeURIComponent(s),a=decodeURIComponent(a.replace(/\+/g," "));var l;(l=s.match(/(.*)\[\]$/))?(s=l[1])in e?e[s].push(a):e[s]=[a]:e[s]=a}}}return e},RDFE.Utils.uri2name=function(e){if(e){var t=e.lastIndexOf("#");if((t<0||-1!==["this","me","i"].indexOf(e.substring(t+1,e.length)))&&(t=e.lastIndexOf("/"))+1===e.length&&(t=(e=e.substring(0,e.length-1)).lastIndexOf("/")),0<=t)return e.substring(t+1,e.length);if(0<=(t=e.lastIndexOf(":")))return e.substring(t+1,e.length)}return e},RDFE.Utils.uriAbbreviate=function(e,t){if(e&&t){if(e.length<=t)return e;var i="",n="...",r=RDFE.Utils.uri2name(e);if(r.length>t-3)return r;if((e=e.substring(0,e.length-r.length)).match(/http:\/\/.*/))i="http://",(e=e.substring(i.length,e.length)).length<=3?n=e:i+=e.substring(0,t-3-i.length-r.length);else{var o=e.indexOf(":");0<o?o===e.length-1?(i=e,n=""):(i=e.substring(0,o+1),(e=e.substring(i.length,e.length)).length<=3?n=e:i+=e.substring(0,t-3-i.length-r.length)):i+=e.substring(0,t-3-i.length-r.length)}return i+n+r}return e},RDFE.Utils.strAbbreviate=function(e,t){if(e&&t){if(e.length<=t||e.length<="...".length+2)return e;t<"...".length+2&&(t="...".length+2);var i=e.substring(0,Math.ceil((t-3)/2));return i+"..."+e.substr(-(t-i.length-"...".length))}return e},RDFE.Utils.getLabel=function(e,t){return e&&e[t]?e[t]:t},RDFE.Utils.getUrl=function(e){var t=RDFE.Utils.splitUrl(e);return t.protocol+"//"+t.host+t.path},RDFE.Utils.getUrlBase=function(e){var t=RDFE.Utils.splitUrl(e);return t.protocol+"//"+t.host},RDFE.Utils.getProtocol=function(e){return RDFE.Utils.splitUrl(e).protocol},RDFE.Utils.splitUrl=function(e){var t=document.createElement("a");return t.href=e,{protocol:t.protocol,host:t.host,hostname:t.hostname,path:t.pathname,port:t.port,search:t.search}},RDFE.Utils.resolveStorageLocations=function(s,a){var l=[];!function n(r){if(r>=s.length)a(l);else{var o=s[r].uri,e=s[r].sparqlEndpoint;if(e){var t=new RDFE.IO.Folder(e);t.ioType="sparql",t.sparqlEndpoint=e;var i=new RDFE.IO.File(o);return i.parent=t,i.ioType="sparql",i.sparqlEndpoint=e,t.children.push(i),l.push(t),void n(r+1)}RDFE.IO.openUrl(o,{checkForFiles:!0},function(e){l.push(e),n(r+1)},function(e,t){var i=new RDFE.IO.File(o);i.errorMessage=e,i.httpStatus=t,l.push(i),n(r+1)})}}(0)},RDFE.Utils.extractDomain=function(e){return(-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0]},RDFE.Validate={},RDFE.Validate.error=function(e,t){return $.notify({message:t},{type:"danger"}),setTimeout(function(){e.focus()},1),!1},RDFE.Validate.integer=function(e,t){return!!/^[0-9]+$/.test(t)||RDFE.Validate.error(e,"Invalid integer value: "+t)},RDFE.Validate.float=function(e,t){return!!/^[-+]?([0-9]*\.)?[0-9]+([eE][-+]?[0-9]+)?$/.test(t)||RDFE.Validate.error(e,"Invalid float value: "+t)},RDFE.Validate.date=function(e,t){return!!/^((?:19|20)[0-9][0-9])[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])$/.test(t)||RDFE.Validate.error(e,"Invalid date value: "+t)},RDFE.Validate.time=function(e,t){return!!/^([01]?[0-9]|[2][0-3])(:[0-5][0-9])?$/.test(t)||RDFE.Validate.error(e,"Invalid time value: "+t)},RDFE.Validate.dateTime=function(e,t){return!!/^((?:19|20)[0-9][0-9])[- /.](0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])( ([01]?[0-9]|[2][0-3])(:[0-5][0-9])?)?$/.test(t)||RDFE.Validate.error(e,"Invalid date value: "+t)},RDFE.Validate.mail=function(e,t){if(0==t.length||40<t.length)return RDFE.Validate.error(e,"E-mail address cannot be empty or longer then 40 chars");return!!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)||RDFE.Validate.error(e,"Invalid E-mail address: "+t)},RDFE.Validate.URL=function(e,t){return!!/^(ftp|http|https):(\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)||RDFE.Validate.error(e,"Invalid URL address: "+t)},RDFE.Validate.URI=function(e,t){return!(!/^([a-z0-9+.-]+):(\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(t)&&!/^acct:([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t))||RDFE.Validate.error(e,"Invalid URI address: "+t)},RDFE.Validate.WebID=function(e,t){if("foaf:Agent"==t)return!0;var i=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return!!i.test(t)||(!!(i=/^acct:([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-:])+)+\.?([a-zA-Z0-9]{0,4})+$/).test(t)||(!!(i=/^acct:([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/).test(t)||RDFE.Validate.error(e,"Invalid URI address: "+t)))},RDFE.Validate.check=function(e,t,i){return i=i||[],0==(t=RDFE.Utils.trim(t)).length&&-1!==i.indexOf("canEmpty")||(-1!==i.indexOf("integer")?RDFE.Validate.integer(e,t):-1!==i.indexOf("float")?RDFE.Validate.float(e,t):-1!==i.indexOf("date")?RDFE.Validate.date(e,t):-1!==i.indexOf("time")?RDFE.Validate.time(e,t):-1!==i.indexOf("dateTime")?RDFE.Validate.dateTime(e,t):-1!==i.indexOf("mail")?RDFE.Validate.mail(e,t):-1!==i.indexOf("URL")?RDFE.Validate.URL(e,t):-1!==i.indexOf("URI")?RDFE.Validate.URI(e,t):-1!==i.indexOf("WebID")?RDFE.Validate.WebID(e,t):0!=t.length||RDFE.Validate.error(e,"Field cannot be empty"))},rdfstore.Store.prototype.curiToUri=function(e){return this.rdf.resolve(e)},rdfstore.Store.prototype.parseLiteral=function(e){var t=e.lastIndexOf("@");return-1!=t&&'"'===e[t-1]&&null!=e.substring(t,e.length).match(/^@[a-zA-Z\-]+$/g)?{token:"literal",value:e.substring(1,t-1),lang:e.substring(t+1,e.length)}:-1!=(t=e.lastIndexOf("^^"))&&'"'===e[t-1]&&"<"===e[t+2]&&">"===e[e.length-1]?{token:"literal",value:e.substring(1,t-1),type:e.substring(t+3,e.length-1)}:{token:"literal",value:e.substring(1,e.length-1)}},rdfstore.Store.prototype.termToNode=function(e){return"literal"==e.token?this.rdf.createLiteral(e.value,e.lang,e.type):(e.token,this.rdf.createNamedNode(e.value))},rdfstore.Store.prototype.rdf.api.RDFNode.prototype.localeCompare=function(e,t,i){return this.toString().localeCompare(e.toString(),t,i)},rdfstore.Store.prototype.loadTurtle=function(s,a,l,u,c){var d=this,e=N3.Parser(),h=[],p=[],f=function(e){switch(e[0]){case'"':if(0<e.indexOf("^^")){var t=e.split("^^");return{literal:t[0]+"^^<"+t[1]+">"}}return{literal:e};case"_":return{blank:e.replace("b","")};default:return{token:"uri",value:e,prefix:null,suffix:null}}};e.parse(s,function(e,t,i){if(e){if(e.message.startsWith("Undefined prefix")&&u){var n=e.message.indexOf('"'),r=e.message.substring(n+1);if(n=r.indexOf('"'),r=r.substring(0,n-1),u[r])return s="@prefix "+r+": <"+u[r]+"> ."+s,d.loadTurtle(s,a,l,u,c)}c&&c(e)}else{var o;if(null===t)!function(){try{d.insert(d.rdf.createGraph(h),a,function(e){if(e)c&&c(e);else if(p.length)try{d.insert(d.rdf.createGraph(p),a,function(e){e?c&&c(e):c&&c(null)})}catch(e){c&&c(e)}else c&&c(null)})}catch(e){c&&c(e)}}();else"BlankNode"===(t=(o=t,d.rdf.createTriple(f(o.subject),f(o.predicate),f(o.object)))).subject.interfaceName||"BlankNode"===t.object.interfaceName?p.push(t):h.push(t)}})},RDFModel.Graph.prototype.toNTBeatify=function(t){var i="",n={};this.forEach(function(e){i+=e.toNTBeatify(t,n)});var e="";for(var r in n)e=e+"@prefix "+r+": <"+n[r]+">. \r\n";return e+"\r\n"+i},RDFModel.NamedNode.prototype.toNTBeatify=function(e,t){var i=this.toString();for(var n in e){var r=e[n];if(0<r.length&&i.startsWith(r))return t[n]=r,i.replace(r,n+":")}return"<"+i+">"},RDFModel.BlankNode.prototype.toNTBeatify=function(){return this.toNT()},RDFModel.Literal.prototype.toNTBeatify=function(){return this.toNT()},RDFModel.Triple.prototype.toNTBeatify=function(e,t){var i=this.subject.toNTBeatify(e,t),n=this.predicate.toNTBeatify(e,t);return"rdf:type"===n&&(n="a"),i+" "+n+" "+this.object.toNTBeatify(e,t)+" . \r\n"},String.prototype.format=function(){var i=arguments;return this.replace(/{(\d+)}/g,function(e,t){return void 0!==i[t]?i[t]:e})},function(c){window.RDFE||(window.RDFE={}),RDFE.IO={},c.ajaxSetup({cache:!1}),RDFE.IO.createIO=function(e,t){var i="http",n={};if("string"==typeof e?(i=e,n=t):"object"==typeof e&&(n=e).type&&(i=n.type),"sparql"===i)return new RDFE.IO.SPARQL(n);if("gsp"===i)return new RDFE.IO.GSP(n);if("ldp"===i||"webdav"===i||"dav"===i)return new RDFE.IO.LDP(n);if("http"===i)return new RDFE.IO.HTTP(n);throw"Unsupport IO type: "+i};var e,t,d,h,i,n,r,p=function(e,t){return c.extend({},t,e)},o=function(){},l=function(e,t,i){i=i||o,e.clear(t,i)};RDFE.IO.Base=((e=function(){}).inherit=function(e){var t=function(){};return t.prototype=this.prototype,e.prototype=new t,(e.prototype.constructor=e).super=this,e},e.prototype.baseExec=function(r,o){var s=this;c(document).ajaxError(o.ajaxError),c(document).ajaxSuccess(o.ajaxSuccess),r.headers=r.headers||{},r.headers["WebID-TLS"]="true",o.username&&(r.headers.Authorization="Basic "+btoa(o.username+":"+o.password),r=c.extend({withCredentials:!0},r)),o.authFunction&&RDFE.Utils.getUrlBase(r.url)===RDFE.Utils.getUrlBase(window.location.href)&&(r.headers["X-Requested-With"]="XMLHttpRequest"),r=c.extend({crossDomain:!0,cache:!0},r),s.options.ioTimeout&&(r=c.extend({timeout:s.options.ioTimeout},r));var e=c.jStorage.get("rdfe:settings",{});e.userID&&(r.headers["On-Behalf-Of"]=e.userID),RDFE.Utils.getProtocol(r.url)===document.location.protocol||"https:"!==document.location.protocol?c.ajax(r).done(function(e,t,i){o&&o.success&&o.success(e,t,i)}).fail(function(e,t,i){if(o&&o.error){var n={httpCode:e.status,message:e.statusText};if(this.crossDomain&&"error"===n.message&&0===e.status)n.message="CORS Error: "+("sparql"!==s.type?r.url:"The document")+" failed to load - this could be related to missing CORS settings on the server.";else{if((401===e.status||403===e.status)&&o.authFunction)return void o.authFunction(r.url,function(e){o.username=e.username,o.password=e.password,s.baseExec(r,o)},function(){n="Error: "+e.status+" - "+e.statusText+("sparql"!==s.type?" ("+r.url+")":""),o.error(n,i,t,e)});"timeout"===t&&(n={httpCode:t,message:"Timeout Error: Failed to load "+("sparql"!==s.type?r.url:"document")})}o.error(n,i,t,e)}}):o&&o.error&&o.error({httpCode:"",message:"Mixed Content Error: This request has been blocked; the content must be served over HTTPS"})},e.prototype.acceptParameter=function(e){return e&&e.accept?e.accept:this.options.accept},e.prototype.rerieveLoadCallback=function(e,t,i,n,r){e?t.error&&t.error(e):t.__success&&t.__success(i,n,r)},e),RDFE.IO.SPARQL=(t=RDFE.IO.Base.inherit(function(e){this.constructor.super.call(this);var t={sparqlEndpoint:window.location.protocol+"//"+window.location.host+"/sparql"};this.options=c.extend({},t,e),this.options.sparqlEndpoint&&0!==this.options.sparqlEndpoint.length||(this.options.sparqlEndpoint=t.sparqlEndpoint)}),d="INSERT DATA {GRAPH <{0}> { {1}}}",h="<{0}> <{1}> {2}",t.prototype.retrieve=function(e,t,i){t=p(t,this.options),i&&(t.ajaxError=null,t.ajaxSuccess=null),this.exec("CONSTRUCT {?s ?p ?o} WHERE {GRAPH <{0}> {?s ?p ?o}}".format(e),t)},t.prototype.retrieveToStore=function(e,r,o,s){var a=this;(s=p(s,a.options)).__success=s.success,s.success=function(t,i,n){l(r,o,function(){r.load("text/turtle",t,o,function(e){a.rerieveLoadCallback(e,s,t,i,n)})})},a.retrieve(e,s,!0)},t.prototype.insert=function(e,t,i,n,r){r=p(r,this.options),this.exec(d.format(e,h.format(t,i,n)),r)},t.prototype.insertFromStore=function(a,e,t,l){var u=this;l=p(l,u.options),e.graph(t,function(e,s){e?l.error&&l.error(s):(l.__success=l.success,l.success=function(e,t){var r=l.chunkSize||400,o=function(e){if(e>=s.length)l.success=l.__success,l.__success=null,l.success();else{for(var t="",i="\n",n=e;n<e+r&&n<s.length;n+=1)t+=i+h.format(s.toArray()[n].subject,s.toArray()[n].predicate,s.toArray()[n].object.toNT()),i=" .\n";l.success=function(){o(e+r)},u.exec(d.format(a,t),c.extend({method:"POST"},l))}};o(0)},u.clear(a,l))})},t.prototype.delete=function(e,t,i,n,r){r=p(r,this.options),this.exec("DELETE DATA {GRAPH <{0}> { <{1}> <{2}> {3} . }}".format(e,t,i,n),r)},t.prototype.clear=function(e,t,i){t=p(t,this.options),i&&(t.ajaxError=null,t.ajaxSuccess=null),this.exec("CLEAR GRAPH <{0}>".format(e),t)},t.prototype.exec=function(e,t){var i={url:t.sparqlEndpoint,type:t.method||"GET",data:{query:e,format:t.format},dataType:"text"};return this.baseExec(i,t)},t),RDFE.IO.GSP=((i=RDFE.IO.Base.inherit(function(e){console.log("GSP");this.constructor.super.call(this);var t={contentType:"application/octet-stream",processData:!1,gspEndpoint:window.location.protocol+"//"+window.location.host+"/sparql-graph-crud"};this.options=c.extend({},t,e),this.options.gspEndpoint&&0!==this.options.gspEndpoint.length||(this.options.gspEndpoint=t.gspEndpoint)})).prototype.retrieve=function(e,t,i){t=p(t,this.options),i&&(t.ajaxError=null,t.ajaxSuccess=null),this.exec("GET",e,null,t)},i.prototype.retrieveToStore=function(e,r,o,s){var a=this;(s=p(s,a.options)).__success=s.success,s.success=function(t,i,n){l(r,o,function(){r.loadTurtle(t,o,e,null,function(e){a.rerieveLoadCallback(e,s,t,i,n)})})},this.retrieve(e,s,!0)},i.prototype.insert=function(e,t,i){i=p(i,this.options),this.exec("PUT",e,t,i)},i.prototype.insertFromStore=function(n,e,t,r){var o=this;r=p(r,o.options),e.graph(t,function(e,i){e?r.error&&r.error(e):(r.__success=r.success,r.success=function(e,t){r.success=r.__success,o.insert(n,i.toNT(),r)},o.clear(n,r,!0))})},i.prototype.update=function(e,t,i){i=p(i,this.options),this.exec("POST",e,t,i)},i.prototype.delete=function(e,t,i){t=p(t,this.options),i&&(t.ajaxError=null,t.ajaxSuccess=null),this.exec("DELETE",e,null,t)},i.prototype.clear=i.prototype.delete,i.prototype.exec=function(e,t,i,n){var r={url:n.gspEndpoint+"?graph="+encodeURIComponent(t),type:e,contentType:n.contentType,processData:n.processData,data:i,dataType:"text"};return this.baseExec(r,n)},i),RDFE.IO.LDP=((n=RDFE.IO.Base.inherit(function(e){this.constructor.super.call(this);this.options=c.extend({},{dataType:"text"},e)})).prototype.retrieve=function(e,t,i){t=p(t,this.options),i&&(t.ajaxError=null,t.ajaxSuccess=null);var n={};"webdav"!=this.type&&(n={Accept:"text/turtle, */*;q=0.1"}),this.exec("GET",e,n,null,t)},n.prototype.retrieveToStore=function(e,r,o,s){var a=this;(s=p(s,a.options)).__success=s.success,s.success=function(t,i,n){l(r,o,function(){r.load("text/turtle",t,o,function(e){a.rerieveLoadCallback(e,s,t,i,n)})})},a.retrieve(e,s,!0)},n.prototype.insert=function(e,t,i){var n;i=p(i,this.options),"webdav"!==this.type&&(n={"Content-Type":"text/turtle"}),this.exec("PUT",e,n,t,i)},n.prototype.insertFromStore=function(n,r,e,o){var s=this;o=p(o,s.options),r.graph(e,function(e,t){if(e)o.error&&o.error(e);else{var i=t.toNTBeatify(r.rdf.prefixes);t.toNT(),s.insert(n,i,o)}})},n.prototype.update=function(e,t,i,n,r,o){o=p(o,this.options);var s="INSERT DATA {GRAPH <{0}> { <{1}> <{2}> {3} . }}".format(t,i,n,r);this.exec("PATCH",e,{"Content-Type":"application/sparql-update"},s,o)},n.prototype.delete=function(e,t){t=p(t,this.options),this.exec("DELETE",e,null,null,t)},n.prototype.clear=n.prototype.delete,n.prototype.exec=function(e,t,i,n,r){var o={url:t,type:e,headers:i,contentType:r.contentType?r.contentType:"text/turtle",processData:!1,data:n,dataType:r.dataType};return this.baseExec(o,r)},n),RDFE.IO.HTTP=((r=RDFE.IO.Base.inherit(function(e){this.constructor.super.call(this);var t={dataType:"text",httpTemplate:"{0}",httpProxyTemplate:document.location.protocol+"//"+document.location.host+"/proxy?url={0}&output-format=turtle&force=rdf"};this.options=c.extend({},t,e),this.options.httpTemplate&&0!==this.options.httpTemplate.length||(this.options.httpTemplate=t.httpTemplate),this.options.httpProxyTemplate&&0!==this.options.httpProxyTemplate.length||(this.options.httpProxyTemplate=t.httpProxyTemplate)})).prototype.retrieve=function(e,t){var i=t.proxy?this.options.httpProxyTemplate.format(encodeURIComponent(e)):this.options.httpTemplate.format(e),n=this.acceptParameter();n||(n="text/turtle; q=1, text/n3; q=0.9, application/ld+json; q=0.7, application/rdf+xml; q=0.6");var r={url:i,type:"GET",dataType:"text",beforeSend:function(e){e.setRequestHeader("Accept",n)}};return this.baseExec(r,t)},r.prototype.retrieveToStore=function(e,r,o,t){var s,a=this;t.__success=t.success,t.success=(s=t,function(t,i,n){var e=(n.getResponseHeader("content-type")||"").split(";")[0];r.load(e,t,o,function(e){a.rerieveLoadCallback(e,s,t,i,n)})});var i=t.proxy?a.options.httpProxyTemplate.format(encodeURIComponent(e)):a.options.httpTemplate.format(e),n=a.acceptParameter();n||(n="text/turtle; q=1, text/n3; q=0.9, application/ld+json; q=0.7, application/rdf+xml; q=0.6");var l={url:i,type:"GET",dataType:"text",beforeSend:function(e){e.setRequestHeader("Accept",n)}};return a.baseExec(l,t)},r)}(jQuery),function(m){var e,t,i;window.RDFE||(window.RDFE={}),RDFE.IO||(RDFE.IO={}),RDFE.IO.Resource=((e=function(e){this.url=e||"",e&&(this.path=decodeURIComponent(RDFE.Utils.splitUrl(e).path),this.host=RDFE.Utils.splitUrl(e).host,this.name=this.path.match(/([^\/]+)\/?$/),this.name&&1<this.name.length?this.name=this.name[1]:this.name=this.url),this.options={}}).inherit=function(e){var t=function(){};return t.prototype=this.prototype,e.prototype=new t,(e.prototype.constructor=e).super=this,e.inherit=this.inherit,e},e.prototype.isFolder=function(){return"folder"===this.type},e.prototype.isFile=function(){return"file"===this.type},e.prototype.getOption=function(e){return this.options[e]?this.options[e]:this.parent?this.parent.getOption(e):void 0},e.prototype.standardAjaxHeaders=function(e){var t=this.getOption("username");return e=e||{},t&&(e.Authorization="Basic "+btoa(t+":"+this.getOption("password"))),e},e),RDFE.IO.File=RDFE.IO.Resource.inherit(function(e,t){this.constructor.super.call(this,e),this.type="file",this.dirty=!0,this.options=m.extend({},{},t)}),RDFE.IO.Folder=function(){var e=RDFE.IO.Resource.inherit(function(e,t){RDFE.IO.Resource.call(this,e),this.type="folder",this.dirty=!0,this.rootUrl=this.url,this.children=[];this.options=m.extend({},{},t)});e.prototype.update=function(e,t,i){var n=this,r=e,o=t,s=i;"function"==typeof r&&(s=o,o=r,r=!1),r||this.dirty?this.listDir(function(){m(n.children).each(function(){this.rootUrl=n.rootUrl,this.parent=n}),n.dirty=!1,o&&o(n)},function(e,t){401!==t&&403!==t||!n.options.authFunction?s&&s(n,e,t):n.options.authFunction(n.url,function(e){n.options.username=e.username,n.options.password=e.password,n.update(r,o,s)},function(){s&&s(n,e,t)})}):o(n)},e.prototype.listDir=function(e){e()};var a={sort:"name",foldersFirst:!0,sortOrder:"asc"};return e.prototype.getChildren=function(e){for(var i=m.extend({},a,e),t=[],n=[],r=0;r<this.children.length;r++)"folder"!==i.type&&"file"===this.children[r].type||"file"!==i.type&&!i.foldersFirst?t.push(this.children[r]):"file"!==i.type&&n.push(this.children[r]);var o="desc"===i.sortOrder.toLowerCase(),s=function(e,t){return o?e[i.sort]>t[i.sort]:e[i.sort]<t[i.sort]};return i.sort&&(t.sort(s),n.sort(s)),m.merge(n,t)},e}(),RDFE.IO.WebDavFolder=((t=RDFE.IO.Folder.inherit(function(e,t){this.constructor.super.call(this,e);this.ioType="webdav",this.options=m.extend({},{},t)})).prototype.listDir=function(t,i){var n=this,e=this.standardAjaxHeaders();e.Depth=1,m.ajax({url:this.url,method:"PROPFIND",contentType:"text/xml",data:'<?xml version="1.0" encoding="utf-8" ?><propfind xmlns="DAV:">  <prop>    <creationdate />    <getlastmodified />    <href />    <resourcetype />    <getcontentlength />    <getcontenttype />    <virtpermissions xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />    <virtowneruid xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />    <virtownergid xmlns="http://www.openlinksw.com/virtuoso/webdav/1.0/" />  </prop></propfind>',dataType:"xml",headers:e}).done(function(e){n.children=function(e,t){for(var i=RDFE.Utils.getUrlBase(e),n=[],r=!1,o=function(e,t){for(var i=[],n=e.getElementsByTagName("*"),r=0;r<n.length;r++)n[r].localName!==t&&n[r].baseName!==t||i.push(n[r]);return i},s=function(e,t){var i=o(e,t);return i.length?m(i[0]).text():null},a=o(t,"response"),l=0;l<a.length;l++){var u=null,c=a[l],d=o(c,"href");if(d.length){var h=i+m(d[0]).text();if(h!==e){var p=o(c,"propstat");if(!p.length)continue;var f=o(p[0],"prop");if(!f.length)continue;if(o(f[0],"collection").length)u=new RDFE.IO.WebDavFolder(h);else{u=new RDFE.IO.File(h);var g=s(f[0],"getcontentlength");g&&(u.size=parseInt(m(g[0]).text())),u.dirty=!1,u.ioType="dav"}var v=s(f[0],"creationdate");v&&(u.creationDate=new Date(v)),(v=s(f[0],"getlastmodified"))&&(u.modificationDate=new Date(v)),(v=s(f[0],"virtpermissions"))&&(u.permissions=v),(v=s(f[0],"virtowneruid"))&&(u.uid=v),(v=s(f[0],"virtownergid"))&&(u.gid=v),(v=s(f[0],"getcontenttype"))&&(u.contentType=v),n.push(u)}else r=!0}}return 0!==n.length||r?n:null}(n.url,e),n.children?t():i('Failed to parse WebDAV result for "'+n.url+'".',200)}).fail(function(e){i(RDFE.IO.ajaxFailMessage(e,'Failed to list WebDAV folder for "{0}"',n.url),e.status)})},t),RDFE.IO.LDPFolder=((i=RDFE.IO.Folder.inherit(function(e,t){this.constructor.super.call(this,e),this.ioType="ldp";this.options=m.extend({},{},t)})).prototype.listDir=function(a,l){var u=this;m.ajax({url:u.url,headers:u.standardAjaxHeaders({Accept:"text/turtle"})}).done(function(i,e,t){var n=!1,r=t.getResponseHeader("Link");if(r)for(var o=r.split(","),s=0;s<o.length;s++)if(0<=o[s].replace(/ /g,"").toLowerCase().indexOf('rel="type"')&&0<=o[s].indexOf("http://www.w3.org/ns/ldp#BasicContainer")){n=!0;break}n?t.getResponseHeader("Content-Type").indexOf("turtle")<0?l("The LDP container at "+u.url+" does not return Turtle content."):rdfstore.create(function(e,t){t.load("text/turtle",i,"urn:default",function(){!function(o,s,a,l){o.registerDefaultNamespace("rdfs","http://www.w3.org/2000/01/rdf-schema#"),o.registerDefaultNamespace("posix","http://www.w3.org/ns/posix/stat#"),o.registerDefaultNamespace("ldp","http://www.w3.org/ns/ldp#");var u=[],c=function(e){for(var t=0;t<u.length;t++)if(u[t].url==e)return!0;return!1};o.execute(" select distinct ?s ?mtime ?contains   from <urn:default>    where {            ?s a ?t .            FILTER(str(?t) = 'http://www.w3.org/ns/posix/stat#Directory' || str(?t) = 'http://www.w3.org/ns/ldp#Container' || str(?t) = 'http://www.w3.org/ns/ldp#BasicContainer') .            optional { ?s posix:mtime ?mtime }            optional { ?s ldp:contains ?contains }          }  order by asc(?s)",function(e,t){if(e)l("Failed to query LDP the container at "+s+".");else{for(var i=0;i<t.length;i++)if(!t[i].contains){var n=t[i].s.value;if(n.startsWith("http")||(n=s+n),!c(n)&&n!=s){var r=new RDFE.IO.LDPFolder(n);t[i].mtime&&(r.modificationDate=new Date(1e3*t[i].mtime.value)),u.push(r)}}o.execute(" select distinct ?s ?size ?mtime    from <urn:default>    where {            ?s a ?t .           FILTER (str(?t) = 'http://www.w3.org/ns/posix/stat#File' || str(?t) = 'http://www.w3.org/2000/01/rdf-schema#Resource' || str(?t) = 'http://www.w3.org/ns/ldp#Resource') .            FILTER (str(?t) != 'http://www.w3.org/ns/posix/stat#Directory' && str(?t) != 'http://www.w3.org/ns/ldp#Container' && str(?t) != 'http://www.w3.org/ns/ldp#BasicContainer') .            optional { ?s posix:size ?size . } .            optional { ?s posix:mtime ?mtime . }          }  order by asc(?s)",function(e,t){if(e)l("Failed to query LDP the container at "+s+".");else{for(var i=0;i<t.length;i++){var n=t[i].s.value;if(n.startsWith("http")||(n=s+n),!c(n)){var r=new RDFE.IO.File(n);t[i].mtime&&(r.modificationDate=new Date(1e3*t[i].mtime.value)),t[i].size&&(r.size=t[i].size.value),r.dirty=!1,r.ioType="ldp",u.push(r)}}a(u)}})}})}(t,u.url,function(e){u.children=e,a&&a()},l)})}):l("Only LDP Basic containers are supported at the moment.")}).fail(function(e){l&&l(RDFE.IO.ajaxFailMessage(e,'Failed to fetch turtle content from "{0}"',u.url),e.status)})},i),RDFE.IO.openUrl=function(o,e,t,i){var s=t,a=i,l=e;"function"==typeof e&&(a=s,s=l,l=void 0);var r=new RDFE.IO.LDPFolder(o,l);r.update(function(){s(r)},function(e,t,i){if(401===i||403===i)a(t,i);else{var n=new RDFE.IO.WebDavFolder(o,r.options);n.update(function(){s(n)},function(r,e,t){l&&l.checkForFiles?m.ajax({url:o,headers:r.standardAjaxHeaders()}).done(function(e,t,i){var n=new RDFE.IO.File(o,r.options);n.content=e,n.contentType=i.getResponseHeader("Content-Type"),n.size=parseInt(i.getResponseHeader("Content-Length")),n.dirty=!1,n.ioType="http",s(n)}).fail(function(e){a&&a(RDFE.IO.ajaxFailMessage(e,'Failed to get "{0}"',o),e.status)}):a&&a(e,t)})}})},RDFE.IO.ajaxFailMessage=function(e,t,i){return"error"===e.statusText&&RDFE.Utils.extractDomain(i)!==window.location.hostname?t.format(i)+" - this could be related to missing CORS settings on the server.":t.format(i)+". "+e.status+" - "+(e.responseText?e.responseText:e.statusText)}}(jQuery),window.RDFE||(window.RDFE={}),RDFE.Config=function(e,t,n){var i,r=this;this.options=RDFE.Config.defaults,e&&$.ajax({url:e,type:"GET",dataType:"json",success:(i=t,function(e){var t=RDFE.Utils.uriParams();r.options=$.extend(r.options,e),r.options.ontology=$.extend(RDFE.Config.defaults.ontology,e.ontology),"EAV"!==t.uiMode&&"SPO"!==t.uiMode||(r.options.namingSchema=t.uiMode),r.options.labelProps&&0!=r.options.labelProps.length||(r.options.labelProps=RDFE.Config.defaults.labelProps),i&&i(r)}),error:function(e,t,i){console.error("config load =>",i),n&&n()}})},RDFE.Config.defaults={ontology:{proxy:!1,nonTTLProxy:!0,fresnelLenses:!0,fresnelFormats:!0,fresnelGroups:!0,forceLoad:!1,preloadOnly:!1},bookmarks:[],actions:["new","open","save","saveAs","bookmarks","entities","triples"],labelProps:["http://www.w3.org/2004/02/skos/core#prefLabel","http://www.w3.org/2000/01/rdf-schema#"],sparqlEndpoint:window.location.protocol+"//"+window.location.host+"/sparql",gspEndpoint:window.location.protocol+"//"+window.location.host+"/sparql-graph-crud",prefixes:{},entityUriTmpl:"{DOC-URI}#{NAME}",autoInverseOfHandling:!1,entityTypesFiler:null,defaultView:"statements",namingSchema:"EAV",EAV:{spo:["Statement","Statements"],s:["Entity","Entities"],p:["Attribute","Attributes"],o:["Value","Values"]},SPO:{spo:["Triple","Triples"],s:["Subject","Subjects"],p:["Predicate","Predicates"],o:["Object","Objects"]},useEntityEditor:!1,maxLabelLength:0,pageSettings:{pageNo:1,pageSize:10}},window.RDFE||(window.RDFE={}),RDFE.RdfNode=function(e,t,i,n){this.type=e,this.value=t,this.datatype=i,this.language=n},RDFE.RdfNode.prototype.toStoreNode=function(e){return"uri"==this.type?e.rdf.createNamedNode(this.value):e.rdf.createLiteral(this.value,this.language,this.datatype)},RDFE.RdfNode.prototype.toString=function(){return this.value},RDFE.RdfNode.fromStoreNode=function(e){if("string"==typeof e)return new RDFE.RdfNode("uri",e);if("number"==typeof e)return new RDFE.RdfNode("literal",e);if(e instanceof RDFE.RdfNode)return e;if(e.token)return new RDFE.RdfNode(e.token,e.value,e.type,e.lang);if(e.interfaceName){var t;if("NamedNode"===e.interfaceName)t="uri";else{if("Literal"!==e.interfaceName)throw"Blank nodes cannot be converted into RDFE.RdfNode values.";t="literal"}return new RDFE.RdfNode(t,e.nominalValue,e.datatype,e.language)}if(e.uri)return new RDFE.RdfNode("uri",e.uri);throw"Unsupported node type for RDFE.RdfNode conversion."},"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0==this.indexOf(e)}),window.RDFE||(window.RDFE={}),RDFE.prefixes={},RDFE.prefixes.adms="http://www.w3.org/ns/adms#",RDFE.prefixes.annotation="http://www.w3.org/2000/10/annotation-ns#",RDFE.prefixes.atom="http://atomowl.org/ontologies/atomrdf#",RDFE.prefixes.bibo="http://purl.org/ontology/bibo/",RDFE.prefixes.book="http://purl.org/NET/book/vocab#",RDFE.prefixes.cc="http://web.resource.org/cc/",RDFE.prefixes.cert="http://www.w3.org/ns/auth/cert#",RDFE.prefixes.dataview="http://www.w3.org/2003/g/data-view#",RDFE.prefixes.dbpedia="http://dbpedia.org/resource/",RDFE.prefixes.dc="http://purl.org/dc/elements/1.1/",RDFE.prefixes.dcam="http://purl.org/dc/dcam/",RDFE.prefixes.dcterms="http://purl.org/dc/terms/",RDFE.prefixes.dctype="http://purl.org/dc/dcmitype/",RDFE.prefixes.doap="http://usefulinc.com/ns/doap#",RDFE.prefixes.foaf="http://xmlns.com/foaf/0.1/",RDFE.prefixes.fresnel="http://www.w3.org/2004/09/fresnel#",RDFE.prefixes.geo="http://www.w3.org/2003/01/geo/wgs84_pos#",RDFE.prefixes.gr="http://purl.org/goodrelations/v1#",RDFE.prefixes.gso="http://www.w3.org/ns/adms#",RDFE.prefixes.ibis="http://purl.org/ibis#",RDFE.prefixes.ical="http://www.w3.org/2002/12/cal/icaltzd#",RDFE.prefixes.like="http://ontologi.es/like#",RDFE.prefixes.mo="http://purl.org/ontology/mo/",RDFE.prefixes.owl="http://www.w3.org/2002/07/owl#",RDFE.prefixes.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFE.prefixes.rdfs="http://www.w3.org/2000/01/rdf-schema#",RDFE.prefixes.rev="http://purl.org/stuff/rev#",RDFE.prefixes.rss="http://purl.org/rss/1.0/",RDFE.prefixes.schema="http://schema.org/",RDFE.prefixes.scot="http://scot-project.org/scot/ns",RDFE.prefixes.sioc="http://rdfs.org/sioc/ns#",RDFE.prefixes.sioct="http://rdfs.org/sioc/types#",RDFE.prefixes.skos="http://www.w3.org/2004/02/skos/core#",RDFE.prefixes.vcard="http://www.w3.org/2006/vcard/ns#",RDFE.prefixes.void="http://rdfs.org/ns/void#",RDFE.prefixes.vs="http://www.w3.org/2003/06/sw-vocab-status/ns#",RDFE.prefixes.wot="http://xmlns.com/wot/0.1/",RDFE.prefixes.wdrs="http://www.w3.org/2007/05/powder-s#",RDFE.prefixes.ws="http://www.w3.org/ns/pim/space#",RDFE.prefixes.xhtml="http://www.w3.org/1999/xhtml",RDFE.prefixes.xsd="http://www.w3.org/2001/XMLSchema#",RDFE.coalesce=function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e]&&null!==arguments[e])return arguments[e]},RDFE.uriPrefix=function(e){var t=Math.max(e.lastIndexOf(":"),e.lastIndexOf("/"),e.lastIndexOf("#"));return-1!=t&&t==e.lastIndexOf(":")?e.substring(0,t):null},RDFE.uriLabel=function(e){var t=Math.max(e.lastIndexOf(":"),e.lastIndexOf("/"),e.lastIndexOf("#"));return-1==t?e:t!=e.length-1?e.substring(t+1):null},RDFE.isUriPrefix=function(e){return-1==Math.max(e.lastIndexOf(":"),e.lastIndexOf("/"),e.lastIndexOf("#"))},RDFE.uriOntology=function(e){if(!e)return null;var t=Math.max(e.lastIndexOf(":"),e.lastIndexOf("/"),e.lastIndexOf("#"));return-1!=t?e.substring(0,t+1):null},RDFE.isBlankNode=function(e){return _.isString(e)?!!e.match(/^\_\:*/):!(!_.isObject(e)||!e.URI)&&RDFE.isBlankNode(e.URI)},RDFE.ontologyByPrefix=function(t,i){var e=location.protocol+"//prefix.cc/{0}.file.json".format(t);return $.ajax({url:e,type:"GET",async:!!i}).done(function(e){RDFE.prefixes[t]=e[t],i&&i(e[t])}),RDFE.prefixes[t]},RDFE.prefixByOntology=function(n,r){var e="https://lov.linkeddata.es/dataset/lov/api/v2/vocabulary/autocomplete?q="+encodeURIComponent(RDFE.Utils.trim(n,"#"));$.ajax({url:e,type:"GET",dataType:"json",async:!1}).done(function(e){for(var t=e.results,i=0;i<t.length;i++)for(;0<t[i].uri.length;i++)if(RDFE.Utils.trim(t[i].uri[0],"#")===RDFE.Utils.trim(n,"#"))return void(r&&r(t[i].prefix[0]))})},RDFE.schema2ontology_range=function(e){var t=e;return"http://schema.org/Boolean"===e?t="http://www.w3.org/2001/XMLSchema#boolean":"http://schema.org/Date"===e?t="http://www.w3.org/2001/XMLSchema#boolean":"http://schema.org/DateTime"===e?t="http://www.w3.org/2001/XMLSchema#datetime":"http://schema.org/Time"===e?t="http://www.w3.org/2001/XMLSchema#datetime":"http://schema.org/Number"===e?t="http://www.w3.org/2001/XMLSchema#decimal":"http://schema.org/Float"===e?t="http://www.w3.org/2001/XMLSchema#float":"http://schema.org/Integer"===e?t="http://www.w3.org/2001/XMLSchema#integer":"http://schema.org/Text"===e?t="http://www.w3.org/2001/XMLSchema#string":"http://schema.org/URL"===e&&(t="http://www.w3.org/2001/XMLSchema#string"),t},RDFE.OntologyManager=function(e){this.config=e||{},this.options=$.extend(RDFE.Config.defaults.ontology,this.config.ontology),this.reset(),this.prefixes=$.extend({},RDFE.prefixes,this.config.prefixes)},RDFE.OntologyManager.prototype.init=function(e){var o=this;this.reset();e=$.extend({},e);var s=o.options.preloadOntologies||[],a=function(i,e){if(i<s.length){var n=s[i],t=function(e,t){return function(){$(o).trigger(t,[o,n]),a(i+1,e)}},r={success:t(e,"loadingFinished"),error:t(e,"loadingFailed")};$(o).trigger("loading",[o,n]),o.parseOntologyFile(n,r)}else e.success&&e.success()};a(0,e)},RDFE.OntologyManager.prototype.reset=function(e){this.ontologies={},this.ontologyClasses={},this.ontologyProperties={},this.individuals={},this.fresnelLenses={}},RDFE.OntologyManager.prototype.prefixByOntology=function(e){for(var t in this.prefixes)if(this.prefixes[t]===e)return t;return null},RDFE.OntologyManager.prototype.uriDenormalize=function(e){var t=RDFE.uriPrefix(e);return t&&(this.prefixes[t]||RDFE.ontologyByPrefix(t),this.prefixes[t])?this.prefixes[t]+e.substring(t.length+1):e},RDFE.OntologyManager.prototype.uriNormalize=function(e,t){var i=RDFE.uriOntology(e);if(i)for(var n in this.prefixes)if(this.prefixes[n]==i)return n+":"+e.substring(i.length);return t},RDFE.OntologyManager.prototype.ontologiesAsArray=function(){return _.values(this.ontologies)},RDFE.OntologyManager.prototype.ontologyByURI=function(e,t){var i=this.ontologies[e];return i||!0!==t||(this.ontologies[e]=i=new RDFE.Ontology(this,e)),i},RDFE.OntologyManager.prototype.ontologyByPrefix=function(e){return this.ontologies[this.prefixes[e]]},RDFE.OntologyManager.prototype.ontologyRemove=function(e){var t=this.ontologyByURI(e);if(t){delete this.ontologies[e];for(var i=t.classesAsArray(),n=0;n<i.length;n++)this.ontologyClassRemove(i[n].URI);var r=t.allProperties();for(n=0;n<r.length;n++)this.ontologyPropertyRemove(r[n].URI);$(this).trigger("changed",[this])}},RDFE.OntologyManager.prototype.ontologyClassRemove=function(e){delete this.ontologyClasses[e]},RDFE.OntologyManager.prototype.ontologyPropertyRemove=function(e){delete this.ontologyProperties[e]},RDFE.OntologyManager.prototype.ontologyClassByURI=function(e,t){var i=this.ontologyClasses[e];return i||!0!==t||(this.ontologyClasses[e]=i=new RDFE.OntologyClass(this,e),i.ontology=this.ontologyByURI(RDFE.uriOntology(e),!0),i.ontology.classes[e]=i),i},RDFE.OntologyManager.prototype.ontologyPropertyByURI=function(e,t){var i=this.ontologyProperties[e];return i||!0!==t||(this.ontologyProperties[e]=i=new RDFE.OntologyProperty(this,e),i.ontology=this.ontologyByURI(RDFE.uriOntology(e),!0),i.ontology.properties[e]=i),i},RDFE.OntologyManager.prototype.individualByURI=function(e){return this.individuals[e]},RDFE.OntologyManager.prototype.load=function(r,o){var s=this,e=o.ioType?o.ioType:"http",t={};s.options.nonTTLProxyUrl&&(t.httpProxyTemplate=s.options.nonTTLProxyUrl[document.location.protocol]);var a=RDFE.IO.createIO(e,t);a.type=e,o.__success=o.success,o.success=function(e,t,i){if(s.options.nonTTLProxy&&s.options.proxy!==s.options.nonTTLProxy){var n=(i.getResponseHeader("content-type")||"").split(";")[0];if(0<n.length&&n.indexOf("turtle")<0)return void a.retrieve(r,$.extend({proxy:s.options.nonTTLProxy},o))}o.__success&&o.__success(e,t,i)},o.__error=o.error,o.error=function(e,t,i,n){if(s.options.nonTTLProxy&&s.options.proxy!==s.options.nonTTLProxy)return o.error=o.__error,void a.retrieve(r,$.extend({proxy:s.options.nonTTLProxy},o));o.__error&&o.__error(e,t,i,n)};var i=RDFE.Utils.getProtocol(r)!==document.location.protocol&&"https:"===document.location.protocol||s.options.proxy;a.retrieve(r,$.extend({proxy:i},o))},RDFE.OntologyManager.prototype.parseOntologyFile=function(e,o){var m=this,y={},b={},w={},x={},k={},F={};function C(e){return N3.Util.isBlank(e)?null:m.ontologyClassByURI(e,!0)}function E(e){return N3.Util.isBlank(e)?null:m.ontologyPropertyByURI(e,!0)}function T(e){return F[e]=F[e]||new RDFE.FresnelLens(m,e)}function d(e){for(var t=[],i=e;i;){var n=k[i];i=n?(n.first&&t.push(n.first),n.rest):null}return t}var s=function(e){var t,i,n,r,o,s,a,l=e.subject,u=e.predicate,c=e.object;if("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===u){switch(c){case"http://www.w3.org/2002/07/owl#ObjectProperty":case"http://www.w3.org/2002/07/owl#DatatypeProperty":case"http://www.w3.org/1999/02/22-rdf-syntax-ns#Property":E(l);break;case"http://www.w3.org/2000/01/rdf-schema#Class":case"http://www.w3.org/2002/07/owl#Class":C(l);break;case"http://www.w3.org/2002/07/owl#Restriction":w[l]=w[l]||{};break;case"http://www.openlinksw.com/ontology/oplowl#AggregateRestriction":w[l]=w[l]||{},w[l].isAggregate=!0;break;case"http://www.openlinksw.com/ontology/oplowl#UniqueIdRestriction":w[l]=w[l]||{},w[l].isUniqueId=!0;break;case"http://www.w3.org/2004/09/fresnel#Lens":T(l)}var d=(a=l,m.individuals[a]=m.individuals[a]||new RDFE.OntologyIndividual(m,a)),h=C(c);(d.type=h).individuals[l]=d}else if("http://www.w3.org/2000/01/rdf-schema#label"===u)r=l,o=N3.Util.getLiteralValue(c),(s=m.ontologyProperties[r])?s.label=s.label||o:(s=m.ontologyClasses[r])?s.label=s.label||o:(s=m.ontologies[r])?s.label=s.label||o:(s=m.individuals[r])?s.label=s.label||o:(s=F[r])?s.label=s.label||o:y[r]=o;else if("http://www.w3.org/2000/01/rdf-schema#comment"===u)t=l,i=N3.Util.getLiteralValue(c),(n=m.ontologyProperties[t])?n.comment=n.comment||i:(n=m.ontologyClasses[t])?n.comment=n.comment||i:(n=m.ontologies[t])?n.comment=n.comment||i:(n=m.individuals[t])?n.comment=n.comment||i:(n=F[t])?n.comment=n.comment||i:b[t]=i;else if("http://www.w3.org/2000/01/rdf-schema#subClassOf"===u){var p=C(l);if(N3.Util.isBlank(c))(v=x[l]=x[l]||[]).push(c);else f=C(c),p.subClassOf.push(f),f.superClassOf.push(p)}else if("http://www.w3.org/2000/01/rdf-schema#subPropertyOf"===u){var f=E(c);(p=E(l)).subPropertyOf.push(f),f.superPropertyOf.push(p)}else if("http://www.w3.org/2000/01/rdf-schema#domain"===u||"http://schema.org/domainIncludes"===u){var g=E(l);N3.Util.isBlank(c)?g.domain.push(c):g.domain.push(C(c))}else if("http://www.w3.org/2000/01/rdf-schema#range"===u){(g=E(l)).range.push(c)}else if("http://schema.org/rangeIncludes"===u){g=E(l);var v=RDFE.schema2ontology_range(c);g.range.push(v)}else if("http://www.w3.org/2002/07/owl#onProperty"===u){((v=w[l]=w[l]||{}).onProperty=v.onProperty||[]).push(c)}else if("http://www.w3.org/2002/07/owl#cardinality"===u||"http://www.w3.org/2002/07/owl#maxCardinality"===u||"http://www.w3.org/2002/07/owl#minCardinality"===u||"http://www.openlinksw.com/ontology/oplowl#hasCustomLabel"===u||"http://www.openlinksw.com/ontology/oplowl#hasCustomComment"===u){(v=w[l]=w[l]||{})[RDFE.uriLabel(u)]=N3.Util.getLiteralValue(c)}else if("http://www.w3.org/1999/02/22-rdf-syntax-ns#first"===u||"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest"===u){if("http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"!==c)(g=k[l]=k[l]||{})[RDFE.uriLabel(u)]=c}else if("http://www.w3.org/2002/07/owl#unionOf"===u)k[l]={rest:c};else if("http://www.w3.org/2004/09/fresnel#showProperties"===u||"http://www.w3.org/2004/09/fresnel#hideProperties"===u||"http://www.w3.org/2004/09/fresnel#classLensDomain"===u){T(l)[RDFE.uriLabel(u)]=c}},t={ioType:o.ioType,success:function(e,t,i){var n=(i.getResponseHeader("content-type")||"").split(";")[0];if(0<n.length&&n.indexOf("turtle")<0){var r="Only Turtle files can be parsed in the ontology manager.";console.error(r),o.error&&o.error({message:r})}else N3.Parser().parse(e,function(e,t){e?o.error&&o.error({message:"Parse error."}):t?s(t):(function(){for(var e in m.ontologyClasses){var t=m.ontologyClasses[e];t.label=t.label||y[e],t.comment=t.comment||b[e],delete y[e],delete b[e];var i=x[e];if(i){for(var n=0;n<i.length;n++){for(var r=w[i[n]],o=_.clone(r),s=0;s<r.onProperty.length;s++)t.restrictions[r.onProperty[s]]=o;delete o.onProperty}delete x[e]}}for(var e in m.ontologyProperties){(c=m.ontologyProperties[e]).label=c.label||y[e],c.comment=c.comment||b[e],delete y[e],delete b[e];var a=_.clone(c.range);for(c.range=[],n=0;n<a.length;n++)N3.Util.isBlank(a[n])?c.range=_.union(c.range,d(a[n])):c.range.push(a[n]);var l=_.clone(c.domain);for(c.domain=[],n=0;n<l.length;n++)!l[n].URI&&N3.Util.isBlank(l[n])?c.domain=_.union(c.domain,d(l[n])):c.domain.push(l[n])}for(e in F)(c=F[e]).label=c.label||y[e],c.comment=c.comment||b[e],delete y[e],delete b[e],c.showProperties=d(c.showProperties),c.hideProperties=d(c.hideProperties),(m.fresnelLenses[e]=c).classLensDomain&&(C(c.classLensDomain).fresnelLens=c);for(e in m.ontologies){var u=m.ontologies[e];u.label=u.label||y[e]||y[e.substring(0,e.length-1)],u.comment=u.comment||b[e]||b[e.substring(0,e.length-1)],delete y[e],delete b[e]}for(e in m.individuals){var c;(c=m.individuals[e]).label=c.label||y[e],c.comment=c.comment||b[e],delete y[e],delete b[e]}$(m).trigger("changed",[m])}(),o.success&&o.success())})},error:o.error};e.startsWith(RDFE.Utils.getUrlBase(e))||(e=RDFE.Utils.getUrl(e)),m.load(e,t)},RDFE.OntologyManager.prototype.findFresnelLens=function(e){var t=this.ontologyClasses[e];return t?t.getFresnelLens():null},RDFE.OntologyManager.prototype.ontologyDetermine=function(e){var t,i=RDFE.uriPrefix(e);return t=i?(t=this.ontologyByPrefix(i))?t.URI:RDFE.ontologyByPrefix(i):RDFE.uriOntology(e)},RDFE.OntologyManager.prototype.allOntologies=function(){return _.values(this.ontologies)},RDFE.OntologyManager.prototype.allClasses=function(){return _.values(this.ontologyClasses)},RDFE.OntologyManager.prototype.allProperties=function(e){var t=[];for(var i in this.ontologyProperties){var n=this.ontologyProperties[i];e&&!n.domain.indexOf(e)||t.push(n)}return t},RDFE.OntologyManager.prototype.typesToLabel=function(e,n){var r=this;return _.uniq(_.map(e,function(e){var t,i=r.ontologyClassByURI(e);return t=i?i.label:RDFE.Utils.uri2name(e),n?'<a href="'+e+'">'+t+"</a>":t})).join(", ")},RDFE.Ontology=function(e,t,i,n){var r=this;if(i&&e.prefixes[i]===t)return null;if(r.options=$.extend({},n),r.URI=t,r.classes={},r.properties={},r.manager=e,(r.manager.ontologies[t]=r).prefix=i||e.prefixByOntology(t),!r.prefix){RDFE.prefixByOntology(t,function(e){e&&(r.prefix=e,r.manager.prefixes[e]=t,$(r.manager).trigger("changed",[r.manager]))})}},RDFE.Ontology.prototype.classesAsArray=function(){return _.values(this.classes)},RDFE.Ontology.prototype.classesLength=function(){return this.classesAsArray().length},RDFE.Ontology.prototype.ontologyClassByURI=function(e){return this.classes[e]},RDFE.Ontology.prototype.propertyByURI=function(e){return this.properties[e]},RDFE.Ontology.prototype.propertiesLength=function(){return _.values(this.properties).length},RDFE.Ontology.prototype.allProperties=function(e){var t=[];for(var i in this.properties){var n=this.properties[i];e&&!n.domain.indexOf(e)||t.push(n)}return t},RDFE.OntologyClass=function(e,t){this.URI=t,this.curi=e.uriNormalize(t),this.name=RDFE.Utils.uri2name(t),this.subClassOf=[],this.superClassOf=[],this.disjointWith=[],this.properties={},this.individuals={},this.restrictions={},this.manager=e},RDFE.OntologyClass.prototype.propertiesAsArray=function(){var e=[];for(var t in this.properties)e.push(this.properties[t]);return e},RDFE.OntologyClass.prototype.maxCardinalityForProperty=function(e,t){var i=this.restrictions[e],n=null;if(i&&(n=i.cardinality||i.maxCardinality))return n;var r=this.manager.ontologyPropertyByURI(e);if(r)for(var o=r.getSuperProperties(),s=0;s<o.length;s++){var a=this.restrictions[o[s].URI];if(a&&(n=a.cardinality||a.maxCardinality))return n}for(s=0;s<this.subClassOf.length;s++){var l=this.subClassOf[s];if($.inArray(l.URI,t)<0){if((t=t||[]).push(l.URI),n=l.maxCardinalityForProperty(e,t))return n}else console.log("CAUTION: Found sub-class loop in ",t)}return null},RDFE.OntologyClass.prototype.isAggregateProperty=function(e,t){var i=this.restrictions[e];if(i&&i.isAggregate)return!0;for(var n=0;n<this.subClassOf.length;n++){var r=this.subClassOf[n];if($.inArray(r.URI,t)<0){if((t=t||[]).push(r.URI),r.isAggregateProperty(e,t))return!0}else console.log("CAUTION: Found sub-class loop in ",t)}return!1},RDFE.OntologyClass.prototype.getSubClasses=function(e,t,i){if(t=t||[],t=_.union(t,this.superClassOf),!1!==e){(i=i||[]).push(this.URI);for(var n=0;n<this.superClassOf.length;n++){var r=this.superClassOf[n];$.inArray(r.URI,i)<0&&r.getSubClasses(e,t,i)}}return t},RDFE.OntologyClass.prototype.getSuperClasses=function(e,t,i){if(t=t||[],t=_.union(t,this.subClassOf),!1!==e){(i=i||[]).push(this.URI);for(var n=0;n<this.subClassOf.length;n++){var r=this.subClassOf[n];$.inArray(r.URI,i)<0&&r.getSuperClasses(e,t,i)}}return t},RDFE.OntologyClass.prototype.getUniqueRestrictions=function(){var e=[];if(this.restrictions)for(var t in this.restrictions){!0===this.restrictions[t].isUniqueId&&e.push(this.manager.ontologyPropertyByURI(t))}return e},RDFE.OntologyClass.prototype.getIndividuals=function(e){var t=this.individuals;if(e)for(var i=this.getSubClasses(!0),n=0;n<i.length;n++)t=_.union(t,i[n].individuals);return t},RDFE.OntologyClass.prototype.getFresnelLens=function(){var e=this.fresnelLens;if(!e)for(var t=this.getSuperClasses(!0),i=0;i<t.length;i++)if(e=t[i].fresnelLens)return e;return e},RDFE.OntologyProperty=function(e,t){this.URI=t,this.curi=e.uriNormalize(t),this.name=RDFE.Utils.uri2name(t),this.subPropertyOf=[],this.superPropertyOf=[],this.domain=[],this.range=[],this.manager=e,this.manager.ontologyProperties[t]=this},RDFE.OntologyProperty.prototype.hasDomain=function(e){if(this.domain)for(var t=0;t<this.domain.length;t++)if(e==this.domain[t])return!0;return!1},RDFE.OntologyProperty.prototype.getRange=function(e){var t=this.range;if(!_.isEmpty(t))return t;for(var i=0;i<this.subPropertyOf.length;i++){var n=this.subPropertyOf[i];if($.inArray(n.URI,e)<0){if((e=e||[]).push(n.URI),t=n.getRange(e),!_.isEmpty(t))return t}else console.log("CAUTION: Found sub-property loop in ",e)}},RDFE.OntologyProperty.prototype.getSuperProperties=function(e,t,i){if(t=t||[],t=_.union(t,this.subPropertyOf),!1!==e){(i=i||[]).push(this.URI);for(var n=0;n<this.subPropertyOf.length;n++){var r=this.subPropertyOf[n];$.inArray(r.URI,i)<0&&r.getSuperProperties(e,t,i)}}return t},RDFE.OntologyIndividual=function(e,t,i){this.URI=t,this.curi=e.uriNormalize(t),this.name=RDFE.Utils.uri2name(t),this.manager=e,this.manager.individuals[t]=this},RDFE.FresnelLens=function(e,t){this.URI=t,this.manager=e,this.showProperties=[],this.hideProperties=[]},window.RDFE||(window.RDFE={}),RDFE.Document=function(e,i){var n=this;n.ontologyManager=e.ontologyManager,n.config=e.config,n.documentTree=e.documentTree,n.graph="urn:graph:default",n.dirty=!1,rdfstore.create(function(e,t){e||(n.store=t,n.store.registerDefaultNamespace("skos","http://www.w3.org/2004/02/skos/core#"),i&&i(n))})},RDFE.Document.prototype.setChanged=function(e){this.dirty=e,this.dirty&&$(this).trigger("changed",this),$(this).trigger("docChanged",this)},RDFE.Document.prototype.load=function(n,r,o,e){var s=this,t=function(e,t,i){s.url=n,s.io=r,s.setChanged(!1),s.srcParams={length:e.length,md5:$.md5(e)},o&&o()};s.store.clear(function(){r.retrieveToStore(n,s.store,s.graph,{success:t,error:e})})},RDFE.Document.prototype.verifyData=function(i){if(!this.config.options.validateEmptyNodes)return i&&i(),!0;var e="select * from <"+this.graph+"> where {{ <> ?p ?o } union { ?s2 ?p2 <> }}";this.store.execute(e,function(e,t){return e?(i&&i(e),!1):0<t.length?(i&&i(new Error("The document is not valid. It contains empty URI nodes.")),!1):(i&&i(),!0)})},RDFE.Document.prototype.save=function(e,t,i,n){var r=this,o=e,s=t,a=i,l=n;"string"!=typeof e&&(o=r.url,s=e,a=t,l=i),"function"!=typeof s&&s||(l=a,a=s,s=r.io),o?(s.insertFromStore||((s=RDFE.IO.createIO("webdav",s.options)).type="webdav"),r.verifyData(function(e){if(e)l&&l(e);else{s.insertFromStore(o,r.store,r.graph,{success:function(){r.url=o,r.io=s,r.setChanged(!1),r.documentTree.addRecentDoc(r.url,r.io.type),s.retrieve(o,{success:function(e,t,i){r.srcParams={length:e.length,md5:$.md5(e)}},error:function(){r.srcParams=null}}),a&&a()},error:l})}})):l&&l("No document loaded")},RDFE.Document.prototype.new=function(t,i){var n=this;n.url=null,n.io=null,n.srcParams=null,n.signature=null,n.store.clear(n.graph,function(e){e?e&&i&&i(e):(n.setChanged(!1),t&&t())})},RDFE.Document.prototype.import=function(e,t,r,o){var s=this;if("function"==typeof t&&(o=r,r=t,t=null),"application/ld+json"===t)s.importJSON(e,r,o);else if("application/rdf+xml"===t)s.importRDF(e,r,o);else if("text/turtle"===t)s.importTurtle(e,r,o);else{s.importTurtle(e,r,function(n){s.importJSON(e,r,function(i){s.importRDF(e,r,function(e){var t=new Error;t.name="SyntaxError",t.message="<b>TTL</b>: "+n.message+" or <b>JSON-LP</b>: "+i.message+" or <b>RDF</b>: "+e.message,o(t)})})})}},RDFE.Document.prototype.importTurtle=function(o,s,a){var l=this;l.store.load("text/turtle",o,l.graph,function(e,t){if(e){if(e.message.startsWith("Undefined prefix")){var i=e.message.indexOf('"'),n=e.message.substring(i+1);i=n.indexOf('"'),n=n.substring(0,i-1);var r=l.ontologyManager.prefixes[n];if(r)return o="@prefix {0}: <{1}> .".format(n,r)+o,l.importTurtle(o,s,a)}a&&a(e)}else s&&s(t)})},RDFE.Document.prototype.importJSON=function(e,i,n){this.store.load("application/ld+json",e,this.graph,function(e,t){!e&&i?i(t):e&&n&&n(e)})},RDFE.Document.prototype.importRDF=function(e,i,n){try{$.parseXML(e),this.store.load("application/rdf+xml",e,this.graph,function(e,t){!e&&i?i(t):e&&n&&n(e)})}catch(e){n({message:"RDF syntax error!"})}},RDFE.Document.prototype.deleteBySubject=function(e,i,n){var r=this;if(r.config.options.autoInverseOfHandling){var t="construct { <{1}> ?p ?o } from <{0}> where { <{1}> ?p ?o. } ".format(r.graph,e);r.store.execute(t,function(e,t){e?n&&n(e):r.deleteTriples(t.triples,i,n)})}else{t="with <{0}> delete { <{1}> ?p ?o } where { <{1}> ?p ?o }".format(r.graph,e);r.store.execute(t,function(e,t){!e&&i?i():e&&n&&n(e)})}},RDFE.Document.prototype.deleteByPredicate=function(e,i,n){var r=this;if(r.config.options.autoInverseOfHandling){var t="construct { ?s <{1}> ?o} from <{0}> where { ?s <{1}> ?o . } ".format(r.graph,e);r.store.execute(t,function(e,t){e?n&&n(e):r.deleteTriples(t.triples,i,n)})}else{t="with <{0}> delete { ?s <{1}> ?o} where { ?s <{1}> ?o . }".format(r.graph,e);r.store.execute(t,function(e,t){!e&&i?i():e&&n&&n(e)})}},RDFE.Document.prototype.deleteByObjectIRI=function(e,i,n){var r=this;if(r.config.options.autoInverseOfHandling){var t="construct { ?s ?p <{1}> } from <{0}> where { ?s ?p <{1}> . } ".format(r.graph,e);r.store.execute(t,function(e,t){e?n&&n(e):r.deleteTriples(t.triples,i,n)})}else{t="with <{0}> delete { ?s ?p <{1}> } where { ?s ?p <{1}> . }".format(r.graph,e);r.store.execute(t,function(e,t){!e&&i?i():e&&n&&n(e)})}},RDFE.Document.prototype.deleteByObject=function(e,i,n){var t,r=this;t="Literal"===e.interfaceName?'construct { ?s ?p ?o } from <{0}> where { ?s ?p ?o. FILTER (str(?o) = "{1}"). } '.format(r.graph,"http://www.w3.org/2001/XMLSchema#dateTime"==e.datatype?new Date(e.nominalValue).toString():e.nominalValue):"construct { ?s ?p <{1}> } from <{0}> where { ?s ?p <{1}> . } ".format(r.graph,e.toString()),r.store.execute(t,function(e,t){e?n&&n(e):r.deleteTriples(t.triples,i,n)})},RDFE.Document.prototype.deleteEntity=function(e,t,i){var n=this;e?n.deleteBySubject(e,function(){n.deleteByObjectIRI(e,t,i)},i):i&&i("Need Entity URI for deletion.")},RDFE.Document.prototype.deleteEntities=function(e,t,i){var n,r=this;(n=0)<e.length?r.deleteEntity(e[n],function(){delUri(n+1)},i):t()},RDFE.Document.prototype.deletePredicate=function(e,t,i){e?this.deleteByPredicate(e,t,i):i&&i("Need Predicate URI for deletion.")},RDFE.Document.prototype.deleteObject=function(e,t,i){e?this.deleteByObject(e,t,i):i&&i("Need object for deletion.")},RDFE.Document.prototype.checkTriple=function(n,r,o){this.store.node(n.subject.nominalValue,this.graph,function(e,t){if(e)o&&o(!1);else if(r){var i=t.match(null,n.predicate,n.object);r(0<i.triples.length)}})},RDFE.Document.prototype.addTriples=function(e,n,r,o){var s=this,a=_.isArray(e)?e:[e];_.isEmpty(a)?n&&n():s.store.insert(s.store.rdf.createGraph(a),s.graph,function(e,t){if(e)r&&r();else if(!0!==s.config.options.autoInverseOfHandling||o)s.setChanged(!0),n&&n();else{var i=s.inverseTriples(a);_.isEmpty(i)?(s.setChanged(!0),n&&n()):s.addTriples(i,n,r,!0)}})},RDFE.Document.prototype.addTriple=RDFE.Document.prototype.addTriples,RDFE.Document.prototype.deleteTriples=function(e,n,r,o){var s=this,a=_.isArray(e)?e:[e];_.isEmpty(a)?n&&n():s.store.delete(s.store.rdf.createGraph(a),s.graph,function(e,t){if(e)r&&r(e);else if(s.setChanged(!0),!0!==s.config.options.autoInverseOfHandling||o)s.setChanged(!0),n&&n();else{var i=s.inverseTriples(a);_.isEmpty(i)?(s.setChanged(!0),n&&n()):s.deleteTriples(i,n,r,!0)}})},RDFE.Document.prototype.deleteTriple=RDFE.Document.prototype.deleteTriples,RDFE.Document.prototype.updateTriple=function(e,t,i,n){var r=this;r.deleteTriple(e,function(){r.addTriple(t,function(){r.setChanged(!0),i&&i()},function(){n&&n("Adding new triple failed")})},function(){n&&n("Deleting triple failed")})},RDFE.Document.prototype.inverseTriple=function(e){var t=null,i=e.subject,n=e.object;if("NamedNode"==i.interfaceName&&"NamedNode"==n.interfaceName){var r=e.predicate,o=this.ontologyManager.ontologyPropertyByURI(r.nominalValue);if(o){var s=o.inverseOf;s&&(t=this.store.rdf.createTriple(this.store.rdf.createNamedNode(n.nominalValue),this.store.rdf.createNamedNode(s.URI),this.store.rdf.createNamedNode(i.nominalValue)))}}return t},RDFE.Document.prototype.inverseTriples=function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=this.inverseTriple(e[i]);r&&t.push(r)}return t},RDFE.Document.prototype.getEntityLabel=function(e,t,i){var r=this,n=t,o=i;"function"==typeof n&&(o=n,n=void 0);var s=function(i,n){n>=i.length?o(RDFE.Utils.uri2name(e),!1):r.store.execute("select ?l from <"+r.graph+"> where { <"+e+"> <"+i[n]+"> ?l . }",function(e,t){!e&&0<t.length&&0<t[0].l.value.length?o(t[0].l.value,!0):s(i,n+1)})};s(n||r.config.options.labelProps,0)},RDFE.Document.prototype.getEntity=function(s,a){var l=this;l.store.node(s,l.graph,function(e,t){var i={uri:s,label:RDFE.Utils.uri2name(s),types:[],properties:{}};if(!e){for(var n=t.triples,r=0;r<n.length;r++){var o=n[r].predicate.nominalValue;(i.properties[o]=i.properties[o]||[]).push(RDFE.RdfNode.fromStoreNode(n[r].object)),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"==o&&i.types.push(n[r].object.nominalValue)}for(r=0;r<l.config.options.labelProps.length;r++)if(i.properties[l.config.options.labelProps[r]]){i.label=i.properties[l.config.options.labelProps[r]][0].toString();break}}a(i)})},RDFE.Document.prototype.listProperties=function(r){this.store.execute("select distinct ?p from <"+this.graph+"> where { ?s ?p ?o }",function(e,t){var i=[];if(!e)for(var n=0;n<t.length;n++)i.push(t[n].p.value);r(i)})},RDFE.Document.prototype.listEntities=function(e,a,l){var u=this;"string"==typeof e&&(e=[e]);var t="select ?s ?p ?o from <{0}> where { ?s ?p ?o . ".format(u.graph);if(0<e.length){t+="?s a ?t . filter(";for(var i=0;i<e.length;i++)0<i&&(t+=" || "),t+='(str(?t) = "{0}")'.format(e[i]);t+=") . "}t+="}",u.store.execute(t,function(e,t){var i={};if(e)l&&l(e);else{for(var n=0;n<t.length;n++){var r=t[n].s.value,o=t[n].p.value;i[r]||(i[r]={uri:r,types:[]});var s=i[r];"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"==o?s.types.push(t[n].o.value):0<=_.indexOf(u.config.options.labelProps,o)&&(s[o]=t[n].o.value)}i=_.values(i);for(n=0;n<i.length;n++)i[n].label=u.getEntityLabel(i[n])}a(i)})},RDFE.Document.prototype.itemsByRange=function(e){var n;if(e){for(var t=0;t<e.length;t++){var i=this.ontologyManager.ontologyClassByURI(e[t]);if(i){n=n||[];for(var r=_.values(i.getIndividuals()),o=0;o<r.length;o++){var s=RDFE.RdfNode.fromStoreNode(r[o].URI);s.label=r[o].curi||r[o].URI,n.push(s)}this.listEntities(e[t],function(e){for(var t=0;t<e.length;t++){var i=RDFE.RdfNode.fromStoreNode(e[t].uri);i.label=e[t].label||e[t].uri,n.push(i)}})}}return n}},RDFE.Document.prototype.buildEntityUri=function(e){var n=this.config.options.entityUriTmpl;n&&0!=n.length||(n="urn:entities:{NAME}");var t=e||"entity";0<=(n=n.replace("{DOC-URI}",this.url||"urn:entities:")).indexOf("{NAME}")?n=n.replace("{NAME}",encodeURIComponent(t)):("#"!=n[n.length-1]&&"/"!=n[n.length-1]&&":"!=n[n.length-1]&&(n+="#"),n+=encodeURIComponent(t));var r=n,o=this,s=function(i){o.store.node(r,o.graph,function(e,t){console.log(e,t),!e&&t.length&&(r=n+i,s(i+1))})};return s(1),r},RDFE.Document.prototype.addEntity=function(e,t,i,n,r){var o=this;e&&0!=e.length||(e=o.buildEntityUri(t));var s=[o.store.rdf.createTriple(o.store.rdf.createNamedNode(e),o.store.rdf.createNamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),o.store.rdf.createNamedNode(i))];if(t&&0<t.length){var a=o.ontologyManager.uriDenormalize(o.config.options.labelProps[0]);s.push(o.store.rdf.createTriple(o.store.rdf.createNamedNode(e),o.store.rdf.createNamedNode(a),o.store.rdf.createLiteral(t)))}for(var l=o.ontologyManager.ontologyClassByURI(i),u=l?l.getUniqueRestrictions():[],c=0;c<u.length;c++){var d=u[c],h=o.getUniqueValue(e,d);h&&s.push(o.store.rdf.createTriple(o.store.rdf.createNamedNode(e),o.store.rdf.createNamedNode(d.URI),o.store.rdf.createLiteral(h.toString(),null,d.range)))}o.addTriples(s,function(){n&&n({uri:e,label:t})},function(){r&&r()})},RDFE.Document.prototype.listSubjects=function(s,a){var l=this;l.store.graph(l.graph,function(e,t){if(e)a&&a(e);else{for(var i={},n=t.toArray(),r=0;r<n.length;r+=1){var o=n[r].subject.toString();i[o]||(i[o]=l.newSubject(o)),i[o].items.push(n[r])}i=_.values(i),s(i)}})},RDFE.Document.prototype.getSubject=function(o,s,a){var l=this;l.store.graph(l.graph,function(e,t){if(e)a&&a(e);else{for(var i=l.newSubject(o),n=t.toArray(),r=0;r<n.length;r+=1)n[r].subject.toString()===o&&i.items.push(n[r]);s&&s(i)}})},RDFE.Document.prototype.newSubject=function(e){return{uri:e,items:[]}},RDFE.Document.prototype.listPredicates=function(s,a){var l=this;l.store.graph(l.graph,function(e,t){if(e)a&&a(e);else{for(var i={},n=t.toArray(),r=0;r<n.length;r+=1){var o=n[r].predicate.toString();i[o]||(i[o]=l.newPredicate(o)),i[o].items.push(n[r])}i=_.values(i),s(i)}})},RDFE.Document.prototype.getPredicate=function(o,s,a){var l=this;l.store.graph(l.graph,function(e,t){if(e)a&&a(e);else{for(var i=l.newPredicate(o),n=t.toArray(),r=0;r<n.length;r+=1)n[r].predicate.toString()===o&&i.items.push(n[r]);s&&s(i)}})},RDFE.Document.prototype.newPredicate=function(e){return{uri:e,items:[]}},RDFE.Document.prototype.listObjects=function(a,l){var u=this;u.store.graph(u.graph,function(e,t){if(e)l&&l(e);else{for(var i={},n=t.toArray(),r=0;r<n.length;r+=1){var o=n[r].object,s=u.formatObjectID(o);i[s]||(i[s]=u.newObject(o)),i[s].items.push(n[r])}i=_.values(i),a(i)}})},RDFE.Document.prototype.getObject=function(o,s,a){var l=this;l.store.graph(l.graph,function(e,t){if(e)a&&a(e);else{for(var i=l.newObject(o),n=t.toArray(),r=0;r<n.length;r+=1)l.formatObjectID(n[r].object)===i.id&&i.items.push(n[r]);s&&s(i)}})},RDFE.Document.prototype.newObject=function(e){return"string"==typeof e&&(e=new RDFE.RdfNode("literal",e)),{id:this.formatObjectID(e),label:this.formatObjectLabel(e),type:this.formatObjectType(e),object:e,items:[]}},RDFE.Document.prototype.formatObjectID=function(e){if("Literal"!=e.interfaceName)return e.toString();var t="http://www.w3.org/2001/XMLSchema#dateTime"==e.datatype?new Date(e.nominalValue).toString():e.nominalValue;return(e.datatype?e.datatype:"literal")+" - "+t},RDFE.Document.prototype.formatObjectLabel=function(e){return"Literal"===e.interfaceName?"http://www.w3.org/2001/XMLSchema#dateTime"==e.datatype?new Date(e.nominalValue).toString():e.nominalValue:e.toString()},RDFE.Document.prototype.formatObjectType=function(e){return"Literal"===e.interfaceName?e.datatype?e.datatype:"http://www.w3.org/2000/01/rdf-schema#Literal":"IRI"},RDFE.Document.prototype.getEntityLabel=function(e){for(var t=0;t<this.config.options.labelProps.length;t++)if(e[this.config.options.labelProps[t]])return e[this.config.options.labelProps[t]];return RDFE.Utils.uri2name(e.uri)},RDFE.Document.prototype.getUniqueValue=function(){var o=["http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#string"],s=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#positiveInteger"];return function(i,n){var r,e=n.range;if(-1!==o.indexOf(e))r=i;else if(-1!==s.indexOf(e)){r=1;var t="select (MAX(?v) as ?mv) from <{0}> where {?s <{1}> ?v}".format(this.graph,n.URI);this.store.execute(t,function(e,t){e?console.log("Failed to determine unique value for ",i," and ",n.URI,t):0!==t.length&&(r=parseInt(RDFE.coalesce(t[0].mv.value,0)),isNaN(r)&&(r=0),r++)})}return r}}(),RDFE.Document.prototype.checkForSignature=function(i){var n=this;n.store.registerDefaultNamespace("rdfs","http://www.w3.org/2000/01/rdf-schema#"),n.store.registerDefaultNamespace("cert","http://www.w3.org/ns/auth/cert#"),n.store.registerDefaultNamespace("oplcert","http://www.openlinksw.com/schemas/cert#");var e="SELECT ?signatureDocURI        FROM <{0}>        WHERE {                <{1}> oplcert:hasSignature ?signatureDocURI .              }";e=e.format(n.graph,n.url),n.store.execute(e,function(e,t){!e&&t.length?n.signature=t[0].signatureDocURI.value:n.signature=null,i&&i(n.signature)})},function(e,t){"function"==typeof define&&define.amd?define("sifter",t):"object"==typeof exports?module.exports=t():e.Sifter=t()}(this,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(!(e=a(String(e||"").toLowerCase()))||!e.length)return[];var t,i,n,r,o=[],s=e.split(/ +/);for(t=0,i=s.length;t<i;t++){if(n=l(s[t]),this.settings.diacritics)for(r in u)u.hasOwnProperty(r)&&(n=n.replace(new RegExp(r,"g"),u[r]));o.push({string:s[t],regex:new RegExp(n,"i")})}return o},e.prototype.iterator=function(e,t){(s(e)?Array.prototype.forEach||function(e){for(var t=0,i=this.length;t<i;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)}).apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var r,o,s,a;e=this.prepareSearch(e,t),o=e.tokens,r=e.options.fields,s=o.length,a=e.options.nesting;var l,u=function(e,t){var i,n;return e?-1===(n=(e=String(e||"")).search(t.regex))?0:(i=t.string.length/e.length,0===n&&(i+=.5),i):0},c=(l=r.length)?1===l?function(e,t){return u(f(t,r[0],a),e)}:function(e,t){for(var i=0,n=0;i<l;i++)n+=u(f(t,r[i],a),e);return n/l}:function(){return 0};return s?1===s?function(e){return c(o[0],e)}:"and"===e.options.conjunction?function(e){for(var t,i=0,n=0;i<s;i++){if((t=c(o[i],e))<=0)return 0;n+=t}return n/s}:function(e){for(var t=0,i=0;t<s;t++)i+=c(o[t],e);return i/s}:function(){return 0}},e.prototype.getSortFunction=function(e,i){var t,n,r,o,s,a,l,u,c,d,h;if(h=!(e=(r=this).prepareSearch(e,i)).query&&i.sort_empty||i.sort,c=function(e,t){return"$score"===e?t.score:f(r.items[t.id],e,i.nesting)},s=[],h)for(t=0,n=h.length;t<n;t++)(e.query||"$score"!==h[t].field)&&s.push(h[t]);if(e.query){for(d=!0,t=0,n=s.length;t<n;t++)if("$score"===s[t].field){d=!1;break}d&&s.unshift({field:"$score",direction:"desc"})}else for(t=0,n=s.length;t<n;t++)if("$score"===s[t].field){s.splice(t,1);break}for(u=[],t=0,n=s.length;t<n;t++)u.push("desc"===s[t].direction?-1:1);return(a=s.length)?1===a?(o=s[0].field,l=u[0],function(e,t){return l*p(c(o,e),c(o,t))}):function(e,t){var i,n,r;for(i=0;i<a;i++)if(r=s[i].field,n=u[i]*p(c(r,e),c(r,t)))return n;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;var i=(t=o({},t)).fields,n=t.sort,r=t.sort_empty;return i&&!s(i)&&(t.fields=[i]),n&&!s(n)&&(t.sort=[n]),r&&!s(r)&&(t.sort_empty=[r]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,i){var n,r,t,o;return r=this.prepareSearch(e,i),i=r.options,e=r.query,o=i.score||this.getScoreFunction(r),e.length?this.iterator(this.items,function(e,t){n=o(e),(!1===i.filter||0<n)&&r.items.push({score:n,id:t})}):this.iterator(this.items,function(e,t){r.items.push({score:1,id:t})}),(t=this.getSortFunction(r,i))&&r.items.sort(t),r.total=r.items.length,"number"==typeof i.limit&&(r.items=r.items.slice(0,i.limit)),r};var p=function(e,t){return"number"==typeof e&&"number"==typeof t?t<e?1:e<t?-1:0:(e=i(String(e||"")),(t=i(String(t||"")))<e?1:e<t?-1:0)},o=function(e,t){var i,n,r,o;for(i=1,n=arguments.length;i<n;i++)if(o=arguments[i])for(r in o)o.hasOwnProperty(r)&&(e[r]=o[r]);return e},f=function(e,t,i){if(e&&t){if(!i)return e[t];for(var n=t.split(".");n.length&&(e=e[n.shift()]););return e}},a=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},l=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},s=Array.isArray||"undefined"!=typeof $&&$.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},i=function(){var e,t,i,n,r="",o={};for(i in u)if(u.hasOwnProperty(i))for(r+=n=u[i].substring(2,u[i].length-1),e=0,t=n.length;e<t;e++)o[n.charAt(e)]=i;var s=new RegExp("["+r+"]","g");return function(e){return e.replace(s,function(e){return o[e]}).toLowerCase()}}();return e}),function(e,t){"function"==typeof define&&define.amd?define("microplugin",t):"object"==typeof exports?module.exports=t():e.MicroPlugin=t()}(this,function(){var e={mixin:function(n){n.plugins={},n.prototype.initializePlugins=function(e){var t,i,n,r=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},o.isArray(e))for(t=0,i=e.length;t<i;t++)"string"==typeof e[t]?r.push(e[t]):(this.plugins.settings[e[t].name]=e[t].options,r.push(e[t].name));else if(e)for(n in e)e.hasOwnProperty(n)&&(this.plugins.settings[n]=e[n],r.push(n));for(;r.length;)this.require(r.shift())},n.prototype.loadPlugin=function(e){var t=this.plugins,i=n.plugins[e];if(!n.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');t.requested[e]=!0,t.loaded[e]=i.fn.apply(this,[this.plugins.settings[e]||{}]),t.names.push(e)},n.prototype.require=function(e){var t=this.plugins;if(!this.plugins.loaded.hasOwnProperty(e)){if(t.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');this.loadPlugin(e)}return t.loaded[e]},n.define=function(e,t){n.plugins[e]={name:e,fn:t}}}},o={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}};return e}),function(e,t){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],t):"object"==typeof exports?module.exports=t(require("jquery"),require("sifter"),require("microplugin")):e.Selectize=t(e.jQuery,e.Sifter,e.MicroPlugin)}(this,function(F,d,e){"use strict";var C=function(e,t){if("string"!=typeof t||t.length){var l="string"==typeof t?new RegExp(t,"i"):t,u=function(e){var t=0;if(3===e.nodeType){var i=e.data.search(l);if(0<=i&&0<e.data.length){var n=e.data.match(l),r=document.createElement("span");r.className="highlight";var o=e.splitText(i),s=(o.splitText(n[0].length),o.cloneNode(!0));r.appendChild(s),o.parentNode.replaceChild(r,o),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var a=0;a<e.childNodes.length;++a)a+=u(e.childNodes[a]);return t};return e.each(function(){u(this)})}};F.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()};var n=function(){};n.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=!1&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=!1)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(e){for(var t=["on","off","trigger"],i=0;i<t.length;i++)e.prototype[t[i]]=n.prototype[t[i]]};var x=/Mac/.test(navigator.userAgent),k=x?91:17,_=x?18:17,E=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,u=function(e){return void 0!==e},T=function(e){return null==e?null:"boolean"==typeof e?e?"1":"0":e+""},a=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},t={before:function(e,t,i){var n=e[t];e[t]=function(){return i.apply(e,arguments),n.apply(e,arguments)}},after:function(t,e,i){var n=t[e];t[e]=function(){var e=n.apply(t,arguments);return i.apply(t,arguments),e}}},i=function(t,i,e){var n,r=t.trigger,o={};for(n in t.trigger=function(){var e=arguments[0];if(-1===i.indexOf(e))return r.apply(t,arguments);o[e]=arguments},e.apply(t,[]),t.trigger=r,o)o.hasOwnProperty(n)&&r.apply(t,o[n])},f=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var i=document.selection.createRange(),n=document.selection.createRange().text.length;i.moveStart("character",-e.value.length),t.start=i.text.length-n,t.length=n}return t},D=function(h){var p=null,e=function(e,t){var i,n,r,o,s,a,l,u,c,d;(t=t||{},(e=e||window.event||{}).metaKey||e.altKey)||(t.force||!1!==h.data("grow"))&&(i=h.val(),e.type&&"keydown"===e.type.toLowerCase()&&(r=48<=(n=e.keyCode)&&n<=57||65<=n&&n<=90||96<=n&&n<=111||186<=n&&n<=222||32===n,46===n||8===n?(u=f(h[0])).length?i=i.substring(0,u.start)+i.substring(u.start+u.length):8===n&&u.start?i=i.substring(0,u.start-1)+i.substring(u.start+1):46===n&&void 0!==u.start&&(i=i.substring(0,u.start)+i.substring(u.start+1)):r&&(a=e.shiftKey,l=String.fromCharCode(e.keyCode),i+=l=a?l.toUpperCase():l.toLowerCase())),o=h.attr("placeholder"),!i&&o&&(i=o),d=h,(s=((c=i)?(b.$testInput||(b.$testInput=F("<span />").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).appendTo("body")),b.$testInput.text(c),function(e,t,i){var n,r,o={};if(i)for(n=0,r=i.length;n<r;n++)o[i[n]]=e.css(i[n]);else o=e.css();t.css(o)}(d,b.$testInput,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]),b.$testInput.width()):0)+4)!==p&&(p=s,h.width(s),h.triggerHandler("resize")))};h.on("keydown keyup update blur",e),e()},b=function(e,t){var i,n,r,o,s=this;(o=e[0]).selectize=s;var a,l,u,c=window.getComputedStyle&&window.getComputedStyle(o,null);if(r=(r=c?c.getPropertyValue("direction"):o.currentStyle&&o.currentStyle.direction)||e.parents("[dir]:first").attr("dir")||"",F.extend(s,{order:0,settings:t,$input:e,tabIndex:e.attr("tabindex")||"",tagType:"select"===o.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(r),eventNS:".selectize"+ ++b.count,highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:e.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===t.loadThrottle?s.onSearchChange:(a=s.onSearchChange,l=t.loadThrottle,function(){var e=this,t=arguments;window.clearTimeout(u),u=window.setTimeout(function(){a.apply(e,t)},l)})}),s.sifter=new d(this.options,{diacritics:t.diacritics}),s.settings.options){for(i=0,n=s.settings.options.length;i<n;i++)s.registerOption(s.settings.options[i]);delete s.settings.options}if(s.settings.optgroups){for(i=0,n=s.settings.optgroups.length;i<n;i++)s.registerOptionGroup(s.settings.optgroups[i]);delete s.settings.optgroups}s.settings.mode=s.settings.mode||(1===s.settings.maxItems?"single":"multi"),"boolean"!=typeof s.settings.hideSelected&&(s.settings.hideSelected="multi"===s.settings.mode),s.initializePlugins(s.settings.plugins),s.setupCallbacks(),s.setupTemplates(),s.setup()};return n.mixin(b),void 0!==e?e.mixin(b):function(e,t){t||(t={});console.error("Selectize: "+e),t.explanation&&(console.group&&console.group(),console.error(t.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),F.extend(b.prototype,{setup:function(){var e,t,i,n,r,o,s,a,l,u,c,d,h,p,f=this,g=f.settings,v=f.eventNS,m=F(window),y=F(document),b=f.$input;if(s=f.settings.mode,a=b.attr("class")||"",e=F("<div>").addClass(g.wrapperClass).addClass(a).addClass(s),t=F("<div>").addClass(g.inputClass).addClass("items").appendTo(e),i=F('<input type="text" autocomplete="off" />').appendTo(t).attr("tabindex",b.is(":disabled")?"-1":f.tabIndex),o=F(g.dropdownParent||e),n=F("<div>").addClass(g.dropdownClass).addClass(s).hide().appendTo(o),r=F("<div>").addClass(g.dropdownContentClass).appendTo(n),(u=b.attr("id"))&&(i.attr("id",u+"-selectized"),F("label[for='"+u+"']").attr("for",u+"-selectized")),f.settings.copyClassesToDropdown&&n.addClass(a),e.css({width:b[0].style.width}),f.plugins.names.length&&(l="plugin-"+f.plugins.names.join(" plugin-"),e.addClass(l),n.addClass(l)),(null===g.maxItems||1<g.maxItems)&&1===f.tagType&&b.attr("multiple","multiple"),f.settings.placeholder&&i.attr("placeholder",g.placeholder),!f.settings.splitOn&&f.settings.delimiter){var w=f.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");f.settings.splitOn=new RegExp("\\s*"+w+"+\\s*")}b.attr("autocorrect")&&i.attr("autocorrect",b.attr("autocorrect")),b.attr("autocapitalize")&&i.attr("autocapitalize",b.attr("autocapitalize")),i[0].type=b[0].type,f.$wrapper=e,f.$control=t,f.$control_input=i,f.$dropdown=n,f.$dropdown_content=r,n.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",function(e){e.stopImmediatePropagation()}),n.on("mouseenter","[data-selectable]",function(){return f.onOptionHover.apply(f,arguments)}),n.on("mousedown click","[data-selectable]",function(){return f.onOptionSelect.apply(f,arguments)}),d="mousedown",h="*:not(input)",p=function(){return f.onItemSelect.apply(f,arguments)},(c=t).on(d,h,function(e){for(var t=e.target;t&&t.parentNode!==c[0];)t=t.parentNode;return e.currentTarget=t,p.apply(this,[e])}),D(i),t.on({mousedown:function(){return f.onMouseDown.apply(f,arguments)},click:function(){return f.onClick.apply(f,arguments)}}),i.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return f.onKeyDown.apply(f,arguments)},keyup:function(){return f.onKeyUp.apply(f,arguments)},keypress:function(){return f.onKeyPress.apply(f,arguments)},resize:function(){f.positionDropdown.apply(f,[])},blur:function(){return f.onBlur.apply(f,arguments)},focus:function(){return f.ignoreBlur=!1,f.onFocus.apply(f,arguments)},paste:function(){return f.onPaste.apply(f,arguments)}}),y.on("keydown"+v,function(e){f.isCmdDown=e[x?"metaKey":"ctrlKey"],f.isCtrlDown=e[x?"altKey":"ctrlKey"],f.isShiftDown=e.shiftKey}),y.on("keyup"+v,function(e){e.keyCode===_&&(f.isCtrlDown=!1),16===e.keyCode&&(f.isShiftDown=!1),e.keyCode===k&&(f.isCmdDown=!1)}),y.on("mousedown"+v,function(e){if(f.isFocused){if(e.target===f.$dropdown[0]||e.target.parentNode===f.$dropdown[0])return!1;f.$control.has(e.target).length||e.target===f.$control[0]||f.blur(e.target)}}),m.on(["scroll"+v,"resize"+v].join(" "),function(){f.isOpen&&f.positionDropdown.apply(f,arguments)}),m.on("mousemove"+v,function(){f.ignoreHover=!1}),this.revertSettings={$children:b.children().detach(),tabindex:b.attr("tabindex")},b.attr("tabindex",-1).hide().after(f.$wrapper),F.isArray(g.items)&&(f.setValue(g.items),delete g.items),E&&b.on("invalid"+v,function(e){e.preventDefault(),f.isInvalid=!0,f.refreshState()}),f.updateOriginalInput(),f.refreshItems(),f.refreshState(),f.updatePlaceholder(),f.isSetup=!0,b.is(":disabled")&&f.disable(),f.on("change",this.onChange),b.data("selectize",f),b.addClass("selectized"),f.trigger("initialize"),!0===g.preload&&f.onSearchChange("")},setupTemplates:function(){var i=this.settings.labelField,n=this.settings.optgroupLabelField,e={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[n])+"</div>"},option:function(e,t){return'<div class="option">'+t(e[i])+"</div>"},item:function(e,t){return'<div class="item">'+t(e[i])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};this.settings.render=F.extend({},e,this.settings.render)},setupCallbacks:function(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)i.hasOwnProperty(e)&&(t=this.settings[i[e]])&&this.on(e,t)},onClick:function(e){this.isFocused&&this.isOpen||(this.focus(),e.preventDefault())},onMouseDown:function(e){var t=this,i=e.isDefaultPrevented();F(e.target);if(t.isFocused){if(e.target!==t.$control_input[0])return"single"===t.settings.mode?t.isOpen?t.close():t.open():i||t.setActiveItem(null),!1}else i||window.setTimeout(function(){t.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var r=this;r.isFull()||r.isInputHidden||r.isLocked?e.preventDefault():r.settings.splitOn&&setTimeout(function(){var e=r.$control_input.val();if(e.match(r.settings.splitOn))for(var t=F.trim(e).split(r.settings.splitOn),i=0,n=t.length;i<n;i++)r.createItem(t[i])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){e.target,this.$control_input[0];var t=this;if(t.isLocked)9!==e.keyCode&&e.preventDefault();else{switch(e.keyCode){case 65:if(t.isCmdDown)return void t.selectAll();break;case 27:return void(t.isOpen&&(e.preventDefault(),e.stopPropagation(),t.close()));case 78:if(!e.ctrlKey||e.altKey)break;case 40:if(!t.isOpen&&t.hasOptions)t.open();else if(t.$activeOption){t.ignoreHover=!0;var i=t.getAdjacentOption(t.$activeOption,1);i.length&&t.setActiveOption(i,!0,!0)}return void e.preventDefault();case 80:if(!e.ctrlKey||e.altKey)break;case 38:if(t.$activeOption){t.ignoreHover=!0;var n=t.getAdjacentOption(t.$activeOption,-1);n.length&&t.setActiveOption(n,!0,!0)}return void e.preventDefault();case 13:return void(t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),e.preventDefault()));case 37:return void t.advanceSelection(-1,e);case 39:return void t.advanceSelection(1,e);case 9:return t.settings.selectOnTab&&t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),t.isFull()||e.preventDefault()),void(t.settings.create&&t.createItem()&&e.preventDefault());case 8:case 46:return void t.deleteSelection(e)}!t.isFull()&&!t.isInputHidden||(x?e.metaKey:e.ctrlKey)||e.preventDefault()}},onKeyUp:function(e){if(this.isLocked)return e&&e.preventDefault();var t=this.$control_input.val()||"";this.lastValue!==t&&(this.lastValue=t,this.onSearchChange(t),this.refreshOptions(),this.trigger("type",t))},onSearchChange:function(t){var i=this,n=i.settings.load;n&&(i.loadedSearches.hasOwnProperty(t)||(i.loadedSearches[t]=!0,i.load(function(e){n.apply(i,[t,e])})))},onFocus:function(e){var t=this,i=t.isFocused;if(t.isDisabled)return t.blur(),e&&e.preventDefault(),!1;t.ignoreFocus||(t.isFocused=!0,"focus"===t.settings.preload&&t.onSearchChange(""),i||t.trigger("focus"),t.$activeItems.length||(t.showInput(),t.setActiveItem(null),t.refreshOptions(!!t.settings.openOnFocus)),t.refreshState())},onBlur:function(e,t){var i=this;if(i.isFocused&&(i.isFocused=!1,!i.ignoreFocus)){if(!i.ignoreBlur&&document.activeElement===i.$dropdown_content[0])return i.ignoreBlur=!0,void i.onFocus(e);var n=function(){i.close(),i.setTextboxValue(""),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),t&&t.focus&&t.focus(),i.isBlurring=!1,i.ignoreFocus=!1,i.trigger("blur")};i.isBlurring=!0,i.ignoreFocus=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,n):n()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(e){var t,i,n=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),(i=F(e.currentTarget)).hasClass("create")?n.createItem(null,function(){n.settings.closeAfterSelect&&n.close()}):void 0!==(t=i.attr("data-value"))&&(n.lastQuery=null,n.setTextboxValue(""),n.addItem(t),n.settings.closeAfterSelect?n.close():!n.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&n.setActiveOption(n.getOption(t)))},onItemSelect:function(e){this.isLocked||"multi"===this.settings.mode&&(e.preventDefault(),this.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,i=t.$wrapper.addClass(t.settings.loadingClass);t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||i.removeClass(t.settings.loadingClass),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input;t.val()!==e&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,t){i(this,t?[]:["change"],function(){this.clear(t),this.addItems(e,t)})},setActiveItem:function(e,t){var i,n,r,o,s,a,l,u,c=this;if("single"!==c.settings.mode){if(!(e=F(e)).length)return F(c.$activeItems).removeClass("active"),c.$activeItems=[],void(c.isFocused&&c.showInput());if("mousedown"===(i=t&&t.type.toLowerCase())&&c.isShiftDown&&c.$activeItems.length){for(u=c.$control.children(".active:last"),o=Array.prototype.indexOf.apply(c.$control[0].childNodes,[u[0]]),(s=Array.prototype.indexOf.apply(c.$control[0].childNodes,[e[0]]))<o&&(l=o,o=s,s=l),n=o;n<=s;n++)a=c.$control[0].childNodes[n],-1===c.$activeItems.indexOf(a)&&(F(a).addClass("active"),c.$activeItems.push(a));t.preventDefault()}else"mousedown"===i&&c.isCtrlDown||"keydown"===i&&this.isShiftDown?e.hasClass("active")?(r=c.$activeItems.indexOf(e[0]),c.$activeItems.splice(r,1),e.removeClass("active")):c.$activeItems.push(e.addClass("active")[0]):(F(c.$activeItems).removeClass("active"),c.$activeItems=[e.addClass("active")[0]]);c.hideInput(),this.isFocused||c.focus()}},setActiveOption:function(e,t,i){var n,r,o,s,a,l=this;l.$activeOption&&l.$activeOption.removeClass("active"),l.$activeOption=null,(e=F(e)).length&&(l.$activeOption=e.addClass("active"),!t&&u(t)||(n=l.$dropdown_content.height(),r=l.$activeOption.outerHeight(!0),t=l.$dropdown_content.scrollTop()||0,a=(s=o=l.$activeOption.offset().top-l.$dropdown_content.offset().top+t)-n+r,n+t<o+r?l.$dropdown_content.stop().animate({scrollTop:a},i?l.settings.scrollDuration:0):o<t&&l.$dropdown_content.stop().animate({scrollTop:s},i?l.settings.scrollDuration:0)))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))},blur:function(e){this.$control_input[0].blur(),this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t,nesting:e.nesting}},search:function(e){var t,i,n,r=this.settings,o=this.getSearchOptions();if(r.score&&"function"!=typeof(n=this.settings.score.apply(this,[e])))throw new Error('Selectize "score" setting must be a function that returns a function');if(e!==this.lastQuery?(this.lastQuery=e,i=this.sifter.search(e,F.extend(o,{score:n})),this.currentResults=i):i=F.extend(!0,{},this.currentResults),r.hideSelected)for(t=i.items.length-1;0<=t;t--)-1!==this.items.indexOf(T(i.items[t].id))&&i.items.splice(t,1);return i},refreshOptions:function(e){var t,i,n,r,o,s,a,l,u,c,d,h,p,f,g,v;void 0===e&&(e=!0);var m,y,b=this,w=F.trim(b.$control_input.val()),x=b.search(w),k=b.$dropdown_content,_=b.$activeOption&&T(b.$activeOption.attr("data-value"));for(r=x.items.length,"number"==typeof b.settings.maxOptions&&(r=Math.min(r,b.settings.maxOptions)),o={},s=[],t=0;t<r;t++)for(a=b.options[x.items[t].id],l=b.render("option",a),u=a[b.settings.optgroupField]||"",i=0,n=(c=F.isArray(u)?u:[u])&&c.length;i<n;i++)u=c[i],b.optgroups.hasOwnProperty(u)||(u=""),o.hasOwnProperty(u)||(o[u]=document.createDocumentFragment(),s.push(u)),o[u].appendChild(l);for(this.settings.lockOptgroupOrder&&s.sort(function(e,t){return(b.optgroups[e].$order||0)-(b.optgroups[t].$order||0)}),d=document.createDocumentFragment(),t=0,r=s.length;t<r;t++)u=s[t],b.optgroups.hasOwnProperty(u)&&o[u].childNodes.length?((h=document.createDocumentFragment()).appendChild(b.render("optgroup_header",b.optgroups[u])),h.appendChild(o[u]),d.appendChild(b.render("optgroup",F.extend({},b.optgroups[u],{html:(m=h,y=void 0,y=document.createElement("div"),y.appendChild(m.cloneNode(!0)),y.innerHTML),dom:h})))):d.appendChild(o[u]);if(k.html(d),b.settings.highlight&&(k.removeHighlight(),x.query.length&&x.tokens.length))for(t=0,r=x.tokens.length;t<r;t++)C(k,x.tokens[t].regex);if(!b.settings.hideSelected)for(t=0,r=b.items.length;t<r;t++)b.getOption(b.items[t]).addClass("selected");(p=b.canCreate(w))&&(k.prepend(b.render("option_create",{input:w})),v=F(k[0].childNodes[0])),b.hasOptions=0<x.items.length||p,b.hasOptions?(0<x.items.length?((g=_&&b.getOption(_))&&g.length?f=g:"single"===b.settings.mode&&b.items.length&&(f=b.getOption(b.items[0])),f&&f.length||(f=v&&!b.settings.addPrecedence?b.getAdjacentOption(v,1):k.find("[data-selectable]:first"))):f=v,b.setActiveOption(f),e&&!b.isOpen&&b.open()):(b.setActiveOption(null),e&&b.isOpen&&b.close())},addOption:function(e){var t,i,n;if(F.isArray(e))for(t=0,i=e.length;t<i;t++)this.addOption(e[t]);else(n=this.registerOption(e))&&(this.userOptions[n]=!0,this.lastQuery=null,this.trigger("option_add",n,e))},registerOption:function(e){var t=T(e[this.settings.valueField]);return null!=t&&!this.options.hasOwnProperty(t)&&(e.$order=e.$order||++this.order,this.options[t]=e,t)},registerOptionGroup:function(e){var t=T(e[this.settings.optgroupValueField]);return!!t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)},removeOptionGroup:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.renderCache={},this.trigger("optgroup_remove",e))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,t){var i,n,r,o,s,a,l,u=this;if(e=T(e),r=T(t[u.settings.valueField]),null!==e&&u.options.hasOwnProperty(e)){if("string"!=typeof r)throw new Error("Value must be set in option data");l=u.options[e].$order,r!==e&&(delete u.options[e],-1!==(o=u.items.indexOf(e))&&u.items.splice(o,1,r)),t.$order=t.$order||l,u.options[r]=t,s=u.renderCache.item,a=u.renderCache.option,s&&(delete s[e],delete s[r]),a&&(delete a[e],delete a[r]),-1!==u.items.indexOf(r)&&(i=u.getItem(e),n=F(u.render("item",t)),i.hasClass("active")&&n.addClass("active"),i.replaceWith(n)),u.lastQuery=null,u.isOpen&&u.refreshOptions(!1)}},removeOption:function(e,t){e=T(e);var i=this.renderCache.item,n=this.renderCache.option;i&&delete i[e],n&&delete n[e],delete this.userOptions[e],delete this.options[e],this.lastQuery=null,this.trigger("option_remove",e),this.removeItem(e,t)},clearOptions:function(){var i=this;i.loadedSearches={},i.userOptions={},i.renderCache={};var n=i.options;F.each(i.options,function(e,t){-1==i.items.indexOf(e)&&delete n[e]}),i.options=i.sifter.items=n,i.lastQuery=null,i.trigger("option_clear")},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,t){var i=this.$dropdown.find("[data-selectable]"),n=i.index(e)+t;return 0<=n&&n<i.length?i.eq(n):F()},getElementWithValue:function(e,t){if(null!=(e=T(e)))for(var i=0,n=t.length;i<n;i++)if(t[i].getAttribute("data-value")===e)return F(t[i]);return F()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(e,t){this.buffer=document.createDocumentFragment();for(var i=this.$control[0].childNodes,n=0;n<i.length;n++)this.buffer.appendChild(i[n]);for(var r=F.isArray(e)?e:[e],o=(n=0,r.length);n<o;n++)this.isPending=n<o-1,this.addItem(r[n],t);var s=this.$control[0];s.insertBefore(this.buffer,s.firstChild),this.buffer=null},addItem:function(a,l){i(this,l?[]:["change"],function(){var e,t,i,n,r,o=this,s=o.settings.mode;a=T(a),-1===o.items.indexOf(a)?o.options.hasOwnProperty(a)&&("single"===s&&o.clear(l),"multi"===s&&o.isFull()||(e=F(o.render("item",o.options[a])),r=o.isFull(),o.items.splice(o.caretPos,0,a),o.insertAtCaret(e),(!o.isPending||!r&&o.isFull())&&o.refreshState(),o.isSetup&&(i=o.$dropdown_content.find("[data-selectable]"),o.isPending||(t=o.getOption(a),n=o.getAdjacentOption(t,1).attr("data-value"),o.refreshOptions(o.isFocused&&"single"!==s),n&&o.setActiveOption(o.getOption(n))),!i.length||o.isFull()?o.close():o.isPending||o.positionDropdown(),o.updatePlaceholder(),o.trigger("item_add",a,e),o.isPending||o.updateOriginalInput({silent:l})))):"single"===s&&o.close()})},removeItem:function(e,t){var i,n,r,o=this;i=e instanceof F?e:o.getItem(e),e=T(i.attr("data-value")),-1!==(n=o.items.indexOf(e))&&(i.remove(),i.hasClass("active")&&(r=o.$activeItems.indexOf(i[0]),o.$activeItems.splice(r,1)),o.items.splice(n,1),o.lastQuery=null,!o.settings.persist&&o.userOptions.hasOwnProperty(e)&&o.removeOption(e,t),n<o.caretPos&&o.setCaret(o.caretPos-1),o.refreshState(),o.updatePlaceholder(),o.updateOriginalInput({silent:t}),o.positionDropdown(),o.trigger("item_remove",e,i))},createItem:function(e,i){var n=this,r=n.caretPos;e=e||F.trim(n.$control_input.val()||"");var o=arguments[arguments.length-1];if("function"!=typeof o&&(o=function(){}),"boolean"!=typeof i&&(i=!0),!n.canCreate(e))return o(),!1;n.lock();var t,s,a="function"==typeof n.settings.create?this.settings.create:function(e){var t={};return t[n.settings.labelField]=e,t[n.settings.valueField]=e,t},l=(s=!(t=function(e){if(n.unlock(),!e||"object"!=typeof e)return o();var t=T(e[n.settings.valueField]);if("string"!=typeof t)return o();n.setTextboxValue(""),n.addOption(e),n.setCaret(r),n.addItem(t),n.refreshOptions(i&&"single"!==n.settings.mode),o(e)}),function(){s||(s=!0,t.apply(this,arguments))}),u=a.apply(this,[e,l]);return void 0!==u&&l(u),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var e=!this.items.length;this.isInvalid=e,this.$control_input.prop("required",e),this.$input.prop("required",!e)},refreshClasses:function(){var e=this,t=e.isFull(),i=e.isLocked;e.$wrapper.toggleClass("rtl",e.rtl),e.$control.toggleClass("focus",e.isFocused).toggleClass("disabled",e.isDisabled).toggleClass("required",e.isRequired).toggleClass("invalid",e.isInvalid).toggleClass("locked",i).toggleClass("full",t).toggleClass("not-full",!t).toggleClass("input-active",e.isFocused&&!e.isInputHidden).toggleClass("dropdown-active",e.isOpen).toggleClass("has-options",!F.isEmptyObject(e.options)).toggleClass("has-items",0<e.items.length),e.$control_input.data("grow",!t&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,i,n,r,o=this;if(e=e||{},1===o.tagType){for(n=[],t=0,i=o.items.length;t<i;t++)r=o.options[o.items[t]][o.settings.labelField]||"",n.push('<option value="'+a(o.items[t])+'" selected="selected">'+a(r)+"</option>");n.length||this.$input.attr("multiple")||n.push('<option value="" selected="selected"></option>'),o.$input.html(n.join(""))}else o.$input.val(o.getValue()),o.$input.attr("value",o.$input.val());o.isSetup&&(e.silent||o.trigger("change",o.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})}},open:function(){var e=this;e.isLocked||e.isOpen||"multi"===e.settings.mode&&e.isFull()||(e.focus(),e.isOpen=!0,e.refreshState(),e.$dropdown.css({visibility:"hidden",display:"block"}),e.positionDropdown(),e.$dropdown.css({visibility:"visible"}),e.trigger("dropdown_open",e.$dropdown))},close:function(){var e=this,t=e.isOpen;"single"===e.settings.mode&&e.items.length&&(e.hideInput(),e.isBlurring||e.$control_input.blur()),e.isOpen=!1,e.$dropdown.hide(),e.setActiveOption(null),e.refreshState(),t&&e.trigger("dropdown_close",e.$dropdown)},positionDropdown:function(){var e=this.$control,t="body"===this.settings.dropdownParent?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e[0].getBoundingClientRect().width,top:t.top,left:t.left})},clear:function(e){var t=this;t.items.length&&(t.$control.children(":not(input)").remove(),t.items=[],t.lastQuery=null,t.setCaret(0),t.setActiveItem(null),t.updatePlaceholder(),t.updateOriginalInput({silent:e}),t.refreshState(),t.showInput(),t.trigger("clear"))},insertAtCaret:function(e){var t=Math.min(this.caretPos,this.items.length),i=e[0],n=this.buffer||this.$control[0];0===t?n.insertBefore(i,n.firstChild):n.insertBefore(i,n.childNodes[t]),this.setCaret(t+1)},deleteSelection:function(e){var t,i,n,r,o,s,a,l,u,c=this;if(n=e&&8===e.keyCode?-1:1,r=f(c.$control_input[0]),c.$activeOption&&!c.settings.hideSelected&&(a=c.getAdjacentOption(c.$activeOption,-1).attr("data-value")),o=[],c.$activeItems.length){for(u=c.$control.children(".active:"+(0<n?"last":"first")),s=c.$control.children(":not(input)").index(u),0<n&&s++,t=0,i=c.$activeItems.length;t<i;t++)o.push(F(c.$activeItems[t]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(c.isFocused||"single"===c.settings.mode)&&c.items.length&&(n<0&&0===r.start&&0===r.length?o.push(c.items[c.caretPos-1]):0<n&&r.start===c.$control_input.val().length&&o.push(c.items[c.caretPos]));if(!o.length||"function"==typeof c.settings.onDelete&&!1===c.settings.onDelete.apply(c,[o]))return!1;for(void 0!==s&&c.setCaret(s);o.length;)c.removeItem(o.pop());return c.showInput(),c.positionDropdown(),c.refreshOptions(!0),a&&(l=c.getOption(a)).length&&c.setActiveOption(l),!0},advanceSelection:function(e,t){var i,n,r,o,s,a=this;0!==e&&(a.rtl&&(e*=-1),i=0<e?"last":"first",n=f(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(o=a.$control_input.val().length,(e<0?0===n.start&&0===n.length:n.start===o)&&!o&&a.advanceCaret(e,t)):(s=a.$control.children(".active:"+i)).length&&(r=a.$control.children(":not(input)").index(s),a.setActiveItem(null),a.setCaret(0<e?r+1:r)))},advanceCaret:function(e,t){var i,n;0!==e&&(i=0<e?"next":"prev",this.isShiftDown?(n=this.$control_input[i]()).length&&(this.hideInput(),this.setActiveItem(n),t&&t.preventDefault()):this.setCaret(this.caretPos+e))},setCaret:function(e){var t,i,n,r;if(e="single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,e)),!this.isPending)for(t=0,i=(n=this.$control.children(":not(input)")).length;t<i;t++)r=F(n[t]).detach(),t<e?this.$control_input.before(r):this.$control.append(r);this.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){this.$input.prop("disabled",!1),this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex),this.isDisabled=!1,this.unlock()},destroy:function(){var e=this,t=e.eventNS,i=e.revertSettings;e.trigger("destroy"),e.off(),e.$wrapper.remove(),e.$dropdown.remove(),e.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),e.$control_input.removeData("grow"),e.$input.removeData("selectize"),0==--b.count&&b.$testInput&&(b.$testInput.remove(),b.$testInput=void 0),F(window).off(t),F(document).off(t),F(document.body).off(t),delete e.$input[0].selectize},render:function(e,t){var i,n,r="",o=!1,s=this;return"option"!==e&&"item"!==e||(o=!!(i=T(t[s.settings.valueField]))),o&&(u(s.renderCache[e])||(s.renderCache[e]={}),s.renderCache[e].hasOwnProperty(i))?s.renderCache[e][i]:(r=F(s.settings.render[e].apply(this,[t,a])),"option"===e||"option_create"===e?t[s.settings.disabledField]||r.attr("data-selectable",""):"optgroup"===e&&(n=t[s.settings.optgroupValueField]||"",r.attr("data-group",n),t[s.settings.disabledField]&&r.attr("data-disabled","")),"option"!==e&&"item"!==e||r.attr("data-value",i||""),o&&(s.renderCache[e][i]=r[0]),r[0])},clearCache:function(e){void 0===e?this.renderCache={}:delete this.renderCache[e]},canCreate:function(e){if(!this.settings.create)return!1;var t=this.settings.createFilter;return e.length&&("function"!=typeof t||t.apply(this,[e]))&&("string"!=typeof t||new RegExp(t).test(e))&&(!(t instanceof RegExp)||t.test(e))}}),b.count=0,b.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},F.fn.selectize=function(r){var o=F.fn.selectize.defaults,d=F.extend({},o,r),h=d.dataAttr,p=d.labelField,f=d.valueField,g=d.disabledField,v=d.optgroupField,m=d.optgroupLabelField,y=d.optgroupValueField;return this.each(function(){if(!this.selectize){var e=F(this),t=this.tagName.toLowerCase(),i=e.attr("placeholder")||e.attr("data-placeholder");i||d.allowEmptyOption||(i=e.children('option[value=""]').text());var n={placeholder:i,options:[],optgroups:[],items:[]};"select"===t?function(e,s){var t,i,n,r,o=s.options,a={},l=function(e){var t=h&&e.attr(h);return"string"==typeof t&&t.length?JSON.parse(t):null},u=function(e,t){e=F(e);var i=T(e.val());if(i||d.allowEmptyOption)if(a.hasOwnProperty(i)){if(t){var n=a[i][v];n?F.isArray(n)?n.push(t):a[i][v]=[n,t]:a[i][v]=t}}else{var r=l(e)||{};r[p]=r[p]||e.text(),r[f]=r[f]||i,r[g]=r[g]||e.prop("disabled"),r[v]=r[v]||t,a[i]=r,o.push(r),e.is(":selected")&&s.items.push(i)}},c=function(e){var t,i,n,r,o;for((n=(e=F(e)).attr("label"))&&((r=l(e)||{})[m]=n,r[y]=n,r[g]=e.prop("disabled"),s.optgroups.push(r)),t=0,i=(o=F("option",e)).length;t<i;t++)u(o[t],n)};for(s.maxItems=e.attr("multiple")?null:1,t=0,i=(r=e.children()).length;t<i;t++)"optgroup"===(n=r[t].tagName.toLowerCase())?c(r[t]):"option"===n&&u(r[t])}(e,n):function(e,t){var i,n,r,o,s=e.attr(h);if(s)for(t.options=JSON.parse(s),i=0,n=t.options.length;i<n;i++)t.items.push(t.options[i][f]);else{var a=F.trim(e.val()||"");if(!d.allowEmptyOption&&!a.length)return;for(i=0,n=(r=a.split(d.delimiter)).length;i<n;i++)(o={})[p]=r[i],o[f]=r[i],t.options.push(o);t.items=r}}(e,n),new b(e,F.extend(!0,{},o,n,r))}})},F.fn.selectize.defaults=b.defaults,F.fn.selectize.support={validity:E},b.define("drag_drop",function(e){if(!F.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var t,i,n,r=this;r.lock=(t=r.lock,function(){var e=r.$control.data("sortable");return e&&e.disable(),t.apply(r,arguments)}),r.unlock=(i=r.unlock,function(){var e=r.$control.data("sortable");return e&&e.enable(),i.apply(r,arguments)}),r.setup=(n=r.setup,function(){n.apply(this,arguments);var i=r.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:r.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),i.css({overflow:"visible"})},stop:function(){i.css({overflow:"hidden"});var e=r.$activeItems?r.$activeItems.slice():null,t=[];i.children("[data-value]").each(function(){t.push(F(this).attr("data-value"))}),r.setValue(t),r.setActiveItem(e)}})})}}),b.define("dropdown_header",function(e){var t,i=this;e=F.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},e),i.setup=(t=i.setup,function(){t.apply(i,arguments),i.$dropdown_header=F(e.html(e)),i.$dropdown.prepend(i.$dropdown_header)})}),b.define("optgroup_columns",function(a){var o,l=this;a=F.extend({equalizeWidth:!0,equalizeHeight:!0},a),this.getAdjacentOption=function(e,t){var i=e.closest("[data-group]").find("[data-selectable]"),n=i.index(e)+t;return 0<=n&&n<i.length?i.eq(n):F()},this.onKeyDown=(o=l.onKeyDown,function(e){var t,i,n,r;return!this.isOpen||37!==e.keyCode&&39!==e.keyCode?o.apply(this,arguments):(l.ignoreHover=!0,t=(r=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((i=(n=(r=37===e.keyCode?r.prev("[data-group]"):r.next("[data-group]")).find("[data-selectable]")).eq(Math.min(n.length-1,t))).length&&this.setActiveOption(i)))});var u=function(){var e,t=u.width,i=document;return void 0===t&&((e=i.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,i.body.appendChild(e),t=u.width=e.offsetWidth-e.clientWidth,i.body.removeChild(e)),t},e=function(){var e,t,i,n,r,o,s;if((t=(s=F("[data-group]",l.$dropdown_content)).length)&&l.$dropdown_content.width()){if(a.equalizeHeight){for(e=i=0;e<t;e++)i=Math.max(i,s.eq(e).height());s.css({height:i})}a.equalizeWidth&&(o=l.$dropdown_content.innerWidth()-u(),n=Math.round(o/t),s.css({width:n}),1<t&&(r=o-n*(t-1),s.eq(t-1).css({width:r})))}};(a.equalizeHeight||a.equalizeWidth)&&(t.after(this,"positionDropdown",e),t.after(this,"refreshOptions",e))}),b.define("remove_button",function(e){e=F.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e);var o,t,i,n,s;"single"!==this.settings.mode?(n=o=this,s='<a href="javascript:void(0)" class="'+(t=e).className+'" tabindex="-1" title="'+a(t.title)+'">'+t.label+"</a>",o.setup=(i=n.setup,function(){if(t.append){var r=n.settings.render.item;n.settings.render.item=function(e){return t=r.apply(o,arguments),i=s,n=t.search(/(<\/[^>]+>\s*)$/),t.substring(0,n)+i+t.substring(n);var t,i,n}}i.apply(o,arguments),o.$control.on("click","."+t.className,function(e){if(e.preventDefault(),!n.isLocked){var t=F(e.currentTarget).parent();n.setActiveItem(t),n.deleteSelection()&&n.setCaret(n.items.length)}})})):function(r,t){t.className="remove-single";var i,o=r,s='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+a(t.title)+'">'+t.label+"</a>";r.setup=(i=o.setup,function(){if(t.append){var e=F(o.$input.context).attr("id"),n=(F("#"+e),o.settings.render.item);o.settings.render.item=function(e){return t=n.apply(r,arguments),i=s,F("<span>").append(t).append(i);var t,i}}i.apply(r,arguments),r.$control.on("click","."+t.className,function(e){e.preventDefault(),o.isLocked||o.clear()})})}(this,e)}),b.define("restore_on_backspace",function(n){var r,e=this;n.text=n.text||function(e){return e[this.settings.labelField]},this.onKeyDown=(r=e.onKeyDown,function(e){var t,i;return 8===e.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&0<=(t=this.caretPos-1)&&t<this.items.length?(i=this.options[this.items[t]],this.deleteSelection(e)&&(this.setTextboxValue(n.text.apply(this,[i])),this.refreshOptions(!0)),void e.preventDefault()):r.apply(this,arguments)})}),b}),function(e){if("undefined"!=typeof exports&&"undefined"!=typeof require)var l=e._||require("underscore"),u=e.Backbone||require("backbone");else l=e._,u=e.Backbone;var o,r=u.View.extend({events:{submit:function(e){this.trigger("submit",e)}},initialize:function(t){var i=this;t=this.options=l.extend({submitButton:!1},t);var n=this.schema=function(){if(t.schema)return l.result(t,"schema");var e=t.model;return e&&e.schema?l.result(e,"schema"):i.schema?l.result(i,"schema"):{}}();l.extend(this,l.pick(t,"model","data","idPrefix","templateData"));var e=this.constructor;this.template=t.template||this.template||e.template,this.Fieldset=t.Fieldset||this.Fieldset||e.Fieldset,this.Field=t.Field||this.Field||e.Field,this.NestedField=t.NestedField||this.NestedField||e.NestedField;var r=this.selectedFields=t.fields||l.keys(n),o=this.fields={};l.each(r,function(e){var t=n[e];o[e]=this.createField(e,t)},this);var s=t.fieldsets||l.result(this,"fieldsets")||l.result(this.model,"fieldsets")||[r];this.fieldsets=[];l.each(s,function(e){this.fieldsets.push(this.createFieldset(e))},this)},createFieldset:function(e){var t={schema:e,fields:this.fields,legend:e.legend||null};return new this.Fieldset(t)},createField:function(e,t){var i={form:this,key:e,schema:t,idPrefix:this.idPrefix};this.model?i.model=this.model:this.data?i.value=this.data[e]:i.value=void 0;var n=new this.Field(i);return this.listenTo(n.editor,"all",this.handleEditorEvent),n},handleEditorEvent:function(e,t){var i=t.key+":"+e;switch(this.trigger.call(this,i,this,t,Array.prototype.slice.call(arguments,2)),e){case"change":this.trigger("change",this);break;case"focus":this.hasFocus||this.trigger("focus",this);break;case"blur":if(this.hasFocus){var n=this;setTimeout(function(){l.find(n.fields,function(e){return e.editor.hasFocus})||n.trigger("blur",n)},0)}}},templateData:function(){return{submitButton:this.options.submitButton}},render:function(){var o=this,s=this.fields,a=u.$,e=a(a.trim(this.template(l.result(this,"templateData"))));return e.find("[data-editors]").add(e).each(function(e,t){var i=a(t),n=i.attr("data-editors");if(!l.isUndefined(n)){var r="*"==n?o.selectedFields||l.keys(s):n.split(",");l.each(r,function(e){var t=s[e];i.append(t.editor.render().el)})}}),e.find("[data-fields]").add(e).each(function(e,t){var i=a(t),n=i.attr("data-fields");if(!l.isUndefined(n)){var r="*"==n?o.selectedFields||l.keys(s):n.split(",");l.each(r,function(e){var t=s[e];i.append(t.render().el)})}}),e.find("[data-fieldsets]").add(e).each(function(e,t){var i=a(t),n=i.attr("data-fieldsets");l.isUndefined(n)||l.each(o.fieldsets,function(e){i.append(e.render().el)})}),this.setElement(e),e.addClass(this.className),this.attributes&&e.attr(this.attributes),this},validate:function(e){var n=this.fields,t=this.model,r={};if(e=e||{},l.each(n,function(e){var t=e.validate();t&&(r[e.key]=t)}),!e.skipModelValidate&&t&&t.validate){var i=t.validate(this.getValue());if(i){var o=l.isObject(i)&&!l.isArray(i);o||(r._others=r._others||[],r._others.push(i)),o&&l.each(i,function(e,t){if(n[t]&&!r[t])n[t].setError(e),r[t]=e;else{r._others=r._others||[];var i={};i[t]=e,r._others.push(i)}})}}return l.isEmpty(r)?null:r},commit:function(e){var i,t={skipModelValidate:!(e=e||{}).validate},n=this.validate(t);if(n)return n;var r=l.extend({error:function(e,t){i=t}},e);return this.model.set(this.getValue(),r),i||void 0},getValue:function(e){if(e)return this.fields[e].getValue();var t={};return l.each(this.fields,function(e){t[e.key]=e.getValue()}),t},setValue:function(e,t){var i,n={};for(i in"string"==typeof e?n[e]=t:n=e,this.schema)void 0!==n[i]&&this.fields[i].setValue(n[i])},getEditor:function(e){var t=this.fields[e];if(!t)throw new Error("Field not found: "+e);return t.editor},focus:function(){if(!this.hasFocus){var e=this.fieldsets[0].getFieldAt(0);e&&e.editor.focus()}},blur:function(){if(this.hasFocus){var e=l.find(this.fields,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),u.View.prototype.trigger.apply(this,arguments)},remove:function(){return l.each(this.fieldsets,function(e){e.remove()}),l.each(this.fields,function(e){e.remove()}),u.View.prototype.remove.apply(this,arguments)}},{editors:{}});r.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},r.template=l.template('    <form>     <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit"><%= submitButton %></button>      <% } %>    </form>  ',null,r.templateSettings),r.validators=((o={}).errMessages={required:"Required",regexp:"Invalid",number:"Must be a number",range:l.template("Must be a number between <%= min %> and <%= max %>",null,r.templateSettings),email:"Invalid email address",url:"Invalid URL",match:l.template('Must match field "<%= field %>"',null,r.templateSettings)},o.required=function(i){return i=l.extend({type:"required",message:this.errMessages.required},i),function(e){i.value=e;var t={type:i.type,message:l.isFunction(i.message)?i.message(i):i.message};if(null==e||!1===e||""===e||""===$.trim(e))return t}},o.regexp=function(i){if(!i.regexp)throw new Error('Missing required "regexp" option for "regexp" validator');return i=l.extend({type:"regexp",match:!0,message:this.errMessages.regexp},i),function(e){i.value=e;var t={type:i.type,message:l.isFunction(i.message)?i.message(i):i.message};if(null!=e&&""!==e)return"string"==typeof i.regexp&&(i.regexp=new RegExp(i.regexp,i.flags)),(i.match?!i.regexp.test(e):i.regexp.test(e))?t:void 0}},o.number=function(e){return e=l.extend({type:"number",message:this.errMessages.number,regexp:/^[-+]?([0-9]*.[0-9]+|[0-9]+)$/},e),o.regexp(e)},o.range=function(r){return r=l.extend({type:"range",message:this.errMessages.range,numberMessage:this.errMessages.number,min:0,max:100},r),function(e){r.value=e;var t={type:r.type,message:l.isFunction(r.message)?r.message(r):r.message};if(null!=e&&""!==e){var i=o.number({message:r.numberMessage})(e);if(i)return i;var n=parseFloat(r.value);return n<r.min||n>r.max?t:void 0}}},o.email=function(e){return e=l.extend({type:"email",message:this.errMessages.email,regexp:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i},e),o.regexp(e)},o.url=function(e){return e=l.extend({type:"url",message:this.errMessages.url,regexp:/^((http|https):\/\/)?(([A-Z0-9][A-Z0-9_\-]*)(\.[A-Z0-9][A-Z0-9_\-]*)+)(:(\d+))?\/?/i},e),o.regexp(e)},o.match=function(n){if(!n.field)throw new Error('Missing required "field" options for "match" validator');return n=l.extend({type:"match",message:this.errMessages.match},n),function(e,t){n.value=e;var i={type:n.type,message:l.isFunction(n.message)?n.message(n):n.message};if(null!=e&&""!==e)return e!==t[n.field]?i:void 0}},o),r.Fieldset=u.View.extend({initialize:function(e){e=e||{};var t=this.schema=this.createSchema(e.schema);this.fields=l.pick(e.fields,t.fields),this.template=e.template||t.template||this.template||this.constructor.template},createSchema:function(e){return l.isArray(e)&&(e={fields:e}),e.legend=e.legend||null,e},getFieldAt:function(e){var t=this.schema.fields[e];return this.fields[t]},templateData:function(){return this.schema},render:function(){this.schema;var r=this.fields,o=u.$,e=o(o.trim(this.template(l.result(this,"templateData"))));return e.find("[data-fields]").add(e).each(function(e,t){var i=o(t),n=i.attr("data-fields");l.isUndefined(n)||l.each(r,function(e){i.append(e.render().el)})}),this.setElement(e),this},remove:function(){l.each(this.fields,function(e){e.remove()}),u.View.prototype.remove.call(this)}},{template:l.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  ",null,r.templateSettings)}),r.Field=u.View.extend({initialize:function(e){e=e||{},l.extend(this,l.pick(e,"form","key","model","value","idPrefix"));var t=this.schema=this.createSchema(e.schema);this.template=e.template||t.template||this.template||this.constructor.template,this.errorClassName=e.errorClassName||t.errorClassName||this.errorClassName||this.constructor.errorClassName,this.editor=this.createEditor()},createSchema:function(e){return l.isString(e)&&(e={type:e}),(e=l.extend({type:"Text",title:this.createTitle()},e)).type=l.isString(e.type)?r.editors[e.type]:e.type,e},createEditor:function(){var e=l.extend(l.pick(this,"schema","form","key","model","value"),{id:this.createEditorId()});return new this.schema.type(e)},createEditorId:function(){var e=this.idPrefix,t=this.key;return t=t.replace(/\./g,"_"),l.isString(e)||l.isNumber(e)?e+t:l.isNull(e)?t:this.model?this.model.cid+"_"+t:t},createTitle:function(){var e=this.key;return e=(e=e.replace(/([A-Z])/g," $1")).replace(/^./,function(e){return e.toUpperCase()})},templateData:function(){var e=this.schema;return{help:e.help||"",title:e.title,titleHTML:e.titleHTML,fieldAttrs:e.fieldAttrs,editorAttrs:e.editorAttrs,key:this.key,editorId:this.editor.id}},render:function(){var e=this.schema,r=this.editor,o=u.$;if(!0===this.editor.noField)return this.setElement(r.render().el);var t=o(o.trim(this.template(l.result(this,"templateData"))));return e.fieldClass&&t.addClass(e.fieldClass),e.fieldAttrs&&t.attr(e.fieldAttrs),t.find("[data-editor]").add(t).each(function(e,t){var i=o(t),n=i.attr("data-editor");l.isUndefined(n)||i.append(r.render().el)}),this.setElement(t),this},disable:function(){l.isFunction(this.editor.disable)?this.editor.disable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!0))},enable:function(){l.isFunction(this.editor.enable)?this.editor.enable():($input=this.editor.$el,$input=$input.is("input")?$input:$input.find("input"),$input.attr("disabled",!1))},validate:function(){var e=this.editor.validate();return e?this.setError(e.message):this.clearError(),e},setError:function(e){this.editor.hasNestedForm||(this.$el.addClass(this.errorClassName),this.$("[data-error]").last().html(e))},clearError:function(){this.$el.removeClass(this.errorClassName),this.$("[data-error]").empty()},commit:function(){return this.editor.commit()},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),u.View.prototype.remove.call(this)}},{template:l.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div data-error></div>        <div><%= help %></div>      </div>    </div>  ',null,r.templateSettings),errorClassName:"error"}),r.NestedField=r.Field.extend({template:l.template('    <div>      <label for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div>        <span data-editor></span>        <div class="error-text" data-error></div>        <div class="error-help"><%= help %></div>      </div>    </div>  ',null,r.templateSettings)}),r.Editor=r.editors.Base=u.View.extend({defaultValue:null,hasFocus:!1,initialize:function(e){if((e=e||{}).model){if(!e.key)throw new Error("Missing option: 'key'");this.model=e.model,this.value=this.model.get(e.key)}else void 0!==e.value&&(this.value=e.value);void 0===this.value&&(this.value=this.defaultValue),l.extend(this,l.pick(e,"key","form"));var t=this.schema=e.schema||{};this.validators=e.validators||t.validators,this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),t.editorClass&&this.$el.addClass(t.editorClass),t.editorAttrs&&this.$el.attr(t.editorAttrs)},getName:function(){return(this.key||"").replace(/\./g,"_")},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){throw new Error("Not implemented")},blur:function(){throw new Error("Not implemented")},commit:function(e){var i=this.validate();return i||(this.listenTo(this.model,"invalid",function(e,t){i=t}),this.model.set(this.key,this.getValue(),e),i||void 0)},validate:function(){this.$el;var t=null,i=this.getValue(),n=this.form?this.form.getValue():{},e=this.validators,r=this.getValidator;return e&&l.every(e,function(e){return!(t=r(e)(i,n))}),t},trigger:function(e){return"focus"===e?this.hasFocus=!0:"blur"===e&&(this.hasFocus=!1),u.View.prototype.trigger.apply(this,arguments)},getValidator:function(e){var t=r.validators;if(l.isRegExp(e))return t.regexp({regexp:e});if(l.isString(e)){if(!t[e])throw new Error('Validator "'+e+'" not found');return t[e]()}if(l.isFunction(e))return e;if(l.isObject(e)&&e.type){var i=e;return t[i.type](i)}throw new Error("Invalid validator: "+e)}}),r.editors.Text=r.Editor.extend({tagName:"input",defaultValue:"",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},select:function(e){this.trigger("select",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e);var t=this.schema,i="text";t&&t.editorAttrs&&t.editorAttrs.type&&(i=t.editorAttrs.type),t&&t.dataType&&(i=t.dataType),this.$el.attr("type",i)},render:function(){return this.setValue(this.value),this},determineChange:function(e){var t=this.$el.val();t!==this.previousValue&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.value=e,this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},select:function(){this.$el.select()}}),r.editors.TextArea=r.editors.Text.extend({tagName:"textarea",initialize:function(e){r.editors.Base.prototype.initialize.call(this,e)}}),r.editors.Password=r.editors.Text.extend({initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","password")}}),r.editors.Number=r.editors.Text.extend({defaultValue:0,events:l.extend({},r.editors.Text.prototype.events,{keypress:"onKeyPress",change:"onKeyPress"}),initialize:function(e){r.editors.Text.prototype.initialize.call(this,e);var t=this.schema;this.$el.attr("type","number"),t&&t.editorAttrs&&t.editorAttrs.step||this.$el.attr("step","any")},onKeyPress:function(e){var t=this,i=function(){setTimeout(function(){t.determineChange()},0)};if(0!==e.charCode){var n=this.$el.val();null!=e.charCode&&(n+=String.fromCharCode(e.charCode)),/^[0-9]*\.?[0-9]*?$/.test(n)?i():e.preventDefault()}else i()},getValue:function(){var e=this.$el.val();return""===e?null:parseFloat(e,10)},setValue:function(e){e=l.isNumber(e)?e:l.isString(e)&&""!==e?parseFloat(e,10):null,l.isNaN(e)&&(e=null),this.value=e,r.editors.Text.prototype.setValue.call(this,e)}}),r.editors.Hidden=r.editors.Text.extend({defaultValue:"",noField:!0,initialize:function(e){r.editors.Text.prototype.initialize.call(this,e),this.$el.attr("type","hidden")},focus:function(){},blur:function(){}}),r.editors.Checkbox=r.editors.Base.extend({defaultValue:!1,tagName:"input",events:{click:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){r.editors.Base.prototype.initialize.call(this,e),this.$el.attr("type","checkbox")},render:function(){return this.setValue(this.value),this},getValue:function(){return this.$el.prop("checked")},setValue:function(e){e?this.$el.prop("checked",!0):this.$el.prop("checked",!1),this.value=!!e},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()}}),r.editors.Select=r.editors.Base.extend({tagName:"select",previousValue:"",events:{keyup:"determineChange",keypress:function(e){var t=this;setTimeout(function(){t.determineChange()},0)},change:function(e){this.trigger("change",this)},focus:function(e){this.trigger("focus",this)},blur:function(e){this.trigger("blur",this)}},initialize:function(e){if(r.editors.Base.prototype.initialize.call(this,e),!this.schema||!this.schema.options)throw new Error("Missing required 'schema.options'")},render:function(){return this.setOptions(this.schema.options),this},setOptions:function(t){var i=this;if(t instanceof u.Collection){var e=t;0<e.length?this.renderOptions(t):e.fetch({success:function(e){i.renderOptions(t)}})}else l.isFunction(t)?t(function(e){i.renderOptions(e)},i):this.renderOptions(t)},renderOptions:function(e){var t,i=this.$el;t=this._getOptionsHtml(e),i.html(t),this.setValue(this.value)},_getOptionsHtml:function(e){var t;if(l.isString(e))t=e;else if(l.isArray(e))t=this._arrayToHtml(e);else if(e instanceof u.Collection)t=this._collectionToHtml(e);else if(l.isFunction(e)){var i;e(function(e){i=e},this),t=this._getOptionsHtml(i)}else t=this._objectToHtml(e);return t},determineChange:function(e){var t=this.getValue();t!==this.previousValue&&(this.previousValue=t,this.trigger("change",this))},getValue:function(){return this.$el.val()},setValue:function(e){this.value=e,this.$el.val(e)},focus:function(){this.hasFocus||this.$el.focus()},blur:function(){this.hasFocus&&this.$el.blur()},_collectionToHtml:function(e){var t=[];return e.each(function(e){t.push({val:e.id,label:e.toString()})}),this._arrayToHtml(t)},_objectToHtml:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push({val:i,label:e[i]});return this._arrayToHtml(t)},_arrayToHtml:function(e){var n=$();return l.each(e,function(e){if(l.isObject(e))if(e.group){var t=$("<optgroup>").attr("label",e.group).html(this._getOptionsHtml(e.options));n=n.add(t)}else{var i=e.val||0===e.val?e.val:"";n=n.add($("<option>").val(i).text(e.label))}else n=n.add($("<option>").text(e))},this),n}}),r.editors.Radio=r.editors.Select.extend({tagName:"ul",events:{"change input[type=radio]":function(){this.trigger("change",this)},"focus input[type=radio]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=radio]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=radio]:focus")[0]||e.trigger("blur",e)},0)}}},getTemplate:function(){return this.schema.template||this.constructor.template},getValue:function(){return this.$("input[type=radio]:checked").val()},setValue:function(e){this.value=e,this.$("input[type=radio]").val([e])},focus:function(){if(!this.hasFocus){var e=this.$("input[type=radio]:checked");e[0]?e.focus():this.$("input[type=radio]").first().focus()}},blur:function(){this.hasFocus&&this.$("input[type=radio]:focus").blur()},_arrayToHtml:function(e){var t=this.getTemplate(),n=this.getName(),r=this.id;return t({items:l.map(e,function(e,t){var i={name:n,id:r+"-"+t};return l.isObject(e)?(i.value=e.val||0===e.val?e.val:"",i.label=e.label,i.labelHTML=e.labelHTML):(i.value=e,i.label=e),i})})}},{template:l.template('    <% _.each(items, function(item) { %>      <li>        <input type="radio" name="<%= item.name %>" value="<%- item.value %>" id="<%= item.id %>" />        <label for="<%= item.id %>"><% if (item.labelHTML){ %><%= item.labelHTML %><% }else{ %><%- item.label %><% } %></label>      </li>    <% }); %>  ',null,r.templateSettings)}),r.editors.Checkboxes=r.editors.Select.extend({tagName:"ul",groupNumber:0,events:{"click input[type=checkbox]":function(){this.trigger("change",this)},"focus input[type=checkbox]":function(){this.hasFocus||this.trigger("focus",this)},"blur input[type=checkbox]":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("input[type=checkbox]:focus")[0]||e.trigger("blur",e)},0)}}},getValue:function(){var e=[],t=this;return this.$("input[type=checkbox]:checked").each(function(){e.push(t.$(this).val())}),e},setValue:function(e){l.isArray(e)||(e=[e]),this.value=e,this.$("input[type=checkbox]").val(e)},focus:function(){this.hasFocus||this.$("input[type=checkbox]").first().focus()},blur:function(){this.hasFocus&&this.$("input[type=checkbox]:focus").blur()},_arrayToHtml:function(e){var o=$(),s=this;return l.each(e,function(e,t){var i=$("<li>");if(l.isObject(e))if(e.group){var n=s.id;s.id+="-"+s.groupNumber++,i=(i=$('<fieldset class="group">').append($("<legend>").text(e.group))).append(s._arrayToHtml(e.options)),s.id=n,close=!1}else{var r=e.val||0===e.val?e.val:"";i.append($('<input type="checkbox" name="'+s.getName()+'" id="'+s.id+"-"+t+'" />').val(r)),e.labelHTML?i.append($('<label for="'+s.id+"-"+t+'" />').html(e.labelHTML)):i.append($('<label for="'+s.id+"-"+t+'" />').text(e.label))}else i.append($('<input type="checkbox" name="'+s.getName()+'" id="'+s.id+"-"+t+'" />').val(e)),i.append($('<label for="'+s.id+"-"+t+'" />').text(e));o=o.add(i)}),o}}),r.editors.Object=r.editors.Base.extend({hasNestedForm:!0,initialize:function(e){if(this.value={},r.editors.Base.prototype.initialize.call(this,e),!this.form)throw new Error('Missing required option "form"');if(!this.schema.subSchema)throw new Error("Missing required 'schema.subSchema' option for Object editor")},render:function(){var e=this.form.constructor;return this.nestedForm=new e({schema:this.schema.subSchema,data:this.value,idPrefix:this.id+"_",Field:e.NestedField}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){return this.nestedForm?this.nestedForm.getValue():this.value},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.nestedForm.focus()},blur:function(){this.hasFocus&&this.nestedForm.blur()},remove:function(){this.nestedForm.remove(),u.View.prototype.remove.call(this)},validate:function(){var e=l.extend({},r.editors.Base.prototype.validate.call(this),this.nestedForm.validate());return!l.isEmpty(e)&&e},_observeFormEvents:function(){this.nestedForm&&this.nestedForm.on("all",function(){var e=l.toArray(arguments);(e[1]=this).trigger.apply(this,e)},this)}}),r.editors.NestedModel=r.editors.Object.extend({initialize:function(e){if(r.editors.Base.prototype.initialize.call(this,e),!this.form)throw new Error('Missing required option "form"');if(!e.schema.model)throw new Error('Missing required "schema.model" option for NestedModel editor')},render:function(){var e=this.form.constructor,t=this.value||{},i=(this.key,this.schema.model),n=t.constructor===i?t:new i(t);return this.nestedForm=new e({model:n,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},commit:function(){var e=this.nestedForm.commit();return e?(this.$el.addClass("error"),e):r.editors.Object.prototype.commit.call(this)}}),r.editors.Date=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e);var t=r.editors.Date,i=new Date;if(this.options=l.extend({monthNames:t.monthNames,showMonthNames:t.showMonthNames},e),this.schema=l.extend({yearStart:i.getFullYear()-100,yearEnd:i.getFullYear()},e.schema||{}),this.value&&!l.isDate(this.value)&&(this.value=new Date(this.value)),!this.value){var n=new Date;n.setSeconds(0),n.setMilliseconds(0),this.value=n}this.template=e.template||this.constructor.template},render:function(){var t=this.options,e=this.schema,i=u.$,n=l.map(l.range(1,32),function(e){return'<option value="'+e+'">'+e+"</option>"}),r=l.map(l.range(0,12),function(e){return'<option value="'+e+'">'+(t.showMonthNames?t.monthNames[e]:e+1)+"</option>"}),o=e.yearStart<e.yearEnd?l.range(e.yearStart,e.yearEnd+1):l.range(e.yearStart,e.yearEnd-1,-1),s=l.map(o,function(e){return'<option value="'+e+'">'+e+"</option>"}),a=i(i.trim(this.template({dates:n.join(""),months:r.join(""),years:s.join("")})));return this.$date=a.find('[data-type="date"]'),this.$month=a.find('[data-type="month"]'),this.$year=a.find('[data-type="year"]'),this.$hidden=i('<input type="hidden" name="'+this.key+'" />'),a.append(this.$hidden),this.setValue(this.value),this.setElement(a),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.$year.val(),t=this.$month.val(),i=this.$date.val();return e&&t&&i?new Date(e,t,i):null},setValue:function(e){this.value=e,this.$date.val(e.getDate()),this.$month.val(e.getMonth()),this.$year.val(e.getFullYear()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();l.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)}},{template:l.template('    <div>      <select data-type="date"><%= dates %></select>      <select data-type="month"><%= months %></select>      <select data-type="year"><%= years %></select>    </div>  ',null,r.templateSettings),showMonthNames:!0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"]}),r.editors.DateTime=r.editors.Base.extend({events:{"change select":function(){this.updateHidden(),this.trigger("change",this)},"focus select":function(){this.hasFocus||this.trigger("focus",this)},"blur select":function(){if(this.hasFocus){var e=this;setTimeout(function(){e.$("select:focus")[0]||e.trigger("blur",e)},0)}}},initialize:function(e){e=e||{},r.editors.Base.prototype.initialize.call(this,e),this.options=l.extend({DateEditor:r.editors.DateTime.DateEditor},e),this.schema=l.extend({minsInterval:15},e.schema||{}),this.dateEditor=new this.options.DateEditor(e),this.value=this.dateEditor.value,this.template=e.template||this.constructor.template},render:function(){function t(e){return e<10?"0"+e:e}var e=this.schema,i=u.$,n=l.map(l.range(0,24),function(e){return'<option value="'+e+'">'+t(e)+"</option>"}),r=l.map(l.range(0,60,e.minsInterval),function(e){return'<option value="'+e+'">'+t(e)+"</option>"}),o=i(i.trim(this.template({hours:n.join(),mins:r.join()})));return o.find("[data-date]").append(this.dateEditor.render().el),this.$hour=o.find('select[data-type="hour"]'),this.$min=o.find('select[data-type="min"]'),this.$hidden=o.find('input[type="hidden"]'),this.setValue(this.value),this.setElement(o),this.$el.attr("id",this.id),this.$el.attr("name",this.getName()),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.dateEditor.getValue(),t=this.$hour.val(),i=this.$min.val();return e&&t&&i?(e.setHours(t),e.setMinutes(i),e):null},setValue:function(e){l.isDate(e)||(e=new Date(e)),this.value=e,this.dateEditor.setValue(e),this.$hour.val(e.getHours()),this.$min.val(e.getMinutes()),this.updateHidden()},focus:function(){this.hasFocus||this.$("select").first().focus()},blur:function(){this.hasFocus&&this.$("select:focus").blur()},updateHidden:function(){var e=this.getValue();l.isDate(e)&&(e=e.toISOString()),this.$hidden.val(e)},remove:function(){this.dateEditor.remove(),r.editors.Base.prototype.remove.call(this)}},{template:l.template('    <div class="bbf-datetime">      <div class="bbf-date-container" data-date></div>      <select data-type="hour"><%= hours %></select>      :      <select data-type="min"><%= mins %></select>    </div>  ',null,r.templateSettings),DateEditor:r.editors.Date}),r.VERSION="0.14.0",u.Form=r,"undefined"!=typeof module&&(module.exports=r)}(window||global||this),function(o){"use strict";var s=function(e,t){this.options=o.extend({},o.fn.editableform.defaults,t),this.$div=o(e),this.options.scope||(this.options.scope=this)};s.prototype={constructor:s,initInput:function(){this.input=this.options.input,this.value=this.input.str2value(this.options.value),this.input.prerender()},initTemplate:function(){this.$form=o(o.fn.editableform.template)},initButtons:function(){var e=this.$form.find(".editable-buttons");e.append(o.fn.editableform.buttons),"bottom"===this.options.showbuttons&&e.addClass("editable-buttons-bottom")},render:function(){this.$loading=o(o.fn.editableform.loading),this.$div.empty().append(this.$loading),this.initTemplate(),this.options.showbuttons?this.initButtons():this.$form.find(".editable-buttons").remove(),this.showLoading(),this.isSaving=!1,this.$div.triggerHandler("rendering"),this.initInput(),this.$form.find("div.editable-input").append(this.input.$tpl),this.$div.append(this.$form),o.when(this.input.render()).then(o.proxy(function(){if(this.options.showbuttons||this.input.autosubmit(),this.$form.find(".editable-cancel").click(o.proxy(this.cancel,this)),this.input.error)this.error(this.input.error),this.$form.find(".editable-submit").attr("disabled",!0),this.input.$input.attr("disabled",!0),this.$form.submit(function(e){e.preventDefault()});else{this.error(!1),this.input.$input.removeAttr("disabled"),this.$form.find(".editable-submit").removeAttr("disabled");var e=null===this.value||void 0===this.value||""===this.value?this.options.defaultValue:this.value;this.input.value2input(e),this.$form.submit(o.proxy(this.submit,this))}this.$div.triggerHandler("rendered"),this.showForm(),this.input.postrender&&this.input.postrender()},this))},cancel:function(){this.$div.triggerHandler("cancel")},showLoading:function(){var e,t;this.$form?(e=this.$form.outerWidth(),t=this.$form.outerHeight(),e&&this.$loading.width(e),t&&this.$loading.height(t),this.$form.hide()):(e=this.$loading.parent().width())&&this.$loading.width(e),this.$loading.show()},showForm:function(e){this.$loading.hide(),this.$form.show(),!1!==e&&this.input.activate(),this.$div.triggerHandler("show")},error:function(e){var t,i=this.$form.find(".control-group"),n=this.$form.find(".editable-error-block");if(!1===e)i.removeClass(o.fn.editableform.errorGroupClass),n.removeClass(o.fn.editableform.errorBlockClass).empty().hide();else{if(e){t=(""+e).split("\n");for(var r=0;r<t.length;r++)t[r]=o("<div>").text(t[r]).html();e=t.join("<br>")}i.addClass(o.fn.editableform.errorGroupClass),n.addClass(o.fn.editableform.errorBlockClass).html(e).show()}},submit:function(e){e.stopPropagation(),e.preventDefault();var i=this.input.input2value(),t=this.validate(i);if("object"===o.type(t)&&void 0!==t.newValue){if(i=t.newValue,this.input.value2input(i),"string"==typeof t.msg)return this.error(t.msg),void this.showForm()}else if(t)return this.error(t),void this.showForm();if(this.options.savenochange||this.input.value2str(i)!==this.input.value2str(this.value)){var n=this.input.value2submit(i);this.isSaving=!0,o.when(this.save(n)).done(o.proxy(function(e){this.isSaving=!1;var t="function"==typeof this.options.success?this.options.success.call(this.options.scope,e,i):null;return!1===t?(this.error(!1),void this.showForm(!1)):"string"==typeof t?(this.error(t),void this.showForm()):(t&&"object"==typeof t&&t.hasOwnProperty("newValue")&&(i=t.newValue),this.error(!1),this.value=i,void this.$div.triggerHandler("save",{newValue:i,submitValue:n,response:e}))},this)).fail(o.proxy(function(e){var t;this.isSaving=!1,t="function"==typeof this.options.error?this.options.error.call(this.options.scope,e,i):"string"==typeof e?e:e.responseText||e.statusText||"Unknown error!",this.error(t),this.showForm()},this))}else this.$div.triggerHandler("nochange")},save:function(e){this.options.pk=o.fn.editableutils.tryParseJson(this.options.pk,!0);var t,i="function"==typeof this.options.pk?this.options.pk.call(this.options.scope):this.options.pk;if(!!("function"==typeof this.options.url||this.options.url&&("always"===this.options.send||"auto"===this.options.send&&null!=i)))return this.showLoading(),t={name:this.options.name||"",value:e,pk:i},"function"==typeof this.options.params?t=this.options.params.call(this.options.scope,t):(this.options.params=o.fn.editableutils.tryParseJson(this.options.params,!0),o.extend(t,this.options.params)),"function"==typeof this.options.url?this.options.url.call(this.options.scope,t):o.ajax(o.extend({url:this.options.url,data:t,type:"POST"},this.options.ajaxOptions))},validate:function(e){if(void 0===e&&(e=this.value),"function"==typeof this.options.validate)return this.options.validate.call(this.options.scope,e)},option:function(e,t){e in this.options&&(this.options[e]=t),"value"===e&&this.setValue(t)},setValue:function(e,t){this.value=t?this.input.str2value(e):e,this.$form&&this.$form.is(":visible")&&this.input.value2input(this.value)}},o.fn.editableform=function(n){var r=arguments;return this.each(function(){var e=o(this),t=e.data("editableform"),i="object"==typeof n&&n;t||e.data("editableform",t=new s(this,i)),"string"==typeof n&&t[n].apply(t,Array.prototype.slice.call(r,1))})},o.fn.editableform.Constructor=s,o.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,defaultValue:null,send:"auto",validate:null,success:null,error:null,ajaxOptions:null,showbuttons:!0,scope:null,savenochange:!1},o.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>',o.fn.editableform.loading='<div class="editableform-loading"></div>',o.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>',o.fn.editableform.errorGroupClass=null,o.fn.editableform.errorBlockClass="editable-error",o.fn.editableform.engine="jquery"}(window.jQuery),function(l){"use strict";l.fn.editableutils={inherit:function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,(e.prototype.constructor=e).superclass=t.prototype},setCursorPosition:function(e,t){if(e.setSelectionRange)e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},tryParseJson:function(e,t){if("string"==typeof e&&e.length&&e.match(/^[\{\[].*[\}\]]$/))if(t)try{e=new Function("return "+e)()}catch(e){}finally{return e}else e=new Function("return "+e)();return e},sliceObj:function(e,t,i){var n,r,o={};if(!l.isArray(t)||!t.length)return o;for(var s=0;s<t.length;s++)n=t[s],e.hasOwnProperty(n)&&(o[n]=e[n]),!0!==i&&(r=n.toLowerCase(),e.hasOwnProperty(r)&&(o[n]=e[r]));return o},getConfigData:function(e){var i={};return l.each(e.data(),function(e,t){("object"!=typeof t||t&&"object"==typeof t&&(t.constructor===Object||t.constructor===Array))&&(i[e]=t)}),i},objectKeys:function(e){if(Object.keys)return Object.keys(e);if(e!==Object(e))throw new TypeError("Object.keys called on a non-object");var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&i.push(t);return i},escape:function(e){return l("<div>").text(e).html()},itemsByValue:function(n,e,r){if(!e||null===n)return[];if("function"!=typeof r){var t=r||"value";r=function(e){return e[t]}}var o=l.isArray(n),s=[],a=this;return l.each(e,function(e,t){if(t.children)s=s.concat(a.itemsByValue(n,t.children,r));else if(o)l.grep(n,function(e){return e==(t&&"object"==typeof t?r(t):t)}).length&&s.push(t);else{var i=t&&"object"==typeof t?r(t):t;n==i&&s.push(t)}}),s},createInput:function(e){var t,i=e.type;return"date"===i&&("inline"===e.mode?l.fn.editabletypes.datefield?i="datefield":l.fn.editabletypes.dateuifield&&(i="dateuifield"):l.fn.editabletypes.date?i="date":l.fn.editabletypes.dateui&&(i="dateui"),"date"!==i||l.fn.editabletypes.date||(i="combodate")),"datetime"===i&&"inline"===e.mode&&(i="datetimefield"),"wysihtml5"!==i||l.fn.editabletypes[i]||(i="textarea"),"function"==typeof l.fn.editabletypes[i]?new(t=l.fn.editabletypes[i])(this.sliceObj(e,this.objectKeys(t.defaults))):(l.error("Unknown type: "+i),!1)},supportsTransitions:function(){var e=(document.body||document.documentElement).style,t="transition",i=["Moz","Webkit","Khtml","O","ms"];if("string"==typeof e[t])return!0;t=t.charAt(0).toUpperCase()+t.substr(1);for(var n=0;n<i.length;n++)if("string"==typeof e[i[n]+t])return!0;return!1}}}(window.jQuery),function(a){"use strict";var l=function(e,t){this.init(e,t)},u=function(e,t){this.init(e,t)};l.prototype={containerName:null,containerDataName:null,innerCss:null,containerClass:"editable-container editable-popup",defaults:{},init:function(e,t){this.$element=a(e),this.options=a.extend({},a.fn.editableContainer.defaults,t),this.splitOptions(),this.formOptions.scope=this.$element[0],this.initContainer(),this.delayedHide=!1,this.$element.on("destroyed",a.proxy(function(){this.destroy()},this)),a(document).data("editable-handlers-attached")||(a(document).on("keyup.editable",function(e){27===e.which&&a(".editable-open").editableContainer("hide")}),a(document).on("click.editable",function(e){var t,i=a(e.target),n=[".editable-container",".ui-datepicker-header",".datepicker",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];if(!a(".select2-drop-mask").is(":visible")&&a.contains(document.documentElement,e.target)&&!i.is(document)){for(t=0;t<n.length;t++)if(i.is(n[t])||i.parents(n[t]).length)return;l.prototype.closeOthers(e.target)}}),a(document).data("editable-handlers-attached",!0))},splitOptions:function(){if(this.containerOptions={},this.formOptions={},!a.fn[this.containerName])throw new Error(this.containerName+" not found. Have you included corresponding js file?");for(var e in this.options)e in this.defaults?this.containerOptions[e]=this.options[e]:this.formOptions[e]=this.options[e]},tip:function(){return this.container()?this.container().$tip:null},container:function(){var e;return this.containerDataName&&(e=this.$element.data(this.containerDataName))?e:e=this.$element.data(this.containerName)},call:function(){this.$element[this.containerName].apply(this.$element,arguments)},initContainer:function(){this.call(this.containerOptions)},renderForm:function(){this.$form.editableform(this.formOptions).on({save:a.proxy(this.save,this),nochange:a.proxy(function(){this.hide("nochange")},this),cancel:a.proxy(function(){this.hide("cancel")},this),show:a.proxy(function(){this.delayedHide?(this.hide(this.delayedHide.reason),this.delayedHide=!1):this.setPosition()},this),rendering:a.proxy(this.setPosition,this),resize:a.proxy(this.setPosition,this),rendered:a.proxy(function(){this.$element.triggerHandler("shown",a(this.options.scope).data("editable"))},this)}).editableform("render")},show:function(e){this.$element.addClass("editable-open"),!1!==e&&this.closeOthers(this.$element[0]),this.innerShow(),this.tip().addClass(this.containerClass),this.$form,this.$form=a("<div>"),this.tip().is(this.innerCss)?this.tip().append(this.$form):this.tip().find(this.innerCss).append(this.$form),this.renderForm()},hide:function(e){this.tip()&&this.tip().is(":visible")&&this.$element.hasClass("editable-open")&&(this.$form.data("editableform").isSaving?this.delayedHide={reason:e}:(this.delayedHide=!1,this.$element.removeClass("editable-open"),this.innerHide(),this.$element.triggerHandler("hidden",e||"manual")))},innerShow:function(){},innerHide:function(){},toggle:function(e){this.container()&&this.tip()&&this.tip().is(":visible")?this.hide():this.show(e)},setPosition:function(){},save:function(e,t){this.$element.triggerHandler("save",t),this.hide("save")},option:function(e,t){this.options[e]=t,e in this.containerOptions?(this.containerOptions[e]=t,this.setContainerOption(e,t)):(this.formOptions[e]=t,this.$form&&this.$form.editableform("option",e,t))},setContainerOption:function(e,t){this.call("option",e,t)},destroy:function(){this.hide(),this.innerDestroy(),this.$element.off("destroyed"),this.$element.removeData("editableContainer")},innerDestroy:function(){},closeOthers:function(r){a(".editable-open").each(function(e,t){if(t!==r&&!a(t).find(r).length){var i=a(t),n=i.data("editableContainer");n&&("cancel"===n.options.onblur?i.data("editableContainer").hide("onblur"):"submit"===n.options.onblur&&i.data("editableContainer").tip().find("form").submit())}})},activate:function(){this.tip&&this.tip().is(":visible")&&this.$form&&this.$form.data("editableform").input.activate()}},a.fn.editableContainer=function(o){var s=arguments;return this.each(function(){var e=a(this),t="editableContainer",i=e.data(t),n="object"==typeof o&&o,r="inline"===n.mode?u:l;i||e.data(t,i=new r(this,n)),"string"==typeof o&&i[o].apply(i,Array.prototype.slice.call(s,1))})},a.fn.editableContainer.Popup=l,a.fn.editableContainer.Inline=u,a.fn.editableContainer.defaults={value:null,placement:"top",autohide:!0,onblur:"cancel",anim:!1,mode:"popup"},jQuery.event.special.destroyed={remove:function(e){e.handler&&e.handler()}}}(window.jQuery),function(e){"use strict";e.extend(e.fn.editableContainer.Inline.prototype,e.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",containerClass:"editable-container editable-inline",initContainer:function(){this.$tip=e("<span></span>"),this.options.anim||(this.options.anim=0)},splitOptions:function(){this.containerOptions={},this.formOptions=this.options},tip:function(){return this.$tip},innerShow:function(){this.$element.hide(),this.tip().insertAfter(this.$element).show()},innerHide:function(){this.$tip.hide(this.options.anim,e.proxy(function(){this.$element.show(),this.innerDestroy()},this))},innerDestroy:function(){this.tip()&&this.tip().empty().remove()}})}(window.jQuery),function(d){"use strict";var h=function(e,t){this.$element=d(e),this.options=d.extend({},d.fn.editable.defaults,t,d.fn.editableutils.getConfigData(this.$element)),this.options.selector?this.initLive():this.init(),this.options.highlight&&!d.fn.editableutils.supportsTransitions()&&(this.options.highlight=!1)};h.prototype={constructor:h,init:function(){var e,t=!1;if(this.options.name=this.options.name||this.$element.attr("id"),this.options.scope=this.$element[0],this.input=d.fn.editableutils.createInput(this.options),this.input){switch(void 0===this.options.value||null===this.options.value?(this.value=this.input.html2value(d.trim(this.$element.html())),t=!0):(this.options.value=d.fn.editableutils.tryParseJson(this.options.value,!0),"string"==typeof this.options.value?this.value=this.input.str2value(this.options.value):this.value=this.options.value),this.$element.addClass("editable"),"textarea"===this.input.type&&this.$element.addClass("editable-pre-wrapped"),"manual"!==this.options.toggle?(this.$element.addClass("editable-click"),this.$element.on(this.options.toggle+".editable",d.proxy(function(e){if(this.options.disabled||e.preventDefault(),"mouseenter"===this.options.toggle)this.show();else{var t="click"!==this.options.toggle;this.toggle(t)}},this))):this.$element.attr("tabindex",-1),"function"==typeof this.options.display&&(this.options.autotext="always"),this.options.autotext){case"always":e=!0;break;case"auto":e=!d.trim(this.$element.text()).length&&null!==this.value&&void 0!==this.value&&!t;break;default:e=!1}d.when(!e||this.render()).then(d.proxy(function(){this.options.disabled?this.disable():this.enable(),this.$element.triggerHandler("init",this)},this))}},initLive:function(){var e=this.options.selector;this.options.selector=!1,this.options.autotext="never",this.$element.on(this.options.toggle+".editable",e,d.proxy(function(e){var t=d(e.target);t.data("editable")||(t.hasClass(this.options.emptyclass)&&t.empty(),t.editable(this.options).trigger(e))},this))},render:function(e){if(!1!==this.options.display)return this.input.value2htmlFinal?this.input.value2html(this.value,this.$element[0],this.options.display,e):"function"==typeof this.options.display?this.options.display.call(this.$element[0],this.value,e):this.input.value2html(this.value,this.$element[0])},enable:function(){this.options.disabled=!1,this.$element.removeClass("editable-disabled"),this.handleEmpty(this.isEmpty),"manual"!==this.options.toggle&&"-1"===this.$element.attr("tabindex")&&this.$element.removeAttr("tabindex")},disable:function(){this.options.disabled=!0,this.hide(),this.$element.addClass("editable-disabled"),this.handleEmpty(this.isEmpty),this.$element.attr("tabindex",-1)},toggleDisabled:function(){this.options.disabled?this.enable():this.disable()},option:function(e,t){if(e&&"object"==typeof e)d.each(e,d.proxy(function(e,t){this.option(d.trim(e),t)},this));else{if(this.options[e]=t,"disabled"===e)return t?this.disable():this.enable();"value"===e&&this.setValue(t),this.container&&this.container.option(e,t),this.input.option&&this.input.option(e,t)}},handleEmpty:function(e){!1!==this.options.display&&(void 0!==e?this.isEmpty=e:"function"==typeof this.input.isEmpty?this.isEmpty=this.input.isEmpty(this.$element):this.isEmpty=""===d.trim(this.$element.html()),this.options.disabled?this.isEmpty&&(this.$element.empty(),this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass)):this.isEmpty?(this.$element.html(this.options.emptytext),this.options.emptyclass&&this.$element.addClass(this.options.emptyclass)):this.options.emptyclass&&this.$element.removeClass(this.options.emptyclass))},show:function(e){if(!this.options.disabled){if(this.container){if(this.container.tip().is(":visible"))return}else{var t=d.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(t),this.$element.on("save.internal",d.proxy(this.save,this)),this.container=this.$element.data("editableContainer")}this.container.show(e)}},hide:function(){this.container&&this.container.hide()},toggle:function(e){this.container&&this.container.tip().is(":visible")?this.hide():this.show(e)},save:function(e,t){if(this.options.unsavedclass){var i=!1;(i=(i=(i=(i=i||"function"==typeof this.options.url)||!1===this.options.display)||void 0!==t.response)||this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(t.newValue))?this.$element.removeClass(this.options.unsavedclass):this.$element.addClass(this.options.unsavedclass)}if(this.options.highlight){var n=this.$element,r=n.css("background-color");n.css("background-color",this.options.highlight),setTimeout(function(){"transparent"===r&&(r=""),n.css("background-color",r),n.addClass("editable-bg-transition"),setTimeout(function(){n.removeClass("editable-bg-transition")},1700)},10)}this.setValue(t.newValue,!1,t.response)},validate:function(){if("function"==typeof this.options.validate)return this.options.validate.call(this,this.value)},setValue:function(e,t,i){this.value=t?this.input.str2value(e):e,this.container&&this.container.option("value",this.value),d.when(this.render(i)).then(d.proxy(function(){this.handleEmpty()},this))},activate:function(){this.container&&this.container.activate()},destroy:function(){this.disable(),this.container&&this.container.destroy(),this.input.destroy(),"manual"!==this.options.toggle&&(this.$element.removeClass("editable-click"),this.$element.off(this.options.toggle+".editable")),this.$element.off("save.internal"),this.$element.removeClass("editable editable-open editable-disabled"),this.$element.removeData("editable")}},d.fn.editable=function(n){var i={},r=arguments,o="editable";switch(n){case"validate":return this.each(function(){var e,t=d(this).data(o);t&&(e=t.validate())&&(i[t.options.name]=e)}),i;case"getValue":return 2===arguments.length&&!0===arguments[1]?i=this.eq(0).data(o).value:this.each(function(){var e=d(this).data(o);e&&void 0!==e.value&&null!==e.value&&(i[e.options.name]=e.input.value2submit(e.value))}),i;case"submit":var t=arguments[1]||{},s=this,e=this.editable("validate");if(d.isEmptyObject(e)){var a={};if(1===s.length){var l=s.data("editable"),u={name:l.options.name||"",value:l.input.value2submit(l.value),pk:"function"==typeof l.options.pk?l.options.pk.call(l.options.scope):l.options.pk};"function"==typeof l.options.params?u=l.options.params.call(l.options.scope,u):(l.options.params=d.fn.editableutils.tryParseJson(l.options.params,!0),d.extend(u,l.options.params)),a={url:l.options.url,data:u,type:"POST"},t.success=t.success||l.options.success,t.error=t.error||l.options.error}else{var c=this.editable("getValue");a={url:t.url,data:c,type:"POST"}}a.success="function"==typeof t.success?function(e){t.success.call(s,e,t)}:d.noop,a.error="function"==typeof t.error?function(){t.error.apply(s,arguments)}:d.noop,t.ajaxOptions&&d.extend(a,t.ajaxOptions),t.data&&d.extend(a.data,t.data),d.ajax(a)}else"function"==typeof t.error&&t.error.call(s,e);return this}return this.each(function(){var e=d(this),t=e.data(o),i="object"==typeof n&&n;i&&i.selector?t=new h(this,i):(t||e.data(o,t=new h(this,i)),"string"==typeof n&&t[n].apply(t,Array.prototype.slice.call(r,1)))})},d.fn.editable.defaults={type:"text",disabled:!1,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null,highlight:"#FFFF80"}}(window.jQuery),function(n){"use strict";n.fn.editabletypes={};var e=function(){};e.prototype={init:function(e,t,i){this.type=e,this.options=n.extend({},i,t)},prerender:function(){this.$tpl=n(this.options.tpl),this.$input=this.$tpl,this.$clear=null,this.error=null},render:function(){},value2html:function(e,t){n(t)[this.options.escape?"text":"html"](n.trim(e))},html2value:function(e){return n("<div>").html(e).text()},value2str:function(e){return e},str2value:function(e){return e},value2submit:function(e){return e},value2input:function(e){this.$input.val(e)},input2value:function(){return this.$input.val()},activate:function(){this.$input.is(":visible")&&this.$input.focus()},clear:function(){this.$input.val(null)},escape:function(e){return n("<div>").text(e).html()},autosubmit:function(){},destroy:function(){},setClass:function(){this.options.inputclass&&this.$input.addClass(this.options.inputclass)},setAttr:function(e){void 0!==this.options[e]&&null!==this.options[e]&&this.$input.attr(e,this.options[e])},option:function(e,t){this.options[e]=t}},e.defaults={tpl:"",inputclass:null,escape:!0,scope:null,showbuttons:!0},n.extend(n.fn.editabletypes,{abstractinput:e})}(window.jQuery),function(a){"use strict";var e=function(e){};a.fn.editableutils.inherit(e,a.fn.editabletypes.abstractinput),a.extend(e.prototype,{render:function(){var e=a.Deferred();return this.error=null,this.onSourceReady(function(){this.renderList(),e.resolve()},function(){this.error=this.options.sourceError,e.resolve()}),e.promise()},html2value:function(e){return null},value2html:function(e,t,i,n){var r=a.Deferred(),o=function(){"function"==typeof i?i.call(t,e,this.sourceData,n):this.value2htmlFinal(e,t),r.resolve()};return null===e?o.call(this):this.onSourceReady(o,function(){r.resolve()}),r.promise()},onSourceReady:function(t,i){var e;if(a.isFunction(this.options.source)?(e=this.options.source.call(this.options.scope),this.sourceData=null):e=this.options.source,this.options.sourceCache&&a.isArray(this.sourceData))t.call(this);else{try{e=a.fn.editableutils.tryParseJson(e,!1)}catch(e){return void i.call(this)}if("string"==typeof e){if(this.options.sourceCache){var n,r=e;if(a(document).data(r)||a(document).data(r,{}),!1===(n=a(document).data(r)).loading&&n.sourceData)return this.sourceData=n.sourceData,this.doPrepend(),void t.call(this);if(!0===n.loading)return n.callbacks.push(a.proxy(function(){this.sourceData=n.sourceData,this.doPrepend(),t.call(this)},this)),void n.err_callbacks.push(a.proxy(i,this));n.loading=!0,n.callbacks=[],n.err_callbacks=[]}var o=a.extend({url:e,type:"get",cache:!1,dataType:"json",success:a.proxy(function(e){n&&(n.loading=!1),this.sourceData=this.makeArray(e),a.isArray(this.sourceData)?(n&&(n.sourceData=this.sourceData,a.each(n.callbacks,function(){this.call()})),this.doPrepend(),t.call(this)):(i.call(this),n&&a.each(n.err_callbacks,function(){this.call()}))},this),error:a.proxy(function(){i.call(this),n&&(n.loading=!1,a.each(n.err_callbacks,function(){this.call()}))},this)},this.options.sourceOptions);a.ajax(o)}else this.sourceData=this.makeArray(e),a.isArray(this.sourceData)?(this.doPrepend(),t.call(this)):i.call(this)}},doPrepend:function(){null!==this.options.prepend&&void 0!==this.options.prepend&&(a.isArray(this.prependData)||(a.isFunction(this.options.prepend)&&(this.options.prepend=this.options.prepend.call(this.options.scope)),this.options.prepend=a.fn.editableutils.tryParseJson(this.options.prepend,!0),"string"==typeof this.options.prepend&&(this.options.prepend={"":this.options.prepend}),this.prependData=this.makeArray(this.options.prepend)),a.isArray(this.prependData)&&a.isArray(this.sourceData)&&(this.sourceData=this.prependData.concat(this.sourceData)))},renderList:function(){},value2htmlFinal:function(e,t){},makeArray:function(e){var i,n,t,r,o=[];if(!e||"string"==typeof e)return null;if(a.isArray(e)){r=function(e,t){if(n={value:e,text:t},2<=i++)return!1};for(var s=0;s<e.length;s++)"object"==typeof(t=e[s])?(i=0,a.each(t,r),1===i?o.push(n):1<i&&(t.children&&(t.children=this.makeArray(t.children)),o.push(t))):o.push({value:t,text:t})}else a.each(e,function(e,t){o.push({value:e,text:t})});return o},option:function(e,t){this.options[e]=t,"source"===e&&(this.sourceData=null),"prepend"===e&&(this.prependData=null)}}),e.defaults=a.extend({},a.fn.editabletypes.abstractinput.defaults,{source:null,prepend:!1,sourceError:"Error when loading list",sourceCache:!0,sourceOptions:null}),a.fn.editabletypes.list=e}(window.jQuery),function(i){"use strict";var t=function(e){this.init("text",e,t.defaults)};i.fn.editableutils.inherit(t,i.fn.editabletypes.abstractinput),i.extend(t.prototype,{render:function(){this.renderClear(),this.setClass(),this.setAttr("placeholder")},activate:function(){this.$input.is(":visible")&&(this.$input.focus(),this.$input.is("input,textarea")&&!this.$input.is('[type="checkbox"],[type="range"]')&&i.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length),this.toggleClear&&this.toggleClear())},renderClear:function(){this.options.clear&&(this.$clear=i('<span class="editable-clear-x"></span>'),this.$input.after(this.$clear).css("padding-right",24).keyup(i.proxy(function(e){if(!~i.inArray(e.keyCode,[40,38,9,13,27])){clearTimeout(this.t);var t=this;this.t=setTimeout(function(){t.toggleClear(e)},100)}},this)).parent().css("position","relative"),this.$clear.click(i.proxy(this.clear,this)))},postrender:function(){},toggleClear:function(e){if(this.$clear){var t=this.$input.val().length,i=this.$clear.is(":visible");t&&!i&&this.$clear.show(),!t&&i&&this.$clear.hide()}},clear:function(){this.$clear.hide(),this.$input.val("").focus()}}),t.defaults=i.extend({},i.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:!0}),i.fn.editabletypes.text=t}(window.jQuery),function(t){"use strict";var i=function(e){this.init("textarea",e,i.defaults)};t.fn.editableutils.inherit(i,t.fn.editabletypes.abstractinput),t.extend(i.prototype,{render:function(){this.setClass(),this.setAttr("placeholder"),this.setAttr("rows"),this.$input.keydown(function(e){e.ctrlKey&&13===e.which&&t(this).closest("form").submit()})},activate:function(){t.fn.editabletypes.text.prototype.activate.call(this)}}),i.defaults=t.extend({},t.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7}),t.fn.editabletypes.textarea=i}(window.jQuery),function(a){"use strict";var t=function(e){this.init("select",e,t.defaults)};a.fn.editableutils.inherit(t,a.fn.editabletypes.list),a.extend(t.prototype,{renderList:function(){this.$input.empty();var o=this.options.escape,s=function(e,t){var i;if(a.isArray(t))for(var n=0;n<t.length;n++)if(i={},t[n].children)i.label=t[n].text,e.append(s(a("<optgroup>",i),t[n].children));else{i.value=t[n].value,t[n].disabled&&(i.disabled=!0);var r=a("<option>",i);r[o?"text":"html"](t[n].text),e.append(r)}return e};s(this.$input,this.sourceData),this.setClass(),this.$input.on("keydown.editable",function(e){13===e.which&&a(this).closest("form").submit()})},value2htmlFinal:function(e,t){var i="",n=a.fn.editableutils.itemsByValue(e,this.sourceData);n.length&&(i=n[0].text),a.fn.editabletypes.abstractinput.prototype.value2html.call(this,i,t)},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){a(this).closest("form").submit()})}}),t.defaults=a.extend({},a.fn.editabletypes.list.defaults,{tpl:"<select></select>"}),a.fn.editabletypes.select=t}(window.jQuery),function(o){"use strict";var t=function(e){this.init("checklist",e,t.defaults)};o.fn.editableutils.inherit(t,o.fn.editabletypes.list),o.extend(t.prototype,{renderList:function(){var e;if(this.$tpl.empty(),o.isArray(this.sourceData)){for(var t=0;t<this.sourceData.length;t++){e=o("<label>").append(o("<input>",{type:"checkbox",value:this.sourceData[t].value}));var i=o("<span>");i[this.options.escape?"text":"html"](" "+this.sourceData[t].text),e.append(i),o("<div>").append(e).appendTo(this.$tpl)}this.$input=this.$tpl.find('input[type="checkbox"]'),this.setClass()}},value2str:function(e){return o.isArray(e)?e.sort().join(o.trim(this.options.separator)):""},str2value:function(e){var t;return"string"==typeof e&&e.length?(t=new RegExp("\\s*"+o.trim(this.options.separator)+"\\s*"),e.split(t)):o.isArray(e)?e:[e]},value2input:function(n){this.$input.prop("checked",!1),o.isArray(n)&&n.length&&this.$input.each(function(e,t){var i=o(t);o.each(n,function(e,t){i.val()==t&&i.prop("checked",!0)})})},input2value:function(){var i=[];return this.$input.filter(":checked").each(function(e,t){i.push(o(t).val())}),i},value2htmlFinal:function(e,t){var n=[],i=o.fn.editableutils.itemsByValue(e,this.sourceData),r=this.options.escape;i.length?(o.each(i,function(e,t){var i=r?o.fn.editableutils.escape(t.text):t.text;n.push(i)}),o(t).html(n.join("<br>"))):o(t).empty()},activate:function(){this.$input.first().focus()},autosubmit:function(){this.$input.on("keydown",function(e){13===e.which&&o(this).closest("form").submit()})}}),t.defaults=o.extend({},o.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","}),o.fn.editabletypes.checklist=t}(window.jQuery),function(i){"use strict";var t=function(e){this.init("password",e,t.defaults)};i.fn.editableutils.inherit(t,i.fn.editabletypes.text),i.extend(t.prototype,{value2html:function(e,t){e?i(t).text("[hidden]"):i(t).empty()},html2value:function(e){return null}}),t.defaults=i.extend({},i.fn.editabletypes.text.defaults,{tpl:'<input type="password">'}),i.fn.editabletypes.password=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("email",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="email">'}),e.fn.editabletypes.email=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("url",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="url">'}),e.fn.editabletypes.url=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("tel",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'}),e.fn.editabletypes.tel=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("number",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.text),e.extend(t.prototype,{render:function(){t.superclass.render.call(this),this.setAttr("min"),this.setAttr("max"),this.setAttr("step")},postrender:function(){this.$clear&&this.$clear.css({right:24})}}),t.defaults=e.extend({},e.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null}),e.fn.editabletypes.number=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("range",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.number),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.setAttr("min"),this.setAttr("max"),this.setAttr("step"),this.$input.on("input",function(){e(this).siblings("output").text(e(this).val())})},activate:function(){this.$input.focus()}}),t.defaults=e.extend({},e.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"}),e.fn.editabletypes.range=t}(window.jQuery),function(e){"use strict";var t=function(e){this.init("time",e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.abstractinput),e.extend(t.prototype,{render:function(){this.setClass()}}),t.defaults=e.extend({},e.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="time">'}),e.fn.editabletypes.time=t}(window.jQuery),function(o){"use strict";var s=function(e){if(this.init("select2",e,s.defaults),e.select2=e.select2||{},this.sourceData=null,e.placeholder&&(e.select2.placeholder=e.placeholder),!e.select2.tags&&e.source){var t=e.source;o.isFunction(e.source)&&(t=e.source.call(e.scope)),"string"==typeof t?(e.select2.ajax=e.select2.ajax||{},e.select2.ajax.dataType||(e.select2.ajax.dataType="json"),e.select2.ajax.data||(e.select2.ajax.data=function(e){return{query:e}}),e.select2.ajax.processResults||(e.select2.ajax.processResults=function(e){return{results:e}}),e.select2.ajax.url=t):(this.sourceData=this.convertSource(t),e.select2.data=this.sourceData)}if(this.options.select2=o.extend({},s.defaults.select2,e.select2),this.isMultiple=this.options.select2.tags||this.options.select2.multiple,this.isRemote="ajax"in this.options.select2,this.idFunc=this.options.select2.id,"function"!=typeof this.idFunc){var i=this.idFunc||"id";this.idFunc=function(e){return e[i]}}this.formatSelection=this.options.select2.formatSelection,"function"!=typeof this.formatSelection&&(this.formatSelection=function(e){return e.text})};o.fn.editableutils.inherit(s,o.fn.editabletypes.abstractinput),o.extend(s.prototype,{render:function(){this.setClass(),this.isRemote&&this.$input.on("select2-loaded",o.proxy(function(e){this.sourceData=e.items.results},this)),this.isMultiple&&this.$input.on("change",function(){o(this).closest("form").parent().triggerHandler("resize")})},value2html:function(e,t){var i,n="",r=this;this.options.select2.tags?i=e:this.sourceData&&(i=o.fn.editableutils.itemsByValue(e,this.sourceData,this.idFunc)),o.isArray(i)?(n=[],o.each(i,function(e,t){n.push(t&&"object"==typeof t?r.formatSelection(t):t)})):i&&(n=r.formatSelection(i)),n=o.isArray(n)?n.join(this.options.viewseparator):n,s.superclass.value2html.call(this,n,t)},html2value:function(e){return this.options.select2.tags?this.str2value(e,this.options.viewseparator):null},value2input:function(e){if(o.isArray(e)&&(e=e.join(this.getSeparator())),this.$input.data("select2")?this.$input.val(e).trigger("change",!0):(this.$input.val(e),this.$input.select2(this.options.select2)),this.isRemote&&!this.isMultiple&&!this.options.select2.initSelection){var t=this.options.select2.id,i=this.options.select2.formatSelection;if(!t&&!i){var n=o(this.options.scope);if(!n.data("editable").isEmpty){var r={id:e,text:n.text()};this.$input.select2("data",r)}}}},input2value:function(){return this.$input.select2("val")},str2value:function(e,t){if("string"!=typeof e||!this.isMultiple)return e;var i,n,r;if(t=t||this.getSeparator(),null===e||e.length<1)return null;for(n=0,r=(i=e.split(t)).length;n<r;n+=1)i[n]=o.trim(i[n]);return i},autosubmit:function(){this.$input.on("change",function(e,t){t||o(this).closest("form").submit()})},getSeparator:function(){return this.options.select2.separator||o.fn.select2.defaults.separator},convertSource:function(e){if(o.isArray(e)&&e.length&&void 0!==e[0].value)for(var t=0;t<e.length;t++)void 0!==e[t].value&&(e[t].id=e[t].value,delete e[t].value);return e},destroy:function(){this.$input.data("select2")&&this.$input.select2("destroy")}}),s.defaults=o.extend({},o.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "}),o.fn.editabletypes.select2=s}(window.jQuery),function(s){var o=function(e,t){this.$element=s(e),this.$element.is("input")?(this.options=s.extend({},s.fn.combodate.defaults,t,this.$element.data()),this.init()):s.error("Combodate should be applied to INPUT element")};o.prototype={constructor:o,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]},this.$widget=s('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on("change","select",s.proxy(function(e){this.$element.val(this.getValue()).change(),this.options.smartDays&&(s(e.target).is(".month")||s(e.target).is(".year"))&&this.fillCombo("day")},this)),this.$widget.find("select").css("width","auto"),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function(){var r=this.options.template;return s.each(this.map,function(e,t){t=t[0];var i=new RegExp(t+"+"),n=1<t.length?t.substring(1,2):t;r=r.replace(i,"{"+n+"}")}),r=r.replace(/ /g,"&nbsp;"),s.each(this.map,function(e,t){var i=1<(t=t[0]).length?t.substring(1,2):t;r=r.replace("{"+i+"}",'<select class="'+e+'"></select>')}),r},initCombos:function(){for(var e in this.map){var t=this.$widget.find("."+e);this["$"+e]=t.length?t:null,this.fillCombo(e)}},fillCombo:function(e){var t=this["$"+e];if(t){var i=this["fill"+e.charAt(0).toUpperCase()+e.slice(1)](),n=t.val();t.empty();for(var r=0;r<i.length;r++)t.append('<option value="'+i[r][0]+'">'+i[r][1]+"</option>");t.val(n)}},fillCommon:function(e){var t,i=[];if("name"===this.options.firstItem){var n="function"==typeof(t=moment.relativeTime||moment.langData()._relativeTime)[e]?t[e](1,!0,e,!1):t[e];n=n.split(" ").reverse()[0],i.push(["",n])}else"empty"===this.options.firstItem&&i.push(["",""]);return i},fillDay:function(){var e,t,i=this.fillCommon("d"),n=-1!==this.options.template.indexOf("DD"),r=31;if(this.options.smartDays&&this.$month&&this.$year){var o=parseInt(this.$month.val(),10),s=parseInt(this.$year.val(),10);isNaN(o)||isNaN(s)||(r=moment([s,o]).daysInMonth())}for(t=1;t<=r;t++)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillMonth:function(){var e,t,i=this.fillCommon("M"),n=-1!==this.options.template.indexOf("MMMM"),r=-1!==this.options.template.indexOf("MMM"),o=-1!==this.options.template.indexOf("MM");for(t=0;t<=11;t++)e=n?moment().date(1).month(t).format("MMMM"):r?moment().date(1).month(t).format("MMM"):o?this.leadZero(t+1):t+1,i.push([t,e]);return i},fillYear:function(){var e,t,i=[],n=-1!==this.options.template.indexOf("YYYY");for(t=this.options.maxYear;t>=this.options.minYear;t--)e=n?t:(t+"").substring(2),i[this.options.yearDescending?"push":"unshift"]([t,e]);return i=this.fillCommon("y").concat(i)},fillHour:function(){var e,t,i=this.fillCommon("h"),n=-1!==this.options.template.indexOf("h"),r=(this.options.template.indexOf("H"),-1!==this.options.template.toLowerCase().indexOf("hh")),o=n?12:23;for(t=n?1:0;t<=o;t++)e=r?this.leadZero(t):t,i.push([t,e]);return i},fillMinute:function(){var e,t,i=this.fillCommon("m"),n=-1!==this.options.template.indexOf("mm");for(t=0;t<=59;t+=this.options.minuteStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillSecond:function(){var e,t,i=this.fillCommon("s"),n=-1!==this.options.template.indexOf("ss");for(t=0;t<=59;t+=this.options.secondStep)e=n?this.leadZero(t):t,i.push([t,e]);return i},fillAmpm:function(){var e=-1!==this.options.template.indexOf("a");this.options.template.indexOf("A");return[["am",e?"am":"AM"],["pm",e?"pm":"PM"]]},getValue:function(e){var t,n={},r=this,o=!1;return s.each(this.map,function(e,t){if("ampm"!==e){var i="day"===e?1:0;return n[e]=r["$"+e]?parseInt(r["$"+e].val(),10):i,isNaN(n[e])?!(o=!0):void 0}}),o?"":(this.$ampm&&(12===n.hour?n.hour="am"===this.$ampm.val()?0:12:n.hour="am"===this.$ampm.val()?n.hour:n.hour+12),t=moment([n.year,n.month,n.day,n.hour,n.minute,n.second]),this.highlight(t),null===(e=void 0===e?this.options.format:e)?t.isValid()?t:null:t.isValid()?t.format(e):"")},setValue:function(e){if(e){var i="string"==typeof e?moment(e,this.options.format):moment(e),n=this,r={};i.isValid()&&(s.each(this.map,function(e,t){"ampm"!==e&&(r[e]=i[t[1]]())}),this.$ampm&&(12<=r.hour?(r.ampm="pm",12<r.hour&&(r.hour-=12)):(r.ampm="am",0===r.hour&&(r.hour=12))),s.each(r,function(e,t){n["$"+e]&&("minute"===e&&1<n.options.minuteStep&&n.options.roundTime&&(t=o(n["$"+e],t)),"second"===e&&1<n.options.secondStep&&n.options.roundTime&&(t=o(n["$"+e],t)),n["$"+e].val(t))}),this.options.smartDays&&this.fillCombo("day"),this.$element.val(i.format(this.options.format)).change())}function o(e,r){var o={};return e.children("option").each(function(e,t){var i,n=s(t).attr("value");""!==n&&(i=Math.abs(n-r),(void 0===o.distance||i<o.distance)&&(o={value:n,distance:i}))}),o.value}},highlight:function(e){e.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find("select").css("border-color",this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(this.borderColor||(this.borderColor=this.$widget.find("select").css("border-color")),this.$widget.find("select").css("border-color","red"))},leadZero:function(e){return e<=9?"0"+e:e},destroy:function(){this.$widget.remove(),this.$element.removeData("combodate").show()}},s.fn.combodate=function(n){var e,r=Array.apply(null,arguments);return r.shift(),"getValue"===n&&this.length&&(e=this.eq(0).data("combodate"))?e.getValue.apply(e,r):this.each(function(){var e=s(this),t=e.data("combodate"),i="object"==typeof n&&n;t||e.data("combodate",t=new o(this,i)),"string"==typeof n&&"function"==typeof t[n]&&t[n].apply(t,r)})},s.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:(new Date).getFullYear(),yearDescending:!0,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null,roundTime:!0,smartDays:!1}}(window.jQuery),function(t){"use strict";var n=function(e){this.init("combodate",e,n.defaults),this.options.viewformat||(this.options.viewformat=this.options.format),e.combodate=t.fn.editableutils.tryParseJson(e.combodate,!0),this.options.combodate=t.extend({},n.defaults.combodate,e.combodate,{format:this.options.format,template:this.options.template})};t.fn.editableutils.inherit(n,t.fn.editabletypes.abstractinput),t.extend(n.prototype,{render:function(){this.$input.combodate(this.options.combodate),"bs3"===t.fn.editableform.engine&&this.$input.siblings().find("select").addClass("form-control"),this.options.inputclass&&this.$input.siblings().find("select").addClass(this.options.inputclass)},value2html:function(e,t){var i=e?e.format(this.options.viewformat):"";n.superclass.value2html.call(this,i,t)},html2value:function(e){return e?moment(e,this.options.viewformat):null},value2str:function(e){return e?e.format(this.options.format):""},str2value:function(e){return e?moment(e,this.options.format):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.combodate("setValue",e)},input2value:function(){return this.$input.combodate("getValue",null)},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus()},autosubmit:function(){}}),n.defaults=t.extend({},t.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null}),t.fn.editabletypes.combodate=n}(window.jQuery),function(s){"use strict";var a=s.fn.editableform.Constructor.prototype.initInput;s.extend(s.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=s(s.fn.editableform.template),this.$form.find(".control-group").addClass("form-group"),this.$form.find(".editable-error-block").addClass("help-block")},initInput:function(){a.apply(this);var e=null===this.input.options.inputclass||!1===this.input.options.inputclass,t="input-sm",i="text,select,textarea,password,email,url,tel,number,range,time,typeaheadjs".split(",");~s.inArray(this.input.type,i)&&(this.input.$input.addClass("form-control"),e&&(this.input.options.inputclass=t,this.input.$input.addClass(t)));for(var n=this.$form.find(".editable-buttons"),r=e?[t]:this.input.options.inputclass.split(" "),o=0;o<r.length;o++)"input-lg"===r[o].toLowerCase()&&n.find("button").removeClass("btn-sm").addClass("btn-lg")}}),s.fn.editableform.buttons='<button type="submit" class="btn btn-primary btn-sm editable-submit"><i class="glyphicon glyphicon-ok"></i></button><button type="button" class="btn btn-default btn-sm editable-cancel"><i class="glyphicon glyphicon-remove"></i></button>',s.fn.editableform.errorGroupClass="has-error",s.fn.editableform.errorBlockClass=null,s.fn.editableform.engine="bs3"}(window.jQuery),function(t){"use strict";t.extend(t.fn.editableContainer.Popup.prototype,{containerName:"popover",containerDataName:"bs.popover",innerCss:".popover-content",defaults:t.fn.popover.Constructor.DEFAULTS,initContainer:function(){var e;t.extend(this.containerOptions,{trigger:"manual",selector:!1,content:" ",template:this.defaults.template}),this.$element.data("template")&&(e=this.$element.data("template"),this.$element.removeData("template")),this.call(this.containerOptions),e&&this.$element.data("template",e)},innerShow:function(){this.call("show")},innerHide:function(){this.call("hide")},innerDestroy:function(){this.call("destroy")},setContainerOption:function(e,t){this.container().options[e]=t},setPosition:function(){(function(){var e=this.tip(),t="function"==typeof this.options.placement?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,i=/\s?auto?\s?/i,n=i.test(t);n&&(t=t.replace(i,"")||"top");var r=this.getPosition(),o=e[0].offsetWidth,s=e[0].offsetHeight;if(n){var a=this.$element.parent(),l=t,u=document.documentElement.scrollTop||document.body.scrollTop,c="body"==this.options.container?window.innerWidth:a.outerWidth(),d="body"==this.options.container?window.innerHeight:a.outerHeight(),h="body"==this.options.container?0:a.offset().left;t="bottom"==t&&r.top+r.height+s-u>d?"top":"top"==t&&r.top-u-s<0?"bottom":"right"==t&&r.right+o>c?"left":"left"==t&&r.left-o<h?"right":t,e.removeClass(l).addClass(t)}var p=this.getCalculatedOffset(t,r,o,s);this.applyPlacement(p,t)}).call(this.container())}})}(window.jQuery),function(k){function _(){return new Date(Date.UTC.apply(Date,arguments))}var v=function(e,t){this._process_options(t),this.element=k(e),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=k(C.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this.o.startDate),this.setEndDate(this.o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};v.prototype={constructor:v,_process_options:function(e){this._o=k.extend({},this._o,e);var t=this.o=k.extend({},this._o),i=t.language;switch(F[i]||(i=i.split("-")[0],F[i]||(i=d.language)),t.language=i,t.startView){case 2:case"decade":t.startView=2;break;case 1:case"year":t.startView=1;break;default:t.startView=0}switch(t.minViewMode){case 1:case"months":t.minViewMode=1;break;case 2:case"years":t.minViewMode=2;break;default:t.minViewMode=0}t.startView=Math.max(t.startView,t.minViewMode),t.weekStart%=7,t.weekEnd=(t.weekStart+6)%7;var n=C.parseFormat(t.format);t.startDate!==-1/0&&(t.startDate=C.parseDate(t.startDate,n,t.language)),t.endDate!==1/0&&(t.endDate=C.parseDate(t.endDate,n,t.language)),t.daysOfWeekDisabled=t.daysOfWeekDisabled||[],k.isArray(t.daysOfWeekDisabled)||(t.daysOfWeekDisabled=t.daysOfWeekDisabled.split(/[,\s]*/)),t.daysOfWeekDisabled=k.map(t.daysOfWeekDisabled,function(e){return parseInt(e,10)})},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.on(i)},_unapplyEvents:function(e){for(var t,i,n=0;n<e.length;n++)t=e[n][0],i=e[n][1],t.off(i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:k.proxy(this.show,this),keyup:k.proxy(this.update,this),keydown:k.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:k.proxy(this.show,this),keyup:k.proxy(this.update,this),keydown:k.proxy(this.keydown,this)}],[this.component,{click:k.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:k.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:k.proxy(this.click,this)}],[k(window),{resize:k.proxy(this.place,this)}],[k(document),{mousedown:k.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).size()||this.picker.is(e.target)||this.picker.find(e.target).size()||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(e,t){var i=t||this.date,n=new Date(i.getTime()+6e4*i.getTimezoneOffset());this.element.trigger({type:e,date:n,format:k.proxy(function(e){var t=e||this.o.format;return C.formatDate(i,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),e&&e.preventDefault(),this._trigger("show")},hide:function(e){this.isInline||this.picker.is(":visible")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){this.date=e,this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e):this.component&&this.element.find("input").val(e)},getFormattedDate:function(e){return void 0===e&&(e=this.o.format),C.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var e=parseInt(this.element.parents().filter(function(){return"auto"!=k(this).css("z-index")}).first().css("z-index"))+10,t=this.component?this.component.parent().offset():this.element.offset(),i=this.component?this.component.outerHeight(!0):this.element.outerHeight(!0);this.picker.css({top:t.top+i,left:t.left,zIndex:e})}},_allow_update:!0,update:function(){if(this._allow_update){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=C.parseDate(e,this.o.format,this.o.language),t&&this.setValue(),this.date<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.date>this.o.endDate?this.viewDate=new Date(this.o.endDate):this.viewDate=new Date(this.date),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var i='<th class="cw">&nbsp;</th>';t+=i,this.picker.find(".datepicker-days thead tr:first-child").prepend(i)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+F[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+F[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(e){e&&e.length?this.range=k.map(e,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(e){var t=[],i=this.viewDate.getUTCFullYear(),n=this.viewDate.getUTCMonth(),r=this.date.valueOf(),o=new Date;return e.getUTCFullYear()<i||e.getUTCFullYear()==i&&e.getUTCMonth()<n?t.push("old"):(e.getUTCFullYear()>i||e.getUTCFullYear()==i&&e.getUTCMonth()>n)&&t.push("new"),this.o.todayHighlight&&e.getUTCFullYear()==o.getFullYear()&&e.getUTCMonth()==o.getMonth()&&e.getUTCDate()==o.getDate()&&t.push("today"),r&&e.valueOf()==r&&t.push("active"),(e.valueOf()<this.o.startDate||e.valueOf()>this.o.endDate||-1!==k.inArray(e.getUTCDay(),this.o.daysOfWeekDisabled))&&t.push("disabled"),this.range&&(e>this.range[0]&&e<this.range[this.range.length-1]&&t.push("range"),-1!=k.inArray(e.valueOf(),this.range)&&t.push("selected")),t},fill:function(){var e,t=new Date(this.viewDate),i=t.getUTCFullYear(),n=t.getUTCMonth(),r=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,o=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,s=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,a=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf();this.picker.find(".datepicker-days thead th.datepicker-switch").text(F[this.o.language].months[n]+" "+i),this.picker.find("tfoot th.today").text(F[this.o.language].today).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot th.clear").text(F[this.o.language].clear).toggle(!1!==this.o.clearBtn),this.updateNavArrows(),this.fillMonths();var l=_(i,n-1,28,0,0,0,0),u=C.getDaysInMonth(l.getUTCFullYear(),l.getUTCMonth());l.setUTCDate(u),l.setUTCDate(u-(l.getUTCDay()-this.o.weekStart+7)%7);var c=new Date(l);c.setUTCDate(c.getUTCDate()+42),c=c.valueOf();for(var d,h=[];l.valueOf()<c;){if(l.getUTCDay()==this.o.weekStart&&(h.push("<tr>"),this.o.calendarWeeks)){var p=new Date(+l+(this.o.weekStart-l.getUTCDay()-7)%7*864e5),f=new Date(+p+(11-p.getUTCDay())%7*864e5),g=new Date(+(g=_(f.getUTCFullYear(),0,1))+(11-g.getUTCDay())%7*864e5),v=(f-g)/864e5/7+1;h.push('<td class="cw">'+v+"</td>")}(d=this.getClassNames(l)).push("day");var m=this.o.beforeShowDay(l);void 0===m?m={}:"boolean"==typeof m?m={enabled:m}:"string"==typeof m&&(m={classes:m}),!1===m.enabled&&d.push("disabled"),m.classes&&(d=d.concat(m.classes.split(/\s+/))),m.tooltip&&(e=m.tooltip),d=k.unique(d),h.push('<td class="'+d.join(" ")+'"'+(e?' title="'+e+'"':"")+">"+l.getUTCDate()+"</td>"),l.getUTCDay()==this.o.weekEnd&&h.push("</tr>"),l.setUTCDate(l.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(h.join(""));var y=this.date&&this.date.getUTCFullYear(),b=this.picker.find(".datepicker-months").find("th:eq(1)").text(i).end().find("span").removeClass("active");y&&y==i&&b.eq(this.date.getUTCMonth()).addClass("active"),(i<r||s<i)&&b.addClass("disabled"),i==r&&b.slice(0,o).addClass("disabled"),i==s&&b.slice(a+1).addClass("disabled"),h="",i=10*parseInt(i/10,10);var w=this.picker.find(".datepicker-years").find("th:eq(1)").text(i+"-"+(i+9)).end().find("td");i-=1;for(var x=-1;x<11;x++)h+='<span class="year'+(-1==x?" old":10==x?" new":"")+(y==i?" active":"")+(i<r||s<i?" disabled":"")+'">'+i+"</span>",i+=1;w.html(h)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()&&i<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&i>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(e){e.preventDefault();var t=k(e.target).closest("span, td, th");if(1==t.length)switch(t[0].nodeName.toLowerCase()){case"th":switch(t[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var i=C.modes[this.viewMode].navStep*("prev"==t[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,i);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,i)}this.fill();break;case"today":var n=new Date;n=_(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),this.showMode(-2);var r="linked"==this.o.todayBtn?null:"view";this._setDate(n,r);break;case"clear":var o;this.isInput?o=this.element:this.component&&(o=this.element.find("input")),o&&o.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!t.is(".disabled")){if(this.viewDate.setUTCDate(1),t.is(".month")){var s=1,a=t.parent().find("span").index(t),l=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(a),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(_(l,a,s,0,0,0,0))}else{l=parseInt(t.text(),10)||0,s=1,a=0;this.viewDate.setUTCFullYear(l),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(_(l,a,s,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(t.is(".day")&&!t.is(".disabled")){s=parseInt(t.text(),10)||1,l=this.viewDate.getUTCFullYear(),a=this.viewDate.getUTCMonth();t.is(".old")?0===a?(a=11,l-=1):a-=1:t.is(".new")&&(11==a?(a=0,l+=1):a+=1),this._setDate(_(l,a,s,0,0,0,0))}}},_setDate:function(e,t){var i;t&&"date"!=t||(this.date=new Date(e)),t&&"view"!=t||(this.viewDate=new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate"),this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),!this.o.autoclose||t&&"date"!=t||this.hide())},moveMonth:function(e,t){if(!t)return e;var i,n,r=new Date(e.valueOf()),o=r.getUTCDate(),s=r.getUTCMonth(),a=Math.abs(t);if(t=0<t?1:-1,1==a)n=-1==t?function(){return r.getUTCMonth()==s}:function(){return r.getUTCMonth()!=i},i=s+t,r.setUTCMonth(i),(i<0||11<i)&&(i=(i+12)%12);else{for(var l=0;l<a;l++)r=this.moveMonth(r,t);i=r.getUTCMonth(),r.setUTCDate(o),n=function(){return i!=r.getUTCMonth()}}for(;n();)r.setUTCDate(--o),r.setUTCMonth(i);return r},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))27==e.keyCode&&this.show();else{var t,i,n,r,o=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38==e.keyCode?-1:1,e.ctrlKey?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):e.shiftKey?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):((i=new Date(this.date)).setUTCDate(this.date.getUTCDate()+7*t),(n=new Date(this.viewDate)).setUTCDate(this.viewDate.getUTCDate()+7*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(o)this._trigger("changeDate"),this.isInput?r=this.element:this.component&&(r=this.element.find("input")),r&&r.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+C.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var c=function(e,t){this.element=k(e),this.inputs=k.map(t.inputs,function(e){return e.jquery?e[0]:e}),delete t.inputs,k(this.inputs).datepicker(t).bind("changeDate",k.proxy(this.dateUpdated,this)),this.pickers=k.map(this.inputs,function(e){return k(e).data("datepicker")}),this.updateDates()};c.prototype={updateDates:function(){this.dates=k.map(this.pickers,function(e){return e.date}),this.updateRanges()},updateRanges:function(){var i=k.map(this.dates,function(e){return e.valueOf()});k.each(this.pickers,function(e,t){t.setRange(i)})},dateUpdated:function(e){var t=k(e.target).data("datepicker").getUTCDate(),i=k.inArray(e.target,this.inputs),n=this.inputs.length;if(-1!=i){if(t<this.dates[i])for(;0<=i&&t<this.dates[i];)this.pickers[i--].setUTCDate(t);else if(t>this.dates[i])for(;i<n&&t>this.dates[i];)this.pickers[i++].setUTCDate(t);this.updateDates()}},remove:function(){k.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var e=k.fn.datepicker,i=k.fn.datepicker=function(a){var l,u=Array.apply(null,arguments);return u.shift(),this.each(function(){var e=k(this),t=e.data("datepicker"),i="object"==typeof a&&a;if(!t){var n=function(e,t){var i=k(e).data(),n={},r=new RegExp("^"+t.toLowerCase()+"([A-Z])");for(var o in t=new RegExp("^"+t.toLowerCase()),i)t.test(o)&&(n[o.replace(r,function(e,t){return t.toLowerCase()})]=i[o]);return n}(this,"date"),r=function(e){var i={};if(F[e]||(e=e.split("-")[0],F[e])){var n=F[e];return k.each(h,function(e,t){t in n&&(i[t]=n[t])}),i}}(k.extend({},d,n,i).language),o=k.extend({},d,r,n,i);if(e.is(".input-daterange")||o.inputs){var s={inputs:o.inputs||e.find("input").toArray()};e.data("datepicker",t=new c(this,k.extend(o,s)))}else e.data("datepicker",t=new v(this,o))}if("string"==typeof a&&"function"==typeof t[a]&&void 0!==(l=t[a].apply(t,u)))return!1}),void 0!==l?l:this},d=k.fn.datepicker.defaults={autoclose:!1,beforeShowDay:k.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},h=k.fn.datepicker.locale_opts=["format","rtl","weekStart"];k.fn.datepicker.Constructor=v;var F=k.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},C={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,C.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),i=e.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(e,t,i){if(e instanceof Date)return e;if("string"==typeof t&&(t=C.parseFormat(t)),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(e)){var n,r=/([\-+]\d+)([dmwy])/,o=e.match(/([\-+]\d+)([dmwy])/g);e=new Date;for(var s=0;s<o.length;s++)switch(u=r.exec(o[s]),n=parseInt(u[1]),u[2]){case"d":e.setUTCDate(e.getUTCDate()+n);break;case"m":e=v.prototype.moveMonth.call(v.prototype,e,n);break;case"w":e.setUTCDate(e.getUTCDate()+7*n);break;case"y":e=v.prototype.moveYear.call(v.prototype,e,n)}return _(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),0,0,0)}o=e&&e.match(this.nonpunctuation)||[],e=new Date;var a,l,u,c={},d=["yyyy","yy","M","MM","m","mm","d","dd"],h={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};h.M=h.MM=h.mm=h.m,h.dd=h.d,e=_(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0);var p=t.parts.slice();if(o.length!=p.length&&(p=k(p).filter(function(e,t){return-1!==k.inArray(t,d)}).toArray()),o.length==p.length){s=0;for(var f=p.length;s<f;s++){if(a=parseInt(o[s],10),u=p[s],isNaN(a))switch(u){case"MM":l=k(F[i].months).filter(function(){var e=this.slice(0,o[s].length);return e==o[s].slice(0,e.length)}),a=k.inArray(l[0],F[i].months)+1;break;case"M":l=k(F[i].monthsShort).filter(function(){var e=this.slice(0,o[s].length);return e==o[s].slice(0,e.length)}),a=k.inArray(l[0],F[i].monthsShort)+1}c[u]=a}var g;for(s=0;s<d.length;s++)(g=d[s])in c&&!isNaN(c[g])&&h[g](e,c[g])}return e},formatDate:function(e,t,i){"string"==typeof t&&(t=C.parseFormat(t));var n={d:e.getUTCDate(),D:F[i].daysShort[e.getUTCDay()],DD:F[i].days[e.getUTCDay()],m:e.getUTCMonth()+1,M:F[i].monthsShort[e.getUTCMonth()],MM:F[i].months[e.getUTCMonth()],yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear()};n.dd=(n.d<10?"0":"")+n.d,n.mm=(n.m<10?"0":"")+n.m;e=[];for(var r=k.extend([],t.separators),o=0,s=t.parts.length;o<=s;o++)r.length&&e.push(r.shift()),e.push(n[t.parts[o]]);return e.join("")},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="datepicker-switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};C.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+C.headTemplate+"<tbody></tbody>"+C.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+C.headTemplate+C.contTemplate+C.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+C.headTemplate+C.contTemplate+C.footTemplate+"</table></div></div>",k.fn.datepicker.DPGlobal=C,k.fn.datepicker.noConflict=function(){return k.fn.datepicker=e,this},k(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(e){var t=k(this);t.data("datepicker")||(e.preventDefault(),i.call(t,"show"))}),k(function(){i.call(k('[data-provide="datepicker-inline"]'))})}(window.jQuery),function(i){"use strict";i.fn.bdatepicker=i.fn.datepicker.noConflict(),i.fn.datepicker||(i.fn.datepicker=i.fn.bdatepicker);var n=function(e){this.init("date",e,n.defaults),this.initPicker(e,n.defaults)};i.fn.editableutils.inherit(n,i.fn.editabletypes.abstractinput),i.extend(n.prototype,{initPicker:function(e,t){this.options.viewformat||(this.options.viewformat=this.options.format),e.datepicker=i.fn.editableutils.tryParseJson(e.datepicker,!0),this.options.datepicker=i.extend({},t.datepicker,e.datepicker,{format:this.options.viewformat}),this.options.datepicker.language=this.options.datepicker.language||"en",this.dpg=i.fn.bdatepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat)},render:function(){this.$input.bdatepicker(this.options.datepicker),this.options.clear&&(this.$clear=i('<a href="#"></a>').html(this.options.clear).click(i.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(i('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,t){var i=e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):"";n.superclass.value2html.call(this,i,t)},html2value:function(e){return this.parseDate(e,this.parsedViewFormat)},value2str:function(e){return e?this.dpg.formatDate(e,this.parsedFormat,this.options.datepicker.language):""},str2value:function(e){return this.parseDate(e,this.parsedFormat)},value2submit:function(e){return this.value2str(e)},value2input:function(e){this.$input.bdatepicker("update",e)},input2value:function(){return this.$input.data("datepicker").date},activate:function(){},clear:function(){this.$input.data("datepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".day",function(e){if(!i(e.currentTarget).is(".old")&&!i(e.currentTarget).is(".new")){var t=i(this).closest("form");setTimeout(function(){t.submit()},200)}})},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datepicker.language),"string"==typeof e&&e!==this.dpg.formatDate(i,t,this.options.datepicker.language)&&(i=null)),i}}),n.defaults=i.extend({},i.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!1},clear:"&times; clear"}),i.fn.editabletypes.date=n}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.date),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.bdatepicker(this.options.datepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.bdatepicker("update")},this))},value2input:function(e){this.$input.val(e?this.dpg.formatDate(e,this.parsedViewFormat,this.options.datepicker.language):""),this.$tpl.bdatepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:!0}}),e.fn.editabletypes.datefield=t}(window.jQuery),function(i){"use strict";var n=function(e){this.init("datetime",e,n.defaults),this.initPicker(e,n.defaults)};i.fn.editableutils.inherit(n,i.fn.editabletypes.abstractinput),i.extend(n.prototype,{initPicker:function(e,t){this.options.viewformat||(this.options.viewformat=this.options.format),e.datetimepicker=i.fn.editableutils.tryParseJson(e.datetimepicker,!0),this.options.datetimepicker=i.extend({},t.datetimepicker,e.datetimepicker,{format:this.options.viewformat}),this.options.datetimepicker.language=this.options.datetimepicker.language||"en",this.dpg=i.fn.datetimepicker.DPGlobal,this.parsedFormat=this.dpg.parseFormat(this.options.format,this.options.formatType),this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat,this.options.formatType)},render:function(){this.$input.datetimepicker(this.options.datetimepicker),this.$input.on("changeMode",function(e){var t=i(this).closest("form").parent();setTimeout(function(){t.triggerHandler("resize")},0)}),this.options.clear&&(this.$clear=i('<a href="#"></a>').html(this.options.clear).click(i.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.clear()},this)),this.$tpl.parent().append(i('<div class="editable-clear">').append(this.$clear)))},value2html:function(e,t){var i=e?this.dpg.formatDate(this.toUTC(e),this.parsedViewFormat,this.options.datetimepicker.language,this.options.formatType):"";if(!t)return i;n.superclass.value2html.call(this,i,t)},html2value:function(e){var t=this.parseDate(e,this.parsedViewFormat);return t?this.fromUTC(t):null},value2str:function(e){return e?this.dpg.formatDate(this.toUTC(e),this.parsedFormat,this.options.datetimepicker.language,this.options.formatType):""},str2value:function(e){var t=this.parseDate(e,this.parsedFormat);return t?this.fromUTC(t):null},value2submit:function(e){return this.value2str(e)},value2input:function(e){e&&this.$input.data("datetimepicker").setDate(e)},input2value:function(){var e=this.$input.data("datetimepicker");return e.date?e.getDate():null},activate:function(){},clear:function(){this.$input.data("datetimepicker").date=null,this.$input.find(".active").removeClass("active"),this.options.showbuttons||this.$input.closest("form").submit()},autosubmit:function(){this.$input.on("mouseup",".minute",function(e){var t=i(this).closest("form");setTimeout(function(){t.submit()},200)})},toUTC:function(e){return e?new Date(e.valueOf()-6e4*e.getTimezoneOffset()):e},fromUTC:function(e){return e?new Date(e.valueOf()+6e4*e.getTimezoneOffset()):e},parseDate:function(e,t){var i=null;return e&&(i=this.dpg.parseDate(e,t,this.options.datetimepicker.language,this.options.formatType),"string"==typeof e&&e!==this.dpg.formatDate(i,t,this.options.datetimepicker.language,this.options.formatType)&&(i=null)),i}}),n.defaults=i.extend({},i.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd hh:ii",formatType:"standard",viewformat:null,datetimepicker:{todayHighlight:!1,autoclose:!1},clear:"&times; clear"}),i.fn.editabletypes.datetime=n}(window.jQuery),function(e){"use strict";var t=function(e){this.init("datetimefield",e,t.defaults),this.initPicker(e,t.defaults)};e.fn.editableutils.inherit(t,e.fn.editabletypes.datetime),e.extend(t.prototype,{render:function(){this.$input=this.$tpl.find("input"),this.setClass(),this.setAttr("placeholder"),this.$tpl.datetimepicker(this.options.datetimepicker),this.$input.off("focus keydown"),this.$input.keyup(e.proxy(function(){this.$tpl.removeData("date"),this.$tpl.datetimepicker("update")},this))},value2input:function(e){this.$input.val(this.value2html(e)),this.$tpl.datetimepicker("update")},input2value:function(){return this.html2value(this.$input.val())},activate:function(){e.fn.editabletypes.text.prototype.activate.call(this)},autosubmit:function(){}}),t.defaults=e.extend({},e.fn.editabletypes.datetime.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-medium",datetimepicker:{todayHighlight:!1,autoclose:!0}}),e.fn.editabletypes.datetimefield=t}(window.jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(T,s){function D(){return new Date(Date.UTC.apply(Date,arguments))}"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){t===s&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var i=this.length;t<i;t++)if(t in this&&this[t]===e)return t;return-1});var y=function(e,o){var t=this;this.element=T(e),this.container=o.container||"body",this.language=o.language||this.element.data("date-language")||"en",this.language=this.language in R?this.language:this.language.split("-")[0],this.language=this.language in R?this.language:"en",this.isRTL=R[this.language].rtl||!1,this.formatType=o.formatType||this.element.data("format-type")||"standard",this.format=j.parseFormat(o.format||this.element.data("date-format")||R[this.language].format||j.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=o.fontAwesome||this.element.data("font-awesome")||!1,this.bootcssVer=o.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=!!this.element.is(".date")&&(3===this.bootcssVer?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-remove, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar, .add-on .fa-calendar, .add-on .fa-clock-o").parent()),this.componentReset=!!this.element.is(".date")&&(3===this.bootcssVer?this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent()),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.linkField=o.linkField||this.element.data("link-field")||!1,this.linkFormat=j.parseFormat(o.linkFormat||this.element.data("link-format")||j.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=o.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=o.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=o.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=o.initialDate||new Date,this.zIndex=o.zIndex||this.element.data("z-index")||s,this.title=void 0!==o.title&&o.title,this.timezone=o.timezone||function(){var e,t,i,n,r;if((i=(null!=(r=(t=(new Date).toString()).split("(")[1])?r.slice(0,-1):0)||t.split(" "))instanceof Array){n=[];for(var o=0,s=i.length;o<s;o++)(e=null!==(r=i[o].match(/\b[A-Z]+\b/)))&&r[0]&&n.push(e);i=n.pop()}return i}(),this.icons={leftArrow:this.fontAwesome?"fa-arrow-left":3===this.bootcssVer?"glyphicon-arrow-left":"icon-arrow-left",rightArrow:this.fontAwesome?"fa-arrow-right":3===this.bootcssVer?"glyphicon-arrow-right":"icon-arrow-right"},this.icontype=this.fontAwesome?"fa":"glyphicon",this._attachEvents(),this.clickedOutside=function(e){0===T(e.target).closest(".datetimepicker").length&&t.hide()},this.formatViewType="datetime","formatViewType"in o?this.formatViewType=o.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in o?this.minView=o.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=j.convertViewMode(this.minView),this.maxView=j.modes.length-1,"maxView"in o?this.maxView=o.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=j.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in o?this.wheelViewModeNavigation=o.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in o?this.wheelViewModeNavigationInverseDirection=o.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in o?this.wheelViewModeNavigationDelay=o.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in o?this.startViewMode=o.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=j.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in o?this.viewSelect=o.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=j.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in o?this.forceParse=o.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));for(var i=3===this.bootcssVer?j.templateV3:j.template;-1!==i.indexOf("{iconType}");)i=i.replace("{iconType}",this.icontype);for(;-1!==i.indexOf("{leftArrow}");)i=i.replace("{leftArrow}",this.icons.leftArrow);for(;-1!==i.indexOf("{rightArrow}");)i=i.replace("{rightArrow}",this.icons.rightArrow);if(this.picker=T(i).appendTo(this.isInline?this.element:this.container).on({click:T.proxy(this.click,this),mousedown:T.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(T.fn.mousewheel?this.picker.on({mousewheel:T.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu"),this.isRTL){this.picker.addClass("datetimepicker-rtl");var n=3===this.bootcssVer?".prev span, .next span":".prev i, .next i";this.picker.find(n).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}T(document).on("mousedown touchend",this.clickedOutside),this.autoclose=!1,"autoclose"in o?this.autoclose=o.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in o?this.keyboardNavigation=o.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=o.todayBtn||this.element.data("date-today-btn")||!1,this.clearBtn=o.clearBtn||this.element.data("date-clear-btn")||!1,this.todayHighlight=o.todayHighlight||this.element.data("date-today-highlight")||!1,void(this.weekStart=0)!==o.weekStart?this.weekStart=o.weekStart:void 0!==this.element.data("date-weekstart")?this.weekStart=this.element.data("date-weekstart"):void 0!==R[this.language].weekStart&&(this.weekStart=R[this.language].weekStart),this.weekStart=this.weekStart%7,this.weekEnd=(this.weekStart+6)%7,this.onRenderDay=function(e){var t=(o.onRenderDay||function(){return[]})(e);"string"==typeof t&&(t=[t]);return["day"].concat(t||[])},this.onRenderHour=function(e){var t=(o.onRenderHour||function(){return[]})(e);return"string"==typeof t&&(t=[t]),["hour"].concat(t||[])},this.onRenderMinute=function(e){var t=(o.onRenderMinute||function(){return[]})(e),i=["minute"];return"string"==typeof t&&(t=[t]),e<this.startDate||e>this.endDate?i.push("disabled"):Math.floor(this.date.getUTCMinutes()/this.minuteStep)===Math.floor(e.getUTCMinutes()/this.minuteStep)&&i.push("active"),i.concat(t||[])},this.onRenderYear=function(e){var t=(o.onRenderYear||function(){return[]})(e),i=["year"];"string"==typeof t&&(t=[t]),this.date.getUTCFullYear()===e.getUTCFullYear()&&i.push("active");var n=e.getUTCFullYear(),r=this.endDate.getUTCFullYear();return(e<this.startDate||r<n)&&i.push("disabled"),i.concat(t||[])},this.onRenderMonth=function(e){var t=(o.onRenderMonth||function(){return[]})(e);return"string"==typeof t&&(t=[t]),["month"].concat(t||[])},this.startDate=new Date(-8639968443048e3),this.endDate=new Date(8639968443048e3),this.datesDisabled=[],this.daysOfWeekDisabled=[],this.setStartDate(o.startDate||this.element.data("date-startdate")),this.setEndDate(o.endDate||this.element.data("date-enddate")),this.setDatesDisabled(o.datesDisabled||this.element.data("date-dates-disabled")),this.setDaysOfWeekDisabled(o.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(o.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(o.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};y.prototype={constructor:y,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{focus:T.proxy(this.show,this),keyup:T.proxy(this.update,this),keydown:T.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{focus:T.proxy(this.show,this),keyup:T.proxy(this.update,this),keydown:T.proxy(this.keydown,this)}],[this.component,{click:T.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:T.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:T.proxy(this.show,this)}]];for(var e,t,i=0;i<this._events.length;i++)e=this._events[i][0],t=this._events[i][1],e.on(t)},_detachEvents:function(){for(var e,t,i=0;i<this._events.length;i++)e=this._events[i][0],t=this._events[i][1],e.off(t);this._events=[]},show:function(e){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),T(window).on("resize",T.proxy(this.place,this)),e&&(e.stopPropagation(),e.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(){this.isVisible&&(this.isInline||(this.picker.hide(),T(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||T(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),T(document).off("mousedown",this.clickedOutside),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return null===e?null:new Date(e.getTime()+6e4*e.getTimezoneOffset())},getUTCDate:function(){return this.date},getInitialDate:function(){return this.initialDate},setInitialDate:function(e){this.initialDate=e},setDate:function(e){this.setUTCDate(new Date(e.getTime()-6e4*e.getTimezoneOffset()))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){var t;this.format=j.parseFormat(e,this.formatType),this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e):(this.component&&this.element.find("input").val(e),this.element.data("date",e)),this.linkField&&T("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return e=e||this.format,j.formatDate(this.date,e,this.language,this.formatType,this.timezone)},setStartDate:function(e){this.startDate=e||this.startDate,8639968443048e3!==this.startDate.valueOf()&&(this.startDate=j.parseDate(this.startDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||this.endDate,8639968443048e3!==this.endDate.valueOf()&&(this.endDate=j.parseDate(this.endDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setDatesDisabled:function(e){this.datesDisabled=e||[],T.isArray(this.datesDisabled)||(this.datesDisabled=this.datesDisabled.split(/,\s*/));var t=this;this.datesDisabled=T.map(this.datesDisabled,function(e){return j.parseDate(e,t.format,t.language,t.formatType,t.timezone).toDateString()}),this.update(),this.updateNavArrows()},setTitle:function(e,t){return this.picker.find(e).find("th:eq(1)").text(!1===this.title?t:this.title)},setDaysOfWeekDisabled:function(e){this.daysOfWeekDisabled=e||[],T.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=T.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(e){this.minutesDisabled=e||[],T.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=T.map(this.minutesDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(e){this.hoursDisabled=e||[],T.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=T.map(this.hoursDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){if(!this.zIndex){var t=0;T("div").each(function(){var e=parseInt(T(this).css("zIndex"),10);t<e&&(t=e)}),this.zIndex=t+10}var e,i,n,r;r=this.container instanceof T?this.container.offset():T(this.container).offset(),this.component?(n=(e=this.component.offset()).left,"bottom-left"!==this.pickerPosition&&"top-left"!==this.pickerPosition||(n+=this.component.outerWidth()-this.picker.outerWidth())):(n=(e=this.element.offset()).left,"bottom-left"!==this.pickerPosition&&"top-left"!==this.pickerPosition||(n+=this.element.outerWidth()-this.picker.outerWidth()));var o=document.body.clientWidth||window.innerWidth;o<n+220&&(n=o-220),i="top-left"===this.pickerPosition||"top-right"===this.pickerPosition?e.top-this.picker.outerHeight():e.top+this.height,i-=r.top,n-=r.left,this.picker.css({top:i,left:n,zIndex:this.zIndex})}},hour_minute:"^([0-9]|0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]",update:function(){var e,t=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],t=!0):"string"==typeof(e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate)&&(e=e.replace(/^\s+|\s+$/g,"")),e||(e=new Date,t=!1),"string"==typeof e&&(new RegExp(this.hour_minute).test(e)||new RegExp(this.hour_minute+":[0-5][0-9]").test(e))&&(e=this.getDate()),this.date=j.parseDate(e,this.format,this.language,this.formatType,this.timezone),t&&this.setValue(),this.date<this.startDate?this.viewDate=new Date(this.startDate):this.date>this.endDate?this.viewDate=new Date(this.endDate):this.viewDate=new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+R[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=new Date(this.viewDate),i=0;i<12;i++){t.setUTCMonth(i),e+='<span class="'+this.onRenderMonth(t).join(" ")+'">'+R[this.language].monthsShort[i]+"</span>"}this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(this.date&&this.viewDate){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth(),n=e.getUTCDate(),r=e.getUTCHours(),o=this.startDate.getUTCFullYear(),s=this.startDate.getUTCMonth(),a=this.endDate.getUTCFullYear(),l=this.endDate.getUTCMonth()+1,u=new D(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),c=new Date;if(this.setTitle(".datetimepicker-days",R[this.language].months[i]+" "+t),"time"===this.formatViewType){var d=this.getFormattedDate();this.setTitle(".datetimepicker-hours",d),this.setTitle(".datetimepicker-minutes",d)}else this.setTitle(".datetimepicker-hours",n+" "+R[this.language].months[i]+" "+t),this.setTitle(".datetimepicker-minutes",n+" "+R[this.language].months[i]+" "+t);this.picker.find("tfoot th.today").text(R[this.language].today||R.en.today).toggle(!1!==this.todayBtn),this.picker.find("tfoot th.clear").text(R[this.language].clear||R.en.clear).toggle(!1!==this.clearBtn),this.updateNavArrows(),this.fillMonths();var h=D(t,i-1,28,0,0,0,0),p=j.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(p),h.setUTCDate(p-(h.getUTCDay()-this.weekStart+7)%7);var f=new Date(h);f.setUTCDate(f.getUTCDate()+42),f=f.valueOf();for(var g,v=[];h.valueOf()<f;)h.getUTCDay()===this.weekStart&&v.push("<tr>"),g=this.onRenderDay(h),h.getUTCFullYear()<t||h.getUTCFullYear()===t&&h.getUTCMonth()<i?g.push("old"):(h.getUTCFullYear()>t||h.getUTCFullYear()===t&&h.getUTCMonth()>i)&&g.push("new"),this.todayHighlight&&h.getUTCFullYear()===c.getFullYear()&&h.getUTCMonth()===c.getMonth()&&h.getUTCDate()===c.getDate()&&g.push("today"),h.valueOf()===u&&g.push("active"),(h.valueOf()+864e5<=this.startDate||h.valueOf()>this.endDate||-1!==T.inArray(h.getUTCDay(),this.daysOfWeekDisabled)||-1!==T.inArray(h.toDateString(),this.datesDisabled))&&g.push("disabled"),v.push('<td class="'+g.join(" ")+'">'+h.getUTCDate()+"</td>"),h.getUTCDay()===this.weekEnd&&v.push("</tr>"),h.setUTCDate(h.getUTCDate()+1);this.picker.find(".datetimepicker-days tbody").empty().append(v.join("")),v=[];var m="",y="",b="",w=this.hoursDisabled||[];e=new Date(this.viewDate);for(var x=0;x<24;x++){e.setUTCHours(x),g=this.onRenderHour(e),-1!==w.indexOf(x)&&g.push("disabled");var k=D(t,i,n,x);k.valueOf()+36e5<=this.startDate||k.valueOf()>this.endDate?g.push("disabled"):r===x&&g.push("active"),this.showMeridian&&2===R[this.language].meridiem.length?((y=x<12?R[this.language].meridiem[0]:R[this.language].meridiem[1])!==b&&(""!==b&&v.push("</fieldset>"),v.push('<fieldset class="hour"><legend>'+y.toUpperCase()+"</legend>")),b=y,m=x%12?x%12:12,x<12?g.push("hour_am"):g.push("hour_pm"),v.push('<span class="'+g.join(" ")+'">'+m+"</span>"),23===x&&v.push("</fieldset>")):(m=x+":00",v.push('<span class="'+g.join(" ")+'">'+m+"</span>"))}this.picker.find(".datetimepicker-hours td").html(v.join("")),v=[],b=y=m="";var _=this.minutesDisabled||[];e=new Date(this.viewDate);for(x=0;x<60;x+=this.minuteStep)-1===_.indexOf(x)&&(e.setUTCMinutes(x),e.setUTCSeconds(0),g=this.onRenderMinute(e),this.showMeridian&&2===R[this.language].meridiem.length?((y=r<12?R[this.language].meridiem[0]:R[this.language].meridiem[1])!==b&&(""!==b&&v.push("</fieldset>"),v.push('<fieldset class="minute"><legend>'+y.toUpperCase()+"</legend>")),b=y,m=r%12?r%12:12,v.push('<span class="'+g.join(" ")+'">'+m+":"+(x<10?"0"+x:x)+"</span>"),59===x&&v.push("</fieldset>")):(m=x+":00",v.push('<span class="'+g.join(" ")+'">'+r+":"+(x<10?"0"+x:x)+"</span>")));this.picker.find(".datetimepicker-minutes td").html(v.join(""));var F=this.date.getUTCFullYear(),C=this.setTitle(".datetimepicker-months",t).end().find(".month").removeClass("active");F===t&&C.eq(this.date.getUTCMonth()).addClass("active"),(t<o||a<t)&&C.addClass("disabled"),t===o&&C.slice(0,s).addClass("disabled"),t===a&&C.slice(l).addClass("disabled"),v="",t=10*parseInt(t/10,10);var E=this.setTitle(".datetimepicker-years",t+"-"+(t+9)).end().find("td");t-=1,e=new Date(this.viewDate);for(x=-1;x<11;x++)e.setUTCFullYear(t),g=this.onRenderYear(e),-1!==x&&10!==x||g.push(S),v+='<span class="'+g.join(" ")+'">'+t+"</span>",t+=1;E.html(v),this.place()}},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth(),n=e.getUTCDate(),r=e.getUTCHours();switch(this.viewMode){case 0:t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&n<=this.startDate.getUTCDate()&&r<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&n>=this.endDate.getUTCDate()&&r>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&n<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&n>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(e){if(e.preventDefault(),e.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var t=e.originalEvent.wheelDelta,i=0<t?1:0===t?0:-1;this.wheelViewModeNavigationInverseDirection&&(i=-i),this.showMode(i),setTimeout(T.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(e){e.stopPropagation(),e.preventDefault();var t=T(e.target).closest("span, td, th, legend");if(t.is("."+this.icontype)&&(t=T(t).parent().closest("span, td, th, legend")),1===t.length){if(t.is(".disabled"))return void this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate});switch(t[0].nodeName.toLowerCase()){case"th":switch(t[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var i=j.modes[this.viewMode].navStep*("prev"===t[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,i);break;case 1:this.viewDate=this.moveDate(this.viewDate,i);break;case 2:this.viewDate=this.moveMonth(this.viewDate,i);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,i)}this.fill(),this.element.trigger({type:t[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"clear":this.reset(),this.autoclose&&this.hide();break;case"today":var n=new Date;(n=D(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),0))<this.startDate?n=this.startDate:n>this.endDate&&(n=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(n),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!t.is(".disabled")){var r=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth(),s=this.viewDate.getUTCDate(),a=this.viewDate.getUTCHours(),l=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();if(t.is(".month")?(this.viewDate.setUTCDate(1),o=t.parent().find("span").index(t),s=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(o),this.element.trigger({type:"changeMonth",date:this.viewDate}),3<=this.viewSelect&&this._setDate(D(r,o,s,a,l,u,0))):t.is(".year")?(this.viewDate.setUTCDate(1),r=parseInt(t.text(),10)||0,this.viewDate.setUTCFullYear(r),this.element.trigger({type:"changeYear",date:this.viewDate}),4<=this.viewSelect&&this._setDate(D(r,o,s,a,l,u,0))):t.is(".hour")?(a=parseInt(t.text(),10)||0,(t.hasClass("hour_am")||t.hasClass("hour_pm"))&&(12===a&&t.hasClass("hour_am")?a=0:12!==a&&t.hasClass("hour_pm")&&(a+=12)),this.viewDate.setUTCHours(a),this.element.trigger({type:"changeHour",date:this.viewDate}),1<=this.viewSelect&&this._setDate(D(r,o,s,a,l,u,0))):t.is(".minute")&&(l=parseInt(t.text().substr(t.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(l),this.element.trigger({type:"changeMinute",date:this.viewDate}),0<=this.viewSelect&&this._setDate(D(r,o,s,a,l,u,0))),0!==this.viewMode){var c=this.viewMode;this.showMode(-1),this.fill(),c===this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(t.is(".day")&&!t.is(".disabled")){s=parseInt(t.text(),10)||1,r=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth(),a=this.viewDate.getUTCHours(),l=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();t.is(".old")?0===o?(o=11,r-=1):o-=1:t.is(".new")&&(11===o?(o=0,r+=1):o+=1),this.viewDate.setUTCFullYear(r),this.viewDate.setUTCMonth(o,s),this.element.trigger({type:"changeDay",date:this.viewDate}),2<=this.viewSelect&&this._setDate(D(r,o,s,a,l,u,0))}c=this.viewMode;this.showMode(-1),this.fill(),c===this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(e,t){var i;t&&"date"!==t||(this.date=e),t&&"view"!==t||(this.viewDate=e),this.fill(),this.setValue(),this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&i.change(),this.element.trigger({type:"changeDate",date:this.getDate()}),null===e&&(this.date=this.viewDate)},moveMinute:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCMinutes(i.getUTCMinutes()+t*this.minuteStep),i},moveHour:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCHours(i.getUTCHours()+t),i},moveDate:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCDate(i.getUTCDate()+t),i},moveMonth:function(e,t){if(!t)return e;var i,n,r=new Date(e.valueOf()),o=r.getUTCDate(),s=r.getUTCMonth(),a=Math.abs(t);if(t=0<t?1:-1,1===a)n=-1===t?function(){return r.getUTCMonth()===s}:function(){return r.getUTCMonth()!==i},i=s+t,r.setUTCMonth(i),(i<0||11<i)&&(i=(i+12)%12);else{for(var l=0;l<a;l++)r=this.moveMonth(r,t);i=r.getUTCMonth(),r.setUTCDate(o),n=function(){return i!==r.getUTCMonth()}}for(;n();)r.setUTCDate(--o),r.setUTCMonth(i);return r},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))27===e.keyCode&&this.show();else{var t,i,n,r,o=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;t=37===e.keyCode?-1:1;var s=this.viewMode;e.ctrlKey?s+=2:e.shiftKey&&(s+=1),4===s?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):3===s?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):2===s?(i=this.moveDate(this.date,t),n=this.moveDate(this.viewDate,t)):1===s?(i=this.moveHour(this.date,t),n=this.moveHour(this.viewDate,t)):0===s&&(i=this.moveMinute(this.date,t),n=this.moveMinute(this.viewDate,t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;t=38===e.keyCode?-1:1,s=this.viewMode,e.ctrlKey?s+=2:e.shiftKey&&(s+=1),4===s?(i=this.moveYear(this.date,t),n=this.moveYear(this.viewDate,t)):3===s?(i=this.moveMonth(this.date,t),n=this.moveMonth(this.viewDate,t)):2===s?(i=this.moveDate(this.date,7*t),n=this.moveDate(this.viewDate,7*t)):1===s?n=this.showMeridian?(i=this.moveHour(this.date,6*t),this.moveHour(this.viewDate,6*t)):(i=this.moveHour(this.date,4*t),this.moveHour(this.viewDate,4*t)):0===s&&(i=this.moveMinute(this.date,4*t),n=this.moveMinute(this.viewDate,4*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=n,this.setValue(),this.update(),e.preventDefault(),o=!0);break;case 13:if(0!==this.viewMode){var a=this.viewMode;this.showMode(-1),this.fill(),a===this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(o)this.isInput?r=this.element:this.component&&(r=this.element.find("input")),r&&r.change(),this.element.trigger({type:"changeDate",date:this.getDate()})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(j.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+j.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var S=T.fn.datetimepicker;T.fn.datetimepicker=function(n){var r,o=Array.apply(null,arguments);return o.shift(),this.each(function(){var e=T(this),t=e.data("datetimepicker"),i="object"==typeof n&&n;if(t||e.data("datetimepicker",t=new y(this,T.extend({},T.fn.datetimepicker.defaults,i))),"string"==typeof n&&"function"==typeof t[n]&&(r=t[n].apply(t,o))!==s)return!1}),r!==s?r:this},T.fn.datetimepicker.defaults={},T.fn.datetimepicker.Constructor=y;var R=T.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today",clear:"Clear"}},j={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,j.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if("standard"===e)return"input"===t?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"===e)return"input"===t?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if("standard"===e)return/t|hh?|HH?|p|P|z|Z|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"===e)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var i=e.replace(this.validParts(t),"\0").split("\0"),n=e.match(this.validParts(t));if(!i||!i.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:i,parts:n}},parseDate:function(e,t,i,n,r){if(e instanceof Date){var o=new Date(e.valueOf()-6e4*e.getTimezoneOffset());return o.setMilliseconds(0),o}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(e)&&(t=this.parseFormat("yyyy-mm-dd",n)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(e)&&(t=this.parseFormat("yyyy-mm-dd hh:ii",n)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(e)&&(t=this.parseFormat("yyyy-mm-dd hh:ii:ss",n)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(e)){var s,a=/([-+]\d+)([dmwy])/,l=e.match(/([-+]\d+)([dmwy])/g);e=new Date;for(var u=0;u<l.length;u++)switch(h=a.exec(l[u]),s=parseInt(h[1]),h[2]){case"d":e.setUTCDate(e.getUTCDate()+s);break;case"m":e=y.prototype.moveMonth.call(y.prototype,e,s);break;case"w":e.setUTCDate(e.getUTCDate()+7*s);break;case"y":e=y.prototype.moveYear.call(y.prototype,e,s)}return D(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),0)}l=e&&e.toString().match(this.nonpunctuation)||[],e=new Date(0,0,0,0,0,0,0);var c,d,h,p={},f=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P","z","Z"],g={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(12===t?0:t)},H:function(e,t){return e.setUTCHours(12===t?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(1===t?e.getUTCHours()+12:e.getUTCHours())},z:function(){return r}};if(g.M=g.MM=g.mm=g.m,g.dd=g.d,g.P=g.p,g.Z=g.z,e=D(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()),l.length===t.parts.length){u=0;for(var v=t.parts.length;u<v;u++){if(c=parseInt(l[u],10),h=t.parts[u],isNaN(c))switch(h){case"MM":d=T(R[i].months).filter(function(){var e=this.slice(0,l[u].length);return e===l[u].slice(0,e.length)}),c=T.inArray(d[0],R[i].months)+1;break;case"M":d=T(R[i].monthsShort).filter(function(){var e=this.slice(0,l[u].length),t=l[u].slice(0,e.length);return e.toLowerCase()===t.toLowerCase()}),c=T.inArray(d[0],R[i].monthsShort)+1;break;case"p":case"P":c=T.inArray(l[u].toLowerCase(),R[i].meridiem)}p[h]=c}var m;for(u=0;u<f.length;u++)(m=f[u])in p&&!isNaN(p[m])&&g[m](e,p[m])}return e},formatDate:function(e,t,i,n,r){if(null===e)return"";var o;if("standard"===n)o={t:e.getTime(),yy:e.getUTCFullYear().toString().substring(2),yyyy:e.getUTCFullYear(),m:e.getUTCMonth()+1,M:R[i].monthsShort[e.getUTCMonth()],MM:R[i].months[e.getUTCMonth()],d:e.getUTCDate(),D:R[i].daysShort[e.getUTCDay()],DD:R[i].days[e.getUTCDay()],p:2===R[i].meridiem.length?R[i].meridiem[e.getUTCHours()<12?0:1]:"",h:e.getUTCHours(),i:e.getUTCMinutes(),s:e.getUTCSeconds(),z:r},2===R[i].meridiem.length?o.H=o.h%12==0?12:o.h%12:o.H=o.h,o.HH=(o.H<10?"0":"")+o.H,o.P=o.p.toUpperCase(),o.Z=o.z,o.hh=(o.h<10?"0":"")+o.h,o.ii=(o.i<10?"0":"")+o.i,o.ss=(o.s<10?"0":"")+o.s,o.dd=(o.d<10?"0":"")+o.d,o.mm=(o.m<10?"0":"")+o.m;else{if("php"!==n)throw new Error("Invalid format type.");(o={y:e.getUTCFullYear().toString().substring(2),Y:e.getUTCFullYear(),F:R[i].months[e.getUTCMonth()],M:R[i].monthsShort[e.getUTCMonth()],n:e.getUTCMonth()+1,t:j.getDaysInMonth(e.getUTCFullYear(),e.getUTCMonth()),j:e.getUTCDate(),l:R[i].days[e.getUTCDay()],D:R[i].daysShort[e.getUTCDay()],w:e.getUTCDay(),N:0===e.getUTCDay()?7:e.getUTCDay(),S:e.getUTCDate()%10<=R[i].suffix.length?R[i].suffix[e.getUTCDate()%10-1]:"",a:2===R[i].meridiem.length?R[i].meridiem[e.getUTCHours()<12?0:1]:"",g:e.getUTCHours()%12==0?12:e.getUTCHours()%12,G:e.getUTCHours(),i:e.getUTCMinutes(),s:e.getUTCSeconds()}).m=(o.n<10?"0":"")+o.n,o.d=(o.j<10?"0":"")+o.j,o.A=o.a.toString().toUpperCase(),o.h=(o.g<10?"0":"")+o.g,o.H=(o.G<10?"0":"")+o.G,o.i=(o.i<10?"0":"")+o.i,o.s=(o.s<10?"0":"")+o.s}e=[];for(var s=T.extend([],t.separators),a=0,l=t.parts.length;a<l;a++)s.length&&e.push(s.shift()),e.push(o[t.parts[a]]);return s.length&&e.push(s.shift()),e.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="{iconType} {leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{iconType} {rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};j.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+j.headTemplate+"<tbody></tbody>"+j.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+"</table></div></div>",j.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+j.headTemplateV3+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-hours"><table class=" table-condensed">'+j.headTemplateV3+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-days"><table class=" table-condensed">'+j.headTemplateV3+"<tbody></tbody>"+j.footTemplate+'</table></div><div class="datetimepicker-months"><table class="table-condensed">'+j.headTemplateV3+j.contTemplate+j.footTemplate+'</table></div><div class="datetimepicker-years"><table class="table-condensed">'+j.headTemplateV3+j.contTemplate+j.footTemplate+"</table></div></div>",T.fn.datetimepicker.DPGlobal=j,T.fn.datetimepicker.noConflict=function(){return T.fn.datetimepicker=S,this},T(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(e){var t=T(this);t.data("datetimepicker")||(e.preventDefault(),t.datetimepicker("show"))}),T(function(){T('[data-provide="datetimepicker-inline"]').datetimepicker()})}),function(l){"use strict";var r=function(e,t){this.$element=l(e),this.options=l.extend({},this.defaults(),t),this.render()};r.VERSION="2.2.0",r.DEFAULTS={on:"On",off:"Off",onstyle:"primary",offstyle:"default",size:"normal",style:"",width:null,height:null},r.prototype.defaults=function(){return{on:this.$element.attr("data-on")||r.DEFAULTS.on,off:this.$element.attr("data-off")||r.DEFAULTS.off,onstyle:this.$element.attr("data-onstyle")||r.DEFAULTS.onstyle,offstyle:this.$element.attr("data-offstyle")||r.DEFAULTS.offstyle,size:this.$element.attr("data-size")||r.DEFAULTS.size,style:this.$element.attr("data-style")||r.DEFAULTS.style,width:this.$element.attr("data-width")||r.DEFAULTS.width,height:this.$element.attr("data-height")||r.DEFAULTS.height}},r.prototype.render=function(){this._onstyle="btn-"+this.options.onstyle,this._offstyle="btn-"+this.options.offstyle;var e="large"===this.options.size?"btn-lg":"small"===this.options.size?"btn-sm":"mini"===this.options.size?"btn-xs":"",t=l('<label class="btn">').html(this.options.on).addClass(this._onstyle+" "+e),i=l('<label class="btn">').html(this.options.off).addClass(this._offstyle+" "+e+" active"),n=l('<span class="toggle-handle btn btn-default">').addClass(e),r=l('<div class="toggle-group">').append(t,i,n),o=l('<div class="toggle btn" data-toggle="toggle">').addClass(this.$element.prop("checked")?this._onstyle:this._offstyle+" off").addClass(e).addClass(this.options.style);this.$element.wrap(o),l.extend(this,{$toggle:this.$element.parent(),$toggleOn:t,$toggleOff:i,$toggleGroup:r}),this.$toggle.append(r);var s=this.options.width||Math.max(t.outerWidth(),i.outerWidth())+n.outerWidth()/2,a=this.options.height||Math.max(t.outerHeight(),i.outerHeight());t.addClass("toggle-on"),i.addClass("toggle-off"),this.$toggle.css({width:s,height:a}),this.options.height&&(t.css("line-height",t.height()+"px"),i.css("line-height",i.height()+"px")),this.update(!0),this.trigger(!0)},r.prototype.toggle=function(){this.$element.prop("checked")?this.off():this.on()},r.prototype.on=function(e){return!this.$element.prop("disabled")&&(this.$toggle.removeClass(this._offstyle+" off").addClass(this._onstyle),this.$element.prop("checked",!0),void(e||this.trigger()))},r.prototype.off=function(e){return!this.$element.prop("disabled")&&(this.$toggle.removeClass(this._onstyle).addClass(this._offstyle+" off"),this.$element.prop("checked",!1),void(e||this.trigger()))},r.prototype.enable=function(){this.$toggle.removeAttr("disabled"),this.$element.prop("disabled",!1)},r.prototype.disable=function(){this.$toggle.attr("disabled","disabled"),this.$element.prop("disabled",!0)},r.prototype.update=function(e){this.$element.prop("disabled")?this.disable():this.enable(),this.$element.prop("checked")?this.on(e):this.off(e)},r.prototype.trigger=function(e){this.$element.off("change.bs.toggle"),e||this.$element.change(),this.$element.on("change.bs.toggle",l.proxy(function(){this.update()},this))},r.prototype.destroy=function(){this.$element.off("change.bs.toggle"),this.$toggleGroup.remove(),this.$element.removeData("bs.toggle"),this.$element.unwrap()};var e=l.fn.bootstrapToggle;l.fn.bootstrapToggle=function(n){return this.each(function(){var e=l(this),t=e.data("bs.toggle"),i="object"==typeof n&&n;t||e.data("bs.toggle",t=new r(this,i)),"string"==typeof n&&t[n]&&t[n]()})},l.fn.bootstrapToggle.Constructor=r,l.fn.toggle.noConflict=function(){return l.fn.bootstrapToggle=e,this},l(function(){l("input[type=checkbox][data-toggle^=toggle]").bootstrapToggle()}),l(document).on("click.bs.toggle","div[data-toggle^=toggle]",function(e){l(this).find("input[type=checkbox]").bootstrapToggle("toggle"),e.preventDefault()})}(jQuery),function(a){a.editors.List=a.editors.Base.extend({events:{'click [data-action="add"]:last':function(e){e.preventDefault(),this.addItem(null,!0)}},initialize:function(e){e=e||{};var t=a.editors;t.Base.prototype.initialize.call(this,e);var i,n=this.schema;if(!n)throw new Error("Missing required option 'schema'");this.template=e.template||this.constructor.template,this.Editor=(i=n.itemType)?t.List[i]?t.List[i]:t[i]:t.Text,this.items=[]},render:function(){var t=this,e=this.value||[],i=Backbone.$,n=i(i.trim(this.template()));return this.$list=n.is("[data-items]")?n:n.find("[data-items]"),e.length?_.each(e,function(e){t.addItem(e)}):this.Editor.isAsync||this.addItem(),t.schema.maxCardinality&&t.items.length>=t.schema.maxCardinality&&n.find('button[data-action="add"]:last').hide(),this.setElement(n),this.$el.attr("id",this.id),this.$el.attr("name",this.key),this.hasFocus&&this.trigger("blur",this),this},addItem:function(e,t){var i=this,n=a.editors,r=new n.List.Item({list:this,form:this.form,schema:this.schema,value:e,Editor:this.Editor,key:this.key}).render(),o=function(){i.items.push(r),i.$list.append(r.el),i.schema.maxCardinality&&i.items.length>=i.schema.maxCardinality&&i.$el.find('button[data-action="add"]:last').hide(),r.editor.on("all",function(e){if("change"!==e){var t=_.toArray(arguments);t[0]="item:"+e,t.splice(1,0,i),n.List.prototype.trigger.apply(this,t)}},i),r.editor.on("change",function(){r.addEventTriggered||(r.addEventTriggered=!0,this.trigger("add",this,r.editor)),this.trigger("item:change",this,r.editor),this.trigger("change",this)},i),r.editor.on("focus",function(){this.hasFocus||this.trigger("focus",this)},i),r.editor.on("blur",function(){if(this.hasFocus){var e=this;setTimeout(function(){_.find(e.items,function(e){return e.editor.hasFocus})||e.trigger("blur",e)},0)}},i),(t||e)&&(r.addEventTriggered=!0),t&&(i.trigger("add",i,r.editor),i.trigger("change",i))};return this.Editor.isAsync?r.editor.on("readyToAdd",o,this):(o(),r.editor.focus()),r},removeItem:function(e){var t=this.schema.confirmDelete;if(!t||confirm(t)){var i=_.indexOf(this.items,e);this.items[i].remove(),this.items.splice(i,1),e.addEventTriggered&&(this.trigger("remove",this,e.editor),this.trigger("change",this)),this.items.length||this.Editor.isAsync||this.addItem(),this.schema.maxCardinality&&this.items.length<this.schema.maxCardinality&&this.$el.find('button[data-action="add"]:last').show()}},getValue:function(){var e=_.map(this.items,function(e){return e.getValue()});return _.without(e,void 0,"")},setValue:function(e){this.value=e,this.render()},focus:function(){this.hasFocus||this.items[0]&&this.items[0].editor.focus()},blur:function(){if(this.hasFocus){var e=_.find(this.items,function(e){return e.editor.hasFocus});e&&e.editor.blur()}},remove:function(){_.invoke(this.items,"remove"),a.editors.Base.prototype.remove.call(this)},validate:function(){if(!this.validators)return null;var e=_.map(this.items,function(e){return e.validate()});return!_.compact(e).length?null:{type:"list",message:"Some of the items in the list failed validation",errors:e}}},{template:_.template('      <div>        <div data-items></div>        <button type="button" data-action="add">Add</button>      </div>    ',null,a.templateSettings)}),a.editors.List.Item=a.editors.Base.extend({events:{'click [data-action="remove"]:last':function(e){e.preventDefault(),this.list.removeItem(this)},"keydown input[type=text]":function(e){13===e.keyCode&&e.preventDefault()}},initialize:function(e){this.list=e.list,this.schema=e.schema||this.list.schema,this.value=e.value,this.Editor=e.Editor||a.editors.Text,this.key=e.key,this.template=e.template||this.schema.itemTemplate||this.constructor.template,this.errorClassName=e.errorClassName||this.constructor.errorClassName,this.form=e.form},render:function(){var e=Backbone.$;this.editor=new this.Editor({key:this.key,schema:this.schema,value:this.value,list:this.list,item:this,form:this.form}).render();var t=e(e.trim(this.template()));return t.find("[data-editor]").append(this.editor.el),this.setElement(t),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.editor.focus()},blur:function(){this.editor.blur()},remove:function(){this.editor.remove(),Backbone.View.prototype.remove.call(this)},validate:function(){var t=this.getValue(),i=this.list.form?this.list.form.getValue():{},e=this.schema.validators,n=this.getValidator;if(!e)return null;var r=null;return _.every(e,function(e){return!(r=n(e)(t,i))}),r?this.setError(r):this.clearError(),r||null},setError:function(e){this.$el.addClass(this.errorClassName),this.$el.attr("title",e.message)},clearError:function(){this.$el.removeClass(this.errorClassName),this.$el.attr("title",null)}},{template:_.template('      <div>        <span data-editor></span>        <button type="button" data-action="remove">&times;</button>      </div>    ',null,a.templateSettings),errorClassName:"error"}),a.editors.List.Modal=a.editors.Base.extend({events:{click:"openEditor"},initialize:function(e){if(e=e||{},a.editors.Base.prototype.initialize.call(this,e),!a.editors.List.Modal.ModalAdapter)throw new Error("A ModalAdapter is required");if(this.form=e.form,!e.form)throw new Error('Missing required option: "form"');this.template=e.template||this.constructor.template},render:function(){var e=this;return _.isEmpty(this.value)?this.openEditor():(this.renderSummary(),setTimeout(function(){e.trigger("readyToAdd")},0)),this.hasFocus&&this.trigger("blur",this),this},renderSummary:function(){this.$el.html($.trim(this.template({summary:this.getStringValue()})))},itemToString:function(o){o=o||{};var s=[];return _.each(this.nestedSchema,function(e,t){var i,n=e.title?e.title:(i={key:t},a.Field.prototype.createTitle.call(i)),r=o[t];(_.isUndefined(r)||_.isNull(r))&&(r=""),s.push(n+": "+r)}),s.join("<br />")},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?"[Empty]":e.itemToString?e.itemToString(t):this.itemToString(t)},openEditor:function(){var e=this.form.constructor,t=this.modalForm=new e({schema:this.nestedSchema,data:this.value}),i=this.modal=new a.editors.List.Modal.ModalAdapter({content:t,animate:!0});i.open(),this.trigger("open",this),this.trigger("focus",this),i.on("cancel",this.onModalClosed,this),i.on("ok",_.bind(this.onModalSubmitted,this))},onModalSubmitted:function(){var e=this.modal,t=this.modalForm,i=!this.value;if(t.validate())return e.preventClose();this.value=t.getValue(),this.renderSummary(),i&&this.trigger("readyToAdd"),this.trigger("change",this),this.onModalClosed()},onModalClosed:function(){this.modal=null,this.modalForm=null,this.trigger("close",this),this.trigger("blur",this)},getValue:function(){return this.value},setValue:function(e){this.value=e},focus:function(){this.hasFocus||this.openEditor()},blur:function(){this.hasFocus&&this.modal&&this.modal.trigger("cancel")}},{template:_.template("      <div><%= summary %></div>    ",null,a.templateSettings),ModalAdapter:Backbone.BootstrapModal,isAsync:!0}),a.editors.List.Object=a.editors.List.Modal.extend({initialize:function(){a.editors.List.Modal.prototype.initialize.apply(this,arguments);var e=this.schema;if(!e.subSchema)throw new Error('Missing required option "schema.subSchema"');this.nestedSchema=e.subSchema}}),a.editors.List.NestedModel=a.editors.List.Modal.extend({initialize:function(){a.editors.List.Modal.prototype.initialize.apply(this,arguments);var e=this.schema;if(!e.model)throw new Error('Missing required option "schema.model"');var t=e.model.prototype.schema;this.nestedSchema=_.isFunction(t)?t():t},getStringValue:function(){var e=this.schema,t=this.getValue();return _.isEmpty(t)?null:e.itemToString?e.itemToString(t):new e.model(t).toString()}})}(Backbone.Form),function(e){e.template=_.template('    <form class="form-horizontal" role="form">      <div data-fieldsets></div>      <% if (submitButton) { %>        <button type="submit" class="btn"><%= submitButton %></button>      <% } %>    </form>  '),e.Fieldset.template=_.template("    <fieldset data-fields>      <% if (legend) { %>        <legend><%= legend %></legend>      <% } %>    </fieldset>  "),e.Field.template=_.template('    <div class="form-group field-<%= key %>">      <label class="col-sm-2 control-label" for="<%= editorId %>">        <% if (titleHTML){ %><%= titleHTML %>        <% } else { %><%- title %><% } %>      </label>      <div class="col-sm-10">        <span data-editor></span>        <p class="help-block" data-error></p>        <p class="help-block"><%= help %></p>      </div>    </div>  '),e.NestedField.template=_.template('    <div class="field-<%= key %>">      <div title="<% if (titleHTML){ %><%= titleHTML %><% } else { %><%- title %><% } %>" class="input-xlarge">        <span data-editor></span>        <div class="help-inline" data-error></div>      </div>      <div class="help-block"><%= help %></div>    </div>  '),e.editors.Base.prototype.className="form-control",e.Field.errorClassName="has-error",e.editors.List&&(e.editors.List.template=_.template('      <div class="bbf-list">        <div class="bbf-list-contents">          <ul class="list-unstyled clearfix" data-items></ul>        </div>        <div class="bbf-list-buttons">          <button type="button" class="btn btn-default bbf-add" data-action="add"><span class="glyphicon glyphicon-plus"></span> add value</button>        </div>      </div>    '),e.editors.List.Item.template=_.template('      <li class="clearfix">        <div class="input-group">          <div data-editor></div>          <span class="input-group-btn">            <button type="button" class="btn btn-default bbf-del" data-action="remove">&times;</button>          </span>        </div>      </li>    '),e.editors.List.Object.template=e.editors.List.NestedModel.template=_.template('      <div class="bbf-list-modal"><%= summary %></div>    '))}(Backbone.Form),function(e,t){if("function"==typeof define&&define.amd)define([],t);else if("undefined"!=typeof exports)t();else{t(),e.bootstrapTable={}}}(this,function(){"use strict";var o=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}(),q=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function d(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(V){var e=3;try{var t=V.fn.dropdown.Constructor.VERSION;void 0!==t&&(e=parseInt(t,10))}catch(e){}var F={3:{iconsPrefix:"glyphicon",icons:{paginationSwitchDown:"glyphicon-collapse-down icon-chevron-down",paginationSwitchUp:"glyphicon-collapse-up icon-chevron-up",refresh:"glyphicon-refresh icon-refresh",toggleOff:"glyphicon-list-alt icon-list-alt",toggleOn:"glyphicon-list-alt icon-list-alt",columns:"glyphicon-th icon-th",detailOpen:"glyphicon-plus icon-plus",detailClose:"glyphicon-minus icon-minus",fullscreen:"glyphicon-fullscreen"},classes:{buttons:"default",pull:"pull"},html:{toobarDropdow:['<ul class="dropdown-menu" role="menu">',"</ul>"],toobarDropdowItem:'<li role="menuitem"><label>%s</label></li>',pageDropdown:['<ul class="dropdown-menu" role="menu">',"</ul>"],pageDropdownItem:'<li role="menuitem" class="%s"><a href="#">%s</a></li>'}},4:{iconsPrefix:"fa",icons:{paginationSwitchDown:"fa-caret-square-down",paginationSwitchUp:"fa-caret-square-up",refresh:"fa-sync",toggleOff:"fa-toggle-off",toggleOn:"fa-toggle-on",columns:"fa-th-list",detailOpen:"fa-plus",detailClose:"fa-minus",fullscreen:"fa-arrows-alt"},classes:{buttons:"secondary",pull:"float"},html:{toobarDropdow:['<div class="dropdown-menu dropdown-menu-right">',"</div>"],toobarDropdowItem:'<label class="dropdown-item">%s</label>',pageDropdown:['<div class="dropdown-menu">',"</div>"],pageDropdownItem:'<a class="dropdown-item %s" href="#">%s</a>'}}}[e],z={bootstrapVersion:e,sprintf:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=!0,o=0,s=e.replace(/%s/g,function(){var e=i[o++];return void 0===e?(r=!1,""):e});return r?s:""},getFieldTitle:function(e,t){var i=!0,n=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;if(a.field===t)return a.title}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}return""},setFieldIndex:function(e){var t=0,i=[],n=!0,r=!1,o=void 0;try{for(var s,a=e[0][Symbol.iterator]();!(n=(s=a.next()).done);n=!0){t+=s.value.colspan||1}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}for(var l=0;l<e.length;l++){i[l]=[];for(var u=0;u<t;u++)i[l][u]=!1}for(var c=0;c<e.length;c++){var d=!0,h=!1,p=void 0;try{for(var f,g=e[c][Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var v=f.value,m=v.rowspan||1,y=v.colspan||1,b=i[c].indexOf(!1);1===y&&(v.fieldIndex=b,void 0===v.field&&(v.field=b));for(var w=0;w<m;w++)i[c+w][b]=!0;for(var x=0;x<y;x++)i[c][b+x]=!0}}catch(e){h=!0,p=e}finally{try{!d&&g.return&&g.return()}finally{if(h)throw p}}}},getScrollBarWidth:function(){if(void 0===this.cachedWidth){var e=V("<div/>").addClass("fixed-table-scroll-inner"),t=V("<div/>").addClass("fixed-table-scroll-outer");t.append(e),V("body").append(t);var i=e[0].offsetWidth;t.css("overflow","scroll");var n=e[0].offsetWidth;i===n&&(n=t[0].clientWidth),t.remove(),this.cachedWidth=i-n}return this.cachedWidth},calculateObjectValue:function(e,t,i,n){var r=t;if("string"==typeof t){var o=t.split(".");if(1<o.length){r=window;var s=!0,a=!1,l=void 0;try{for(var u,c=o[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){r=r[u.value]}}catch(e){a=!0,l=e}finally{try{!s&&c.return&&c.return()}finally{if(a)throw l}}}else r=window[t]}return null!==r&&"object"===(void 0===r?"undefined":h(r))?r:"function"==typeof r?r.apply(e,i||[]):!r&&"string"==typeof t&&this.sprintf.apply(this,[t].concat(d(i)))?this.sprintf.apply(this,[t].concat(d(i))):n},compareObjects:function(e,t,i){var n=Object.keys(e),r=Object.keys(t);if(i&&n.length!==r.length)return!1;var o=!0,s=!1,a=void 0;try{for(var l,u=n[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;if(r.includes(c)&&e[c]!==t[c])return!1}}catch(e){s=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}return!0},escapeHTML:function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/`/g,"&#x60;"):e},getRealDataAttr:function(e){var t=!0,i=!1,n=void 0;try{for(var r,o=Object.entries(e)[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,a=q(s,2),l=a[0],u=a[1],c=l.split(/(?=[A-Z])/).join("-").toLowerCase();c!==l&&(e[c]=u,delete e[l])}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}return e},getItemField:function(e,t,i){var n=e;if("string"!=typeof t||e.hasOwnProperty(t))return i?this.escapeHTML(e[t]):e[t];var r=t.split("."),o=!0,s=!1,a=void 0;try{for(var l,u=r[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value;n=n&&n[c]}}catch(e){s=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}return i?this.escapeHTML(n):n},isIEBrowser:function(){return navigator.userAgent.includes("MSIE ")||/Trident.*rv:11\./.test(navigator.userAgent)},findIndex:function(e,t){var i=!0,n=!1,r=void 0;try{for(var o,s=e.entries()[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value,l=q(a,2),u=l[0],c=l[1];if(JSON.stringify(c)===JSON.stringify(t))return u}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}return-1}},i={height:void 0,classes:"table table-bordered table-hover",theadClasses:"",rowStyle:function(e,t){return{}},rowAttributes:function(e,t){return{}},undefinedText:"-",locale:void 0,sortable:!0,sortClass:void 0,silentSort:!0,sortName:void 0,sortOrder:"asc",sortStable:!1,rememberOrder:!1,customSort:void 0,columns:[[]],data:[],url:void 0,method:"get",cache:!0,contentType:"application/json",dataType:"json",ajax:void 0,ajaxOptions:{},queryParams:function(e){return e},queryParamsType:"limit",responseHandler:function(e){return e},totalField:"total",dataField:"rows",pagination:!1,onlyInfoPagination:!1,paginationLoop:!0,sidePagination:"client",totalRows:0,pageNumber:1,pageSize:10,pageList:[10,25,50,100],paginationHAlign:"right",paginationVAlign:"bottom",paginationDetailHAlign:"left",paginationPreText:"&lsaquo;",paginationNextText:"&rsaquo;",paginationSuccessivelySize:5,paginationPagesBySide:1,paginationUseIntermediate:!1,search:!1,searchOnEnterKey:!1,strictSearch:!1,trimOnSearch:!0,searchAlign:"right",searchTimeOut:500,searchText:"",customSearch:void 0,showHeader:!0,showFooter:!1,footerStyle:function(e,t){return{}},showColumns:!1,minimumCountColumns:1,showPaginationSwitch:!1,showRefresh:!1,showToggle:!1,showFullscreen:!1,smartDisplay:!0,escape:!1,idField:void 0,uniqueId:void 0,cardView:!1,detailView:!1,detailFormatter:function(e,t){return""},detailFilter:function(e,t){return!0},selectItemName:"btSelectItem",clickToSelect:!1,ignoreClickToSelectOn:function(e){var t=e.tagName;return["A","BUTTON"].includes(t)},singleSelect:!1,checkboxHeader:!0,maintainSelected:!1,toolbar:void 0,toolbarAlign:"left",buttonsToolbar:void 0,buttonsAlign:"right",buttonsClass:F.classes.buttons,icons:F.icons,iconSize:void 0,iconsPrefix:F.iconsPrefix,onAll:function(e,t){return!1},onClickCell:function(e,t,i,n){return!1},onDblClickCell:function(e,t,i,n){return!1},onClickRow:function(e,t){return!1},onDblClickRow:function(e,t){return!1},onSort:function(e,t){return!1},onCheck:function(e){return!1},onUncheck:function(e){return!1},onCheckAll:function(e){return!1},onUncheckAll:function(e){return!1},onCheckSome:function(e){return!1},onUncheckSome:function(e){return!1},onLoadSuccess:function(e){return!1},onLoadError:function(e){return!1},onColumnSwitch:function(e,t){return!1},onPageChange:function(e,t){return!1},onSearch:function(e){return!1},onToggle:function(e){return!1},onPreBody:function(e){return!1},onPostBody:function(){return!1},onPostHeader:function(){return!1},onExpandRow:function(e,t,i){return!1},onCollapseRow:function(e,t){return!1},onRefreshOptions:function(e){return!1},onRefresh:function(e){return!1},onResetView:function(){return!1},onScrollBody:function(){return!1}},n={};n["en-US"]=n.en={formatLoadingMessage:function(){return"Loading, please wait..."},formatRecordsPerPage:function(e){return z.sprintf("%s rows per page",e)},formatShowingRows:function(e,t,i){return z.sprintf("Showing %s to %s of %s rows",e,t,i)},formatDetailPagination:function(e){return z.sprintf("Showing %s rows",e)},formatSearch:function(){return"Search"},formatNoMatches:function(){return"No matching records found"},formatPaginationSwitch:function(){return"Hide/Show pagination"},formatRefresh:function(){return"Refresh"},formatToggle:function(){return"Toggle"},formatFullscreen:function(){return"Fullscreen"},formatColumns:function(){return"Columns"},formatAllRows:function(){return"All"}},V.extend(i,n["en-US"]);var r={radio:!1,checkbox:!1,checkboxEnabled:!0,field:void 0,title:void 0,titleTooltip:void 0,class:void 0,align:void 0,halign:void 0,falign:void 0,valign:void 0,width:void 0,sortable:!1,order:"asc",visible:!0,switchable:!0,clickToSelect:!0,formatter:void 0,footerFormatter:void 0,events:void 0,sorter:void 0,sortName:void 0,cellStyle:void 0,searchable:!0,searchFormatter:!0,cardVisible:!0,escape:!1,showSelectTitle:!1},l=function(){function s(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.options=t,this.$el=V(e),this.$el_=this.$el.clone(),this.timeoutId_=0,this.timeoutFooter_=0,this.init()}return o(s,[{key:"init",value:function(){this.initLocale(),this.initContainer(),this.initTable(),this.initHeader(),this.initData(),this.initHiddenRows(),this.initFooter(),this.initToolbar(),this.initPagination(),this.initBody(),this.initSearchText(),this.initServer()}},{key:"initLocale",value:function(){if(this.options.locale){var e=V.fn.bootstrapTable.locales,t=this.options.locale.split(/-|_/);t[0]=t[0].toLowerCase(),t[1]&&(t[1]=t[1].toUpperCase()),e[this.options.locale]?V.extend(this.options,e[this.options.locale]):e[t.join("-")]?V.extend(this.options,e[t.join("-")]):e[t[0]]&&V.extend(this.options,e[t[0]])}}},{key:"initContainer",value:function(){var e=["top","both"].includes(this.options.paginationVAlign)?'<div class="fixed-table-pagination clearfix"></div>':"",t=["bottom","both"].includes(this.options.paginationVAlign)?'<div class="fixed-table-pagination"></div>':"";this.$container=V('\n        <div class="bootstrap-table">\n        <div class="fixed-table-toolbar"></div>\n        '+e+'\n        <div class="fixed-table-container">\n        <div class="fixed-table-header"><table></table></div>\n        <div class="fixed-table-body">\n        <div class="fixed-table-loading">\n        '+this.options.formatLoadingMessage()+'\n        </div>\n        </div>\n        <div class="fixed-table-footer"><table><tr></tr></table></div>\n        </div>\n        '+t+"\n        </div>\n      "),this.$container.insertAfter(this.$el),this.$tableContainer=this.$container.find(".fixed-table-container"),this.$tableHeader=this.$container.find(".fixed-table-header"),this.$tableBody=this.$container.find(".fixed-table-body"),this.$tableLoading=this.$container.find(".fixed-table-loading"),this.$tableFooter=this.$container.find(".fixed-table-footer"),this.options.buttonsToolbar?this.$toolbar=V("body").find(this.options.buttonsToolbar):this.$toolbar=this.$container.find(".fixed-table-toolbar"),this.$pagination=this.$container.find(".fixed-table-pagination"),this.$tableBody.append(this.$el),this.$container.after('<div class="clearfix"></div>'),this.$el.addClass(this.options.classes),this.options.height&&(this.$tableContainer.addClass("fixed-height"),this.options.classes.split(" ").includes("table-bordered")&&(this.$tableBody.append('<div class="fixed-table-border"></div>'),this.$tableBorder=this.$tableBody.find(".fixed-table-border"),this.$tableLoading.addClass("fixed-table-border")))}},{key:"initTable",value:function(){var c=this,n=[],t=[];if(this.$header=this.$el.find(">thead"),this.$header.length||(this.$header=V('<thead class="'+this.options.theadClasses+'"></thead>').appendTo(this.$el)),this.$header.find("tr").each(function(e,t){var i=[];V(t).find("th").each(function(e,t){void 0!==V(t).data("field")&&V(t).data("field",""+V(t).data("field")),i.push(V.extend({},{title:V(t).html(),class:V(t).attr("class"),titleTooltip:V(t).attr("title"),rowspan:V(t).attr("rowspan")?+V(t).attr("rowspan"):void 0,colspan:V(t).attr("colspan")?+V(t).attr("colspan"):void 0},V(t).data()))}),n.push(i)}),Array.isArray(this.options.columns[0])||(this.options.columns=[this.options.columns]),this.options.columns=V.extend(!0,[],n,this.options.columns),this.columns=[],this.fieldsColumnsIndex=[],z.setFieldIndex(this.options.columns),this.options.columns.forEach(function(e,n){e.forEach(function(e,t){var i=V.extend({},s.COLUMN_DEFAULTS,e);void 0!==i.fieldIndex&&(c.columns[i.fieldIndex]=i,c.fieldsColumnsIndex[i.field]=i.fieldIndex),c.options.columns[n][t]=i})}),!this.options.data.length){var d=[];this.$el.find(">tbody>tr").each(function(l,e){var u={};u._id=V(e).attr("id"),u._class=V(e).attr("class"),u._data=z.getRealDataAttr(V(e).data()),V(e).find(">td").each(function(e,t){for(var i=+V(t).attr("colspan")||1,n=+V(t).attr("rowspan")||1,r=e;d[l]&&d[l][r];r++);for(var o=r;o<r+i;o++)for(var s=l;s<l+n;s++)d[s]||(d[s]=[]),d[s][o]=!0;var a=c.columns[r].field;u[a]=V(t).html(),u["_"+a+"_id"]=V(t).attr("id"),u["_"+a+"_class"]=V(t).attr("class"),u["_"+a+"_rowspan"]=V(t).attr("rowspan"),u["_"+a+"_colspan"]=V(t).attr("colspan"),u["_"+a+"_title"]=V(t).attr("title"),u["_"+a+"_data"]=z.getRealDataAttr(V(t).data())}),t.push(u)}),(this.options.data=t).length&&(this.fromHtml=!0)}}},{key:"initHeader",value:function(){var d=this,h={},p=[];this.header={fields:[],styles:[],classes:[],formatters:[],events:[],sorters:[],sortNames:[],cellStyles:[],searchables:[]},this.options.columns.forEach(function(e,c){p.push("<tr>"),0===c&&!d.options.cardView&&d.options.detailView&&p.push('<th class="detail" rowspan="'+d.options.columns.length+'">\n            <div class="fht-cell"></div>\n            </th>\n          '),e.forEach(function(e,t){var i,n,r="",o="",s=z.sprintf(' class="%s"',e.class),a="px",l=e.width;if(void 0===e.width||d.options.cardView||"string"==typeof e.width&&e.width.includes("%")&&(a="%"),e.width&&"string"==typeof e.width&&(l=e.width.replace("%","").replace("px","")),i=z.sprintf("text-align: %s; ",e.halign?e.halign:e.align),n=z.sprintf("text-align: %s; ",e.align),o=z.sprintf("vertical-align: %s; ",e.valign),o+=z.sprintf("width: %s; ",!e.checkbox&&!e.radio||l?l?l+a:void 0:e.showSelectTitle?void 0:"36px"),void 0!==e.fieldIndex){if(d.header.fields[e.fieldIndex]=e.field,d.header.styles[e.fieldIndex]=n+o,d.header.classes[e.fieldIndex]=s,d.header.formatters[e.fieldIndex]=e.formatter,d.header.events[e.fieldIndex]=e.events,d.header.sorters[e.fieldIndex]=e.sorter,d.header.sortNames[e.fieldIndex]=e.sortName,d.header.cellStyles[e.fieldIndex]=e.cellStyle,d.header.searchables[e.fieldIndex]=e.searchable,!e.visible)return;if(d.options.cardView&&!e.cardVisible)return;h[e.field]=e}p.push("<th"+z.sprintf(' title="%s"',e.titleTooltip),e.checkbox||e.radio?z.sprintf(' class="bs-checkbox %s"',e.class||""):s,z.sprintf(' style="%s"',i+o),z.sprintf(' rowspan="%s"',e.rowspan),z.sprintf(' colspan="%s"',e.colspan),z.sprintf(' data-field="%s"',e.field),0===t&&0<c?" data-not-first-th":"",">"),p.push(z.sprintf('<div class="th-inner %s">',d.options.sortable&&e.sortable?"sortable both":""));var u=r=d.options.escape?z.escapeHTML(e.title):e.title;e.checkbox&&(r="",!d.options.singleSelect&&d.options.checkboxHeader&&(r='<input name="btSelectAll" type="checkbox" />'),d.header.stateField=e.field),e.radio&&(r="",d.header.stateField=e.field,d.options.singleSelect=!0),!r&&e.showSelectTitle&&(r+=u),p.push(r),p.push("</div>"),p.push('<div class="fht-cell"></div>'),p.push("</div>"),p.push("</th>")}),p.push("</tr>")}),this.$header.html(p.join("")),this.$header.find("th[data-field]").each(function(e,t){V(t).data(h[V(t).data("field")])}),this.$container.off("click",".th-inner").on("click",".th-inner",function(e){var t=V(e.currentTarget);if(d.options.detailView&&!t.parent().hasClass("bs-checkbox")&&t.closest(".bootstrap-table")[0]!==d.$container[0])return!1;d.options.sortable&&t.parent().data().sortable&&d.onSort(e)}),this.$header.children().children().off("keypress").on("keypress",function(e){d.options.sortable&&V(e.currentTarget).data().sortable&&(13===(e.keyCode||e.which)&&d.onSort(e))}),V(window).off("resize.bootstrap-table"),!this.options.showHeader||this.options.cardView?(this.$header.hide(),this.$tableHeader.hide(),this.$tableLoading.css("top",0)):(this.$header.show(),this.$tableHeader.show(),this.$tableLoading.css("top",this.$header.outerHeight()+1),this.getCaret(),V(window).on("resize.bootstrap-table",V.proxy(this.resetWidth,this))),this.$selectAll=this.$header.find('[name="btSelectAll"]'),this.$selectAll.off("click").on("click",function(e){var t=e.currentTarget,i=V(t).prop("checked");d[i?"checkAll":"uncheckAll"](),d.updateSelected()})}},{key:"initFooter",value:function(){!this.options.showFooter||this.options.cardView?this.$tableFooter.hide():this.$tableFooter.show()}},{key:"initData",value:function(e,t){this.options.data="append"===t?this.options.data.concat(e):"prepend"===t?[].concat(e).concat(this.options.data):e||this.options.data,this.data=this.options.data,"server"!==this.options.sidePagination&&this.initSort()}},{key:"initSort",value:function(){var o=this,s=this.options.sortName,a="desc"===this.options.sortOrder?-1:1,l=this.header.fields.indexOf(this.options.sortName),e=0;-1!==l&&(this.options.sortStable&&this.data.forEach(function(e,t){e.hasOwnProperty("_position")||(e._position=t)}),this.options.customSort?z.calculateObjectValue(this.options,this.options.customSort,[this.options.sortName,this.options.sortOrder,this.data]):this.data.sort(function(e,t){o.header.sortNames[l]&&(s=o.header.sortNames[l]);var i=z.getItemField(e,s,o.options.escape),n=z.getItemField(t,s,o.options.escape),r=z.calculateObjectValue(o.header,o.header.sorters[l],[i,n,e,t]);return void 0!==r?o.options.sortStable&&0===r?a*(e._position-t._position):a*r:(null==i&&(i=""),null==n&&(n=""),o.options.sortStable&&i===n&&(i=e._position,n=t._position),V.isNumeric(i)&&V.isNumeric(n)?(i=parseFloat(i))<(n=parseFloat(n))?-1*a:n<i?a:0:i===n?0:("string"!=typeof i&&(i=i.toString()),-1===i.localeCompare(n)?-1*a:a))}),void 0!==this.options.sortClass&&(clearTimeout(e),e=setTimeout(function(){o.$el.removeClass(o.options.sortClass);var e=o.$header.find('[data-field="'+o.options.sortName+'"]').index();o.$el.find("tr td:nth-child("+(e+1)+")").addClass(o.options.sortClass)},250)))}},{key:"onSort",value:function(e){var t=e.type,i=e.currentTarget,n="keypress"===t?V(i):V(i).parent(),r=this.$header.find("th").eq(n.index());this.$header.add(this.$header_).find("span.order").remove(),this.options.sortName===n.data("field")?this.options.sortOrder="asc"===this.options.sortOrder?"desc":"asc":(this.options.sortName=n.data("field"),this.options.rememberOrder?this.options.sortOrder="asc"===n.data("order")?"desc":"asc":this.options.sortOrder=this.columns[this.fieldsColumnsIndex[n.data("field")]].order),this.trigger("sort",this.options.sortName,this.options.sortOrder),n.add(r).data("order",this.options.sortOrder),this.getCaret(),"server"!==this.options.sidePagination?(this.initSort(),this.initBody()):this.initServer(this.options.silentSort)}},{key:"initToolbar",value:function(){var n=this,r=[],t=0,e=void 0,i=void 0,o=0;this.$toolbar.find(".bs-bars").children().length&&V("body").append(V(this.options.toolbar)),this.$toolbar.html(""),"string"!=typeof this.options.toolbar&&"object"!==h(this.options.toolbar)||V(z.sprintf('<div class="bs-bars %s-%s"></div>',F.classes.pull,this.options.toolbarAlign)).appendTo(this.$toolbar).append(V(this.options.toolbar)),r=[z.sprintf('<div class="columns columns-%s btn-group %s-%s">',this.options.buttonsAlign,F.classes.pull,this.options.buttonsAlign)],"string"==typeof this.options.icons&&(this.options.icons=z.calculateObjectValue(null,this.options.icons)),this.options.showPaginationSwitch&&r.push(z.sprintf('<button class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+'" type="button" name="paginationSwitch" aria-label="pagination Switch" title="%s">',this.options.formatPaginationSwitch()),z.sprintf('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.paginationSwitchDown),"</button>"),this.options.showFullscreen&&this.$toolbar.find('button[name="fullscreen"]').off("click").on("click",V.proxy(this.toggleFullscreen,this)),this.options.showRefresh&&r.push(z.sprintf('<button class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+'" type="button" name="refresh" aria-label="refresh" title="%s">',this.options.formatRefresh()),z.sprintf('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.refresh),"</button>"),this.options.showToggle&&r.push(z.sprintf('<button class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+'" type="button" name="toggle" aria-label="toggle" title="%s">',this.options.formatToggle()),z.sprintf('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.toggleOff),"</button>"),this.options.showFullscreen&&r.push(z.sprintf('<button class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+'" type="button" name="fullscreen" aria-label="fullscreen" title="%s">',this.options.formatFullscreen()),z.sprintf('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.fullscreen),"</button>"),this.options.showColumns&&(r.push(z.sprintf('<div class="keep-open btn-group" title="%s">',this.options.formatColumns()),'<button type="button" aria-label="columns" class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">',z.sprintf('<i class="%s %s"></i>',this.options.iconsPrefix,this.options.icons.columns),' <span class="caret"></span>',"</button>",F.html.toobarDropdow[0]),this.columns.forEach(function(e,t){if(!e.radio&&!e.checkbox&&(!n.options.cardView||e.cardVisible)){var i=e.visible?' checked="checked"':"";e.switchable&&(r.push(z.sprintf(F.html.toobarDropdowItem,z.sprintf('<input type="checkbox" data-field="%s" value="%s"%s> %s',e.field,t,i,e.title))),o++)}}),r.push(F.html.toobarDropdow[1],"</div>")),r.push("</div>"),(this.showToolbar||2<r.length)&&this.$toolbar.append(r.join("")),this.options.showPaginationSwitch&&this.$toolbar.find('button[name="paginationSwitch"]').off("click").on("click",V.proxy(this.togglePagination,this)),this.options.showRefresh&&this.$toolbar.find('button[name="refresh"]').off("click").on("click",V.proxy(this.refresh,this)),this.options.showToggle&&this.$toolbar.find('button[name="toggle"]').off("click").on("click",function(){n.toggleView()}),this.options.showColumns&&(e=this.$toolbar.find(".keep-open"),o<=this.options.minimumCountColumns&&e.find("input").prop("disabled",!0),e.find("li").off("click").on("click",function(e){e.stopImmediatePropagation()}),e.find("input").off("click").on("click",function(e){var t=e.currentTarget,i=V(t);n.toggleColumn(i.val(),i.prop("checked"),!1),n.trigger("column-switch",i.data("field"),i.prop("checked"))})),this.options.search&&((r=[]).push(z.sprintf('<div class="%s-%s search">',F.classes.pull,this.options.searchAlign),z.sprintf('<input class="form-control'+z.sprintf(" input-%s",this.options.iconSize)+'" type="text" placeholder="%s">',this.options.formatSearch()),"</div>"),this.$toolbar.append(r.join("")),(i=this.$toolbar.find(".search input")).off("keyup drop blur").on("keyup drop blur",function(e){n.options.searchOnEnterKey&&13!==e.keyCode||[37,38,39,40].includes(e.keyCode)||(clearTimeout(t),t=setTimeout(function(){n.onSearch(e)},n.options.searchTimeOut))}),z.isIEBrowser()&&i.off("mouseup").on("mouseup",function(e){clearTimeout(t),t=setTimeout(function(){n.onSearch(e)},n.options.searchTimeOut)}))}},{key:"onSearch",value:function(e){var t=e.currentTarget,i=e.firedByInitSearchText,n=V.trim(V(t).val());this.options.trimOnSearch&&V(t).val()!==n&&V(t).val(n),n!==this.searchText&&(this.searchText=n,this.options.searchText=n,i||(this.options.pageNumber=1),this.initSearch(),i?"client"===this.options.sidePagination&&this.updatePagination():this.updatePagination(),this.trigger("search",n))}},{key:"initSearch",value:function(){var l=this;if("server"!==this.options.sidePagination){if(this.options.customSearch)return void z.calculateObjectValue(this.options,this.options.customSearch,[this.searchText]);var u=this.searchText&&(this.options.escape?z.escapeHTML(this.searchText):this.searchText).toLowerCase(),n=V.isEmptyObject(this.filterColumns)?null:this.filterColumns;this.data=n?this.options.data.filter(function(e,t){for(var i in n)if(Array.isArray(n[i])&&!n[i].includes(e[i])||!Array.isArray(n[i])&&e[i]!==n[i])return!1;return!0}):this.options.data,this.data=u?this.data.filter(function(e,t){for(var i=0;i<l.header.fields.length;i++)if(l.header.searchables[i]){var n=V.isNumeric(l.header.fields[i])?parseInt(l.header.fields[i],10):l.header.fields[i],r=l.columns[l.fieldsColumnsIndex[n]],o=void 0;if("string"==typeof n){o=e;for(var s=n.split("."),a=0;a<s.length;a++)null!==o[s[a]]&&(o=o[s[a]])}else o=e[n];if(r&&r.searchFormatter&&(o=z.calculateObjectValue(r,l.header.formatters[i],[o,e,t],o)),"string"==typeof o||"number"==typeof o)if(l.options.strictSearch){if((""+o).toLowerCase()===u)return!0}else if((""+o).toLowerCase().includes(u))return!0}return!1}):this.data}}},{key:"initPagination",value:function(){var n=this;if(this.options.pagination){this.$pagination.show();var e=[],r=!1,t=void 0,i=void 0,o=void 0,s=void 0,a=void 0,l=void 0,u=void 0,c=this.getData(),d=this.options.pageList;if("server"!==this.options.sidePagination&&(this.options.totalRows=c.length),this.totalPages=0,this.options.totalRows){if(this.options.pageSize===this.options.formatAllRows())this.options.pageSize=this.options.totalRows,r=!0;else if(this.options.pageSize===this.options.totalRows){("string"==typeof this.options.pageList?this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").toLowerCase().split(","):this.options.pageList).includes(this.options.formatAllRows().toLowerCase())&&(r=!0)}this.totalPages=1+~~((this.options.totalRows-1)/this.options.pageSize),this.options.totalPages=this.totalPages}if(0<this.totalPages&&this.options.pageNumber>this.totalPages&&(this.options.pageNumber=this.totalPages),this.pageFrom=(this.options.pageNumber-1)*this.options.pageSize+1,this.pageTo=this.options.pageNumber*this.options.pageSize,this.pageTo>this.options.totalRows&&(this.pageTo=this.options.totalRows),e.push(z.sprintf('<div class="%s-%s pagination-detail">',F.classes.pull,this.options.paginationDetailHAlign),'<span class="pagination-info">',this.options.onlyInfoPagination?this.options.formatDetailPagination(this.options.totalRows):this.options.formatShowingRows(this.pageFrom,this.pageTo,this.options.totalRows),"</span>"),!this.options.onlyInfoPagination){e.push('<span class="page-list">');var h=[z.sprintf('<span class="btn-group %s">',"top"===this.options.paginationVAlign||"both"===this.options.paginationVAlign?"dropdown":"dropup"),'<button type="button" class="btn'+z.sprintf(" btn-%s",this.options.buttonsClass)+z.sprintf(" btn-%s",this.options.iconSize)+' dropdown-toggle" data-toggle="dropdown">','<span class="page-size">',r?this.options.formatAllRows():this.options.pageSize,"</span>",' <span class="caret"></span>',"</button>",F.html.pageDropdown[0]];if("string"==typeof this.options.pageList){var p=this.options.pageList.replace("[","").replace("]","").replace(/ /g,"").split(","),f=!0,g=!(d=[]),v=void 0;try{for(var m,y=p[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var b=m.value;d.push(b.toUpperCase()===this.options.formatAllRows().toUpperCase()||"UNLIMITED"===b.toUpperCase()?this.options.formatAllRows():+b)}}catch(e){g=!0,v=e}finally{try{!f&&y.return&&y.return()}finally{if(g)throw v}}}d.forEach(function(e,t){if(!n.options.smartDisplay||0===t||d[t-1]<n.options.totalRows){var i=void 0;i=r?e===n.options.formatAllRows()?"active":"":e===n.options.pageSize?"active":"",h.push(z.sprintf(F.html.pageDropdownItem,i,e))}}),h.push(F.html.pageDropdown[1]+"</span>"),e.push(this.options.formatRecordsPerPage(h.join(""))),e.push("</span>"),e.push("</div>",z.sprintf('<div class="%s-%s pagination">',F.classes.pull,this.options.paginationHAlign),'<ul class="pagination'+z.sprintf(" pagination-%s",this.options.iconSize)+'">',z.sprintf('<li class="page-item page-pre"><a class="page-link" href="#">%s</a></li>',this.options.paginationPreText)),o=this.totalPages<this.options.paginationSuccessivelySize?(i=1,this.totalPages):(i=this.options.pageNumber-this.options.paginationPagesBySide)+2*this.options.paginationPagesBySide,this.options.pageNumber<this.options.paginationSuccessivelySize-1&&(o=this.options.paginationSuccessivelySize),o>this.totalPages&&(o=this.totalPages),this.options.paginationSuccessivelySize>this.totalPages-i&&(i=i-(this.options.paginationSuccessivelySize-(this.totalPages-i))+1),i<1&&(i=1),o>this.totalPages&&(o=this.totalPages);var w=Math.round(this.options.paginationPagesBySide/2),x=function(e){return'\n          <li class="page-item'+(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")+(e===n.options.pageNumber?" active":"")+'">\n            <a class="page-link" href="#">'+e+"</a>\n          </li>\n        "};if(1<i){var k=this.options.paginationPagesBySide;for(i<=k&&(k=i-1),t=1;t<=k;t++)e.push(x(t));i-1===k+1?(t=i-1,e.push(x(t))):k<i-1&&(i-2*this.options.paginationPagesBySide>this.options.paginationPagesBySide&&this.options.paginationUseIntermediate?(t=Math.round((i-w)/2+w),e.push(x(t," page-intermediate"))):e.push('\n                  <li class="page-item page-first-separator disabled">\n                    <a class="page-link" href="#">...</a>\n                  </li>'))}for(t=i;t<=o;t++)e.push(x(t));if(this.totalPages>o){var _=this.totalPages-(this.options.paginationPagesBySide-1);for(_<=o&&(_=o+1),o+1===_-1?(t=o+1,e.push(x(t))):o+1<_&&(this.totalPages-o>2*this.options.paginationPagesBySide&&this.options.paginationUseIntermediate?(t=Math.round((this.totalPages-w-o)/2+o),e.push(x(t," page-intermediate"))):e.push('\n                  <li class="page-item page-last-separator disabled">\n                    <a class="page-link" href="#">...</a>\n                  </li>')),t=_;t<=this.totalPages;t++)e.push(x(t))}e.push('\n          <li class="page-item page-next">\n          <a class="page-link" href="#">'+this.options.paginationNextText+"</a>\n          </li>\n          </ul>\n          </div>\n        ")}this.$pagination.html(e.join("")),this.options.onlyInfoPagination||(s=this.$pagination.find(".page-list a"),a=this.$pagination.find(".page-pre"),l=this.$pagination.find(".page-next"),u=this.$pagination.find(".page-item").not(".page-next, .page-pre"),this.options.smartDisplay&&(this.totalPages<=1&&this.$pagination.find("div.pagination").hide(),(d.length<2||this.options.totalRows<=d[0])&&this.$pagination.find("span.page-list").hide(),this.$pagination[this.getData().length?"show":"hide"]()),this.options.paginationLoop||(1===this.options.pageNumber&&a.addClass("disabled"),this.options.pageNumber===this.totalPages&&l.addClass("disabled")),r&&(this.options.pageSize=this.options.formatAllRows()),s.off("click").on("click",V.proxy(this.onPageListChange,this)),a.off("click").on("click",V.proxy(this.onPagePre,this)),l.off("click").on("click",V.proxy(this.onPageNext,this)),u.off("click").on("click",V.proxy(this.onPageNumber,this)))}else this.$pagination.hide()}},{key:"updatePagination",value:function(e){e&&V(e.currentTarget).hasClass("disabled")||(this.options.maintainSelected||this.resetRows(),this.initPagination(),"server"===this.options.sidePagination?this.initServer():this.initBody(),this.trigger("page-change",this.options.pageNumber,this.options.pageSize))}},{key:"onPageListChange",value:function(e){e.preventDefault();var t=V(e.currentTarget);return t.parent().addClass("active").siblings().removeClass("active"),this.options.pageSize=t.text().toUpperCase()===this.options.formatAllRows().toUpperCase()?this.options.formatAllRows():+t.text(),this.$toolbar.find(".page-size").text(this.options.pageSize),this.updatePagination(e),!1}},{key:"onPagePre",value:function(e){return e.preventDefault(),this.options.pageNumber-1==0?this.options.pageNumber=this.options.totalPages:this.options.pageNumber--,this.updatePagination(e),!1}},{key:"onPageNext",value:function(e){return e.preventDefault(),this.options.pageNumber+1>this.options.totalPages?this.options.pageNumber=1:this.options.pageNumber++,this.updatePagination(e),!1}},{key:"onPageNumber",value:function(e){if(e.preventDefault(),this.options.pageNumber!==+V(e.currentTarget).text())return this.options.pageNumber=+V(e.currentTarget).text(),this.updatePagination(e),!1}},{key:"initRow",value:function(M,P,e,t){var U=this,$=[],B={},Q=[],i="",n={},r=[];if(!(-1<z.findIndex(this.hiddenRows,M))){if((B=z.calculateObjectValue(this.options,this.options.rowStyle,[M,P],B))&&B.css){var o=!0,s=!1,a=void 0;try{for(var l,u=Object.entries(B.css)[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=l.value,d=q(c,2),h=d[0],p=d[1];Q.push(h+": "+p)}}catch(e){s=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw a}}}if(n=z.calculateObjectValue(this.options,this.options.rowAttributes,[M,P],n)){var f=!0,g=!1,v=void 0;try{for(var m,y=Object.entries(n)[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var b=m.value,w=q(b,2),x=w[0],k=w[1];r.push(x+'="'+z.escapeHTML(k)+'"')}}catch(e){g=!0,v=e}finally{try{!f&&y.return&&y.return()}finally{if(g)throw v}}}if(M._data&&!V.isEmptyObject(M._data)){var _=!0,F=!1,C=void 0;try{for(var E,T=Object.entries(M._data)[Symbol.iterator]();!(_=(E=T.next()).done);_=!0){var D=E.value,S=q(D,2),R=S[0],j=S[1];if("index"===R)return;i+=" data-"+R+'="'+j+'"'}}catch(e){F=!0,C=e}finally{try{!_&&T.return&&T.return()}finally{if(F)throw C}}}return $.push("<tr",z.sprintf(" %s",r.length?r.join(" "):void 0),z.sprintf(' id="%s"',Array.isArray(M)?void 0:M._id),z.sprintf(' class="%s"',B.classes||(Array.isArray(M)?void 0:M._class)),' data-index="'+P+'"',z.sprintf(' data-uniqueid="%s"',M[this.options.uniqueId]),z.sprintf("%s",i),">"),this.options.cardView&&$.push('<td colspan="'+this.header.fields.length+'"><div class="card-views">'),!this.options.cardView&&this.options.detailView&&($.push("<td>"),z.calculateObjectValue(null,this.options.detailFilter,[P,M])&&$.push('\n            <a class="detail-icon" href="#">\n            <i class="'+this.options.iconsPrefix+" "+this.options.icons.detailOpen+'"></i>\n            </a>\n          '),$.push("</td>")),this.header.fields.forEach(function(e,t){var i="",n=z.getItemField(M,e,U.options.escape),r="",o="",s={},a="",l=U.header.classes[t],u="",c="",d="",h="",p="",f=U.columns[t];if((!U.fromHtml||void 0!==n||f.checkbox||f.radio)&&f.visible&&(!U.options.cardView||f.cardVisible)){if(f.escape&&(n=z.escapeHTML(n)),Q.concat([U.header.styles[t]]).length&&(u=' style="'+Q.concat([U.header.styles[t]]).join("; ")+'"'),M["_"+e+"_id"]&&(a=z.sprintf(' id="%s"',M["_"+e+"_id"])),M["_"+e+"_class"]&&(l=z.sprintf(' class="%s"',M["_"+e+"_class"])),M["_"+e+"_rowspan"]&&(d=z.sprintf(' rowspan="%s"',M["_"+e+"_rowspan"])),M["_"+e+"_colspan"]&&(h=z.sprintf(' colspan="%s"',M["_"+e+"_colspan"])),M["_"+e+"_title"]&&(p=z.sprintf(' title="%s"',M["_"+e+"_title"])),(s=z.calculateObjectValue(U.header,U.header.cellStyles[t],[n,M,P,e],s)).classes&&(l=' class="'+s.classes+'"'),s.css){var g=[],v=!0,m=!1,y=void 0;try{for(var b,w=Object.entries(s.css)[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var x=b.value,k=q(x,2),_=k[0],F=k[1];g.push(_+": "+F)}}catch(e){m=!0,y=e}finally{try{!v&&w.return&&w.return()}finally{if(m)throw y}}u=' style="'+g.concat(U.header.styles[t]).join("; ")+'"'}if(r=z.calculateObjectValue(f,U.header.formatters[t],[n,M,P,e],n),M["_"+e+"_data"]&&!V.isEmptyObject(M["_"+e+"_data"])){var C=!0,E=!1,T=void 0;try{for(var D,S=Object.entries(M["_"+e+"_data"])[Symbol.iterator]();!(C=(D=S.next()).done);C=!0){var R=D.value,j=q(R,2),I=j[0],A=j[1];if("index"===I)return;c+=" data-"+I+'="'+A+'"'}}catch(e){E=!0,T=e}finally{try{!C&&S.return&&S.return()}finally{if(E)throw T}}}if(f.checkbox||f.radio){o=f.checkbox?"checkbox":o,o=f.radio?"radio":o;var O=f.class||"",N=!0===r||n||r&&r.checked,L=!f.checkboxEnabled||r&&r.disabled;i=[U.options.cardView?'<div class="card-view '+O+'">':'<td class="bs-checkbox '+O+'">','<input\n              data-index="'+P+'"\n              name="'+U.options.selectItemName+'"\n              type="'+o+'"\n              '+z.sprintf('value="%s"',M[U.options.idField])+"\n              "+z.sprintf('checked="%s"',N?"checked":void 0)+"\n              "+z.sprintf('disabled="%s"',L?"disabled":void 0)+" />",U.header.formatters[t]&&"string"==typeof r?r:"",U.options.cardView?"</div>":"</td>"].join(""),M[U.header.stateField]=!0===r||!!n||r&&r.checked}else{if(r=null==r?U.options.undefinedText:r,U.options.cardView)i='<div class="card-view">'+(U.options.showHeader?'<span class="title"'+B+">"+z.getFieldTitle(U.columns,e)+"</span>":"")+'<span class="value">'+r+"</span></div>",U.options.smartDisplay&&""===r&&(i='<div class="card-view"></div>');else i="<td"+a+l+u+c+d+h+p+">"+r+"</td>"}$.push(i)}}),this.options.cardView&&$.push("</div></td>"),$.push("</tr>"),$.join("")}}},{key:"initBody",value:function(e){var p=this,a=this.getData();this.trigger("pre-body",a),this.$body=this.$el.find(">tbody"),this.$body.length||(this.$body=V("<tbody></tbody>").appendTo(this.$el)),this.options.pagination&&"server"!==this.options.sidePagination||(this.pageFrom=1,this.pageTo=a.length);for(var t=V(document.createDocumentFragment()),i=!1,n=this.pageFrom-1;n<this.pageTo;n++){var r=a[n],o=this.initRow(r,n,a,t);i=i||!!o,o&&"string"==typeof o&&t.append(o)}i?this.$body.html(t):this.$body.html('<tr class="no-records-found">'+z.sprintf('<td colspan="%s">%s</td>',this.$header.find("th").length,this.options.formatNoMatches())+"</tr>"),e||this.scrollTo(0),this.$body.find("> tr[data-index] > td").off("click dblclick").on("click dblclick",function(e){var t=e.currentTarget,i=e.type,n=e.target,r=V(t),o=r.parent(),s=p.data[o.data("index")],a=r[0].cellIndex,l=p.getVisibleFields()[p.options.detailView&&!p.options.cardView?a-1:a],u=p.columns[p.fieldsColumnsIndex[l]],c=z.getItemField(s,l,p.options.escape);if(!r.find(".detail-icon").length&&(p.trigger("click"===i?"click-cell":"dbl-click-cell",l,c,s,r),p.trigger("click"===i?"click-row":"dbl-click-row",s,o,l),"click"===i&&p.options.clickToSelect&&u.clickToSelect&&!p.options.ignoreClickToSelectOn(n))){var d=o.find(z.sprintf('[name="%s"]',p.options.selectItemName));d.length&&d[0].click()}}),this.$body.find("> tr[data-index] > td > .detail-icon").off("click").on("click",function(e){e.preventDefault();var t=V(e.currentTarget),i=t.parent().parent(),n=i.data("index"),r=a[n];if(i.next().is("tr.detail-view"))t.find("i").attr("class",z.sprintf("%s %s",p.options.iconsPrefix,p.options.icons.detailOpen)),p.trigger("collapse-row",n,r,i.next()),i.next().remove();else{t.find("i").attr("class",z.sprintf("%s %s",p.options.iconsPrefix,p.options.icons.detailClose)),i.after(z.sprintf('<tr class="detail-view"><td colspan="%s"></td></tr>',i.find("td").length));var o=i.next().find("td"),s=z.calculateObjectValue(p.options,p.options.detailFormatter,[n,r,o],"");1===o.length&&o.append(s),p.trigger("expand-row",n,r,o)}return p.resetView(),!1}),this.$selectItem=this.$body.find(z.sprintf('[name="%s"]',this.options.selectItemName)),this.$selectItem.off("click").on("click",function(e){e.stopImmediatePropagation();var t=V(e.currentTarget);p.check_(t.prop("checked"),t.data("index"))}),this.header.events.forEach(function(e,t){var i=e;if(i){"string"==typeof i&&(i=z.calculateObjectValue(null,i));var u=p.header.fields[t],c=p.getVisibleFields().indexOf(u);if(-1!==c){p.options.detailView&&!p.options.cardView&&(c+=1);var n=function(a,l){p.$body.find(">tr:not(.no-records-found)").each(function(e,t){var r=V(t),i=r.find(p.options.cardView?".card-view":"td").eq(c),n=a.indexOf(" "),o=a.substring(0,n),s=a.substring(n+1);i.find(s).off(o).on(o,function(e){var t=r.data("index"),i=p.data[t],n=i[u];l.apply(p,[e,n,i,t])})})},r=!0,o=!1,s=void 0;try{for(var a,l=Object.entries(i)[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var d=a.value,h=q(d,2);n(h[0],h[1])}}catch(e){o=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw s}}}}}),this.updateSelected(),this.resetView(),this.trigger("post-body",a)}},{key:"initServer",value:function(i,e,t){var n=this,r={},o=this.header.fields.indexOf(this.options.sortName),s={searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder};if(this.header.sortNames[o]&&(s.sortName=this.header.sortNames[o]),this.options.pagination&&"server"===this.options.sidePagination&&(s.pageSize=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,s.pageNumber=this.options.pageNumber),(t||this.options.url||this.options.ajax)&&("limit"===this.options.queryParamsType&&(s={search:s.searchText,sort:s.sortName,order:s.sortOrder},this.options.pagination&&"server"===this.options.sidePagination&&(s.offset=this.options.pageSize===this.options.formatAllRows()?0:this.options.pageSize*(this.options.pageNumber-1),s.limit=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,0===s.limit&&delete s.limit)),V.isEmptyObject(this.filterColumnsPartial)||(s.filter=JSON.stringify(this.filterColumnsPartial,null)),r=z.calculateObjectValue(this.options,this.options.queryParams,[s],r),V.extend(r,e||{}),!1!==r)){i||this.$tableLoading.show();var a=V.extend({},z.calculateObjectValue(null,this.options.ajaxOptions),{type:this.options.method,url:t||this.options.url,data:"application/json"===this.options.contentType&&"post"===this.options.method?JSON.stringify(r):r,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success:function(e){var t=z.calculateObjectValue(n.options,n.options.responseHandler,[e],e);n.load(t),n.trigger("load-success",t),i||n.$tableLoading.hide()},error:function(e){var t=[];"server"===n.options.sidePagination&&((t={})[n.options.totalField]=0,t[n.options.dataField]=[]),n.load(t),n.trigger("load-error",e.status,e),i||n.$tableLoading.hide()}});this.options.ajax?z.calculateObjectValue(this,this.options.ajax,[a],null):(this._xhr&&4!==this._xhr.readyState&&this._xhr.abort(),this._xhr=V.ajax(a))}}},{key:"initSearchText",value:function(){if(this.options.search&&(this.searchText="")!==this.options.searchText){var e=this.$toolbar.find(".search input");e.val(this.options.searchText),this.onSearch({currentTarget:e,firedByInitSearchText:!0})}}},{key:"getCaret",value:function(){var i=this;this.$header.find("th").each(function(e,t){V(t).find(".sortable").removeClass("desc asc").addClass(V(t).data("field")===i.options.sortName?i.options.sortOrder:"both")})}},{key:"updateSelected",value:function(){var e=this.$selectItem.filter(":enabled").length&&this.$selectItem.filter(":enabled").length===this.$selectItem.filter(":enabled").filter(":checked").length;this.$selectAll.add(this.$selectAll_).prop("checked",e),this.$selectItem.each(function(e,t){V(t).closest("tr")[V(t).prop("checked")?"addClass":"removeClass"]("selected")})}},{key:"updateRows",value:function(){var i=this;this.$selectItem.each(function(e,t){i.data[V(t).data("index")][i.header.stateField]=V(t).prop("checked")})}},{key:"resetRows",value:function(){var e=!0,t=!1,i=void 0;try{for(var n,r=this.data[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value;this.$selectAll.prop("checked",!1),this.$selectItem.prop("checked",!1),this.header.stateField&&(o[this.header.stateField]=!1)}}catch(e){t=!0,i=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw i}}this.initHiddenRows()}},{key:"trigger",value:function(e){for(var t,i=e+".bs.table",n=arguments.length,r=Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=this.options)[s.EVENTS[i]].apply(t,r),this.$el.trigger(V.Event(i),r),this.options.onAll(i,r),this.$el.trigger(V.Event("all.bs.table"),[i,r])}},{key:"resetHeader",value:function(){clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(V.proxy(this.fitHeader,this),this.$el.is(":hidden")?100:0)}},{key:"fitHeader",value:function(){var l=this;if(this.$el.is(":hidden"))this.timeoutId_=setTimeout(V.proxy(this.fitHeader,this),100);else{var e=this.$tableBody.get(0),t=e.scrollWidth>e.clientWidth&&e.scrollHeight>e.clientHeight+this.$header.outerHeight()?z.getScrollBarWidth():0;this.$el.css("margin-top",-this.$header.outerHeight());var i=V(":focus");if(0<i.length){var n=i.parents("th");if(0<n.length){var r=n.attr("data-field");if(void 0!==r){var o=this.$header.find("[data-field='"+r+"']");0<o.length&&o.find(":input").addClass("focus-temp")}}}this.$header_=this.$header.clone(!0,!0),this.$selectAll_=this.$header_.find('[name="btSelectAll"]'),this.$tableHeader.css({"margin-right":t}).find("table").css("width",this.$el.outerWidth()).html("").attr("class",this.$el.attr("class")).append(this.$header_);var s=V(".focus-temp:visible:eq(0)");0<s.length&&(s.focus(),this.$header.find(".focus-temp").removeClass("focus-temp")),this.$header.find("th[data-field]").each(function(e,t){l.$header_.find(z.sprintf('th[data-field="%s"]',V(t).data("field"))).data(V(t).data())});var u=this.getVisibleFields(),c=this.$header_.find("th");this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(e,t){var i=V(t),n=e;if(l.options.detailView&&!l.options.cardView){if(0===e){var r=c.filter(".detail"),o=r.width()-r.find(".fht-cell").width();r.find(".fht-cell").width(i.innerWidth()-o)}n=e-1}if(-1!==n){var s=l.$header_.find(z.sprintf('th[data-field="%s"]',u[n]));1<s.length&&(s=V(c[i[0].cellIndex]));var a=s.width()-s.find(".fht-cell").width();s.find(".fht-cell").width(i.innerWidth()-a)}}),this.horizontalScroll(),this.trigger("post-header")}}},{key:"resetFooter",value:function(){var e=this.getData(),t=[];if(this.options.showFooter&&!this.options.cardView){!this.options.cardView&&this.options.detailView&&t.push('<td><div class="th-inner">&nbsp;</div><div class="fht-cell"></div></td>');var i=!0,n=!1,r=void 0;try{for(var o,s=this.columns[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a,l,u,c=o.value,d=[],h=z.sprintf(' class="%s"',c.class);if(!c.visible)return;if(this.options.cardView&&!c.cardVisible)return;if(a=z.sprintf("text-align: %s; ",c.falign?c.falign:c.align),l=z.sprintf("vertical-align: %s; ",c.valign),(u=z.calculateObjectValue(null,this.options.footerStyle))&&u.css){var p=!0,f=!1,g=void 0;try{for(var v,m=Object.keys(u.css)[Symbol.iterator]();!(p=(v=m.next()).done);p=!0){var y=v.value,b=q(y,2),w=b[0],x=b[1];d.push(w+": "+x)}}catch(e){f=!0,g=e}finally{try{!p&&m.return&&m.return()}finally{if(f)throw g}}}t.push("<td",h,z.sprintf(' style="%s"',a+l+d.concat().join("; ")),">"),t.push('<div class="th-inner">'),t.push(z.calculateObjectValue(c,c.footerFormatter,[e],"&nbsp;")||"&nbsp;"),t.push("</div>"),t.push('<div class="fht-cell"></div>'),t.push("</div>"),t.push("</td>")}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}this.$tableFooter.find("tr").html(t.join("")),this.$tableFooter.show(),clearTimeout(this.timeoutFooter_),this.timeoutFooter_=setTimeout(V.proxy(this.fitFooter,this),this.$el.is(":hidden")?100:0)}}},{key:"fitFooter",value:function(){if(clearTimeout(this.timeoutFooter_),this.$el.is(":hidden"))this.timeoutFooter_=setTimeout(V.proxy(this.fitFooter,this),100);else{var e=this.$el.css("width"),t=e>this.$tableBody.width()?z.getScrollBarWidth():0;this.$tableFooter.css({"margin-right":t}).find("table").css("width",e).attr("class",this.$el.attr("class"));var n=this.$tableFooter.find("td");this.$body.find(">tr:first-child:not(.no-records-found) > *").each(function(e,t){var i=V(t);n.eq(e).find(".fht-cell").width(i.innerWidth())}),this.horizontalScroll()}}},{key:"horizontalScroll",value:function(){var i=this;this.trigger("scroll-body"),this.$tableBody.off("scroll").on("scroll",function(e){var t=e.currentTarget;i.options.showHeader&&i.options.height&&i.$tableHeader.scrollLeft(V(t).scrollLeft()),i.options.showFooter&&!i.options.cardView&&i.$tableFooter.scrollLeft(V(t).scrollLeft())})}},{key:"toggleColumn",value:function(e,t,i){if(-1!==e&&(this.columns[e].visible=t,this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns)){var n=this.$toolbar.find(".keep-open input").prop("disabled",!1);i&&n.filter(z.sprintf('[value="%s"]',e)).prop("checked",t),n.filter(":checked").length<=this.options.minimumCountColumns&&n.filter(":checked").prop("disabled",!0)}}},{key:"getVisibleFields",value:function(){var e=[],t=!0,i=!1,n=void 0;try{for(var r,o=this.header.fields[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value;this.columns[this.fieldsColumnsIndex[s]].visible&&e.push(s)}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}return e}},{key:"resetView",value:function(e){var t=0;if(e&&e.height&&(this.options.height=e.height),this.$selectAll.prop("checked",0<this.$selectItem.length&&this.$selectItem.length===this.$selectItem.filter(":checked").length),this.options.cardView)return this.$el.css("margin-top","0"),this.$tableContainer.css("padding-bottom","0"),void this.$tableFooter.hide();if(this.options.showHeader&&this.options.height?(this.$tableHeader.show(),this.resetHeader(),t+=this.$header.outerHeight()):(this.$tableHeader.hide(),this.trigger("post-header")),this.options.showFooter&&(this.resetFooter(),this.options.height&&(t+=this.$tableFooter.outerHeight()+1)),this.options.height){var i=this.$toolbar.outerHeight(!0),n=this.$pagination.outerHeight(!0),r=this.options.height-i-n,o=this.$tableBody.find("table").outerHeight(!0);this.$tableContainer.css("height",r+"px"),this.$tableBorder&&this.$tableBorder.css("height",r-o-t-1+"px")}this.getCaret(),this.$tableContainer.css("padding-bottom",t+"px"),this.trigger("reset-view")}},{key:"getData",value:function(e){var t=this.options.data;return!this.searchText&&!this.options.sortName&&V.isEmptyObject(this.filterColumns)&&V.isEmptyObject(this.filterColumnsPartial)||(t=this.data),e?t.slice(this.pageFrom-1,this.pageTo):t}},{key:"load",value:function(e){var t,i=e;this.options.pagination&&"server"===this.options.sidePagination&&(this.options.totalRows=i[this.options.totalField]),t=i.fixedScroll,i=Array.isArray(i)?i:i[this.options.dataField],this.initData(i),this.initSearch(),this.initPagination(),this.initBody(t)}},{key:"append",value:function(e){this.initData(e,"append"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"prepend",value:function(e){this.initData(e,"prepend"),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"remove",value:function(e){var t=this.options.data.length,i=void 0,n=void 0;if(e.hasOwnProperty("field")&&e.hasOwnProperty("values")){for(i=t-1;0<=i;i--)(n=this.options.data[i]).hasOwnProperty(e.field)&&e.values.includes(n[e.field])&&(this.options.data.splice(i,1),"server"===this.options.sidePagination&&(this.options.totalRows-=1));t!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}}},{key:"removeAll",value:function(){0<this.options.data.length&&(this.options.data.splice(0,this.options.data.length),this.initSearch(),this.initPagination(),this.initBody(!0))}},{key:"getRowByUniqueId",value:function(e){var t=this.options.uniqueId,i=e,n=null,r=void 0,o=void 0,s=void 0;for(r=this.options.data.length-1;0<=r;r--){if((o=this.options.data[r]).hasOwnProperty(t))s=o[t];else{if(!o._data||!o._data.hasOwnProperty(t))continue;s=o._data[t]}if("string"==typeof s?i=i.toString():"number"==typeof s&&(Number(s)===s&&s%1==0?i=parseInt(i):s===Number(s)&&0!==s&&(i=parseFloat(i))),s===i){n=o;break}}return n}},{key:"removeByUniqueId",value:function(e){var t=this.options.data.length,i=this.getRowByUniqueId(e);i&&this.options.data.splice(this.options.data.indexOf(i),1),t!==this.options.data.length&&(this.initSearch(),this.initPagination(),this.initBody(!0))}},{key:"updateByUniqueId",value:function(e){var t=Array.isArray(e)?e:[e],i=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;if(a.hasOwnProperty("id")&&a.hasOwnProperty("row")){var l=this.options.data.indexOf(this.getRowByUniqueId(a.id));-1!==l&&V.extend(this.options.data[l],a.row)}}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"refreshColumnTitle",value:function(i){i.hasOwnProperty("field")&&i.hasOwnProperty("title")&&(this.columns[this.fieldsColumnsIndex[i.field]].title=this.options.escape?z.escapeHTML(i.title):i.title,this.columns[this.fieldsColumnsIndex[i.field]].visible&&(void 0!==this.options.height?this.$tableHeader:this.$header).find("th[data-field]").each(function(e,t){if(V(t).data("field")===i.field)return V(V(t).find(".th-inner")[0]).text(i.title),!1}))}},{key:"insertRow",value:function(e){e.hasOwnProperty("index")&&e.hasOwnProperty("row")&&(this.options.data.splice(e.index,0,e.row),this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0))}},{key:"updateRow",value:function(e){var t=Array.isArray(e)?e:[e],i=!0,n=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var a=o.value;a.hasOwnProperty("index")&&a.hasOwnProperty("row")&&V.extend(this.options.data[a.index],a.row)}}catch(e){n=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw r}}this.initSearch(),this.initPagination(),this.initSort(),this.initBody(!0)}},{key:"initHiddenRows",value:function(){this.hiddenRows=[]}},{key:"showRow",value:function(e){this.toggleRow(e,!0)}},{key:"hideRow",value:function(e){this.toggleRow(e,!1)}},{key:"toggleRow",value:function(e,t){var i=void 0;if(e.hasOwnProperty("index")?i=this.getData()[e.index]:e.hasOwnProperty("uniqueId")&&(i=this.getRowByUniqueId(e.uniqueId)),i){var n=z.findIndex(this.hiddenRows,i);t||-1!==n?t&&-1<n&&this.hiddenRows.splice(n,1):this.hiddenRows.push(i),this.initBody(!0)}}},{key:"getHiddenRows",value:function(e){if(e)return this.initHiddenRows(),void this.initBody(!0);var t=this.getData(),i=[],n=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var l=s.value;this.hiddenRows.includes(l)&&i.push(l)}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return this.hiddenRows=i}},{key:"mergeCells",value:function(e){var t=e.index,i=this.getVisibleFields().indexOf(e.field),n=e.rowspan||1,r=e.colspan||1,o=void 0,s=void 0,a=this.$body.find(">tr");this.options.detailView&&!this.options.cardView&&(i+=1);var l=a.eq(t).find(">td").eq(i);if(!(t<0||i<0||t>=this.data.length)){for(o=t;o<t+n;o++)for(s=i;s<i+r;s++)a.eq(o).find(">td").eq(s).hide();l.attr("rowspan",n).attr("colspan",r).show()}}},{key:"updateCell",value:function(e){e.hasOwnProperty("index")&&e.hasOwnProperty("field")&&e.hasOwnProperty("value")&&(this.data[e.index][e.field]=e.value,!1!==e.reinit&&(this.initSort(),this.initBody(!0)))}},{key:"updateCellById",value:function(e){var o=this;e.hasOwnProperty("id")&&e.hasOwnProperty("field")&&e.hasOwnProperty("value")&&((Array.isArray(e)?e:[e]).forEach(function(e){var t=e.id,i=e.field,n=e.value,r=o.options.data.indexOf(o.getRowByUniqueId(t));-1!==r&&(o.data[r][i]=n)}),!1!==e.reinit&&(this.initSort(),this.initBody(!0)))}},{key:"getOptions",value:function(){var e=V.extend({},this.options);return delete e.data,V.extend(!0,{},e)}},{key:"getSelections",value:function(){var t=this;return this.options.data.filter(function(e){return!0===e[t.header.stateField]})}},{key:"getAllSelections",value:function(){var t=this;return this.options.data.filter(function(e){return e[t.header.stateField]})}},{key:"checkAll",value:function(){this.checkAll_(!0)}},{key:"uncheckAll",value:function(){this.checkAll_(!1)}},{key:"checkInvert",value:function(){var e=this.$selectItem.filter(":enabled"),t=e.filter(":checked");e.each(function(e,t){V(t).prop("checked",!V(t).prop("checked"))}),this.updateRows(),this.updateSelected(),this.trigger("uncheck-some",t),t=this.getSelections(),this.trigger("check-some",t)}},{key:"checkAll_",value:function(e){var t=void 0;e||(t=this.getSelections()),this.$selectAll.add(this.$selectAll_).prop("checked",e),this.$selectItem.filter(":enabled").prop("checked",e),this.updateRows(),e&&(t=this.getSelections()),this.trigger(e?"check-all":"uncheck-all",t)}},{key:"check",value:function(e){this.check_(!0,e)}},{key:"uncheck",value:function(e){this.check_(!1,e)}},{key:"check_",value:function(e,t){var i=this.$selectItem.filter('[data-index="'+t+'"]'),n=this.data[t];if(i.is(":radio")||this.options.singleSelect){var r=!0,o=!1,s=void 0;try{for(var a,l=this.options.data[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){a.value[this.header.stateField]=!1}}catch(e){o=!0,s=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw s}}this.$selectItem.filter(":checked").not(i).prop("checked",!1)}n[this.header.stateField]=e,i.prop("checked",e),this.updateSelected(),this.trigger(e?"check":"uncheck",this.data[t],i)}},{key:"checkBy",value:function(e){this.checkBy_(!0,e)}},{key:"uncheckBy",value:function(e){this.checkBy_(!1,e)}},{key:"checkBy_",value:function(n,r){var o=this;if(r.hasOwnProperty("field")&&r.hasOwnProperty("values")){var s=[];this.options.data.forEach(function(e,t){if(!e.hasOwnProperty(r.field))return!1;if(r.values.includes(e[r.field])){var i=o.$selectItem.filter(":enabled").filter(z.sprintf('[data-index="%s"]',t)).prop("checked",n);e[o.header.stateField]=n,s.push(e),o.trigger(n?"check":"uncheck",e,i)}}),this.updateSelected(),this.trigger(n?"check-some":"uncheck-some",s)}}},{key:"destroy",value:function(){this.$el.insertBefore(this.$container),V(this.options.toolbar).insertBefore(this.$el),this.$container.next().remove(),this.$container.remove(),this.$el.html(this.$el_.html()).css("margin-top","0").attr("class",this.$el_.attr("class")||"")}},{key:"showLoading",value:function(){this.$tableLoading.show()}},{key:"hideLoading",value:function(){this.$tableLoading.hide()}},{key:"togglePagination",value:function(){this.options.pagination=!this.options.pagination;var e=this.$toolbar.find('button[name="paginationSwitch"] i');this.options.pagination?e.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchDown):e.attr("class",this.options.iconsPrefix+" "+this.options.icons.paginationSwitchUp),this.updatePagination()}},{key:"toggleFullscreen",value:function(){this.$el.closest(".bootstrap-table").toggleClass("fullscreen")}},{key:"refresh",value:function(e){e&&e.url&&(this.options.url=e.url),e&&e.pageNumber&&(this.options.pageNumber=e.pageNumber),e&&e.pageSize&&(this.options.pageSize=e.pageSize),this.initServer(e&&e.silent,e&&e.query,e&&e.url),this.trigger("refresh",e)}},{key:"resetWidth",value:function(){this.options.showHeader&&this.options.height&&this.fitHeader(),this.options.showFooter&&!this.options.cardView&&this.fitFooter()}},{key:"showColumn",value:function(e){this.toggleColumn(this.fieldsColumnsIndex[e],!0,!0)}},{key:"hideColumn",value:function(e){this.toggleColumn(this.fieldsColumnsIndex[e],!1,!0)}},{key:"getHiddenColumns",value:function(){return this.columns.filter(function(e){return!e.visible})}},{key:"getVisibleColumns",value:function(){return this.columns.filter(function(e){return e.visible})}},{key:"toggleAllColumns",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,o=this.columns[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){r.value.visible=e}}catch(e){i=!0,n=e}finally{try{!t&&o.return&&o.return()}finally{if(i)throw n}}if(this.initHeader(),this.initSearch(),this.initPagination(),this.initBody(),this.options.showColumns){var s=this.$toolbar.find(".keep-open input").prop("disabled",!1);s.filter(":checked").length<=this.options.minimumCountColumns&&s.filter(":checked").prop("disabled",!0)}}},{key:"showAllColumns",value:function(){this.toggleAllColumns(!0)}},{key:"hideAllColumns",value:function(){this.toggleAllColumns(!1)}},{key:"filterBy",value:function(e){this.filterColumns=V.isEmptyObject(e)?{}:e,this.options.pageNumber=1,this.initSearch(),this.updatePagination()}},{key:"scrollTo",value:function(e){if(void 0===e)return this.$tableBody.scrollTop();var t=e;"string"==typeof e&&"bottom"===e&&(t=this.$tableBody[0].scrollHeight),this.$tableBody.scrollTop(t)}},{key:"getScrollPosition",value:function(){return this.scrollTo()}},{key:"selectPage",value:function(e){0<e&&e<=this.options.totalPages&&(this.options.pageNumber=e,this.updatePagination())}},{key:"prevPage",value:function(){1<this.options.pageNumber&&(this.options.pageNumber--,this.updatePagination())}},{key:"nextPage",value:function(){this.options.pageNumber<this.options.totalPages&&(this.options.pageNumber++,this.updatePagination())}},{key:"toggleView",value:function(){this.options.cardView=!this.options.cardView,this.initHeader();var e=this.$toolbar.find('button[name="toggle"] i');this.options.cardView?(e.removeClass(this.options.icons.toggleOff),e.addClass(this.options.icons.toggleOn)):(e.removeClass(this.options.icons.toggleOn),e.addClass(this.options.icons.toggleOff)),this.initBody(),this.trigger("toggle",this.options.cardView)}},{key:"refreshOptions",value:function(e){z.compareObjects(this.options,e,!0)||(this.options=V.extend(this.options,e),this.trigger("refresh-options",this.options),this.destroy(),this.init())}},{key:"resetSearch",value:function(e){var t=this.$toolbar.find(".search input");t.val(e||""),this.onSearch({currentTarget:t})}},{key:"expandRow_",value:function(e,t){var i=this.$body.find(z.sprintf('> tr[data-index="%s"]',t));i.next().is("tr.detail-view")===!e&&i.find("> td > .detail-icon").click()}},{key:"expandRow",value:function(e){this.expandRow_(!0,e)}},{key:"collapseRow",value:function(e){this.expandRow_(!1,e)}},{key:"expandAllRows",value:function(e){var t=this;if(e){var i=this.$body.find(z.sprintf('> tr[data-index="%s"]',0)),n=null,r=!1,o=-1;if(i.next().is("tr.detail-view")?i.next().next().is("tr.detail-view")||(i.next().find(".detail-icon").click(),r=!0):(i.find("> td > .detail-icon").click(),r=!0),r)try{o=setInterval(function(){0<(n=t.$body.find("tr.detail-view").last().find(".detail-icon")).length?n.click():clearInterval(o)},1)}catch(e){clearInterval(o)}}else for(var s=this.$body.children(),a=0;a<s.length;a++)this.expandRow_(!0,V(s[a]).data("index"))}},{key:"collapseAllRows",value:function(e){if(e)this.expandRow_(!1,0);else for(var t=this.$body.children(),i=0;i<t.length;i++)this.expandRow_(!1,V(t[i]).data("index"))}},{key:"updateFormatText",value:function(e,t){this.options[z.sprintf("format%s",e)]&&("string"==typeof t?this.options[z.sprintf("format%s",e)]=function(){return t}:"function"==typeof t&&(this.options[z.sprintf("format%s",e)]=t)),this.initToolbar(),this.initPagination(),this.initBody()}}]),s}();l.DEFAULTS=i,l.LOCALES=n,l.COLUMN_DEFAULTS=r,l.EVENTS={"all.bs.table":"onAll","click-cell.bs.table":"onClickCell","dbl-click-cell.bs.table":"onDblClickCell","click-row.bs.table":"onClickRow","dbl-click-row.bs.table":"onDblClickRow","sort.bs.table":"onSort","check.bs.table":"onCheck","uncheck.bs.table":"onUncheck","check-all.bs.table":"onCheckAll","uncheck-all.bs.table":"onUncheckAll","check-some.bs.table":"onCheckSome","uncheck-some.bs.table":"onUncheckSome","load-success.bs.table":"onLoadSuccess","load-error.bs.table":"onLoadError","column-switch.bs.table":"onColumnSwitch","page-change.bs.table":"onPageChange","search.bs.table":"onSearch","toggle.bs.table":"onToggle","pre-body.bs.table":"onPreBody","post-body.bs.table":"onPostBody","post-header.bs.table":"onPostHeader","expand-row.bs.table":"onExpandRow","collapse-row.bs.table":"onCollapseRow","refresh-options.bs.table":"onRefreshOptions","reset-view.bs.table":"onResetView","refresh.bs.table":"onRefresh","scroll-body.bs.table":"onScrollBody"};var u=["getOptions","getSelections","getAllSelections","getData","load","append","prepend","remove","removeAll","insertRow","updateRow","updateCell","updateByUniqueId","removeByUniqueId","getRowByUniqueId","showRow","hideRow","getHiddenRows","mergeCells","refreshColumnTitle","checkAll","uncheckAll","checkInvert","check","uncheck","checkBy","uncheckBy","refresh","resetView","resetWidth","destroy","showLoading","hideLoading","showColumn","hideColumn","getHiddenColumns","getVisibleColumns","showAllColumns","hideAllColumns","filterBy","scrollTo","getScrollPosition","selectPage","prevPage","nextPage","togglePagination","toggleView","refreshOptions","resetSearch","expandRow","collapseRow","expandAllRows","collapseAllRows","updateFormatText","updateCellById"];V.BootstrapTable=l,V.fn.bootstrapTable=function(o){for(var e=arguments.length,s=Array(1<e?e-1:0),t=1;t<e;t++)s[t-1]=arguments[t];var a=void 0;return this.each(function(e,t){var i=V(t).data("bootstrap.table"),n=V.extend({},l.DEFAULTS,V(t).data(),"object"===(void 0===o?"undefined":h(o))&&o);if("string"==typeof o){var r;if(!u.includes(o))throw new Error("Unknown method: "+o);if(!i)return;a=(r=i)[o].apply(r,s),"destroy"===o&&V(t).removeData("bootstrap.table")}i||V(t).data("bootstrap.table",i=new V.BootstrapTable(t,n))}),void 0===a?this:a},V.fn.bootstrapTable.Constructor=l,V.fn.bootstrapTable.defaults=l.DEFAULTS,V.fn.bootstrapTable.columnDefaults=l.COLUMN_DEFAULTS,V.fn.bootstrapTable.locales=l.LOCALES,V.fn.bootstrapTable.methods=u,V.fn.bootstrapTable.utils=z,V(function(){V('[data-toggle="table"]').bootstrapTable()})}(jQuery)}),function(g){"use strict";g.extend(g.fn.bootstrapTable.defaults,{editable:!0,onEditableInit:function(){return!1},onEditableSave:function(e,t,i,n){return!1},onEditableShown:function(e,t,i,n){return i.parent("td").find('button[data-name="dereference-'+e+'"]').hide(),!1},onEditableHidden:function(e,t,i,n){return i.parent("td").find('button[data-name="dereference-'+e+'"]').show(),!1},dereference:!0,onDereferenceInit:function(){return!1}}),g.extend(g.fn.bootstrapTable.Constructor.EVENTS,{"editable-init.bs.table":"onEditableInit","editable-save.bs.table":"onEditableSave","editable-shown.bs.table":"onEditableShown","editable-hidden.bs.table":"onEditableHidden","dereference-init.bs.table":"onDereferenceInit"});var e=g.fn.bootstrapTable.Constructor,t=e.prototype.initTable,i=e.prototype.initBody;e.prototype.initTable=function(){var f=this;t.apply(this,Array.prototype.slice.apply(arguments)),(this.options.editable||this.options.dereference)&&g.each(this.columns,function(e,o){if(o.editable||o.dereference){var s={},a=[],r="editable-",l=function(e,t){var i=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()});if(i.slice(0,r.length)==r){var n=i.replace(r,"data-");s[n]=t}};g.each(f.options,l);var u={},c=[],d="dereference-",h=function(e,t){var i=e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()});if(i.slice(0,d.length)==d){var n=i.replace(d,"data-");u[n]=t}};g.each(f.options,h);var p=o.formatter;o.formatter=function(e,t,i){var n=p?p(e,t,i):e,r="";return o.editable&&(g.each(o,l),g.each(s,function(e,t){a.push(" "+e+'="'+t+'"')}),r+=['<a href="javascript:void(0)"',' data-name="'+o.field+'"',' data-pk="'+t[f.options.idField]+'"',' data-value="'+n+'"',a.join(""),"></a>"].join("")),o.dereference&&(g.each(o,h),g.each(u,function(e,t){c.push(" "+e+'="'+t+'"')}),r+=[' <a href="javascript:void(0)"',' data-name="dereference-'+o.field+'"',' data-value="'+n+'"',c.join(""),"> ",'<i class="glyphicon glyphicon-link"></i>',"</button>"].join("")),r}}})},e.prototype.initBody=function(){var s=this;i.apply(this,Array.prototype.slice.apply(arguments)),this.options.editable&&(g.each(this.columns,function(e,r){if(r.editable){var o=s.getData(),t=s.$body.find('a[data-name="'+r.field+'"]');t.each(function(){if("function"==typeof r.editable){var e=o[g(this).parents("tr[data-index]").data("index")];g(this).editable(r.editable(e,r.field))}else g(this).editable(r.editable)}).off("save").on("save",function(e,t){var i=o[g(this).parents("tr[data-index]").data("index")],n=i[r.field];g(this).data("value",t.submitValue),i[r.field]=t.submitValue,s.trigger("editable-save",r.field,i,n,g(this))}),t.each(function(){if("function"==typeof r.editable){var e=o[g(this).parents("tr[data-index]").data("index")];g(this).editable(r.editable(e,r.field))}else g(this).editable(r.editable)}).off("shown").on("shown",function(e,t){var i=o[g(this).parents("tr[data-index]").data("index")];s.trigger("editable-shown",r.field,i,g(this),t)}),t.each(function(){if("function"==typeof r.editable){var e=o[g(this).parents("tr[data-index]").data("index")];g(this).editable(r.editable(e,r.field))}else g(this).editable(r.editable)}).off("hidden").on("hidden",function(e,t){var i=o[g(this).parents("tr[data-index]").data("index")];s.trigger("editable-hidden",r.field,i,g(this),t)})}}),this.trigger("editable-init")),this.options.dereference&&(g.each(this.columns,function(e,t){if(t.dereference){var i;s.getData();s.$body.find('a[data-name="dereference-'+t.field+'"]').off("click").on("click",(i=t.dereference,function(e,t){"function"==typeof i?i(g(this).attr("data-value")):console.log("Bad dereference definition")}))}}),this.trigger("dereference-init"))}}(jQuery),function(a,r){var l={type:null,showLangSelect:!0,selectize:!1,create:!0},t=function(e,t,i,n,r,o){var s=parseInt(e,10);return!isNaN(s)&&(!(!t&&0==s)&&(!(!i&&s<0)&&(!(!n&&0<s)&&(!(null!=r&&r<s)&&!(null!=o&&s<o)))))},e=function(e){return a.isNumeric(e)},u={"http://www.w3.org/2000/01/rdf-schema#Literal":{label:"Plain Literal"},"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource":{label:"Reference"},"http://www.w3.org/2001/XMLSchema#integer":{label:"Integer",verify:function(e){return t(e,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#decimal":{label:"Decimal",verify:e},"http://www.w3.org/2001/XMLSchema#double":{label:"Double",verify:e},"http://www.w3.org/2001/XMLSchema#float":{label:"Float",verify:e},"http://www.w3.org/2001/XMLSchema#nonPositiveInteger":{label:"Non-Positive Integer",verify:function(e){return t(e,!0,!0,!1)}},"http://www.w3.org/2001/XMLSchema#negativeInteger":{label:"Negative Integer",verify:function(e){return t(e,!1,!0,!1)}},"http://www.w3.org/2001/XMLSchema#long":{label:"Long",verify:function(e){return t(e,!0,!0,!0)}},"http://www.w3.org/2001/XMLSchema#int":{label:"Int",verify:function(e){return t(e,!0,!0,!0,2147483647,-2147483648)}},"http://www.w3.org/2001/XMLSchema#short":{label:"Short",verify:function(e){return t(e,!0,!0,!0,32767,-32768)}},"http://www.w3.org/2001/XMLSchema#byte":{label:"Byte",verify:function(e){return t(e,!0,!0,!0,127,-128)}},"http://www.w3.org/2001/XMLSchema#nonNegativeInteger":{label:"Non-Negative Integer",verify:function(e){return t(e,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedLong":{label:"Unsigned Long",verify:function(e){return t(e,!0,!1,!0)}},"http://www.w3.org/2001/XMLSchema#unsignedInt":{label:"Unsigned Int",verify:function(e){return t(e,!0,!1,!0,4294967295)}},"http://www.w3.org/2001/XMLSchema#unsignedShort":{label:"Unsigned Short",verify:function(e){return t(e,!0,!1,!0,65535)}},"http://www.w3.org/2001/XMLSchema#unsignedByte":{label:"Unsigned Byte",verify:function(e){return t(e,!0,!0,!0,255)}},"http://www.w3.org/2001/XMLSchema#positiveInteger":{label:"Positive Integer",verify:function(e){return t(e,!1,!1,!0)}},"http://www.w3.org/2001/XMLSchema#boolean":{label:"Boolean",setup:function(e,t){t?(e.bootstrapToggle&&e.bootstrapToggle("destroy"),e.attr("type","text")):(e.attr("type","checkbox"),e.bootstrapToggle({on:"True",off:"False"}))},getValue:function(e){return e.is(":checked")?"true":"false"},setValue:function(e,t){this.setup(e),t&&(t=t.toString().toLowerCase()),"1"===t||"true"===t?e.bootstrapToggle("on"):e.bootstrapToggle("off")}},"http://www.w3.org/2001/XMLSchema#string":{label:"String"},"http://www.w3.org/2001/XMLSchema#hexBinary":{label:"Hex Binary"},"http://www.w3.org/2001/XMLSchema#dateTime":{label:"Datetime",setup:function(e,t){t?e.datetimepicker("remove"):e.datetimepicker({format:"yyyy-mm-ddThh:ii:ssZ",weekStart:1,timezone:"Z"})}},"http://www.w3.org/2001/XMLSchema#date":{label:"Date",setup:function(e,t){t?e.datetimepicker("remove"):e.datetimepicker({format:"yyyy-mm-dd",weekStart:1})}}},i=function(e,t){var i=this;i.mainElement=e,i.options=a.extend({},l,t),i.currentType=i.options.type||"http://www.w3.org/2000/01/rdf-schema#Literal",i.mainElement.on("input",function(){i.checkHashSign(),i.verifyInput(),i.change()}),i.container=a(document.createElement("div")).addClass("rdfNodeEditor"),i.inputContainer=a(document.createElement("div")).addClass("rdfNodeInputContainer");var n=a(e).addClass("form-control");for(var r in n.after(i.container),i.inputContainer.append(n),i.container.append(i.inputContainer),i.options.choices&&("object"==typeof i.options.choices?i.selectizeSetup(i.options.choices):"function"==typeof i.options.choices&&i.options.choices(function(e){i.selectizeSetup(e)}),i.updateView(!1)),i.typeContainer=a(document.createElement("div")).addClass("rdfNodeTypeContainer"),i.typeContainer.css("vertical-align","top"),i.typeElement=a(document.createElement("select")).addClass("form-control"),u)i.typeElement.append(a(document.createElement("option")).attr("value",r).text(u[r].label));i.typeContainer.append(i.typeElement),i.container.append(i.typeContainer);var o=function(){i.lastType=i.currentType,i.currentType=i.options.selectize?i.typeElement[0].selectize.getValue():i.typeElement.val(),i.verifyFct=u[i.currentType].verify,i.updateEditor(),i.verifyInput(),i.change()};if(i.options.selectize?(i.typeElement.selectize({onChange:o}),i.typeElement[0].selectize.setValue(this.currentType)):i.typeElement.change(o),i.options.type&&(i.typeElement.val(i.options.type),i.typeContainer.hide()),i.languageElement=a(document.createElement("input")).addClass("form-control").attr("placeholder","Language"),i.languageContainer=a(document.createElement("div")).addClass("rdfNodelanguageContainer"),i.languageContainer.css("vertical-align","top"),i.languageContainer.append(i.languageElement),i.container.append(i.languageContainer),"http://www.w3.org/2000/01/rdf-schema#Literal"===i.currentType&&i.options.showLangSelect||i.languageContainer.hide(),i.languageElement.on("input",function(){i.lang=i.languageElement.val(),i.verifyInput(),i.change()}),i.options.dereferenceLink){i.dereferenceLink=a(document.createElement("button")),i.dereferenceLink.attr("type","button").addClass("btn btn-default btn-sm"),i.dereferenceLink.html('<i class="glyphicon glyphicon-link"></i>');var s=a(document.createElement("div")).addClass("rdfe-reference-link");s.append(i.dereferenceLink),i.mainElement.closest(".editable-input").length?i.container.parent().after(s):i.container.after(s),i.dereferenceLink.on("click",function(){var e=i.getValue();e&&i.options.dereferenceLink(e.value)})}i.updateEditor(!0)};i.prototype.change=function(){a(this).trigger("changed",this)},i.prototype.selectizeSetup=function(e){var t=this;t.resourceContainer||(t.resourceSelect=a(document.createElement("select")),t.resourceSelect.attr("placeholder","Select/Enter resource"),t.resourceContainer=a(document.createElement("div")).addClass("rdfResourceContainer"),t.resourceContainer.append(t.resourceSelect),t.resourceContainer.css("min-width","200px"),t.inputContainer.append(t.resourceContainer)),t.resourceSelectize||(t.resourceSelect.selectize({delimiter:null,valueField:"value",searchField:["label"],sortField:["label"],lockOptgroupOrder:!0,create:function(e,t){var i=new r.RdfNode("uri",e);i.label=e,i.optgroup="local",t(this.options[e]=i)},createOnBlur:!0,onChange:function(e){t.mainElement.val(e),t.change()},render:{item:function(e,t){return"<div>"+t(e.label||e.value)+"</div>"},option:function(e,t){return e.label?"<div>"+t(e.label)+" <small>("+t(e.value)+")</small></div>":"<div>"+t(e.value)+"</div>"},option_create:function(e,t){var i=e.input;return(i=r.Utils.trim(r.Utils.trim(i,"<"),">"))!=e.input?'<div class="create">Add <strong>'+t(e.input)+"</strong> <small>("+t(i)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+t(i)+"</strong>&hellip;</div>"}}}),t.resourceSelectize=a(t.resourceSelect)[0].selectize),t.resourceSelectize.clearOptions(),t.resourceSelectize.clearOptionGroups(),t.resourceSelectize.addOptionGroup("local",{label:"Local Store"});for(var i=0;i<e.length;i++)e[i].optgroup="local";t.resourceSelectize.addOption(e)},i.prototype.updateSelection=function(e,t){var i=this.resourceSelectize;if(i){i.addOptionGroup(e,{label:e});for(var n=0;n<t.length;n++)t[n].optgroup=e;i.addOption(t),i.refreshOptions(!0)}};var n,o=(n=["http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#string"],function(e,t){return e===t||0<=a.inArray(e,n)&&0<=a.inArray(t,n)});i.prototype.updateEditor=function(e){var t=this;o(t.options.type,t.currentType)?t.typeContainer.hide():t.typeContainer.css("display","table-cell"),t.options.showLangSelect&&"http://www.w3.org/2000/01/rdf-schema#Literal"===t.currentType?t.languageContainer.css("display","table-cell"):t.languageContainer.hide(),(e||t.lastType!==t.currentType)&&(t.lastType&&u[t.lastType].setup&&u[t.lastType].setup(t.mainElement,!0),u[t.currentType].setup&&u[t.currentType].setup(t.mainElement),t.updateView("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==t.currentType))},i.prototype.getField=function(){return"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===this.currentType?this.resourceSelectize:this.mainElement},i.prototype.getValue=function(){return"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===this.currentType?new r.RdfNode("uri",r.Utils.trim(r.Utils.trim(this.mainElement.val(),"<"),">")):new r.RdfNode("literal",u[this.currentType].getValue?u[this.currentType].getValue(this.mainElement):this.mainElement.val(),this.currentType,this.lang?this.lang:void 0)},i.prototype.setValue=function(e,t){if(e){var i=this;if(e=r.RdfNode.fromStoreNode(e),i.lastType=i.currentType,"uri"===e.type||i.startsWithHashSign())i.currentType="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",t?(i.selectizeSetup(t),i.updateView(!1)):i.updateView(!0);else if(i.updateView(!0),i.currentType=e.datatype||"http://www.w3.org/2000/01/rdf-schema#Literal","http://www.w3.org/2001/XMLSchema#boolean"===i.options.type){var n=e.value.toString();"0"!==n&&"1"!==n&&"true"!==n.toLowerCase()&&"false"!==n.toLowerCase()||(i.currentType="http://www.w3.org/2001/XMLSchema#boolean")}i.lang=e.language,e.value&&e.value.indexOf&&-1!==e.value.indexOf("\n")&&i.transformToTextarea(),i.mainElement.val(e.value),i.resourceSelectize&&r.Utils.trim(e.value,"")&&(e.optgroup||(e.optgroup="local"),i.resourceSelectize.addOption(e),i.resourceSelectize.setValue(e.value)),u[i.currentType]&&u[i.currentType].setValue&&u[i.currentType].setValue(i.mainElement,i.mainElement.val()),i.languageElement.val(i.lang),i.typeElement.val(i.currentType),i.options.selectize&&i.typeElement[0].selectize.setValue(i.currentType),i.updateEditor(i.lastType!==i.currentType),i.lastType=i.currentType}},i.prototype.updateView=function(e){var t=this;t.dereferenceLink&&("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===t.currentType?t.dereferenceLink.show():t.dereferenceLink.hide()),t.inputContainer.css("width","auto"),e?(t.mainElement.show(),t.resourceContainer&&t.resourceContainer.hide()):t.resourceContainer?(t.inputContainer.css("width","50%"),t.resourceContainer.show(),t.mainElement.hide()):t.mainElement.show()},i.prototype.isValid=function(e){return!this.verifyFct||this.verifyFct(this.mainElement.val())},i.prototype.startsWithHashSign=function(){if(!0!==this.options.startHashSignAsResource)return!1;var e=r.Utils.trim(a(this.mainElement).val());return 1<=e.length&&"#"===e.charAt(0)},i.prototype.checkHashSign=function(){this.startsWithHashSign()&&("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==(this.options.selectize?this.typeElement[0].selectize.getValue():this.typeElement.val())&&(this.options.selectize?(this.typeElement[0].selectize.setValue("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"),this.typeElement[0].selectize.onChange()):(this.typeElement.val("http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"),this.typeElement.change())))},i.prototype.verifyInput=function(){var e=a(this.mainElement).val(),t=!0;0<e.length&&(t=!this.verifyFct||this.verifyFct(e)),t?this.mainElement.removeClass("has-error"):this.mainElement.addClass("has-error")},i.prototype.isLiteralType=function(e){return u.hasOwnProperty(e)&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!=e},i.prototype.setEditFocus=function(){this.getField()&&this.getField().focus()},i.prototype.blur=function(){this.getField().blur()},i.prototype.getElement=function(){return this.container},i.prototype.transformToTextarea=function(){if("INPUT"===this.mainElement.prop("tagName")&&"text"===this.mainElement.prop("type")){var e=document.createElement("textarea");e.id=this.mainElement.prop("id"),e.name=this.mainElement.prop("name"),e.value=this.mainElement.val(),a(e).addClass(this.mainElement.prop("class")),this.mainElement.replaceWith(e),this.mainElement=a(e)}},a.fn.rdfNodeEditor=function(e){var t=this.data("rdfNodeEditor");return t||(t=new i(this,e),this.data("rdfNodeEditor",t)),t}}(window.jQuery,RDFE),function(i,c){var t=function(e){this.init("rdfnode",e,t.defaults)};i.fn.editableutils.inherit(t,i.fn.editabletypes.abstractinput),i.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("input"),this.setClass(),this.$input.rdfNodeEditor(this.options.rdfnode)},activate:function(){this.$input.rdfNodeEditor().setEditFocus()},value2html:function(e,t){e||!1===e?i(t).text(e.toString()):i(t).empty()},html2value:function(e){return null},input2value:function(){return this.$input.rdfNodeEditor().getValue()},value2input:function(e){var t,i,n=this.$input.rdfNodeEditor(),r=function(){return e instanceof c.RdfNode?e.value:e};if(e instanceof c.RdfNode&&(t=e),!t||t&&"uri"===t.type){if(this.options&&this.options.rdfnode){var o=this.options.rdfnode,s=o.ontologyManager;if(s){var a=s.ontologyPropertyByURI(o.predicate);if(a){var l=a.getRange();if(l&&l.length){for(var u=0;u<l.length;u++)if(n.isLiteralType(l[u])){t=new c.RdfNode("literal",r(),l[u]);break}if(!t||t&&"uri"===t.type)if(i=o.document.itemsByRange(l))t=new c.RdfNode("uri",r());else for(u=0;u<l.length;u++)if(n.isLiteralType(l[u])){t=new c.RdfNode("literal",r(),l[u]);break}}}}}t||(t=this.options&&this.options.rdfnode&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"===this.options.rdfnode.type?new c.RdfNode("uri",r(),"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"):new c.RdfNode("literal",r(),this.options.rdfnode.type))}n.setValue(t,i)}}),t.defaults=i.extend({},i.fn.editabletypes.abstractinput.defaults,{rdfnode:{},tpl:'<input type="text">'}),i.fn.editabletypes.rdfnode=t}(window.jQuery,RDFE),function(o){var i=function(e,t){var r=this;r.options=o.extend({},t),r.options.ontologyManager=r.options.ontologyManager||new RDFE.OntologyManager,r.mainElem=e,o(r.options.ontologyManager).on("changed",function(e,t){r.sel.addOption(t.allOntologies())}),o(r.mainElem).selectize({valueField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:r.options.ontologyManager.ontologiesAsArray(),onChange:function(e){o(r).trigger("changed",r.options.ontologyManager.ontologyByURI(e))},createOntology:function(e,t){return r.options.ontologyManager.ontologyByURI(r.options.ontologyManager.ontologyDetermine(e),t)},create:function(t,i){var n=this,e=r.options.ontologyManager.ontologyDetermine(t);e||(e=r.options.ontologyManager.prefixes[t]||t),r.options.ontologyManager.parseOntologyFile(e,{success:function(){i(n.settings.createOntology(t,!0))},error:function(e){e&&e.message&&o.notify({message:e.message},{type:"danger"}),i(n.settings.createOntology(t,!0))}})},render:{item:function(e,t){return"<div>"+t(e.title||e.label||e.prefix||e.URI)+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||e.prefix||e.URI)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var i=r.options.ontologyManager.prefixes[e.input]||e.input;return i!=e.input?'<div class="create">Load <strong>'+t(e.input)+"</strong> <small>("+t(i)+")</small>&hellip;</div>":'<div class="create">Load <strong>'+t(i)+"</strong>&hellip;</div>"}}}),r.sel=o(r.mainElem)[0].selectize};i.prototype.selectedOntologyURI=function(){return this.sel.getValue()},i.prototype.selectedOntology=function(){return this.sel.options[this.selectedOntologyURI()]},i.prototype.on=function(e,t){o(this).on(e,t)},o.fn.ontoBox=function(e){var t=this.data("ontoBox");return t||(t=new i(this,e),this.data("ontoBox",t)),t}}(window.jQuery),function(n,a){var r=function(e,t){var s=this;if(s.options=n.extend({},r.defaults,t),s.options.ontologyManager=s.options.ontologyManager||new a.OntologyManager,s.mainElement=e,n(s.options.ontologyManager).on("changed",function(e,t,i){s.updateOptions()}),n(s.mainElement).selectize({delimiter:null,valueField:"URI",searchField:["title","label","prefix","curi","URI"],sortField:["prefix","URI"],options:s.propertyList(),onChange:function(e){n(s).trigger("changed",s.sel.options[e])},createProperty:function(e,t){return s.options.ontologyManager.ontologyPropertyByURI(s.options.ontologyManager.uriDenormalize(e),t)},create:function(i,n){var r=this,e=!1;"a"===(i=a.Utils.trim(a.Utils.trim(i,"<"),">"))?(i="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",e=!0):i.startsWith("#")&&(e=!0);var t=this.settings.createProperty(i,e);if(t)n(t);else{var o=s.options.ontologyManager.ontologyDetermine(i);o||(o=s.options.ontologyManager.prefixes[i]||i),s.options.ontologyManager.parseOntologyFile(o,{success:function(){n(r.settings.createProperty(i,!0))},error:function(e){var t=e&&e.message?e.message:"Error loading ontology";console.log(t),bootbox.confirm(t+". Do you want to create new property?",function(e){if(e){var t=s.options.ontologyManager.ontologyByURI(o);t||((t=s.options.ontologyManager.ontologyByURI(o))||(t=new a.Ontology(s.options.ontologyManager,o)),n(r.settings.createProperty(i,!0)))}else r.unlock()})}})}},render:{item:function(e,t){var i=e.title||e.label||e.curi||e.name;return"<div>"+(i=e.curi&&e.curi!=i?t(i)+" <small>("+t(e.curi)+")</small>":t(i))+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||e.curi||e.name)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var i=e.input;return i=a.Utils.trim(a.Utils.trim(i,"<"),">"),(i=s.options.ontologyManager.uriDenormalize(i))!=e.input?'<div class="create">Add <strong>'+t(e.input)+"</strong> <small>("+t(i)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+t(i)+"</strong>&hellip;</div>"}}}),s.options.dereferenceLink){s.dereferenceLink=n(document.createElement("button")),s.dereferenceLink.attr("type","button").addClass("btn btn-default btn-sm"),s.dereferenceLink.html('<i class="glyphicon glyphicon-link"></i>');var i=n(document.createElement("div")).addClass("rdfe-reference-link");i.append(s.dereferenceLink),s.mainElement.closest(".editable-input").length?s.mainElement.parent().after(i):s.mainElement.parent().append(i),s.dereferenceLink.on("click",function(){s.options.dereferenceLink(s.selectedURI())})}s.sel=n(s.mainElement)[0].selectize};r.defaults={ontologyManager:null,ontology:null},r.prototype.setOntology=function(e){this.options.ontology=e,this.updateOptions()},r.prototype.propertyList=function(){return this.options.ontology?this.options.ontology.allProperties():this.options.ontologyManager.allProperties()},r.prototype.updateOptions=function(){var e=this.selectedURI(),t=this.propertyList();this.sel.clearOptions(),this.sel.addOption(t),this.setPropertyURI(e)},r.prototype.setPropertyURI=function(e){if(e){var t=this.options.ontologyManager.uriDenormalize(e);t=a.Utils.trim(a.Utils.trim(t,"<"),">"),this.sel.options[t]||this.sel.addOption(this.options.ontologyManager.ontologyPropertyByURI(t,!0)),this.sel.setValue(t)}else this.sel.setValue(null)},r.prototype.selectedURI=function(){return this.sel.getValue()},r.prototype.selectedProperty=function(){return this.sel.options[this.selectedURI()]},r.prototype.on=function(e,t){return n(this).on(e,t),this},n.fn.propertyBox=function(e){var t=this.data("propertyBox");return t||(t=new r(this,e),this.data("propertyBox",t)),t}}(window.jQuery,RDFE),function(i){var t=function(e){this.init("rdfnode",e,t.defaults)};i.fn.editableutils.inherit(t,i.fn.editabletypes.abstractinput),i.extend(t.prototype,{render:function(){this.$input=this.$tpl.filter("select"),this.setClass(),this.$input.propertyBox(this.options.propertyBox),this.$input.propertyBox().sel.$control.css("min-width","250px")},activate:function(){},value2html:function(e,t){e?i(t).text(e.toString()):i(t).empty()},html2value:function(e){return null},input2value:function(){return this.$input.propertyBox().selectedURI()},value2input:function(e){this.$input.propertyBox().setPropertyURI(e)}}),t.defaults=i.extend({},i.fn.editabletypes.abstractinput.defaults,{propertyBox:{},tpl:"<select></select>"}),i.fn.editabletypes.propertyBox=t}(window.jQuery),function(f){var e;window.RDFE||(window.RDFE={}),RDFE.TripleView=((e=function(e){this.editor=e}).prototype.render=function(c,d){var h,p=this;p.editor.doc.listProperties(function(e){p.editor.doc.store.graph(p.editor.doc.graph,function(e,t){if(e)f(p.editor).trigger("rdf-editor-error",{type:"triple-list-error",message:e});else{c.empty();var o=f(document.createElement("table")).addClass("table");c.append(o);for(var i=t.toArray(),n=0;n<i.length;n+=1)i[n].id=n;o.data("maxindex",n);var r=1,s=10,a="subject",l="asc",u=p.editor.config.options.pageSettings;u.pageNo&&(r=u.pageNo),u.pageSize&&(s=u.pageSize),u.sortName&&(a=u.sortName),u.sortOrder&&(l=u.sortOrder),o.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:r,pageSize:s,search:!0,sortName:a,sortOrder:l,searchAlign:"left",showHeader:!0,data:i,editable:!0,dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",p.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",p.editor.namingSchema()),sortable:!0,editable:p.editor.editableSubject(p.editor),formatter:p.editor.nodeFormatter},{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",p.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",p.editor.namingSchema()),sortable:!0,editable:p.editor.editablePredicate(p.editor),formatter:p.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",p.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",p.editor.namingSchema()),sortable:!0,editable:p.editor.editableObject(p.editor,function(e){return e.predicate.toString()}),formatter:p.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add a new statement to the document"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(e,t,i){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(e,t,i,n){var r=i;p.editor.doc.deleteTriple(r,function(){o.bootstrapTable("remove",{field:"id",values:[i.id]}),f(p.editor).trigger("rdf-editor-success",{type:"triple-delete-success",message:"Successfully deleted triple."})},function(){f(p.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),o.on("editable-shown.bs.table",function(e,t,i){h=_.clone(i)}),o.on("editable-save.bs.table",function(e,t,i){p.editor.dataSetter(t,h,i)}),o.on("page-change.bs.table",function(e,t,i){f(p.editor).trigger("rdf-editor-page",{pageNo:t,pageSize:i})}),o.on("sort.bs.table",function(e,t,i){f(p.editor).trigger("rdf-editor-page",{sortName:t,sortOrder:i})}),f(o).find(".add").on("click",function(e){p.editor.editTriple()}),p.tripleTable=o,d&&d()}})})},e.prototype.addTriple=function(e){var t=this.tripleTable.data("maxindex");this.tripleTable.bootstrapTable("append",f.extend(e,{id:t})),this.tripleTable.data("maxindex",t+1)},e)}(jQuery),Backbone.Form.editors.Rdfnode=Backbone.Form.editors.Base.extend({tagName:"input",events:{change:function(){this.trigger("change",this)},focus:function(){this.trigger("focus",this)},blur:function(){this.trigger("blur",this)},keyup:function(e,t){13==e.keyCode&&e.shiftKey&&(console.log("shift+enter"),this.editor&&this.editor.transformToTextarea(),e.stopPropagation()),this.trigger("keyup",this)}},initialize:function(e){Backbone.Form.editors.Base.prototype.initialize.call(this,e)},render:function(){var e=this;return this.$el.attr("type","text"),this.$el.rdfNodeEditor(this.schema.rdfnode),e.editor=this.$el.rdfNodeEditor(),e.setElement(e.editor.getElement()),$(this.editor).on("change",function(){e.trigger("change",this)}),this.setValue(this.value),this},getValue:function(){return this.editor.getValue()},setValue:function(e){this.editor.setValue(e)},focus:function(){this.hasFocus||this.editor.setEditFocus()},blur:function(){this.hasFocus&&this.editor.blur()}}),Backbone.Form.editors.NestedRdf=Backbone.Form.editors.Object.extend({initialize:function(e){if(Backbone.Form.editors.Base.prototype.initialize.call(this,e),!this.form)throw new Error('Missing required option "form"');if(!e.schema.model)throw new Error('Missing required "schema.model" option for NestedRdf editor')},render:function(){var e=this.form.constructor,t=this.value,i=(this.key,this.schema.model),n=t||new i;return this.nestedForm=new e({model:n,idPrefix:this.id+"_",fieldTemplate:"nestedField"}),this._observeFormEvents(),this.$el.html(this.nestedForm.render().el),this.hasFocus&&this.trigger("blur",this),this},getValue:function(){var e=this.nestedForm.getValue();if(this.nestedForm.model.defaults){var t=!1;for(var i in e)if(e[i])for(var n=0;n<e[i].length;n++)if(e[i][n].value){t=!0;break}t&&(e=_.extend({},this.nestedForm.model.defaults,e))}return{uri:this.nestedForm.model.uri,values:e}}}),window.RDFE||(window.RDFE={}),RDFE.EntityModel=Backbone.Model.extend({setEntity:function(e,t){this.doc=e,this.uri=t,this.individualsCache={}},addValue:function(e,t){var i=this.get(e)||[];i.push(t),this.set(e,i)},getIndividuals:function(e,t){if(this.individualsCache[e])t(this.individualsCache[e]);else{var i=[],n=this.doc.ontologyManager.ontologyClassByURI(e);if(e&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource"!==e?"http://www.w3.org/2000/01/rdf-schema#Class"===e?i=this.doc.ontologyManager.ontologyClasses:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Property"===e?i=this.doc.ontologyManager.ontologyProperties:n&&(i=n.getIndividuals(!0)):i=this.doc.ontologyManager.individuals,i=_.map(_.values(i),function(e){var t=new RDFE.RdfNode("uri",e.URI);return t.label=e.label||e.name,t}),this.doc.listEntities(e,function(e){$.merge(i,e)}),n)for(var r=n.getSubClasses(!0),o=0,s=r.length;o<s;o++)this.doc.listEntities(r[o].URI,function(e){$.merge(i,e)});t(this.individualsCache[e]=i)}},maxCardinalityForProperty:function(e){for(var t=0;t<this.types.length;t++){var i=this.types[t].maxCardinalityForProperty(e);if(i)return i}return null},restrictionsForProperty:function(e){for(var t=0;t<this.types.length;t++){var i=this.types[t].restrictions[e];if(i)return i}return null},isAggregateProperty:function(e){for(var t=0;t<this.types.length;t++)if(this.types[t].isAggregateProperty(e))return!0;return!1},addSchemaEntryForProperty:function(e){var t,i,n=this,r=e.URI?e:n.doc.ontologyManager.ontologyProperties[e]||{URI:e},o=this.restrictionsForProperty(e);o&&(t=o.hasCustomLabel,i=o.hasCustomComment);var s=RDFE.Utils.createTitle(t||r.label||r.title||RDFE.Utils.uri2name(r.URI)),a={titleHTML:'<span title="{0}">{1}</span>'.format(RDFE.Utils.escapeXml(r.URI),s),title:s,maxCardinality:n.maxCardinalityForProperty(r.URI),editorAttrs:{title:RDFE.coalesce(i,r.comment,r.description)}};if(n.isAggregateProperty(r.URI)){var l=r.getRange?n.doc.ontologyManager.ontologyClassByURI(r.getRange()):null;l?(a.type="List",a.itemType="NestedRdf",a.model=RDFE.EntityModel.extend({defaults:{"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":[new RDFE.RdfNode("uri",r.getRange())]},initialize:function(e){RDFE.EntityModel.prototype.initialize.call(this,e),this.doc=n.doc,this.buildSchemaFromTypes([l])},individualsCache:n.individualsCache}),a.editorAttrs.style="height:auto;"):(console.log("Caution: invalid range on aggregate: ",r),a.type="List",a.itemType="Rdfnode",a.rdfnode={type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",create:!0})}else{a.type="List",a.itemType="Rdfnode",a.rdfnode={};var u=_.result(r,"getRange");r.class==n.doc.ontologyManager.uriDenormalize("owl:DatatypeProperty")?a.rdfnode.type=u:r.class==n.doc.ontologyManager.uriDenormalize("owl:ObjectProperty")?(a.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",a.rdfnode.choices=function(e){n.getIndividuals(u,e)},a.rdfnode.create=!0):u&&("http://www.w3.org/2000/01/rdf-schema#Literal"==u||u.startsWith("http://www.w3.org/2001/XMLSchema#")?a.rdfnode.type=u:(a.rdfnode.type="http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",a.rdfnode.choices=function(e){n.getIndividuals(u,e)},a.rdfnode.create=!0))}n.schema[r.URI]=a},buildSchemaFromTypes:function(e){var t=this;t.schema={},t.fields=[],t.lens=null;for(var i=0,n=(t.types=e).length;i<n;i++){var r=e[i].getFresnelLens();if(r&&r.showProperties.length){t.lens=r;break}}t.fields=r?_.without(r.showProperties,t.doc.ontologyManager.uriDenormalize("fresnel:allProperties")):[t.doc.ontologyManager.uriDenormalize("rdf:type")];for(i=0;i<t.fields.length;i++)t.addSchemaEntryForProperty(t.fields[i])},docToModel:function(d,e){var h=this;h.schema={},h.fields=[],this.doc.getEntity(h.uri,function(e){h.types=_.compact(_.map(e.types,h.doc.ontologyManager.ontologyClassByURI,h.doc.ontologyManager)),h.fields=[],h.lens=null;if(0===h.types.length)for(var t in e.properties){var i=h.doc.ontologyManager.ontologyPropertyByURI(t);i&&i.domain&&(h.types=_.union(h.types,i.domain))}for(var n=0,r=h.types.length;n<r;n++){var o=h.types[n].getFresnelLens();if(o&&0<o.showProperties.length){h.lens=o;break}}if(o&&(h.fields=_.clone(o.showProperties)),o){var s=h.fields.indexOf(h.doc.ontologyManager.uriDenormalize("fresnel:allProperties"));if(0<=s){h.allowAddProperty=!0;var a=[];for(t in e.properties)_.contains(h.fields,t)||_.contains(o.hideProperties,t)||a.push(t);h.fields.splice.apply(h.fields,[s,1].concat(a))}}else for(var t in h.allowAddProperty=!0,e.properties)_.contains(h.fields,t)||("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===t?h.fields.unshift(t):h.fields.push(t));for(n=0;n<h.fields.length;n++)h.addSchemaEntryForProperty(h.fields[n]);for(var t in e.properties){var l=h.isAggregateProperty(t),u=e.properties[t];for(n=0;n<u.length;n++)if(l){var c=new RDFE.EntityModel;c.setEntity(h.doc,u[n].value),c.individualsCache=h.individualsCache,c.docToModel(function(){h.addValue(t,c)})}else h.addValue(t,u[n])}d&&d()})},modelToDoc:function(){var g=1;return function(t,i){var n=this;g=1;for(var r=function e(t,i,n){var r=[];if(!t||0===t.length){for(var o="",s=0,a=n.config.options.labelProps.length;s<a;s++)if(i[n.config.options.labelProps[s]]){o=i[n.config.options.labelProps[s]];break}o=(o||"subres")+"_"+g,t=n.buildEntityUri(o),g++}var l=n.store.rdf.createNamedNode(t);for(prop in i){var u=n.store.rdf.createNamedNode(prop),c=i[prop];c.constructor!==Array&&(c=[c]);for(var d=0;d<c.length;d++){var h=c[d];if(h.values){var p=e(h.uri,h.values,n);0<p.length&&(r.push(n.store.rdf.createTriple(l,u,p[0].subject)),Array.prototype.push.apply(r,p))}else{var f=c[d].toStoreNode(n.store);f&&0<f.nominalValue.length&&r.push(n.store.rdf.createTriple(l,u,f))}}}return r}(this.uri,n.attributes,n.doc),o=[],e=0;e<r.length;e++)_.indexOf(o,r[e].subject.nominalValue)<0&&o.push(r[e].subject.nominalValue);var s=function(e){e>=o.length?n.doc.addTriples(r,t,i):n.doc.deleteBySubject(o[e],function(){s(e+1)},i)};s(0)}}()}),function(c){var e,d;window.RDFE||(window.RDFE={}),RDFE.EntityEditor=(e=function(e,t){this.doc=e,this.namingSchema=e.config.options[e.config.options.namingSchema],this.ontologyManager=t},d=Backbone.Form.extend({template:_.template('<form class="form-horizontal clearfix" role="form">  <a href="#" class="btn btn-default btn-xs pull-right addProp">Add <%= RDFE.Utils.namingSchemaLabel("p", this.namingSchema) %></a>  <div data-fieldsets></div>  <% if (submitButton) { %>    <button type="submit" class="btn"><%= submitButton %></button>  <% } %></form>'),render:function(){var o=this;return o.namingSchema=o.model.doc.config.options[o.model.doc.config.options.namingSchema],Backbone.Form.prototype.render.call(this),o.model.allowAddProperty||this.$el.find(".addProp").hide(),this.$el.find("> a.addProp").click(function(e){e.preventDefault();var i=c(document.createElement("select")),t=c(document.createElement("button")).addClass("btn").addClass("btn-default").text("Add"),n=c(document.createElement("button")).addClass("btn").addClass("btn-default").text("Cancel"),r=c(document.createElement("div")).append(c(document.createElement("span")).text("New "+RDFE.Utils.namingSchemaLabel("p",o.namingSchema)+":")).append(i).append(t).append(n);i=i.propertyBox({ontologyManager:o.model.doc.ontologyManager}),n.click(function(e){e.preventDefault(),r.remove()}),t.click(function(e){if(e.preventDefault(),i.selectedURI()){console.log("Adding new property",i.selectedURI(),"to form",o),o.commit(),o.model.addSchemaEntryForProperty(i.selectedProperty()),o.model.fields.push(i.selectedURI()),o.fieldsets=void 0,o.initialize(o.options),r.remove();var t=o.$el.parent();o.$el.remove(),o.render(),console.log(t,o.$el),t.append(o.$el)}else console.log("No prop selected")}),o.$el.prepend(r)}),this}}),e.prototype.template=_.template('<div class="panel panel-default">        <div class="panel-heading clearfix">          <h3 class="panel-title pull-left">Editing <a href="<%= entityUri %>"><span class="rdfe-entity-label"><%= entityLabel %><span></a> <span class="rdfe-entity-types"></span></h3>          <div class="btn-group pull-right" role="group">            <button type="button" class="btn btn-primary btn-sm" id="okBtn">Apply</button>            <button type="button" class="btn btn-default btn-sm" id="cnclBtn">Cancel</button>          </div>        </div>        <div class="panel-body" id="entityFormContainer">        </div>      </div>'),e.prototype.render=function(o,s,a){var l=this,u=new RDFE.EntityModel;u.setEntity(this.doc,s),u.docToModel(function(){var t=new d({model:u});t.render(),o.empty(),o.append(l.template({entityUri:s,entityLabel:RDFE.Utils.uri2name(s)})),l.doc.getEntity(s,function(e){o.find(".rdfe-entity-types").html(l.ontologyManager.typesToLabel(e.types,!0)),o.find(".rdfe-entity-label").html(e.label)}),o.find("#entityFormContainer").append(t.el),o.find(".toggle.btn").css("width","100%");var e=o.find("button#cnclBtn"),i=o.find("button#saveBtn"),n=o.find("button#okBtn");e.click(function(){a()});var r=function(e){t.commit(),u.modelToDoc(function(){c(l).trigger("rdf-editor-success",{type:"editor-form-save-done",message:"Locally saved details of "+s}),e&&e()},function(e){c(l).trigger("rdf-editor-error",{type:"editor-form-save-failed",message:e})})};i.click(function(){r()}),n.click(function(){r(a)})},function(e){c(l).trigger("rdf-editor-error",{type:"editor-form-creation-failed",message:e})})},e)}(jQuery),function(l){var e,u,c,d;window.RDFE||(window.RDFE={}),RDFE.EntityView=(u=function(e,t,i){return'<span title="'+t.uri+'">'+t.label+"</span>"},c=function(e,t,i){return t.types&&t.types.length?t.types:"<em>none</em>"},d=function(e,t){return{label:e.label,types:t.typesToLabel(e.types),uri:e.uri||e.value}},(e=function(e,t,i,n){this.doc=e,this.namingSchema=e.config.options[e.config.options.namingSchema],this.ontologyManager=t,this.editor=i,this.editFct=n.editFct}).prototype.render=function(n,r){var s=this,a=function(e,t,i){return['<a class="edit ml10" href="javascript:void(0)" title="Edit this '+RDFE.Utils.namingSchemaLabel("spo",s.namingSchema,!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove this '+RDFE.Utils.namingSchemaLabel("spo",s.namingSchema,!1,!0)+' from the document">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")};s.doc.listEntities(s.editor.config.options.entityTypesFiler,function(e){s.entityTable=null,n.empty();var o=l(document.createElement("table")).addClass("table");n.append(o);for(var t=[],i=0;i<e.length;i++)t.push(d(e[i],s.ontologyManager));o.bootstrapTable({striped:!0,sortName:"label",pagination:!0,search:!0,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:t,idField:"uri",columns:[{field:"label",title:RDFE.Utils.namingSchemaLabel("s",s.namingSchema)+" Name",titleTooltip:RDFE.Utils.namingSchemaLabel("s",s.namingSchema)+" Name",aligh:"left",sortable:!0,formatter:u},{field:"types",title:"Entity Types",titleTooltip:"Entity Types",aligh:"left",class:"rdfe-small-column",sortable:!0,formatter:c},{field:"actions",title:'<button class="add btn btn-default" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("spo",s.namingSchema,!1,!0)+' to the document"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,formatter:a,events:{"click .edit":function(e,t,i,n){s.editFct(i.uri)},"click .remove":function(e,t,i,n){var r;r=i.uri,s.doc.deleteEntity(r,function(){o.bootstrapTable("remove",{field:"uri",values:[r]}),l(s).trigger("rdf-editor-success",{type:"entity-delete-done",uri:r,message:"Successfully deleted entity "+r+"."})},function(e){l(s).trigger("rdf-editor-error",{type:"entity-delete-failed",message:e})})}}}]}),l(o).find(".add").on("click",function(e){s.editor.createNewEntityEditor()}),s.entityTable=o,r&&r()},function(e){l(s).trigger("rdf-editor-error",{type:"entity-list-failed",message:e})})},e.prototype.addEntity=function(e){this.entityTable.bootstrapTable("append",e)},e.prototype.updateEntity=function(e){var t=this;t.doc.getEntity(e,function(e){t.entityTable.bootstrapTable("update",{field:"uri",data:d(e,t.ontologyManager)})})},e)}(jQuery),function(p){var e;window.RDFE||(window.RDFE={}),RDFE.SubjectEditor=((e=function(e,t){this.editor=e,this.subject=t}).prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <form class="form-inline">             <div class="form-group" style="width: 80%;">               <label>Selected <%= RDFE.Utils.namingSchemaLabel("s", this.editor.namingSchema()) %> </label>               <input name="subject" class="form-control" style="width: 85%;" disabled="disabled" />             </div>             <div class="btn-group pull-right" role="group">               <button type="button" class="btn btn-default btn-sm rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </form>         </div>         <div class="panel-body" id="subjectTable">         </div>         <div class="panel-body" id="subjectForm" style="display: none;">       </div>'),e.prototype.render=function(s,e,a,t){var n,i,l=this;if(e.empty(),l.subject){e.append(l.template(l.subject));var r=p(document.createElement("table")).addClass("table");e.find("#subjectTable").append(r),e.find("button#backButton").click(function(){t()});var o=e.find('input[name="subject"]');""!==l.subject.uri?o.val(l.subject.uri):(o.css("color","red"),o.css("font-style","italic"),o.val("Empty")),i=e,r.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",l.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",l.editor.namingSchema()),sortable:!0,editable:l.editor.editablePredicate(l.editor),formatter:l.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",l.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",l.editor.namingSchema()),sortable:!0,editable:l.editor.editableObject(l.editor,function(e){return e.predicate.toString()}),formatter:l.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(e,t,i){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(e,t,i,n){l.editor.doc.deleteTriple(i,function(){r.bootstrapTable("remove",{field:"id",values:[i.id]}),p(l.editor).trigger("rdf-editor-success",{type:"triple-delete-success",message:"Successfully deleted triple."})},function(e){p(l.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),r.on("editable-shown.bs.table",function(e,t,i){n=_.clone(i)}),r.on("editable-save.bs.table",function(e,t,i){l.editor.dataSetter(t,n,i)}),l.subjectTable=r,l.subjectTableContainer=i.find("#subjectTable"),l.subjectFormContainer=i.find("#subjectForm"),l.addButton=p(r).find(".add"),l.addButton.click(function(){l.createNewRelationEditor()}),l.renderData(),a&&l.createNewRelationEditor()}else!function(n,r){var e,t,i;n.html('<div class="panel panel-default">  <div class="panel-heading">    <h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",l.editor.namingSchema())+'</h3>  </div>  <div class="panel-body">    <div class="form-horizontal">       <div class="form-group">         <label for="ontology" class="col-sm-2 control-label">Vocabulary</label>         <div class="col-sm-10">           <select name="ontology" id="ontology" class="form-control" />         </div>       </div>       <div class="form-group">         <label for="class" class="col-sm-2 control-label">Type</label>         <div class="col-sm-10">           <select name="class" id="class" class="form-control" />         </div>       </div>       <div class="form-group">          <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",l.editor.namingSchema())+(l.editor.doc.config.options.entityUriTmpl?" Name":" URI")+'</label>          <div class="col-sm-10">            <input name="subject" id="subject" class="form-control" />          </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <a href="#" class="btn btn-default triple-action triple-action-new-cancel">Cancel</a>           <a href="#" class="btn btn-primary triple-action triple-action-new-save">OK</a>         </div>       </div>     </div>  </div></div>\n'),(e=p("#ontology").ontoBox({ontologyManager:l.editor.ontologyManager})).on("changed",function(e){var t=l.editor.ontologyManager.ontologyByURI(e.currentTarget.selectedOntologyURI());i.clearOptions(),i.addOption(t?t.classesAsArray():l.editor.ontologyManager.allClasses())}),e.sel.focus(),t=p("#class").selectize({valueField:"URI",labelField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:l.editor.ontologyManager.allClasses(),create:function(e,t){t(l.editor.ontologyManager.ontologyClassByURI(l.editor.ontologyManager.uriDenormalize(e),!0))},render:{item:function(e,t){var i=e.title||e.label||name.curi||e.name;return"<div>"+(i=e.curi&&e.curi!=i?t(i)+" <small>("+t(e.curi)+")</small>":t(i))+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||name.curi||e.name)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var i=l.editor.ontologyManager.uriDenormalize(e.input);return i!==e.input?'<div class="create">Add <strong>'+t(e.input)+"</strong> <small>("+t(i)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+t(i)+"</strong>&hellip;</div>"}}}),i=t[0].selectize,n.find("a.triple-action-new-cancel").click(function(e){e.preventDefault(),r()});var o=function(){var e=n.find('input[name="subject"]').val(),t=null,i=n.find("#class")[0].selectize.getValue();l.editor.doc.config.options.entityUriTmpl&&(t=e,e=null),l.editor.doc.addEntity(e,t,i,function(e){p(l.editor).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully created new triple."}),l.editor.doc.getSubject(e.uri,function(e){s.subjectView.addSubject(e),l.subject=e,l.render(s,n,a,r)})},function(){p(l.editor).trigger("rdf-editor-error",{type:"triple-insert-error",message:"Failed to add new triple."})})};n.find("a.triple-action-new-save").click(function(e){e.preventDefault(),o()}),n.find("input#subject").keypress(function(e){13===e.which&&o()})}(e,t)},e.prototype.renderData=function(){for(var e=this.subject?this.subject.items:[],t=0;t<e.length;t++)e[t].id=t;this.subjectTable.data("maxindex",t),this.subjectTable.bootstrapTable("load",e),this.subject?this.addButton.show():this.addButton.hide()},e.prototype.addTriple=function(e){var t=this.subjectTable.data("maxindex");this.subjectTable.bootstrapTable("append",p.extend(e,{id:t})),this.subjectTable.data("maxindex",++t)},e.prototype.createNewRelationEditor=function(){var l=this;l.subjectTableContainer.hide(),l.subjectFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",l.editor.namingSchema())+'</label>         <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>       </div>       <div class="form-group object-list">         <div class="col-sm-12 object-item_0" style="padding: 0;">           <label for="object_0" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",l.editor.namingSchema())+'</label>           <div class="col-sm-9"><input name="object_0" class="form-control" /></div>           <div class="col-sm-1 btn_0"><button type="button" class="btn btn-default object-add" title="Add Object"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button></div>         </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default subject-action subject-action-new-cancel">Cancel</button>           <button type="submt" class="btn btn-primary subject-action subject-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var u=1,c=' <div class="col-sm-12 object-item_<N>" style="padding: 0;">    <label for="object_<N>" class="col-sm-2 control-label"></label>    <div class="col-sm-9"><input name="object_<N>" class="form-control" /></div>    <div class="col-sm-1 btn_<N>"></div>  </div> ',d=[],e=l.subjectFormContainer.find('input[name="object_0"]').rdfNodeEditor(l.editor.doc.config.options);e.setValue(new RDFE.RdfNode("literal","",null,"")),d.push(e);var h=l.subjectFormContainer.find('select[name="predicate"]').propertyBox({ontologyManager:l.editor.ontologyManager}).on("changed",function(e,t){for(var i=0;i<d.length;i++){var n=d[i];n&&l.editor.changeObjectType(t,n)}});h.sel.focus(),l.subjectFormContainer.find("button.object-add").click(function(e){for(var t=0,i=d.length-1;0<=i;i--)if(d[i]){t=i;break}var n=l.editor.ontologyManager.ontologyPropertyByURI(h.selectedURI()),r=l.subjectFormContainer.find("div.object-list");r.append(c.replace(/<N>/g,u)),r.find("button.object-add").detach().appendTo(r.find("div.btn_<N>".replace(/<N>/g,u))),r.find("div.btn_<N>".replace(/<N>/g,t)).append(' <button type="button" class="btn btn-default object-remove_<N>" title="Remove Object"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>'.replace(/<N>/g,t));var o=l.subjectFormContainer.find('input[name="object_<N>"]'.replace(/<N>/g,u)).rdfNodeEditor(l.editor.doc.config.options);o.setValue(new RDFE.RdfNode("literal","",null,"")),n&&l.editor.changeObjectType(n,o);var s,a=(s=t,function(e){l.subjectFormContainer.find("div.object-item_<N>".replace(/<N>/g,s)).remove(),d[s]=null});l.subjectFormContainer.find("button.object-remove_<N>".replace(/<N>/g,t)).click(a),d.push(o),u++}),l.subjectFormContainer.find("button.subject-action-new-cancel").click(function(e){l.subjectFormContainer.hide(),l.subjectTableContainer.show()}),l.subjectFormContainer.find("button.subject-action-new-save").click(function(e){e.preventDefault();var t=!0,i=l.subject.uri,n=h.selectedURI();if(RDFE.Validate.check(h.sel,n)){for(var r=0;r<d.length;r++){var o=d[r];if(o){var s=o.getValue();if(RDFE.Validate.check(o.getField(),s.value)){var a=l.editor.doc.store.rdf.createTriple(l.editor.doc.store.rdf.createNamedNode(i),l.editor.doc.store.rdf.createNamedNode(n),s.toStoreNode(l.editor.doc.store));l.editor.doc.addTriples([a],function(){l.subjectView||l.addTriple(a),p(l.editor).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully added new triple."}),l.subjectFormContainer.find("div.object-item_<N>".replace(/<N>/g,r)).remove(),d[r]=null},function(e){p(l.editor).trigger("rdf-editor-error",{type:"triple-insert-error",message:"Failed to add new triple."}),t=!1})}else t=!1}}t&&(l.subjectFormContainer.hide(),l.subjectTableContainer.show())}})},e)}(jQuery),function(c){var e;window.RDFE||(window.RDFE={}),RDFE.SubjectView=((e=function(e,t){this.editor=e,this.editFct=t.editFct}).prototype.render=function(a,l){var u=this;u.editor.doc.listSubjects(function(e){u.subjects=e,u.subjectTable=null,a.empty();var r=c(document.createElement("table")).addClass("table");a.append(r);var t=1,i=10,n="uri",o="asc",s=u.editor.config.options.pageSettings;s.pageNo&&(t=s.pageNo),s.pageSize&&(i=s.pageSize),s.sortName&&(n=s.sortName),s.sortOrder&&(o=s.sortOrder),r.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:t,pageSize:i,search:!0,sortName:n,sortOrder:o,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:e,idField:"uri",columns:[{field:"uri",title:RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema()),sortable:!0,formatter:function(e,t,i){var n=u.editor.ontologyManager.ontologyClassByURI(t.label)?"":'class="rdfe-green-link"';return""!==RDFE.Utils.uri2name(t.uri)?'<a href="{0}" target="_blank" {1}>{0}</a>'.format(t.uri,n):'<em style="color: red;">Empty</em>'}},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,sorter:u.editor.countSorter,align:"right",class:"rdfe-small-column",formatter:u.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,formatter:function(e,t,i){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!1,!0)+" name and "+RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this '+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!0,!0)+'">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",u.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .edit":function(e,t,i,n){u.editFct(i)},"click .dereference":function(e,t,i,n){u.editor.dereference()(i.uri)},"click .remove":function(e,t,i,n){u.editor.doc.deleteBySubject(i.uri,function(){r.bootstrapTable("remove",{field:"uri",values:[i.uri]}),c(u.editor).trigger("rdf-editor-success",{type:"subject-delete-success",message:"Successfully deleted triples with subject "+i.uri+"."})},function(e){c(u.editor).trigger("rdf-editor-error",{type:"subject-delete-error",message:e})})}}}]}),r.on("page-change.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{pageNo:t,pageSize:i})}),r.on("sort.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{sortName:t,sortOrder:i})}),c(r).find(".add").on("click",function(e){u.editor.editSubject()}),u.subjectTable=r,l&&l()},function(e){c(u.editor).trigger("rdf-editor-error",{type:"subject-list-error",message:e})})},e.prototype.addSubject=function(t){_.find(this.subjects,function(e){return e.uri===t.uri})||this.subjectTable.bootstrapTable("append",t)},e.prototype.updateSubject=function(n){var i=this;i.editor.doc.getSubject(n,function(e){var t=i.subjects.findIndex(function(e,t,i){return e.uri===n});i.subjectTable.bootstrapTable("updateRow",{index:t,row:e})})},e)}(jQuery),function(u){var e;window.RDFE||(window.RDFE={}),RDFE.PredicateEditor=((e=function(e,t){this.editor=e,this.predicate=t}).prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <form class="form-inline">             <div class="form-group" style="width: 80%;">               <label><%= RDFE.Utils.namingSchemaLabel("p", this.editor.namingSchema()) %> </label>               <select name="predicate" class="form-control" style="width: 85%;"></select>             </div>             <div class="btn-group pull-right" role="group">               <button type="button" class="btn btn-default btn-sm rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </form>         </div>         <div class="panel-body" id="predicateTable">         </div>         <div class="panel-body" id="predicateForm" style="display: none;">       </div>'),e.prototype.render=function(e,t,i,n){var r,o=this;t.empty(),t.append(o.template(o.predicate));var s=u(document.createElement("table")).addClass("table");t.find("#predicateTable").append(s),t.find("button#backButton").click(function(){n()});var a,l=t.find('select[name="predicate"]').propertyBox({ontologyManager:o.editor.ontologyManager});o.predicate&&l.setPropertyURI(o.predicate.uri),o.predicate||l.sel.focus(),l.sel.on("change",function(e){e&&o.editor.doc.getPredicate(e,function(e){o.predicateView.addPredicate(e),o.predicate=e,o.renderData()})}),a=t,s.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",o.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",o.editor.namingSchema()),sortable:!0,editable:o.editor.editableSubject(o.editor),formatter:o.editor.nodeFormatter},{field:"object",title:RDFE.Utils.namingSchemaLabel("o",o.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",o.editor.namingSchema()),sortable:!0,editable:o.editor.editableObject(o.editor,function(e){return e.predicate.toString()}),formatter:o.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(e,t,i){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(e,t,i,n){o.editor.doc.deleteTriple(i,function(){s.bootstrapTable("remove",{field:"id",values:[i.id]}),u(o.editor).trigger("rdf-editor-success",{type:"predicate-delete-success",message:"Successfully deleted triple."})},function(e){u(o.editor).trigger("rdf-editor-error",{type:"predicate-delete-error",message:"Failed to delete triple."})})}}}]}),s.on("editable-shown.bs.table",function(e,t,i){r=_.clone(i)}),s.on("editable-save.bs.table",function(e,t,i){o.editor.dataSetter(t,r,i)}),o.predicateView=e.predicateView,o.predicateTable=s,o.predicateTableContainer=a.find("#predicateTable"),o.predicateFormContainer=a.find("#predicateForm"),o.addButton=u(s).find(".add"),o.addButton.click(function(){o.createNewRelationEditor()}),o.renderData(),i&&o.createNewRelationEditor()},e.prototype.renderData=function(){for(var e=this.predicate?this.predicate.items:[],t=0;t<e.length;t++)e[t].id=t;this.predicateTable.data("maxindex",t),this.predicateTable.bootstrapTable("load",e),this.predicate?this.addButton.show():this.addButton.hide()},e.prototype.addTriple=function(e){var t=this.predicateTable.data("maxindex");this.predicateTable.bootstrapTable("append",u.extend(e,{id:t})),this.predicateTable.data("maxindex",++t),this.predicateView.updatePredicate(this.predicate.uri)},e.prototype.createNewRelationEditor=function(){var o=this;o.predicateTableContainer.hide(),o.predicateFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",o.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="subject" class="form-control" /></div>       </div>       <div class="form-group">         <label for="object" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",o.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="object" class="form-control" /></div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default predicate-action predicate-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary predicate-action predicate-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var s=o.predicateFormContainer.find('input[name="subject"]');s.focus();var e=o.editor.ontologyManager.ontologyProperties[o.predicate.uri],a=o.predicateFormContainer.find('input[name="object"]').rdfNodeEditor(o.editor.doc.config.options);o.editor.changeObjectType(e,a),o.predicateFormContainer.find("button.predicate-action-new-cancel").click(function(e){o.predicateFormContainer.hide(),o.predicateTableContainer.show()}),o.predicateFormContainer.find("button.predicate-action-new-save").click(function(e){e.preventDefault();var t=s.val();if(t=RDFE.Utils.trim(RDFE.Utils.trim(t,"<"),">"),RDFE.Validate.check(s,t)){var i=o.predicate.uri,n=a.getValue();if(RDFE.Validate.check(a.getField(),n.value)){var r=o.editor.doc.store.rdf.createTriple(o.editor.doc.store.rdf.createNamedNode(t),o.editor.doc.store.rdf.createNamedNode(i),n.toStoreNode(o.editor.doc.store));o.editor.doc.addTriples([r],function(){o.addTriple(r),u(o.editor).trigger("rdf-editor-success",{type:"predicate-insert-success",message:"Successfully added new triple."}),o.predicateFormContainer.hide(),o.predicateTableContainer.show()},function(){u(o.editor).trigger("rdf-editor-error",{type:"predicate-insert-error",message:"Failed to add new triple."})})}}})},e)}(jQuery),function(c){var e,d,h;window.RDFE||(window.RDFE={}),RDFE.PredicateView=(d=function(e,t,i){return'<a href="{0}" target="_blank">{0}</a>'.format(t.uri)},h=function(e,t){function i(e){return'<a href="{0}">{0}</a>'.format(e)}return e=i(e),(t=i(t))<e?1:e<t?-1:0},(e=function(e,t){this.editor=e,this.editFct=t.editFct}).prototype.render=function(a,l){var u=this;u.editor.doc.listPredicates(function(e){u.predicates=e,u.predicateTable=null,a.empty();var r=c(document.createElement("table")).addClass("table");a.append(r);var t=1,i=10,n="uri",o="asc",s=u.editor.config.options.pageSettings;s.pageNo&&(t=s.pageNo),s.pageSize&&(i=s.pageSize),s.sortName&&(n=s.sortName),s.sortOrder&&(o=s.sortOrder),r.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:t,pageSize:i,search:!0,sortName:n,sortOrder:o,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:e,idField:"uri",columns:[{field:"uri",title:RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema()),sortable:!0,sorter:h,formatter:d},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,align:"right",sorter:u.editor.countSorter,class:"rdfe-small-column",formatter:u.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,formatter:function(e,t,i){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!1,!0)+" and "+RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this '+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!0,!0)+'">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",u.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .edit":function(e,t,i,n){u.editFct(i)},"click .dereference":function(e,t,i,n){u.editor.dereference()(i.uri)},"click .remove":function(e,t,i,n){u.editor.doc.deletePredicate(i.uri,function(){r.bootstrapTable("remove",{field:"uri",values:[i.uri]}),c(u.editor).trigger("rdf-editor-success",{type:"predicate-delete-success",message:"Successfully deleted predicate "+i.uri+"."})},function(e){c(u.editor).trigger("rdf-editor-error",{type:"predicate-delete-error",message:e})})}}}]}),r.on("page-change.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{pageNo:t,pageSize:i})}),r.on("sort.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{sortName:t,sortOrder:i})}),c(r).find(".add").on("click",function(e){u.editor.editPredicate()}),u.predicateTable=r,l&&l()},function(e){c(u.editor).trigger("rdf-editor-error",{type:"predicate-list-error",message:e})})},e.prototype.addPredicate=function(t){_.find(this.predicates,function(e){return e.uri===t.uri})||(this.predicateTable.bootstrapTable("append",t),this.predicates.push(t))},e.prototype.updatePredicate=function(n){var i=this;i.editor.doc.getPredicate(n,function(e){var t=i.predicates.findIndex(function(e,t,i){return e.uri===n});i.predicateTable.bootstrapTable("updateRow",{index:t,row:e})})},e)}(jQuery),function(u){var e;window.RDFE||(window.RDFE={}),RDFE.ObjectEditor=((e=function(e,t){this.editor=e,this.object=t}).prototype.template=_.template('       <div class="panel panel-default">         <div class="panel-heading clearfix">           <div class="form-group">             <div class="col-sm-1">               <label for="object" class="control-label pull-right" style="padding-top: 5px"><%= RDFE.Utils.namingSchemaLabel("o", this.editor.namingSchema()) %> </label>             </div>             <div class="col-sm-10">               <input name="object" class="form-control" />             </div>             <div class="col-sm-1">               <button type="button" class="btn btn-default btn-sm pull-right rdfe-font-bold" id="backButton" title="Back">Back</button>             </div>           </div>         </div>         <div class="panel-body" id="objectTable">         </div>         <div class="panel-body" id="objectForm" style="display: none;">       </div>'),e.prototype.render=function(e,t,i,n){var r,o=this;t.empty(),t.append(o.template(o.object));var s=u(document.createElement("table")).addClass("table");t.find("#objectTable").append(s),t.find("button#backButton").click(function(){o.objectView.removeObject(o.object),n()});var a,l=t.find('input[name="object"]').rdfNodeEditor(o.editor.doc.config.options);o.object&&l.setValue(o.object.object),u(l).on("changed",function(e,t){var i=t.getValue();if(i.value){"uri"==i.type&&(i.value=o.editor.ontologyManager.uriDenormalize(i.value));var n=i.toStoreNode(o.editor.doc.store);o.editor.doc.getObject(n,function(e){o.objectView.removeObject(o.object),o.objectView.addObject(e),o.object=e,o.renderData()})}}),l.mainElement.focus(),a=t,s.bootstrapTable({striped:!0,sortName:"subject",pagination:!0,paginationVAlign:"top",search:!0,searchAlign:"left",showHeader:!0,editable:!0,data:[],dereference:!0,columns:[{field:"subject",title:RDFE.Utils.namingSchemaLabel("s",o.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("s",o.editor.namingSchema()),sortable:!0,editable:o.editor.editableSubject(o.editor),formatter:o.editor.nodeFormatter},{field:"predicate",title:RDFE.Utils.namingSchemaLabel("p",o.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("p",o.editor.namingSchema()),sortable:!0,editable:o.editor.editablePredicate(o.editor),formatter:o.editor.nodeFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Add Relation" style="display: none;"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,editable:!1,formatter:function(e,t,i){return['<a class="remove ml10" href="javascript:void(0)" title="Remove">','<i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .remove":function(e,t,i,n){o.editor.doc.deleteTriple(i,function(){s.bootstrapTable("remove",{field:"id",values:[i.id]}),u(o.editor).trigger("rdf-editor-success",{type:"object-delete-success",message:"Successfully deleted triple."})},function(e){u(o.editor).trigger("rdf-editor-error",{type:"triple-delete-error",message:"Failed to delete triple."})})}}}]}),s.on("editable-shown.bs.table",function(e,t,i){r=_.clone(i)}),s.on("editable-save.bs.table",function(e,t,i){o.editor.dataSetter(t,r,i)}),o.objectView=e.objectView,o.objectTable=s,o.objectTableContainer=a.find("#objectTable"),o.objectFormContainer=a.find("#objectForm"),o.addButton=u(s).find(".add"),o.addButton.click(function(){o.createNewRelationEditor()}),o.renderData(),i&&o.createNewRelationEditor()},e.prototype.renderData=function(){for(var e=this.object?this.object.items:[],t=0;t<e.length;t++)e[t].id=t;this.objectTable.data("maxindex",t),this.objectTable.bootstrapTable("load",e),this.object?this.addButton.show():this.addButton.hide()},e.prototype.addTriple=function(e){var t=this.objectTable.data("maxindex");this.objectTable.bootstrapTable("append",u.extend(e,{id:t})),this.objectTable.data("maxindex",++t),this.objectView.updateObject(this.object.object)},e.prototype.createNewRelationEditor=function(){var r=this;r.objectTableContainer.hide(),r.objectFormContainer.html('<div class="panel panel-default">   <div class="panel-heading"><h3 class="panel-title">Add Relation</h3></div>   <div class="panel-body">     <form class="form-horizontal">       <div class="form-group">         <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",r.editor.namingSchema())+'</label>         <div class="col-sm-10"><input name="subject" class="form-control" /></div>       </div>       <div class="form-group">         <label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",r.editor.namingSchema())+'</label>         <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default object-action object-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary object-action object-action-new-save">OK</button>         </div>       </div>     </form>   </div> </div>').show();var o=r.objectFormContainer.find('select[name="predicate"]').propertyBox({ontologyManager:r.editor.ontologyManager}),s=r.objectFormContainer.find('input[name="subject"]');s.focus(),r.objectFormContainer.find("button.object-action-new-cancel").click(function(e){r.objectFormContainer.hide(),r.objectTableContainer.show()}),r.objectFormContainer.find("button.object-action-new-save").click(function(e){e.preventDefault();var t=s.val();if(t=RDFE.Utils.trim(RDFE.Utils.trim(t,"<"),">"),RDFE.Validate.check(s,t)){var i=o.selectedURI();if(i=RDFE.Utils.trim(RDFE.Utils.trim(i,"<"),">"),RDFE.Validate.check(o.sel,i)){var n=r.editor.doc.store.rdf.createTriple(r.editor.doc.store.rdf.createNamedNode(t),r.editor.doc.store.rdf.createNamedNode(i),r.object.object);r.editor.doc.addTriples([n],function(){r.addTriple(n),u(r.editor).trigger("rdf-editor-success",{type:"object-insert-success",message:"Successfully added new triple."}),r.objectFormContainer.hide(),r.objectTableContainer.show()},function(){u(r.editor).trigger("rdf-editor-error",{type:"object-insert-error",message:"Failed to add new triple."})})}}})},e)}(jQuery),function(c){var e;window.RDFE||(window.RDFE={}),RDFE.ObjectView=((e=function(e,t){this.editor=e,this.editFct=t.editFct}).prototype.render=function(a,l){var u=this;u.editor.doc.listObjects(function(e){u.objects=e,u.objectsTable=null,a.empty();var r=c(document.createElement("table")).addClass("table");a.append(r);var t=1,i=10,n="label",o="asc",s=u.editor.config.options.pageSettings;s.pageNo&&(t=s.pageNo),s.pageSize&&(i=s.pageSize),s.sortName&&(n=s.sortName),s.sortOrder&&(o=s.sortOrder),r.bootstrapTable({striped:!0,pagination:!0,paginationVAlign:"top",pageNumber:t,pageSize:i,search:!0,sortName:n,sortOrder:o,searchAlign:"left",trimOnSearch:!1,showHeader:!0,data:e,idField:"id",columns:[{field:"label",title:RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema()),titleTooltip:RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema()),sortable:!0,formatter:function(e,t,i){if("IRI"!==t.type)return t.label;var n='class="rdfe-green-link"';return u.editor.ontologyManager.ontologyClassByURI(t.label)&&(n=""),'<a href="{0}" target="_blank" {1}>{0}</a>'.format(t.label,n)}},{field:"type",title:"Type",titleTooltip:"Type",sortable:!0,class:"rdfe-small-column",formatter:function(e,t,i){return"IRI"===t.type?t.type:'<a href="{1}" target="_blank">{0}</a>'.format(u.editor.ontologyManager.uriNormalize(t.type),t.type)}},{field:"items",title:"Count",titleTooltip:"Count",sortable:!0,sorter:u.editor.countSorter,align:"right",class:"rdfe-small-column",formatter:u.editor.countFormatter},{field:"actions",title:'<button class="add btn btn-default btn-sm" title="Click to create a new '+RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema(),!1,!0)+'"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New</button>',align:"center",valign:"middle",class:"rdfe-small-column",clickToSelect:!1,formatter:function(e,t,i){return['<a class="edit ml10" href="javascript:void(0)" title="Edit or add a new '+RDFE.Utils.namingSchemaLabel("s",u.editor.namingSchema(),!1,!0)+" and "+RDFE.Utils.namingSchemaLabel("p",u.editor.namingSchema(),!1,!0)+" pairs associated with this "+RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-edit"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove all '+RDFE.Utils.namingSchemaLabel("spo",u.editor.namingSchema(),!0,!0)+" associated with this "+RDFE.Utils.namingSchemaLabel("o",u.editor.namingSchema(),!1,!0)+'">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .edit":function(e,t,i,n){u.editFct(i)},"click .remove":function(e,t,i,n){u.editor.doc.deleteObject(i.object,function(){r.bootstrapTable("remove",{field:"id",values:[i.id]}),c(u.editor).trigger("rdf-editor-success",{type:"object-delete-success",message:"Successfully deleted object."})},function(e){c(u.editor).trigger("rdf-editor-error",{type:"object-delete-error",message:e})})}}}]}),r.on("page-change.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{pageNo:t,pageSize:i})}),r.on("sort.bs.table",function(e,t,i){c(u.editor).trigger("rdf-editor-page",{sortName:t,sortOrder:i})}),c(r).find(".add").on("click",function(e){u.editor.editObject()}),u.objectsTable=r,l&&l()},function(e){c(u.editor).trigger("rdf-editor-error",{type:"object-list-error",message:e})})},e.prototype.addObject=function(t){_.find(this.objects,function(e){return e.id===t.id})||(this.objectsTable.bootstrapTable("append",t),this.objects.push(t))},e.prototype.updateObject=function(e){var t=this;t.editor.doc.getObject(e,function(n){var e=t.objects.findIndex(function(e,t,i){return e.id===n.id});t.objectsTable.bootstrapTable("updateRow",{index:e,row:n})})},e.prototype.removeObject=function(e){e&&0===e.items.length&&this.objectsTable.bootstrapTable("remove",{field:"id",values:[e.id]})},e)}(jQuery),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return 0==this.indexOf(e)}),window.RDFE||(window.RDFE={}),RDFE.Editor=function(t,i){var n=this,e=$.extend({initOntologyManager:!0},t.options);n.config=t.config,n.maxLength=n.config.options.maxLabelLength,n.spinner=0,n.ontologyManager=new RDFE.OntologyManager(t.config.options);var r=function(){var e={config:t.config,documentTree:t.documentTree,ontologyManager:n.ontologyManager};new RDFE.Document(e,function(e){n.doc=e,$(n.doc).on("docChanged",function(e,t){n.docChanged()}),i&&i(n)})};!0===e.initOntologyManager?n.ontologyManager.init({success:r}):r()},RDFE.Editor.prototype.namingSchema=function(){return this.config.options[this.config.options.namingSchema]},RDFE.Editor.prototype.nodeFormatter=function(e){return"Literal"==e.interfaceName?"http://www.w3.org/2001/XMLSchema#dateTime"==e.datatype?new Date(e.nominalValue).toString():RDFE.Utils.escapeXml(RDFE.Utils.strAbbreviate(e.nominalValue,this.maxLength)):RDFE.Utils.uriAbbreviate(e.toString(),this.maxLength)},RDFE.Editor.prototype.countFormatter=function(e,t,i){return t.items.length},RDFE.Editor.prototype.countSorter=function(e,t){return e=e.length,(t=t.length)<e?1:e<t?-1:0},RDFE.Editor.prototype.editableSubject=function(t){return function(e){return{mode:"inline",type:"rdfnode",rdfnode:{mode:"subject",config:$.extend({},t.config.options,{dereferenceLink:t.dereference()}),type:"http://www.w3.org/1999/02/22-rdf-syntax-ns#Resource",dereferenceLink:t.dereference()},value:e.subject}}},RDFE.Editor.prototype.editablePredicate=function(t){return function(e){return{mode:"inline",type:"propertyBox",propertyBox:{ontologyManager:t.ontologyManager,dereferenceLink:t.dereference()},value:e.predicate.nominalValue}}},RDFE.Editor.prototype.editableObject=function(t,i){return function(e){return{mode:"inline",type:"rdfnode",rdfnode:{mode:"object",type:e.object.datatype,config:$.extend({},t.config.options,{dereferenceLink:t.dereference()}),predicate:i?i(e):null,document:t.doc,ontologyManager:t.ontologyManager,dereferenceLink:t.dereference()},value:e.object}}},RDFE.Editor.prototype.render=function(e){this.container=e,this.container.empty(),this.listContainer=$(document.createElement("div")).appendTo(this.container),this.formContainer=$(document.createElement("div")).appendTo(this.container)},RDFE.Editor.prototype.docChanged=function(){this.doc.store.graph(this.doc.graph,function(e,t){var i="<![CDATA["+t.toNT()+"]]>";$("body").find('script[type="text/turtle"][id="document"]').text(i)})},RDFE.Editor.prototype.toggleSpinner=function(e){e?$(this).trigger("rdf-editor-spinner-start","editor-spinner"):$(this).trigger("rdf-editor-spinner-done","editor-spinner")},RDFE.Editor.prototype.toggleView=function(e,t){var i=this;e!==i.view&&(i.view="subjects"===e||"entities"===e?(!0===i.config.options.useEntityEditor?i.createEntityList():i.createSubjectList(),e):"predicates"===e||"attributes"===e?(i.createPredicateList(),e):"objects"===e||"values"===e?(i.createObjectList(),e):(i.createTripleList(),"triples"===e||"statements"===e?e:"EAV"===t?"statements":"triples"),$(i).trigger("rdf-editor-page",{view:i.view}))},RDFE.Editor.prototype.updateView=function(){var e=this;"subjects"===e.view||"entities"===e.view?!0===e.config.options.useEntityEditor?e.createEntityList():e.createSubjectList():"predicates"===e.view||"attributes"===e.view?e.createPredicateList():"objects"===e.view||"values"===e.view?e.createObjectList():e.createTripleList()},RDFE.Editor.prototype.settingsForm=function(){var a=this,l=$("#settingsModal"),e=$.jStorage.get("rdfe:settings",{});l.find("#userID").val(e.userID),l.find('input[name="namingSchema"][value="'+e.namingSchema+'"]').attr("checked","checked"),l.modal({keyboard:!0}),l.keypress(function(e){13==e.which&&l.find('button[type="submit"]').click()}),l.find(".ok").off(),l.find(".ok").on("click",function(e){e.preventDefault();var t=$.jStorage.get("rdfe:settings",{}),i=l.find("#userID").val(),n=t.namingSchema,r="",o=l.find('input[name="namingSchema"]:checked');0<o.length&&(r=o.val()),t={userID:i,namingSchema:r},$.jStorage.set("rdfe:settings",t),l.modal("hide");var s=-1!==["entities","attributes","values","statements"].indexOf(a.view)?"EAV":"SPO";n===r&&s===r||(a.tripleView=null,a.subjectView=null,a.predicateView=null,a.objectView=null,a.config.options.namingSchema=r,$(a).trigger("rdf-editor-namingSchema",{uiMode:r,viewMode:a.view}))})},RDFE.Editor.prototype.localForm=function(){var r=this,o=$("#localModal");o.find("#content").val(""),o.find("#contentType").val("text/turtle"),o.modal({keyboard:!0}),o.find(".ok").off(),o.find(".ok").on("click",function(e){if(e.preventDefault(),window.File&&window.FileReader&&window.FileList&&window.Blob){var t=o.find("#localFile").prop("files");if(t)if(t.length&&t[0]){var i,n;i=t[0],(n=new FileReader).onload=function(){var e=n.result;r.doc.import(e,function(e){o.modal("hide"),r.updateView(),r.docChanged(),$(r).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})},function(e){$(r).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+e.message})})},n.readAsText(i)}else $(r).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Please select a file!"});else $(r).trigger("rdf-editor-error",{type:"rdf-editor-error",message:'This browser doesn\'t seem to support the "files" property of file inputs.'})}else $(r).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"The File APIs are not fully supported by your browser."})})},RDFE.Editor.prototype.remoteForm=function(){var n=this,r=$("#remoteModal");r.find("#remoteURL").val(""),r.modal({keyboard:!0}),r.find(".ok").off(),r.find(".ok").on("click",function(e){e.preventDefault();var i=r.find("#remoteURL").val();$.ajax(i).done(function(e){n.doc.import(e,function(e){r.modal("hide"),n.updateView(),n.docChanged(),$(n).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})},function(e){r.modal("hide"),$(n).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+e.message})})}).fail(function(e){r.modal("hide");var t=RDFE.IO.ajaxFailMessage(e,'Failed to load remote document "{0}"',i);$(n).trigger("rdf-editor-error",{type:"rdf-editor-error",message:t})})})},RDFE.Editor.prototype.importForm=function(){var i=this,n=$("#importModal");n.find("#content").val(""),n.find("#contentType").val("text/turtle"),n.modal({keyboard:!0}),n.find(".ok").off(),n.find(".ok").on("click",function(e){e.preventDefault();var t=n.find("#content").val();n.find("#contentType").val();i.doc.import(t,function(e){n.modal("hide"),i.updateView(),i.docChanged(),$(i).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully imported RDF data."})},function(e){$(i).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to import RDF data. <br /> "+e.message})})})},RDFE.Editor.prototype.exportForm=function(){var n=this,r=$("#exportModal");r.find("#content").val(""),r.keypress(function(e){13==e.which&&r.find('button[type="submit"]').click()}),r.modal({keyboard:!0}),$(n).trigger("rdf-editor-spinner-start","export-spinner"),n.doc.store.graph(n.doc.graph,function(e,t){var i=t.toNT();r.find("#content").val(i),$(n).trigger("rdf-editor-spinner-done","export-spinner")})},RDFE.Editor.prototype.signDocumentForm=function(){var a,l=this,e=$("#signModal"),t=e.find(".modal-body");t.empty(),l.doc.checkForSignature(),angular.element("[ng-controller=AuthHeaderCtrl]").scope().profile?(t.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <input type="text" class="form-control" name="signatureDocURI" id="signatureDocURI" value="{0}">        </div>       </div>    '.format(l.doc.signature?l.doc.signature:l.doc.url+",signature")),e.find(".ok").show(),e.find(".ok").off(),e.find(".ok").on("click",(a=e,function(e){e.preventDefault();var i,t=l.doc.store.rdf,o=a.find("#signatureDocURI").val(),n=t.createTriple(t.createNamedNode(l.doc.url),t.createNamedNode("http://www.openlinksw.com/schemas/cert#hasSignature"),t.createNamedNode(o));l.doc.checkTriple(n,function(e){i=e},function(e){i=e});var r=function(e,t){l.doc.store.graph(l.doc.graph,function(e,t){var i=t.toNT(),n=function(e,t,i){if("error"===t)s();else{var n={contentType:"text/plain",success:function(){a.modal("hide"),l.updateView(),$(l).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully signed document."})},error:s},r=RDFE.IO.createIO("webdav");r.type="webdav",r.insert(o,e,n)}};$.get("/ods/api/signature?content="+i).done(function(e,t,i){n(e,t)}).fail(function(e,t,i){n(e,t)})})},s=function(e,t){i||l.doc.deleteTriples(n),$(l).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to sign document."})};i?r():l.doc.addTriples(n,r,s)}))):(t.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">The user is not logged. Please, login and try again.</p>         </div>       </div>    '),e.find(".ok").hide()),e.modal()},RDFE.Editor.prototype.unsignDocumentForm=function(){var o,s=this,e=$("#unsignModal"),t=e.find(".modal-body");t.empty(),s.doc.checkForSignature(),s.doc.signature?(t.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">{0}</p>         </div>       </div>      <div class="form-group">         <label class="col-sm-2"></label>         <div class="col-sm-10 checkbox">           <label><input type="checkbox" name="deleteSignature" id="deleteSignature" value="on"><strong>Delete Signature File</strong></label>        </div>       </div>    '.format(s.doc.signature)),e.find(".ok").show(),e.find(".ok").off(),e.find(".ok").on("click",(o=e,function(e){e.preventDefault();var i=function(){o.modal("hide"),s.updateView(),$(s).trigger("rdf-editor-success",{type:"rdf-editor-success",message:"Successfully unsigned document."})},n=function(){$(s).trigger("rdf-editor-error",{type:"rdf-editor-error",message:"Failed to unsign document."})},t=function(){var e=s.doc.store.rdf,t=e.createTriple(e.createNamedNode(s.doc.url),e.createNamedNode("http://www.openlinksw.com/schemas/cert#hasSignature"),e.createNamedNode(s.doc.signature));s.doc.deleteTriples(t,i,n)};if(o.find("#deleteSignature").checked){var r=RDFE.IO.createIO("webdav");r.type="webdav",r.delete(s.doc.signature)}else t()}))):(t.html('      <div class="form-group">         <label class="col-sm-2 control-label">Signature</label>         <div class="col-sm-10">           <p class="form-control-static">Document has not signature</p>         </div>       </div>    '),e.find(".ok").hide()),e.modal()},RDFE.Editor.prototype.dereference=function(){var t;return t=this,function(e){if(e){if(e.startsWith("#")){if(!t.doc.url)return;e=t.doc.url+e}e.startsWith("http")&&window.open(e,"_blank").focus()}}},RDFE.Editor.prototype.createTripleList=function(){var e=this;e.toggleSpinner(!0),e.tripleView||(e.tripleView=new RDFE.TripleView(e)),e.formContainer.hide(),e.listContainer.empty().show(),setTimeout(function(){e.tripleView.render(e.listContainer,function(){e.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editTriple=function(e,t,i){var o=this;if(!o.doc)return!1;o.listContainer.hide(),o.formContainer.html('<div class="panel panel-default">  <div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("spo",o.namingSchema())+'</h3></div>  <div class="panel-body">    <form class="form-horizontal">      <div class="form-group"><label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",o.namingSchema())+'</label>        <div class="col-sm-10"><input name="subject" class="form-control" /></div>      </div>      <div class="form-group"><label for="predicate" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("p",o.namingSchema())+'</label>        <div class="col-sm-10"><select name="predicate" class="form-control"></select></div>      </div>      <div class="form-group"><label for="object" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("o",o.namingSchema())+'</label>        <div class="col-sm-10"><input name="object" class="form-control" /></div>      </div>      <div class="form-group">        <div class="col-sm-10 col-sm-offset-2">          <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>           <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>         </div>      </div>    </form>  </div></div>').show();var s=o.formContainer.find('input[name="subject"]');s.focus(),(e||o.saveSubject)&&o.formContainer.find('input[name="subject"]').val(e||o.saveSubject);var a=o.formContainer.find('input[name="object"]').rdfNodeEditor(o.config.options);i&&a.setValue(new RDFE.RdfNode("literal",i,null,""));var l=o.formContainer.find('select[name="predicate"]').propertyBox({ontologyManager:o.ontologyManager}).on("changed",function(e,t){o.changeObjectType(t,a)});t&&l.setPropertyURI(t),o.formContainer.find("button.triple-action-new-cancel").click(function(e){e.preventDefault(),o.createTripleList()}),o.formContainer.find("button.triple-action-new-save").click(function(e){e.preventDefault();var t=s.val();if(t=RDFE.Utils.trim(RDFE.Utils.trim(t,"<"),">"),RDFE.Validate.check(s,t)){var i=l.selectedURI();if(i=RDFE.Utils.trim(RDFE.Utils.trim(i,"<"),">"),RDFE.Validate.check(l.sel,i)){var n=a.getValue();if("uri"==n.type&&(n.value=o.ontologyManager.uriDenormalize(n.value)),RDFE.Validate.check(a.getField(),n.value)){var r=o.doc.store.rdf.createTriple(o.doc.store.rdf.createNamedNode(t),o.doc.store.rdf.createNamedNode(i),n.toStoreNode(o.doc.store));o.doc.addTriples([r],function(){o.tripleView&&o.tripleView.addTriple(r),$(o).trigger("rdf-editor-success",{type:"triple-insert-success",message:"Successfully added new triple."}),o.saveSubject=t,o.createTripleList()},function(){$(o).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})}}}})},RDFE.Editor.prototype.createNewEntityEditor=function(n){var e,t,i,r=this;if(!r.doc)return!1;if(r.listContainer.hide(),r.formContainer.show(),n){var o=r.ontologyManager.ontologyClassByURI(n),s=o?o.label:RDFE.Utils.uri2name(n);r.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",r.namingSchema())+'</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <p class="form-control-static" title="'+n+'">'+s+'</p>    </div>   </div>   <div class="form-group">      <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",r.namingSchema())+' URI</label>      <div class="col-sm-10">        <input name="subject" id="subject" class="form-control" />      </div>   </div>   <div class="form-group">     <div class="col-sm-10 col-sm-offset-2">       <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>       <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>     </div>   </div> </div></div></div>\n'),r.formContainer.find("input#subject").focus()}else r.formContainer.html('<div class="panel panel-default"><div class="panel-heading"><h3 class="panel-title">Add new '+RDFE.Utils.namingSchemaLabel("s",r.namingSchema())+'</h3></div><div class="panel-body"><div class="form-horizontal">   <div class="form-group">     <label for="ontology" class="col-sm-2 control-label">Vocabulary</label>     <div class="col-sm-10">       <select name="ontology" id="ontology" class="form-control" />     </div>   </div>   <div class="form-group">     <label for="class" class="col-sm-2 control-label">Type</label>     <div class="col-sm-10">       <select name="class" id="class" class="form-control" />     </div>   </div>   <div class="form-group">      <label for="subject" class="col-sm-2 control-label">'+RDFE.Utils.namingSchemaLabel("s",r.namingSchema())+' URI</label>      <div class="col-sm-10">        <input name="subject" id="subject" class="form-control" />      </div>   </div>   <div class="form-group">     <div class="col-sm-10 col-sm-offset-2">       <button type="button" class="btn btn-default triple-action triple-action-new-cancel">Cancel</button>       <button type="submit" class="btn btn-primary triple-action triple-action-new-save">OK</button>     </div>   </div> </div></div></div>\n'),(e=$("#ontology").ontoBox({ontologyManager:r.ontologyManager})).on("changed",function(e){var t=r.ontologyManager.ontologyByURI(e.currentTarget.selectedOntologyURI());i.clearOptions(),i.addOption(t?t.classesAsArray():r.ontologyManager.allClasses())}),e.sel.focus(),t=$("#class").selectize({valueField:"URI",labelField:"URI",searchField:["title","label","prefix","URI"],sortField:["prefix","URI"],options:r.ontologyManager.allClasses(),create:function(e,t){t(r.ontologyManager.ontologyClassByURI(r.ontologyManager.uriDenormalize(e),!0))},render:{item:function(e,t){var i=e.title||e.label||name.curi||e.name;return"<div>"+(i=e.curi&&e.curi!=i?t(i)+" <small>("+t(e.curi)+")</small>":t(i))+"</div>"},option:function(e,t){return"<div>"+t(e.title||e.label||name.curi||e.name)+"<br/><small>("+t(e.URI)+")</small></div>"},option_create:function(e,t){var i=r.ontologyManager.uriDenormalize(e.input);return i!=e.input?'<div class="create">Add <strong>'+t(e.input)+"</strong> <small>("+t(i)+")</small>&hellip;</div>":'<div class="create">Add <strong>'+t(i)+"</strong>&hellip;</div>"}}}),i=t[0].selectize;r.config.options.entityUriTmpl&&r.formContainer.find('label[for="subject"]').text(RDFE.Utils.namingSchemaLabel("s",r.namingSchema())+" Name"),r.formContainer.find("button.triple-action-new-cancel").click(function(e){e.preventDefault(),r.listContainer.show(),r.formContainer.hide()});var a=function(){var e=r.formContainer.find('input[name="subject"]').val(),t=null,i=n||r.formContainer.find("#class")[0].selectize.getValue();e=RDFE.Utils.trim(RDFE.Utils.trim(e,"<"),">"),r.config.options.entityUriTmpl&&(t=e,e=null),r.doc.addEntity(e,t,i,function(e){r.entityView&&r.entityView.addEntity(e),$(r).trigger("rdf-editor-success",{type:"entity-insert-success",message:"Successfully created new entity."}),r.editEntity(e.uri)},function(){$(r).trigger("rdf-editor-error",{type:"triple-insert-failed",message:"Failed to add new triple to store."})})};r.formContainer.find("button.triple-action-new-save").click(function(e){e.preventDefault(),a()}),r.formContainer.find("input#subject").keypress(function(e){13===e.which&&a()})},RDFE.Editor.prototype.createEntityList=function(){var i=this;i.toggleSpinner(!0),i.entityView||(i.entityView=new RDFE.EntityView(i.doc,i.ontologyManager,i,{editFct:function(e){i.editEntity.call(i,e)}}),$(i.entityView).on("rdf-editor-error",function(e,t){$(i).trigger("rdf-editor-error",t)}).on("rdf-editor-success",function(e,t){$(i).trigger("rdf-editor-success",t)})),i.formContainer.hide(),i.listContainer.empty().show(),setTimeout(function(){i.entityView.render(i.listContainer,function(){i.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editEntity=function(e){var i=this;i.entityEditor||(i.entityEditor=new RDFE.EntityEditor(i.doc,i.ontologyManager),$(i.entityEditor).on("rdf-editor-error",function(e,t){$(i).trigger("rdf-editor-error",t)}).on("rdf-editor-success",function(e,t){$(i).trigger("rdf-editor-success",t)})),i.listContainer.hide(),i.formContainer.show(),i.entityEditor.render(i.formContainer,e,function(){i.formContainer.hide(),i.listContainer.show(),i.entityView.updateEntity(e)})},RDFE.Editor.prototype.createSubjectList=function(){var t=this;t.toggleSpinner(!0),t.subjectView||(t.subjectView=new RDFE.SubjectView(t,{editFct:function(e){t.editSubject.call(t,e)}})),t.formContainer.hide(),t.listContainer.empty().show(),setTimeout(function(){t.subjectView.render(t.listContainer,function(){t.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editSubject=function(e,t){var i=this;i.subjectEditor||(i.subjectEditor=new RDFE.SubjectEditor(i)),"string"==typeof e&&(e=i.doc.newSubject(e)),i.listContainer.hide(),i.formContainer.show(),i.subjectEditor.subject=e,i.subjectEditor.render(i,i.formContainer,t,function(){i.formContainer.hide(),i.listContainer.show(),e&&e.uri&&i.subjectView.updateSubject(e.uri)})},RDFE.Editor.prototype.createPredicateList=function(){var t=this;t.toggleSpinner(!0),t.predicateView||(t.predicateView=new RDFE.PredicateView(t,{editFct:function(e){t.editPredicate.call(t,e)}})),t.formContainer.hide(),t.listContainer.empty().show(),setTimeout(function(){t.predicateView.render(t.listContainer,function(){t.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editPredicate=function(e,t){var i=this;i.predicateEditor||(i.predicateEditor=new RDFE.PredicateEditor(i)),i.listContainer.hide(),i.formContainer.show(),"string"==typeof e&&(e=i.doc.newPredicate(e)),e&&i.ontologyManager.ontologyPropertyByURI(e.uri,!0),i.predicateEditor.predicate=e,i.predicateEditor.render(i,i.formContainer,t,function(){i.formContainer.hide(),i.listContainer.show(),e&&e.uri&&i.predicateView.updatePredicate(e.uri)})},RDFE.Editor.prototype.createObjectList=function(){var t=this;t.toggleSpinner(!0),t.objectView||(t.objectView=new RDFE.ObjectView(t,{editFct:function(e){t.editObject.call(t,e)}})),t.formContainer.hide(),t.listContainer.empty().show(),setTimeout(function(){t.objectView.render(t.listContainer,function(){t.toggleSpinner(!1)})},0)},RDFE.Editor.prototype.editObject=function(e,t){var i=this;i.objectEditor||(i.objectEditor=new RDFE.ObjectEditor(i)),"string"==typeof e&&(e=i.doc.newObject(e)),i.listContainer.hide(),i.formContainer.show(),i.objectEditor.object=e,i.objectEditor.render(i,i.formContainer,t,function(){i.formContainer.hide(),i.listContainer.show(),e&&i.objectView.updateObject(e)})},RDFE.Editor.prototype.changeObjectType=function(e,t){var i,n,r=t.getValue();if(e){var o=e.getRange();if(o&&o.length){for(var s=0;s<o.length;s++)if(t.isLiteralType(o[s])){i=new RDFE.RdfNode("literal",r.value,o[s],r.language);break}if(!i)if(n=this.doc.itemsByRange(o))i=new RDFE.RdfNode("uri",r.value),"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!==e.URI&&this.objectsLookup(t,o);else for(s=0;s<o.length;s++)t.isLiteralType(o[s])&&(i=new RDFE.RdfNode("literal",r.value,o[s],r.language))}}i||(i=new RDFE.RdfNode("literal",r.value,null,"")),t.setValue(i,n)},RDFE.Editor.prototype.objectsLookup=function(s,e){var t=this.config.options.objectLookups;if(t&&t.enabled){var i=t.sources;if(i)for(var n=RDFE.IO.createIO("http"),a=this.doc.store,r=0;r<i.length;r++)for(var o=0;o<e.length;o++){var l=e[o],u="urn:__GRAPH__"+r+"_"+o,c=i[r].url.format(encodeURIComponent(l)),d={success:function(n,r,o){return function(e,t,i){a.loadTurtle(e,n,n,null,function(e,t){if(!e){var i="select ?s from <{0}> where {?s a <{1}>}".format(n,r);a.execute(i,function(e,t){for(var i=[],n=0;n<t.length;n++)i.push(new RDFE.RdfNode("uri",t[n].s.value));s.updateSelection(o,i)})}}),a.clear(n,function(){})}}(u,l,i[r].label)};n.retrieveToStore(c,a,u,d)}}},RDFE.Editor.prototype.dataSetter=function(e,t,i){var n=this,r=i[e];if("subject"===e)r=n.doc.store.rdf.createNamedNode(r.value);else if("predicate"===e)r=n.doc.store.rdf.createNamedNode(r);else if("object"===e)if("uri"===r.type)r=n.doc.store.rdf.createNamedNode(r.value);else if("http://www.w3.org/2001/XMLSchema#dateTime"===r.datatype){var o=new Date(r.value);r=n.doc.store.rdf.createLiteral(o.toISOString(),r.language,r.datatype)}else r=n.doc.store.rdf.createLiteral(r.value,r.language,r.datatype);i[e]=r,n.doc.updateTriple(t,i,function(e){$(n).trigger("rdf-editor-success",{type:"triple-update-success",message:"Successfully updated triple."})},function(e){$(n).trigger("rdf-editor-error",{type:"triple-update-error",message:"Failed to update triple."})})},function(d){var e;window.RDFE||(window.RDFE={}),RDFE.OntologyView=((e=function(e,t){t=d.extend({},t),this.editor=e,this.ontologyManager=e.ontologyManager,this.ontologies=this.ontologyManager.allOntologies()}).prototype.render=function(e){var c=this;d(c.ontologyManager).on("changed",function(e,t){c.addOntologies(t.allOntologies())}),c.table=null,c.tableContainer=null,c.formContainer=null,e.empty();var t=d(document.createElement("div"));e.append(t);var i=d(document.createElement("table")).addClass("table");t.append(i);var n=d(document.createElement("div"));e.append(n);var r=c.ontologyManager.allOntologies();i.bootstrapTable({striped:!0,sortName:"prefix",showHeader:!1,classes:"table-hover table-condensed",height:157,data:r,idField:"URI",dataSetter:function(e,t,i){i=d.trim(i),e.prefix!==i&&(delete c.ontologyManager.prefixes[e.prefix],delete RDFE.prefixes[e.prefix],e.prefix=i,c.ontologyManager.prefixes[e.prefix]=e.URI,RDFE.prefixes[e.prefix]=e.URI)},columns:[{field:"prefix",title:"Prefix",titleTooltip:"Prefix",editable:function(e){return{mode:"inline",type:"text",value:e.prefix,emptytext:"empty",validate:function(e){var t=d.trim(e);return""==t?"This field is required":c.ontologyManager.ontologyByPrefix(t)?"This prefix is used":void 0}}},formatter:function(e,t,i){return t.prefix?t.prefix:""}},{field:"URI",title:"URI",titleTooltip:"URI",formatter:function(e,t,i){return['<span title="Vocabulary {0} - {1} classes, {2} properties">'.format(t.URI,t.classesLength(),t.propertiesLength()),"{0} - {1}/{2}".format(t.URI,t.classesLength(),t.propertiesLength()),"</span>"].join("")}},{field:"actions",title:"",align:"center",valign:"middle",clickToSelect:!1,formatter:function(e,t,i){return['<a class="refresh ml10" href="javascript:void(0)" title="Refresh vocabulary">','  <i class="glyphicon glyphicon-refresh"></i>',"</a>",'<a class="dereference ml10" href="javascript:void(0)" title="Dereference this vocabulary">','  <i class="glyphicon glyphicon-link"></i>',"</a>",'<a class="remove ml10" href="javascript:void(0)" title="Remove vocabulary">','  <i class="glyphicon glyphicon-remove"></i>',"</a>"].join("")},events:{"click .refresh":function(e,t,i,n){var r=d("#ontology-loading");if(!r.is(":visible")){r.show();var o={success:function(){d(c.ontologyManager).trigger("loadingFinished",[c.ontologyManager]),r.hide()},error:function(e){d(c.ontologyManager).trigger("loadingFailed",[c.ontologyManager]),d.notify({message:e.message},{type:"danger"}),r.hide()},ioType:"http"};c.ontologyManager.parseOntologyFile(i.URI,o)}},"click .dereference":function(e,t,i,n){c.editor.dereference()(i.URI)},"click .remove":function(e,t,i,n){c.ontologyManager.ontologyRemove(i.URI),c.table.bootstrapTable("remove",{field:"URI",values:[i.URI]})}}}]}),c.table=i,c.tableContainer=t,(c.formContainer=n).html('<div class="panel panel-default" style="border: 0; padding: 0; margin-bottom: 0;">   <div class="panel-body" style="padding-top: 10px; padding-bottom: 0;"><div class="form-horizontal">     <form class="form-horizontal">       <div class="form-group">         <label for="ontology" class="col-sm-2 control-label">Prefix</label>         <div class="col-sm-10">           <input name="prefix" id="prefix" class="form-control" />         </div>       </div>       <div class="form-group">         <label for="class" class="col-sm-2 control-label">URI</label>         <div class="col-sm-10">           <input name="uri" id="uri" class="form-control" />         </div>       </div>       <div class="form-group">         <div class="col-sm-10 col-sm-offset-2">           <button type="button" class="btn btn-default cancel">Cancel</button>           <button type="submit" class="btn btn-primary save">OK</button>         </div>       </div>     </form>   </div> </div>\n'),n.find(".cancel").click(function(e){e.preventDefault(),d("#ontology-loading").is(":visible")||(c.formContainer.hide(),c.tableContainer.show())}),n.find(".save").click(function(e){e.preventDefault();var t=d("#ontology-loading");if(!t.is(":visible")){var r=c.formContainer.find("#uri"),o=c.formContainer.find("#prefix"),i=function(){c.formContainer.hide(),c.tableContainer.show(),t.hide()},n={success:function(){d(c.ontologyManager).trigger("loadingFinished",[c.ontologyManager]),c.ontologyManager.prefixes[a]=s,i()},error:function(e){d(c.ontologyManager).trigger("loadingFailed",[c.ontologyManager]);var t=e&&e.message?e.message:"Error loading ontology";bootbox.confirm(t+". <br /><br />Do you want an empty ontology to be added?",function(e){if(e){var t=r.val(),i=o.val(),n=c.ontologyManager.ontologyByURI(t);n||(n=new RDFE.Ontology(c.ontologyManager,t,i),c.addOntologies(c.ontologyManager.allOntologies()))}}),i()}},s=r.val(),a=o.val();if(RDFE.Validate.check(r,s)){var l=RDFE.Utils.splitUrl(s);if("http:"===l.protocol||"https:"===l.protocol){if(c.ontologyManager.ontologyByURI(s)){var u="";return(l=c.ontologyManager.prefixByOntology(s))!==a&&(u=" with prefix "+a),void bootbox.alert("This ontology is loaded{0}. Please, use 'Refresh' action!".format(u))}t.show(),c.ontologyManager.parseOntologyFile(s,n)}else bootbox.alert("Only HTTP and HTTPS protocols are supported")}}}),n.find("#prefix").blur(function(e){var t=c.formContainer.find("#uri").val();if(!t){var i=c.formContainer.find("#prefix").val();i&&(t=RDFE.ontologyByPrefix(i))&&c.formContainer.find("#uri").val(t)}}),n.hide()},e.prototype.addOntologies=function(t){for(var i=0;i<t.length;i++)_.find(this.ontologies,function(e){return e.URI===t[i].URI})||this.table.bootstrapTable("append",t[i]);this.ontologies=t},e.prototype.add=function(e){this.formContainer.find("#prefix").val(""),this.formContainer.find("#uri").val(""),this.tableContainer.hide(),this.formContainer.show(),this.formContainer.find("#prefix").focus()},e)}(jQuery),function(){"use strict";var e=window.jQuery||window.$||(window.$={}),o={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(e){return String(e).evalJSON()}||e.parseJSON||e.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||e.toJSON};if("function"!=typeof o.parse||"function"!=typeof o.stringify)throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");var a,l={__jstorage_meta:{CRC32:{}}},i={jStorage:"{}"},n=null,t=0,r=!1,u={},s=!1,c=0,d={},h=+new Date,p={isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"HTML"!==t.nodeName},encode:function(t){if(!this.isXML(t))return!1;try{return(new XMLSerializer).serializeToString(t)}catch(e){try{return t.xml}catch(e){}}return!1},decode:function(e){var t,i="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t};return!!i&&(t=i.call("DOMParser"in window&&new DOMParser||window,e,"text/xml"),!!this.isXML(t)&&t)}};function f(){var e="{}";if("userDataBehavior"==r){n.load("jStorage");try{e=n.getAttribute("jStorage")}catch(e){}try{c=n.getAttribute("jStorage_update")}catch(e){}i.jStorage=e}y(),x(),k()}function g(){var e;clearTimeout(s),s=setTimeout(function(){if("localStorage"==r||"globalStorage"==r)e=i.jStorage_update;else if("userDataBehavior"==r){n.load("jStorage");try{e=n.getAttribute("jStorage_update")}catch(e){}}e&&e!=c&&(c=e,function(){var e,t=o.parse(o.stringify(l.__jstorage_meta.CRC32));f(),e=o.parse(o.stringify(l.__jstorage_meta.CRC32));var i,n=[],r=[];for(i in t)if(t.hasOwnProperty(i)){if(!e[i]){r.push(i);continue}t[i]!=e[i]&&"2."==String(t[i]).substr(0,2)&&n.push(i)}for(i in e)e.hasOwnProperty(i)&&(t[i]||n.push(i));v(n,"updated"),v(r,"deleted")}())},25)}function v(e,t){var i,n,r,o;if(e=[].concat(e||[]),"flushed"==t){for(var s in e=[],u)u.hasOwnProperty(s)&&e.push(s);t="deleted"}for(i=0,r=e.length;i<r;i++){if(u[e[i]])for(n=0,o=u[e[i]].length;n<o;n++)u[e[i]][n](e[i],t);if(u["*"])for(n=0,o=u["*"].length;n<o;n++)u["*"][n](e[i],t)}}function m(){var e=(+new Date).toString();if("localStorage"==r||"globalStorage"==r)try{i.jStorage_update=e}catch(e){r=!1}else"userDataBehavior"==r&&(n.setAttribute("jStorage_update",e),n.save("jStorage"));g()}function y(){if(i.jStorage)try{l=o.parse(String(i.jStorage))}catch(e){i.jStorage="{}"}else i.jStorage="{}";t=i.jStorage?String(i.jStorage).length:0,l.__jstorage_meta||(l.__jstorage_meta={}),l.__jstorage_meta.CRC32||(l.__jstorage_meta.CRC32={})}function b(){!function(){if(!l.__jstorage_meta.PubSub)return;for(var e=+new Date-2e3,t=0,i=l.__jstorage_meta.PubSub.length;t<i;t++)if(l.__jstorage_meta.PubSub[t][0]<=e){l.__jstorage_meta.PubSub.splice(t,l.__jstorage_meta.PubSub.length-t);break}l.__jstorage_meta.PubSub.length||delete l.__jstorage_meta.PubSub}();try{i.jStorage=o.stringify(l),n&&(n.setAttribute("jStorage",i.jStorage),n.save("jStorage")),t=i.jStorage?String(i.jStorage).length:0}catch(e){}}function w(e){if("string"!=typeof e&&"number"!=typeof e)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==e)throw new TypeError("Reserved key name");return!0}function x(){var e,t,i,n,r=1/0,o=!1,s=[];if(clearTimeout(a),l.__jstorage_meta&&"object"==typeof l.__jstorage_meta.TTL){for(t in e=+new Date,i=l.__jstorage_meta.TTL,n=l.__jstorage_meta.CRC32,i)i.hasOwnProperty(t)&&(i[t]<=e?(delete i[t],delete n[t],delete l[t],o=!0,s.push(t)):i[t]<r&&(r=i[t]));r!=1/0&&(a=setTimeout(x,Math.min(r-e,2147483647))),o&&(b(),m(),v(s,"deleted"))}}function k(){var e;if(l.__jstorage_meta.PubSub){var t,i=h,n=[];for(e=l.__jstorage_meta.PubSub.length-1;0<=e;e--)(t=l.__jstorage_meta.PubSub[e])[0]>h&&(i=t[0],n.unshift(t));for(e=n.length-1;0<=e;e--)_(n[e][1],n[e][2]);h=i}}function _(e,t){if(d[e])for(var i=0,n=d[e].length;i<n;i++)try{d[e][i](e,o.parse(o.stringify(t)))}catch(e){}}e.jStorage={version:"0.4.12",set:function(e,t,i){if(w(e),i=i||{},void 0===t)return this.deleteKey(e),t;if(p.isXML(t))t={_is_xml:!0,xml:p.encode(t)};else{if("function"==typeof t)return;t&&"object"==typeof t&&(t=o.parse(o.stringify(t)))}return l[e]=t,l.__jstorage_meta.CRC32[e]="2."+function(e,t){for(var i,n=e.length,r=t^n,o=0;4<=n;)i=1540483477*(65535&(i=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:r^=(255&e.charCodeAt(o+2))<<16;case 2:r^=(255&e.charCodeAt(o+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(o)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0}(o.stringify(t),2538058380),this.setTTL(e,i.TTL||0),v(e,"updated"),t},get:function(e,t){return w(e),e in l?l[e]&&"object"==typeof l[e]&&l[e]._is_xml?p.decode(l[e].xml):l[e]:void 0===t?null:t},deleteKey:function(e){return w(e),e in l&&(delete l[e],"object"==typeof l.__jstorage_meta.TTL&&e in l.__jstorage_meta.TTL&&delete l.__jstorage_meta.TTL[e],delete l.__jstorage_meta.CRC32[e],b(),m(),v(e,"deleted"),!0)},setTTL:function(e,t){var i=+new Date;return w(e),t=Number(t)||0,e in l&&(l.__jstorage_meta.TTL||(l.__jstorage_meta.TTL={}),0<t?l.__jstorage_meta.TTL[e]=i+t:delete l.__jstorage_meta.TTL[e],b(),x(),m(),!0)},getTTL:function(e){var t=+new Date;return w(e),e in l&&l.__jstorage_meta.TTL&&l.__jstorage_meta.TTL[e]&&l.__jstorage_meta.TTL[e]-t||0},flush:function(){return l={__jstorage_meta:{CRC32:{}}},b(),m(),v(null,"flushed"),!0},storageObj:function(){function e(){}return e.prototype=l,new e},index:function(){var e,t=[];for(e in l)l.hasOwnProperty(e)&&"__jstorage_meta"!=e&&t.push(e);return t},storageSize:function(){return t},currentBackend:function(){return r},storageAvailable:function(){return!!r},listenKeyChange:function(e,t){w(e),u[e]||(u[e]=[]),u[e].push(t)},stopListening:function(e,t){if(w(e),u[e])if(t)for(var i=u[e].length-1;0<=i;i--)u[e][i]==t&&u[e].splice(i,1);else delete u[e]},subscribe:function(e,t){if(!(e=(e||"").toString()))throw new TypeError("Channel not defined");d[e]||(d[e]=[]),d[e].push(t)},publish:function(e,t){if(!(e=(e||"").toString()))throw new TypeError("Channel not defined");var i,n;i=e,n=t,l.__jstorage_meta||(l.__jstorage_meta={}),l.__jstorage_meta.PubSub||(l.__jstorage_meta.PubSub=[]),l.__jstorage_meta.PubSub.unshift([+new Date,i,n]),b(),m()},reInit:function(){f()},noConflict:function(e){return delete window.$.jStorage,e&&(window.jStorage=this),this}},function(){var e=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),e=!0,window.localStorage.removeItem("_tmptest")}catch(e){}if(e)try{window.localStorage&&(i=window.localStorage,r="localStorage",c=i.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(i="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],r="globalStorage",c=i.jStorage_update)}catch(e){}else{if(!(n=document.createElement("link")).addBehavior)return n=null;n.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(n);try{n.load("jStorage")}catch(e){n.setAttribute("jStorage","{}"),n.save("jStorage"),n.load("jStorage")}var t="{}";try{t=n.getAttribute("jStorage")}catch(e){}try{c=n.getAttribute("jStorage_update")}catch(e){}i.jStorage=t,r="userDataBehavior"}y(),x(),"localStorage"==r||"globalStorage"==r?"addEventListener"in window?window.addEventListener("storage",g,!1):document.attachEvent("onstorage",g):"userDataBehavior"==r&&setInterval(g,1e3),k(),"addEventListener"in window&&window.addEventListener("pageshow",function(e){e.persisted&&g()},!1)}()}(),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):e.bootbox=t(e.jQuery)}(this,function t(u,c){"use strict";function l(e,t,i){e.stopPropagation(),e.preventDefault(),u.isFunction(i)&&!1===i(e)||t.modal("hide")}function d(e,i){var n=0;u.each(e,function(e,t){i(e,t,n++)})}function h(e,t,i){return u.extend(!0,{},e,function(e,t){var i=e.length,n={};if(i<1||2<i)throw new Error("Invalid argument length");return 2===i||"string"==typeof e[0]?(n[t[0]]=e[0],n[t[1]]=e[1]):n=e[0],n}(t,i))}function i(e,t,i,n){return f(h({className:"bootbox-"+e,buttons:p.apply(null,t)},n,i),t)}function p(){for(var e={},t=0,i=arguments.length;t<i;t++){var n=arguments[t],r=n.toLowerCase(),o=n.toUpperCase();e[r]={label:(s=o,void 0,a=y[v.locale],a?a[s]:y.en[s])}}var s,a;return e}function f(e,t){var i={};return d(t,function(e,t){i[t]=!0}),d(e.buttons,function(e){if(i[e]===c)throw new Error("button key "+e+" is not allowed (options are "+t.join("\n")+")")}),e}var g={dialog:"<div class='bootbox modal' tabindex='-1' role='dialog'><div class='modal-dialog'><div class='modal-content'><div class='modal-body'><div class='bootbox-body'></div></div></div></div></div>",header:"<div class='modal-header'><h4 class='modal-title'></h4></div>",footer:"<div class='modal-footer'></div>",closeButton:"<button type='button' class='bootbox-close-button close' data-dismiss='modal' aria-hidden='true'>&times;</button>",form:"<form class='bootbox-form'></form>",inputs:{text:"<input class='bootbox-input bootbox-input-text form-control' autocomplete=off type=text />",textarea:"<textarea class='bootbox-input bootbox-input-textarea form-control'></textarea>",email:"<input class='bootbox-input bootbox-input-email form-control' autocomplete='off' type='email' />",select:"<select class='bootbox-input bootbox-input-select form-control'></select>",checkbox:"<div class='checkbox'><label><input class='bootbox-input bootbox-input-checkbox' type='checkbox' /></label></div>",date:"<input class='bootbox-input bootbox-input-date form-control' autocomplete=off type='date' />",time:"<input class='bootbox-input bootbox-input-time form-control' autocomplete=off type='time' />",number:"<input class='bootbox-input bootbox-input-number form-control' autocomplete=off type='number' />",password:"<input class='bootbox-input bootbox-input-password form-control' autocomplete='off' type='password' />"}},v={locale:"en",backdrop:!0,animate:!0,className:null,closeButton:!0,show:!0,container:"body"},m={alert:function(){var e;if((e=i("alert",["ok"],["message","callback"],arguments)).callback&&!u.isFunction(e.callback))throw new Error("alert requires callback property to be a function when provided");return e.buttons.ok.callback=e.onEscape=function(){return!u.isFunction(e.callback)||e.callback()},m.dialog(e)},confirm:function(){var e;if((e=i("confirm",["cancel","confirm"],["message","callback"],arguments)).buttons.cancel.callback=e.onEscape=function(){return e.callback(!1)},e.buttons.confirm.callback=function(){return e.callback(!0)},!u.isFunction(e.callback))throw new Error("confirm requires a callback");return m.dialog(e)},prompt:function(){var t,e,i,n,r,o,s;if(n=u(g.form),e={className:"bootbox-prompt",buttons:p("cancel","confirm"),value:"",inputType:"text"},o=(t=f(h(e,arguments,["title","callback"]),["cancel","confirm"])).show===c||t.show,t.message=n,t.buttons.cancel.callback=t.onEscape=function(){return t.callback(null)},t.buttons.confirm.callback=function(){var i;switch(t.inputType){case"text":case"textarea":case"email":case"select":case"date":case"time":case"number":case"password":i=r.val();break;case"checkbox":var e=r.find("input:checked");i=[],d(e,function(e,t){i.push(u(t).val())})}return t.callback(i)},t.show=!1,!t.title)throw new Error("prompt requires a title");if(!u.isFunction(t.callback))throw new Error("prompt requires a callback");if(!g.inputs[t.inputType])throw new Error("invalid prompt type");switch(r=u(g.inputs[t.inputType]),t.inputType){case"text":case"textarea":case"email":case"date":case"time":case"number":case"password":r.val(t.value);break;case"select":var a={};if(!(s=t.inputOptions||[]).length)throw new Error("prompt with select requires options");d(s,function(e,t){var i=r;if(t.value===c||t.text===c)throw new Error("given options in wrong format");t.group&&(a[t.group]||(a[t.group]=u("<optgroup/>").attr("label",t.group)),i=a[t.group]),i.append("<option value='"+t.value+"'>"+t.text+"</option>")}),d(a,function(e,t){r.append(t)}),r.val(t.value);break;case"checkbox":var l=u.isArray(t.value)?t.value:[t.value];if(!(s=t.inputOptions||[]).length)throw new Error("prompt with checkbox requires options");if(!s[0].value||!s[0].text)throw new Error("given options in wrong format");r=u("<div/>"),d(s,function(e,i){var n=u(g.inputs[t.inputType]);n.find("input").attr("value",i.value),n.find("label").append(i.text),d(l,function(e,t){t===i.value&&n.find("input").prop("checked",!0)}),r.append(n)})}return t.placeholder&&r.attr("placeholder",t.placeholder),t.pattern&&r.attr("pattern",t.pattern),n.append(r),n.on("submit",function(e){e.preventDefault(),e.stopPropagation(),i.find(".btn-primary").click()}),(i=m.dialog(t)).off("shown.bs.modal"),i.on("shown.bs.modal",function(){r.focus()}),!0===o&&i.modal("show"),i}};m.dialog=function(e){e=function(e){var n,r;if("object"!=typeof e)throw new Error("Please supply an object of options");if(!e.message)throw new Error("Please specify a message");return(e=u.extend({},v,e)).buttons||(e.buttons={}),e.backdrop=!!e.backdrop&&"static",n=e.buttons,r=function(e){var t,i=0;for(t in e)i++;return i}(n),d(n,function(e,t,i){if(u.isFunction(t)&&(t=n[e]={callback:t}),"object"!==u.type(t))throw new Error("button with key "+e+" must be an object");t.label||(t.label=e),t.className||(t.className=r<=2&&i===r-1?"btn-primary":"btn-default")}),e}(e);var i=u(g.dialog),t=i.find(".modal-dialog"),n=i.find(".modal-body"),r=e.buttons,o="",s={onEscape:e.onEscape};if(d(r,function(e,t){o+="<button data-bb-handler='"+e+"' type='button' class='btn "+t.className+"'>"+t.label+"</button>",s[e]=t.callback}),n.find(".bootbox-body").html(e.message),!0===e.animate&&i.addClass("fade"),e.className&&i.addClass(e.className),"large"===e.size&&t.addClass("modal-lg"),"small"===e.size&&t.addClass("modal-sm"),e.title&&n.before(g.header),e.closeButton){var a=u(g.closeButton);e.title?i.find(".modal-header").prepend(a):a.css("margin-top","-10px").prependTo(n)}return e.title&&i.find(".modal-title").html(e.title),o.length&&(n.after(g.footer),i.find(".modal-footer").html(o)),i.on("hidden.bs.modal",function(e){e.target===this&&i.remove()}),i.on("shown.bs.modal",function(){i.find(".btn-primary:first").focus()}),i.on("escape.close.bb",function(e){s.onEscape&&l(e,i,s.onEscape)}),i.on("click",".modal-footer button",function(e){var t=u(this).data("bb-handler");l(e,i,s[t])}),i.on("click",".bootbox-close-button",function(e){l(e,i,s.onEscape)}),i.on("keyup",function(e){27===e.which&&i.trigger("escape.close.bb")}),u(e.container).append(i),i.modal({backdrop:e.backdrop,keyboard:!1,show:!1}),e.show&&i.modal("show"),i},m.setDefaults=function(){var e={};2===arguments.length?e[arguments[0]]=arguments[1]:e=arguments[0],u.extend(v,e)},m.hideAll=function(){return u(".bootbox").modal("hide"),m};var y={br:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Sim"},cs:{OK:"OK",CANCEL:"Zrušit",CONFIRM:"Potvrdit"},da:{OK:"OK",CANCEL:"Annuller",CONFIRM:"Accepter"},de:{OK:"OK",CANCEL:"Abbrechen",CONFIRM:"Akzeptieren"},el:{OK:"Εντάξει",CANCEL:"Ακύρωση",CONFIRM:"Επιβεβαίωση"},en:{OK:"OK",CANCEL:"Cancel",CONFIRM:"OK"},es:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Aceptar"},et:{OK:"OK",CANCEL:"Katkesta",CONFIRM:"OK"},fi:{OK:"OK",CANCEL:"Peruuta",CONFIRM:"OK"},fr:{OK:"OK",CANCEL:"Annuler",CONFIRM:"D'accord"},he:{OK:"אישור",CANCEL:"ביטול",CONFIRM:"אישור"},id:{OK:"OK",CANCEL:"Batal",CONFIRM:"OK"},it:{OK:"OK",CANCEL:"Annulla",CONFIRM:"Conferma"},ja:{OK:"OK",CANCEL:"キャンセル",CONFIRM:"確認"},lt:{OK:"Gerai",CANCEL:"Atšaukti",CONFIRM:"Patvirtinti"},lv:{OK:"Labi",CANCEL:"Atcelt",CONFIRM:"Apstiprināt"},nl:{OK:"OK",CANCEL:"Annuleren",CONFIRM:"Accepteren"},no:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},pl:{OK:"OK",CANCEL:"Anuluj",CONFIRM:"Potwierdź"},pt:{OK:"OK",CANCEL:"Cancelar",CONFIRM:"Confirmar"},ru:{OK:"OK",CANCEL:"Отмена",CONFIRM:"Применить"},sv:{OK:"OK",CANCEL:"Avbryt",CONFIRM:"OK"},tr:{OK:"Tamam",CANCEL:"İptal",CONFIRM:"Onayla"},zh_CN:{OK:"OK",CANCEL:"取消",CONFIRM:"确认"},zh_TW:{OK:"OK",CANCEL:"取消",CONFIRM:"確認"}};return m.init=function(e){return t(e||u)},m}),function(d){d.deparam=function(e,l){var u={},c={true:!0,false:!1,null:null};return d.each(e.replace(/\+/g," ").split("&"),function(e,t){var i=t.split("="),n=decodeURIComponent(i[0]),r=u,o=0,s=n.split("]["),a=s.length-1;if(a=/\[/.test(s[0])&&/\]$/.test(s[a])?(s[a]=s[a].replace(/\]$/,""),(s=s.shift().split("[").concat(s)).length-1):0,2===i.length)if(i=decodeURIComponent(i[1]),l&&(i=i&&!isNaN(i)?+i:"undefined"===i?void 0:void 0!==c[i]?c[i]:i),a)for(;o<=a;o++)r=r[n=""===s[o]?r.length:s[o]]=o<a?r[n]||(s[o+1]&&isNaN(s[o+1])?{}:[]):i;else d.isArray(u[n])?u[n].push(i):u[n]=void 0!==u[n]?[u[n],i]:i;else n&&(u[n]=l?void 0:"")}),u}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(f){var n=/\+/g;function g(e){return m.raw?e:encodeURIComponent(e)}function v(e,t){var i=m.raw?e:function(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(n," ")),m.json?JSON.parse(e):e}catch(e){}}(e);return f.isFunction(t)?t(i):i}var m=f.cookie=function(e,t,i){if(void 0!==t&&!f.isFunction(t)){if("number"==typeof(i=f.extend({},m.defaults,i)).expires){var n=i.expires,r=i.expires=new Date;r.setTime(+r+864e5*n)}return document.cookie=[g(e),"=",(o=t,g(m.json?JSON.stringify(o):String(o))),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var o,s,a=e?void 0:{},l=document.cookie?document.cookie.split("; "):[],u=0,c=l.length;u<c;u++){var d=l[u].split("="),h=(s=d.shift(),m.raw?s:decodeURIComponent(s)),p=d.join("=");if(e&&e===h){a=v(p,t);break}e||void 0===(p=v(p))||(a[h]=p)}return a};m.defaults={},f.removeCookie=function(e,t){return void 0!==f.cookie(e)&&(f.cookie(e,"",f.extend({},t,{expires:-1})),!f.cookie(e))}}),function(e){if("object"==typeof exports)e(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define(["jquery","spin"],e);else{if(!window.Spinner)throw new Error("Spin.js not present");e(window.jQuery,window.Spinner)}}(function(r,o){r.fn.spin=function(i,n){return this.each(function(){var e=r(this),t=e.data();t.spinner&&(t.spinner.stop(),delete t.spinner),!1!==i&&(i=r.extend({color:n||e.css("color")},r.fn.spin.presets[i]||i),t.spinner=new o(i).spin(this))})},r.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(c){function i(e,t,i){var l,u,n={content:{message:"object"==typeof t?t.message:t,title:t.title?t.title:"",icon:t.icon?t.icon:"",url:t.url?t.url:"#",target:t.target?t.target:"-"}};i=c.extend(!0,{},n,i),this.settings=c.extend(!0,{},r,i),this._defaults=r,"-"===this.settings.content.target&&(this.settings.content.target=this.settings.url_target),this.animations={start:"webkitAnimationStart oanimationstart MSAnimationStart animationstart",end:"webkitAnimationEnd oanimationend MSAnimationEnd animationend"},"number"==typeof this.settings.offset&&(this.settings.offset={x:this.settings.offset,y:this.settings.offset}),(this.settings.allow_duplicates||!this.settings.allow_duplicates&&(l=this,u=!1,c('[data-notify="container"]').each(function(e,t){var i=c(t),n=i.find('[data-notify="title"]').text().trim(),r=i.find('[data-notify="message"]').html().trim(),o=n===c("<div>"+l.settings.content.title+"</div>").html().trim(),s=r===c("<div>"+l.settings.content.message+"</div>").html().trim(),a=i.hasClass("alert-"+l.settings.type);return o&&s&&a&&(u=!0),!u}),!u))&&this.init()}var r={element:"body",position:null,type:"info",allow_dismiss:!0,allow_duplicates:!0,newest_on_top:!1,showProgressbar:!1,placement:{from:"top",align:"right"},offset:20,spacing:10,z_index:1031,delay:5e3,timer:1e3,url_target:"_blank",mouse_over:null,animate:{enter:"animated fadeInDown",exit:"animated fadeOutUp"},onShow:null,onShown:null,onClose:null,onClosed:null,icon_type:"class",template:'<div data-notify="container" class="col-xs-11 col-sm-4 alert alert-{0}" role="alert"><button type="button" aria-hidden="true" class="close" data-notify="dismiss">&times;</button><span data-notify="icon"></span> <span data-notify="title">{1}</span> <span data-notify="message">{2}</span><div class="progress" data-notify="progressbar"><div class="progress-bar progress-bar-{0}" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;"></div></div><a href="{3}" target="{4}" data-notify="url"></a></div>'};String.format=function(){for(var e=arguments[0],t=1;t<arguments.length;t++)e=e.replace(RegExp("\\{"+(t-1)+"\\}","gm"),arguments[t]);return e},c.extend(i.prototype,{init:function(){var a=this;this.buildNotify(),this.settings.content.icon&&this.setIcon(),"#"!=this.settings.content.url&&this.styleURL(),this.styleDismiss(),this.placement(),this.bind(),this.notify={$ele:this.$ele,update:function(e,t){var i={};for(var n in"string"==typeof e?i[e]=t:i=e,i)switch(n){case"type":this.$ele.removeClass("alert-"+a.settings.type),this.$ele.find('[data-notify="progressbar"] > .progress-bar').removeClass("progress-bar-"+a.settings.type),a.settings.type=i[n],this.$ele.addClass("alert-"+i[n]).find('[data-notify="progressbar"] > .progress-bar').addClass("progress-bar-"+i[n]);break;case"icon":var r=this.$ele.find('[data-notify="icon"]');"class"===a.settings.icon_type.toLowerCase()?r.removeClass(a.settings.content.icon).addClass(i[n]):(r.is("img")||r.find("img"),r.attr("src",i[n]));break;case"progress":var o=a.settings.delay-a.settings.delay*(i[n]/100);this.$ele.data("notify-delay",o),this.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",i[n]).css("width",i[n]+"%");break;case"url":this.$ele.find('[data-notify="url"]').attr("href",i[n]);break;case"target":this.$ele.find('[data-notify="url"]').attr("target",i[n]);break;default:this.$ele.find('[data-notify="'+n+'"]').html(i[n])}var s=this.$ele.outerHeight()+parseInt(a.settings.spacing)+parseInt(a.settings.offset.y);a.reposition(s)},close:function(){a.close()}}},buildNotify:function(){var e=this.settings.content;this.$ele=c(String.format(this.settings.template,this.settings.type,e.title,e.message,e.url,e.target)),this.$ele.attr("data-notify-position",this.settings.placement.from+"-"+this.settings.placement.align),this.settings.allow_dismiss||this.$ele.find('[data-notify="dismiss"]').css("display","none"),(this.settings.delay<=0&&!this.settings.showProgressbar||!this.settings.showProgressbar)&&this.$ele.find('[data-notify="progressbar"]').remove()},setIcon:function(){"class"===this.settings.icon_type.toLowerCase()?this.$ele.find('[data-notify="icon"]').addClass(this.settings.content.icon):this.$ele.find('[data-notify="icon"]').is("img")?this.$ele.find('[data-notify="icon"]').attr("src",this.settings.content.icon):this.$ele.find('[data-notify="icon"]').append('<img src="'+this.settings.content.icon+'" alt="Notify Icon" />')},styleDismiss:function(){this.$ele.find('[data-notify="dismiss"]').css({position:"absolute",right:"10px",top:"5px",zIndex:this.settings.z_index+2})},styleURL:function(){this.$ele.find('[data-notify="url"]').css({backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:this.settings.z_index+1})},placement:function(){var i=this,e=this.settings.offset.y,t={display:"inline-block",margin:"0px auto",position:this.settings.position?this.settings.position:"body"===this.settings.element?"fixed":"absolute",transition:"all .5s ease-in-out",zIndex:this.settings.z_index},n=!1,r=this.settings;switch(c('[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])').each(function(){e=Math.max(e,parseInt(c(this).css(r.placement.from))+parseInt(c(this).outerHeight())+parseInt(r.spacing))}),!0===this.settings.newest_on_top&&(e=this.settings.offset.y),t[this.settings.placement.from]=e+"px",this.settings.placement.align){case"left":case"right":t[this.settings.placement.align]=this.settings.offset.x+"px";break;case"center":t.left=0,t.right=0}this.$ele.css(t).addClass(this.settings.animate.enter),c.each(Array("webkit-","moz-","o-","ms-",""),function(e,t){i.$ele[0].style[t+"AnimationIterationCount"]=1}),c(this.settings.element).append(this.$ele),!0===this.settings.newest_on_top&&(e=parseInt(e)+parseInt(this.settings.spacing)+this.$ele.outerHeight(),this.reposition(e)),c.isFunction(i.settings.onShow)&&i.settings.onShow.call(this.$ele),this.$ele.one(this.animations.start,function(){n=!0}).one(this.animations.end,function(){i.$ele.removeClass(i.settings.animate.enter),c.isFunction(i.settings.onShown)&&i.settings.onShown.call(this)}),setTimeout(function(){n||c.isFunction(i.settings.onShown)&&i.settings.onShown.call(this)},600)},bind:function(){var i=this;if(this.$ele.find('[data-notify="dismiss"]').on("click",function(){i.close()}),this.$ele.mouseover(function(){c(this).data("data-hover","true")}).mouseout(function(){c(this).data("data-hover","false")}),this.$ele.data("data-hover","false"),0<this.settings.delay){i.$ele.data("notify-delay",i.settings.delay);var n=setInterval(function(){var e=parseInt(i.$ele.data("notify-delay"))-i.settings.timer;if("false"===i.$ele.data("data-hover")&&"pause"===i.settings.mouse_over||"pause"!=i.settings.mouse_over){var t=(i.settings.delay-e)/i.settings.delay*100;i.$ele.data("notify-delay",e),i.$ele.find('[data-notify="progressbar"] > div').attr("aria-valuenow",t).css("width",t+"%")}e<=-i.settings.timer&&(clearInterval(n),i.close())},i.settings.timer)}},close:function(){var e=this,t=parseInt(this.$ele.css(this.settings.placement.from)),i=!1;this.$ele.attr("data-closing","true").addClass(this.settings.animate.exit),e.reposition(t),c.isFunction(e.settings.onClose)&&e.settings.onClose.call(this.$ele),this.$ele.one(this.animations.start,function(){i=!0}).one(this.animations.end,function(){c(this).remove(),c.isFunction(e.settings.onClosed)&&e.settings.onClosed.call(this)}),setTimeout(function(){i||(e.$ele.remove(),e.settings.onClosed&&e.settings.onClosed(e.$ele))},600)},reposition:function(e){var t=this,i='[data-notify-position="'+this.settings.placement.from+"-"+this.settings.placement.align+'"]:not([data-closing="true"])',n=this.$ele.nextAll(i);!0===this.settings.newest_on_top&&(n=this.$ele.prevAll(i)),n.each(function(){c(this).css(t.settings.placement.from,e),e=parseInt(e)+parseInt(t.settings.spacing)+c(this).outerHeight()})}}),c.notify=function(e,t){return new i(this,e,t).notify},c.notifyDefaults=function(e){return r=c.extend(!0,{},r,e)},c.notifyClose=function(e){"warning"===e&&(e="danger"),void 0===e||"all"===e?c("[data-notify]").find('[data-notify="dismiss"]').trigger("click"):"success"===e||"info"===e||"warning"===e||"danger"===e?c(".alert-"+e+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):e?c(e+"[data-notify]").find('[data-notify="dismiss"]').trigger("click"):c('[data-notify-position="'+e+'"]').find('[data-notify="dismiss"]').trigger("click")},c.notifyCloseExcept=function(e){"warning"===e&&(e="danger"),"success"===e||"info"===e||"warning"===e||"danger"===e?c("[data-notify]").not(".alert-"+e).find('[data-notify="dismiss"]').trigger("click"):c("[data-notify]").not(e).find('[data-notify="dismiss"]').trigger("click")}});